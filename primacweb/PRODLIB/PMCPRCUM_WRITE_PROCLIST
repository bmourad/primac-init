SUBROUTINE PMCPRCUM_WRITE_PROCLIST
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB PMC_PROCESS
$INCLUDE PMC.CPYLIB SECURITY

ERRMSG = ''
CONO = ''
USER.ID = ''
PMCProperty = ''

STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
STATUS=RBO.getProperty('','UserId',USER.ID)
STATUS=RBO.getProperty('','Process',PROC.LIST)

CONO = PMCProperty<1,4>
USER.ID=UPCASE(USER.ID)
USER.ID=CONO:USER.ID
SEC.ID="_":USER.ID

OPEN "","SECURITY" TO SECURITY ELSE
  ERRMSG = "CANNOT OPEN SECURITY FILE"
  GOTO 93000
END

 PROCESS.ONFILE = 1
  OPEN "","PMC_PROCESS" TO PMC_PROCESS ELSE
    PROCESS.ONFILE = 0
    ERRMSG = "CANNOT OPEN PMC_PROCESS FILE"
    GOTO 93000
  END

READU PROC.LIST FROM SECURITY,SEC.ID ELSE 
ERRMSG = 'SECURITY RECORD IS LOKED BY ANOTHER USER'
GOSUB 93000
GOTO 99999
END

SAVE.PROC.LIST=PROC.LIST

      STATUS = RBO.getProperty('', 'Process',PROC.LIST)
	IF SAVE.PROC.LIST # PROC.LIST THEN
		WRITEU PROC.LIST ON SECURITY,SEC.ID 
	END ELSE
 ERRMSG="PROCESS EXIST ,INVALID ENTRY !! PLEASE re-ENTER."
GOSUB  93000
GOTO   99999
  	END

RETURN
93000:
IF ERRMSG # "" THEN
      STATUS = RBO.setProperty('', 'ServerStatus', 1)
      STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)
END
RETURN

99999:
  RELEASE
RETURN

