SUBROUTINE INVREGM_VALIDATE_PROD
********************************************************************************
*   Program name :- INVREGM_VALIDATE_PROD
*   Created:- 10/6/2005
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE ICS.CPYLIB INVENTORY

OPEN "","COMPANY" TO COMPANY ELSE ERRMSG = "CANNOT OPEN COMPANY FILE";GOTO 91000
OPEN "","INVENTORY" TO INVENTORY ELSE ERRMSG = "CANNOT OPEN INVENTORY FILE";GOTO 91000

* Insert method code here
  STATUS = RBO.getProperty("","ID",PROD.ID)
  CONO = PROD.ID[1,3]

  MATREAD COMP.REC FROM COMPANY,CONO ELSE ERRMSG = "CANNOT READ COMPANY FILE";GOTO 91000
  MATREAD INV.REC FROM INVENTORY,PROD.ID ELSE MAT INV.REC = ""

  IF INV.M.LINE = "FNGD" THEN
     IF CO.OPS = 'Y' THEN ERRMSG = "This product is a Finished Goods Product";GOTO 91000
  END
  IF INV.PAP.TYPE = "ROLL" OR INV.PAP.TYPE = "SKID" OR INV.PAP.TYPE = "SHEET" OR INV.PAP.TYPE = "LROLL" OR INV.PAP.TYPE = "PCOAT" THEN
     ERRMSG = "This product is a Paper Product";GOTO 91000
  END
RETURN

* End of method code
91000*
   STATUS = RBO.setProperty("","ServerStatus",1)
   STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
RETURN

