SUBROUTINE PURGED_INV_INQ_DET
********************************************************************************
*   Program name :- PURGED_INV_INQ_DET
*   Created:- 1/5/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

* Insert method code here
$INCLUDE ARS.CPYLIB PURGED.OPEN.RECV
$INCLUDE CPYLIB CHAR
 
  CALL RBO_OPEN_FILE('PURGED.OPEN.RECV', PURGED.OPEN.RECV, ERRMSG)

  ERRMSG = ''
  IF ERRMSG THEN
     CALL RBO_ERROR_SUB(ERRMSG); RETURN
  END
  
  CALL RBO_GET_PROPERTY('ID', ID, ERRMSG)
  CALL RBO_GET_PROPERTY('INV_NUMBERS', POR.IDENT, ERRMSG)
  * Get CONO
  CONO = ID[1,3]
  OUTPUT_VAR = ''
  POR_TYPE = ''
  POR_TR_DATE = ''
  POR_INV_AMT = ''
  POR_CHECK = ''
  POR_CHK_DATE = ''
  POR_CHK_AMT = ''

  MATREAD POR.REC FROM PURGED.OPEN.RECV,CONO:POR.IDENT ELSE MAT POR.REC = ""
  LAST.TRAN.DATE = DCOUNT(POR.TR.DATE,VM)
  IF LAST.TRAN.DATE < 1 THEN
    POR.DTP = "????"
  END ELSE
    POR.DTP = POR.TR.DATE<1,LAST.TRAN.DATE> - POR.INV.DATE
  END

**** GET ALL VALUES TO BE PRINTED
*10000*
  OUTPUT_VAR = POR.JOB: "~" :OCONV(POR.AS.DATE,"D2/"): "~" :POR.PO: "~" :OCONV(POR.INV.DATE,"D2/"): "~" :OCONV(POR.BAL,"MD2"): "~" :OCONV(POR.AS.DATE,"D2/"): "~" :POR.DIV: "~" :POR.DTP

**** SCROLL TRANSACTION DETAIL
  START.LINE = 1
  LAST.LINE = DCOUNT(POR.TYPE,VM)
  CNT = 1
  FOR N = START.LINE TO LAST.LINE
    POR_TYPE<1,N> = POR.TYPE<1,N>
    POR_TR_DATE<1,N> = OCONV(POR.TR.DATE<1,N>,"D2/")
    POR_INV_AMT<1,N> = OCONV(POR.INV.AMT<1,N>,"MD2")
    POR_CHECK<1,N> = POR.CHECK<1,N>
    POR_CHK_DATE<1,N> = OCONV(POR.CHK.DATE<1,N>,"D2/")
    POR_CHK_AMT<1,N> = OCONV(POR.CHK.AMT<1,N>,"MD2")
    CNT = CNT + 1
  NEXT N
*CALL RBO_ERROR_SUB(POR_TYPE); RETURN
* Set properties
CALL RBO_SET_PROPERTY('OUTPUT_VAR', OUTPUT_VAR, ERRMSG)
CALL RBO_SET_PROPERTY('POR_TYPE', POR_TYPE, ERRMSG)
CALL RBO_SET_PROPERTY('POR_TR_DATE', POR_TR_DATE, ERRMSG)
CALL RBO_SET_PROPERTY('POR_INV_AMT', POR_INV_AMT, ERRMSG)
CALL RBO_SET_PROPERTY('POR_CHECK', POR_CHECK, ERRMSG)
CALL RBO_SET_PROPERTY('POR_CHK_DATE', POR_CHK_DATE , ERRMSG)
CALL RBO_SET_PROPERTY('POR_CHK_AMT', POR_CHK_AMT, ERRMSG)
* End of method code

RETURN

