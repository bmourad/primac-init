SUBROUTINE BOLM_GetProdDesc
********************************************************************************
*   Program name :- BOLM_GetProdDesc
*   Created:- 4/19/2004 RAZI
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE OPS.CPYLIB ORDER.DETAIL
$INCLUDE CPYLIB CHAR
$INCLUDE OPS.CPYLIB BOL
* Insert method code here

ERRMSG=''
OPEN "","DAILY.BOL" TO DAILY.BOL ELSE
      ERRMSG = "Cannot locate the DAILY.BOL file"; GOTO 1000
END

OPEN "","INVENTORY" TO INVENTORY ELSE
	    ERRMSG = "CANNOT OPEN INVENTORY FILE"
END
PRODDESC = ''
STATUS=RBO.getProperty('','ID',ID)
CONO=ID[1,3]
BOLNO=ID[4,99]

MATREAD BOL.REC FROM DAILY.BOL,CONO:BOLNO THEN
	BOL_PROD = BOL.REC(24)
	PCNT=DCOUNT(BOL_PROD,VM)
 
       FOR I=1 TO PCNT	
		MATREAD INV.REC FROM INVENTORY,CONO:BOL_PROD<1,I> THEN
			PRODDESC<1,I>=INV.FULL.DESC
		END
       NEXT I

END
STATUS = RBO.setProperty('','INV_PROD_DSC',PRODDESC)
* End of method code
RETURN

1000
STATUS = RBO.setProperty('','ServerStatus',1)        
STATUS = RBO.setProperty('','ServerMessage',ERRMSG) 
RETURN

