SUBROUTINE ValidateEquipment
********************************************************************************
*   Program name :- ValidateEquipment
*   Created:- 5/12/2005
*   Ravi Kishore Adidam
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JES.CPYLIB EQUIPMENT
$INCLUDE JES.CPYLIB ESTIMATE.RES.PRESS.SPOIL
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE PMC.CPYLIB COST.CNTR

	OPEN "","COMPANY" TO COMPANY ELSE
		ERRMSG = "CANNOT OPEN COMPANY FILE"
		GOSUB 90000
	END

	OPEN "","CONTROL" TO CONTROL ELSE
		ERRMSG = "CANNOT OPEN CONTROL FILE"
		GOSUB 90000
	END

	OPEN "","COST.CNTR" TO COST.CNTR ELSE
		ERRMSG = "CANNOT OPEN COST.CNTR FILE"
		GOSUB 90000
	END

	OPEN '','EQUIPMENT' TO EQUIPMENT ELSE
		ERRMSG = "CANNOT OPEN EQUIPMENT FILE"
		GOSUB 90000
	END

	OPEN "","ESTIMATE.RES.PRESS.SPOIL" TO ESTIMATE.RES.PRESS.SPOIL ELSE
		ERRMSG = "CANNOT OPEN ESTIMATE.RES.PRESS.SPOIL FILE"
		GOSUB 90000
	END

	STATUS=RBO.getProperty('','ID',ID)

	MATREAD EQUIPMENT.REC FROM EQUIPMENT, ID THEN 
		ERRMSG	= "Y"
	END ELSE
       	ERRMSG = "Invalid equipment ID. Try again !"
		GOSUB 90000
	END
      
	IF EQP.TYPE # "40" THEN
       	ERRMSG = "Equipment not a Roll Label Press ID"
		GOSUB 90000
	END	

	MATREAD CCTR.REC FROM COST.CNTR, ID ELSE
       	READV CCTR.DESC FROM COST.CNTR, ID ELSE CCTR.DESC = ''
	END
	
	STATUS=RBO.setProperty('','CCTR_DESC',CCTR.DESC)
	
90000
	STATUS=RBO.setProperty('','ServerMessage',ERRMSG)
