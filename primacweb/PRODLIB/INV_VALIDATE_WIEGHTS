SUBROUTINE INV_VALIDATE_WIEGHTS
********************************************************************************
*   Program name :- INV_VALIDATE_WIEGHTS
*   Created:- 4/29/2005
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INSERT ICS.CPYLIB INVENTORY
$INSERT ICS.CPYLIB INV.WHSE
$INCLUDE ICS.CPYLIB CATEGORY
$INSERT CPYLIB CHAR
ERRMSG = ''
 OPEN "","INVENTORY" TO INVENTORY ELSE
    ERRMSG = "CANNOT OPEN INVENTORY FILE"
	GOTO 93000
  END

 OPEN "","INV.WHSE" TO INV.WHSE ELSE
    ERRMSG = "CANNOT OPEN INV.WHSE FILE"
	GOTO 93000
  END

OPEN "","CATEGORY" TO CATEGORY ELSE ERRMSG = "CANNOT OPEN CATEGORY FILE";GOTO 93000

STATUS=RBO.getProperty('','CONO',CONO)
STATUS=RBO.getProperty('','ID',ID)

QTY.OH=0
ERRMSG=""
TEMP=""
MATREAD INV.REC FROM INVENTORY,CONO:ID THEN
   WH.CNT = COUNT(INV.WHSE.CODE,VM) + (INV.WHSE.CODE # "")
        IF WH.CNT > 0 THEN
          FOR WW = 1 TO WH.CNT 
            MATREAD IWH.REC FROM INV.WHSE  , CONO:ID:"!":INV.WHSE.CODE<1,WW> ELSE
              IWH.ON.HAND = 0
            END
            QTY.OH = QTY.OH + IWH.ON.HAND

          NEXT WW
        END
    IF QTY.OH<>0 THEN
      ERRMSG="THIS FIELD CANNOT BE CHANGED AFTER QTY HAS BEEN RECEIVED"
    END
  MATREAD CATG.REC FROM CATEGORY,CONO:INV.LINE ELSE MAT CATG.REC = ""
  STATUS = RBO.setProperty("","CatgTrkLvl",CATG.TRK.LVL)
  STATUS = RBO.setProperty("","CatgType",CATG.TYPE)


END

STATUS=RBO.setProperty('','MSG',ERRMSG)
RETURN

93000*
	STATUS=RBO.setProperty('','ServerStatus',1)
	STATUS=RBO.setProperty('','ServerMessage',ERRMSG)
RETURN

