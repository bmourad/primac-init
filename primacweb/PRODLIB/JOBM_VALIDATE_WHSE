SUBROUTINE JOBM_VALIDATE_WHSE
********************************************************************************
*   Program name :- JOBM_VALIDATE_WHSE
*   Created:- 7/18/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  Cono,JOB_NO,USER_WHSE_CODE
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB JOB
$INCLUDE ICS.CPYLIB WAREHOUSE
* Insert method code here
ERRMSG = ''
OPEN "","JOB" TO JOB ELSE
	ERRMSG = "CANNOT OPEN JOB FILE"
       GOTO 99999
END

OPEN "","WAREHOUSE" TO WAREHOUSE ELSE
	ERRMSG = "CANNOT OPEN WAREHOUSE FILE"
      	GOTO 99999
END

VAL = RBO.getProperty('','Cono',CONO)
VAL = RBO.getProperty('','JOB_NO',JOBNO)
VAL = RBO.getProperty('','USER_WHSE_CODE',USER.WHSE.CODE) ;* THIS IS WHEN USER SELECTES THE WHSE .CODE

IF USER.WHSE.CODE = 0 THEN USER.WHSE.CODE = ""

MATREAD WHSE.REC FROM WAREHOUSE,CONO:USER.WHSE.CODE ELSE
	ERRMSG=USER.WHSE.CODE:' Is an invalid Warehouse'
	GOSUB 99999
END

MATREAD JOB.REC FROM JOB,CONO:JOBNO ELSE MAT JOB.REC = ""

IF WHS.DIV # '00' AND WHS.DIV # JOB.DIV THEN
      	ERRMSG='Whse/Job division mismatch'
	GOSUB 99999
END

99999
  IF (TRIM(ERRMSG) # "") THEN
       STATUS = RBO.setProperty('','ServerStatus','1')
       STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
  END ELSE
       STATUS = RBO.setProperty('','ServerStatus','')
       STATUS = RBO.setProperty('','ServerMessage','')
  END 
END
