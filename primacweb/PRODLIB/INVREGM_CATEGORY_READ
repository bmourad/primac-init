SUBROUTINE INVREGM_CATEGORY_READ
********************************************************************************
*   Program name :- INVREGM_CATEGORY_READ
*   Created:- 11/15/2002
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB CATEGORY

ERRMSG=''
IF FILEINFO(CATEGORY,0)=0 THEN
  OPEN '','CATEGORY' TO CATEGORY ELSE
    ERRMSG<1,-1>='CATEGORY FILE IS MISSING'
	GOTO 93000
   END
END

;* get ID

STATUS=RBO.getProperty('','ID',INV.ID)
CONO=INV.ID[1,3]

;* get database values

NAMES='' ; VALUES=''
NAMES<1>='INV_LINE'
STATUS=RBO.getDBVals(NAMES,VALUES)
INV.LINE=VALUES<1>

;* retrieve CATEGORY values

CATG.ID=CONO:INV.LINE
MATREAD CATG.REC FROM CATEGORY,CATG.ID THEN
  STATUS=RBO.setProperty('','CatgType',CATG.TYPE)
  STATUS=RBO.setProperty('','CatgMajLine',CATG.MAJ.LINE)
END ELSE
  ERRMSG<1,-1>='Category is not on file'
  GOTO 93000
END

********************************************************************
RETURN

93000* 
STATUS = RBO.setProperty('','ServerStatus',1)        
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)  
RETURN
99999
RETURN

