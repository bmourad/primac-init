SUBROUTINE GETSUBCATEGORY
********************************************************************************
*   Program name :- GETSUBCATEGORY
*   Created:- 2/2/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE GLS.CPYLIB ACCT.CATG
$INCLUDE GLS.CPYLIB ACCT.SUB.CATG
$INCLUDE GLS.CPYLIB CATG.AND.SUB
$INCLUDE CPYLIB CHAR

OPEN '','ACCT.CATG' TO ACCT.CATG ELSE
   ERRMSG = 'ACCT.CATG FILE IS MISSING'; GOTO 93000
END

OPEN '','ACCT.SUB.CATG' TO ACCT.SUB.CATG ELSE
   ERRMSG = 'ACCT.SUB.CATG FILE IS MISSING'; GOTO 93000
END

OPEN '','CATG.AND.SUB' TO CATG.AND.SUB ELSE
   ERRMSG = 'CATG.AND.SUB FILE IS MISSING'; GOTO 93000
END

STATUS=RBO.getProperty('','Cono',Cono)
STATUS=RBO.getProperty('','ID',ID)

SUBCATG=''
SUCATGDESC=''
PRTCURR=''
PRTFIX=''
PRTPROD=''
PRTSDESC=''


MATREAD AC.REC FROM ACCT.CATG, ID THEN
SUBCATG=AC.SUB
END

S=DCOUNT(SUBCATG,VM)
 FOR J = 1 TO S
       
        MATREAD ASC.REC FROM ACCT.SUB.CATG, SUBCATG<1,J> ELSE
          MAT ASC.REC = ''
          ASC.DESC = 'UNKNOWN'
        END
        MATREAD CAS.REC FROM CATG.AND.SUB, Cono:ID:SUBCATG<1,J> ELSE
          MAT CAS.REC = ''
        END
        PRTCURR<1,J> = CAS.CURR
        PRTFIX<1,J> = CAS.FIX
        PRTPROD<1,J> = CAS.PROD
        PRTSDESC<1,J> = ASC.DESC
 NEXT J

STATUS=RBO.setProperty('','SUB_CATG_CODE',SUBCATG)
STATUS=RBO.setProperty('','SUB_CATG_CURR',PRTCURR)
STATUS=RBO.setProperty('','SUB_CATG_FIX',PRTFIX)
STATUS=RBO.setProperty('','SUB_CATG_PROD',PRTPROD)
STATUS=RBO.setProperty('','SUB_CATG_DESC',PRTSDESC)

RETURN

93000 
  STATUS = RBO.setProperty('','ServerStatus',1)        
  STATUS = RBO.setProperty('','ServerMessage',ERRMSG) 
RETURN


