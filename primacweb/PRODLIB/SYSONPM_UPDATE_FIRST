SUBROUTINE SYSONPM_UPDATE_FIRST
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB OVERNIGHT.REQUESTS
ERRMSG = ""
OPEN "","CONTROL" TO CONTROL ELSE
  ERRMSG = "CANNOT OPEN CONTROL FILE"
  GOTO 91000
END
STATUS=RBO.getProperty('','REQUESTEDPROCEDURE',REQUESTEDPROCEDURE)
STATUS=RBO.getProperty('','COMPANYNO',COMPANYNO)
STATUS=RBO.getProperty('','USERID',USERID)
STATUS=RBO.getProperty('','STATUS_R',STATUS_R)
STATUS=RBO.getProperty('','SCHEDDATE',SCHEDDATE)

OR.REPORT.NAME = REQUESTEDPROCEDURE
OR.COMPANY.NO = COMPANYNO
OR.USER.ID = USERID
OR.STATUS = STATUS_R
IF SCHEDDATE # "" THEN
OR.SCHED.DATE = ICONV(SCHEDDATE,"D2/")
END
IF SCHEDDATE = "" THEN
OR.SCHED.DATE = ""
END
MATWRITE OR.REC ON CONTROL,"OVERNIGHT.REQUESTS"

RETURN     
91000 
STATUS=RBO.setProperty('','ServerStatus',1)
STATUS=RBO.setProperty('','ServerMessage',ERRMSG)
RETURN

