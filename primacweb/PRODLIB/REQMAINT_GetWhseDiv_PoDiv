SUBROUTINE REQMAINT_GetWhseDiv_PoDiv
********************************************************************************
*   Program name :- GetWhseDiv_PoDiv
*   Created:- 10/29/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE CPYLIB CHAR
$INCLUDE ICS.CPYLIB WAREHOUSE

ERRMSG = ''
STATUS = RBO.getProperty('','PMCProperty',PMCProperty)

* Insert method code here

  OPEN "","WAREHOUSE" TO WAREHOUSE ELSE
   ERRMSG = "CANNOT OPEN WAREHOUSE FILE"
	GOTO 93000
  END

WHSE.DIV.LIST = ''
WHSEDIV_REC_ID = ''

CONO = PMCProperty<1,4>

* OPENING THE WAREHOUSE FILE

CMD = "SSELECT WAREHOUSE WITH CONO = '" : CONO : "'"
UDTEXECUTE CMD

WHSE_DIVLIST = ""
LOOP
	EOF = 1
	READNEXT WHSE_DIVLIST ELSE EOF = 0
	WHSEDIV_REC_ID<1,-1> = WHSE_DIVLIST
WHILE EOF DO	
REPEAT

FOR N = 1 TO DCOUNT(WHSEDIV_REC_ID,VM)
	MATREAD WHSE.REC FROM WAREHOUSE, WHSEDIV_REC_ID<1,N> THEN 
	WHSE.DIV.LIST<1,-1> = WHSEDIV_REC_ID<1,N>[4,99] : "~" : WHS.DIV
	END
NEXT N

STATUS=RBO.setProperty('','WhseDivList',WHSE.DIV.LIST)
RETURN


93000*
   IF ERRMSG # "" THEN
      STATUS = RBO.setProperty('', 'ServerStatus', 1)
      STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)
   END


* End of method code
RETURN

