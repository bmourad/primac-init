SUBROUTINE GetInventoryCodes
*********************************************************************
* Copyright 1998 by Primac Systems India
* SYSTEM       - EPRIMAC
* PROGRAM      - GetInventoryCodes
* BY           - KHAJA ZIAUDDIN
* DATE         - 05/19/2003 (mm/dd/yyyy)
* DESCRIPTION  - THIS PROGRAM will get the Inventory Codes, Desc, Um, Customer, StockBuyRatio, Paptype, Catg, Track QOH
*                
*ENDDOC
*********************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE CPYLIB CHAR
$INCLUDE ICS.CPYLIB CATEGORY
$INCLUDE ICS.CPYLIB INVENTORY

* Insert method code here
OPEN '','INVENTORY' TO INVENTORY ELSE
   ERRMSG = 'INVENTORY FILE IS MISSING'; GOTO 93000
END
OPEN '','CATEGORY' TO CATEGORY ELSE
   ERRMSG = 'CATEGORY FILE IS MISSING'; GOTO 93000
END

MAT CATG.REC = ''
DIM INV_REC(90)

STATUS = RBO.getProperty('','PMCProperty',PMCProperty)


USER.ID = PMCProperty<1,3>
CONO = PMCProperty<1,4>

   INVENTORYCODES = ''
   INVENTORYDESCS = ''
   INVENTORYUMS = ''
   INVENTORYCUSTS = ''
   INVENTORYSBR = ''		;* SB RATIO
   INVENTORYUM = ''		;* UM ADDED
   INVENTORYPAPTYPE = ''   ;* PAPTYPE (REGULAR,SHEET,ROLL ETC...)
   INVENTORYTRKLVL = ''
   INVENTORYTRACKQOH = ''
   INVENTORYINVLINE=''


CMD = "SSELECT INVENTORY WITH CONO = '" : CONO : "' AND INV_M_LINE # 'FNGD'"
UDTEXECUTE CMD
DATA = 1
I = 1
LOOP
	READNEXT ID ELSE DATA = 0
WHILE DATA DO
       INVENTORYCODES <1,I> = ID[4,99]
	
	*       READV NAME FROM INVENTORY ,ID,1 ELSE NAME = ID
*     	READV UM FROM INVENTORY ,ID,21 ELSE ADDR1 = ID
*	READV CUST FROM INVENTORY ,ID,19 ELSE ADDR1 = ID
*	READV INV.UNIT FROM INVENTORY ,ID,21 ELSE UM = ID
	*	READV UM FROM INVENTORY ,ID,21 ELSE UM = ID
	*	READV CUST FROM INVENTORY ,ID,19 ELSE CUST = ID
	*	READV SBR FROM INVENTORY,ID,15 ELSE SBR = ID
	*	READV PAPTYPE FROM INVENTORY,ID,31 ELSE PAPTYPE = ID
	*	READV PLINE FROM INVENTORY,ID,5 ELSE PLINE = ' '
MATREAD INV_REC FROM INVENTORY,ID THEN
	NAME 	 = INV_REC(1)
	UM   	 = INV_REC(21)
	CUST 	 = INV_REC(19)
	SBR  	 = INV_REC(15)
	PAPTYPE = INV_REC(31)
	PLINE   = INV_REC(5)
END ELSE
	NAME 	 = ""
	UM   	 = ""
	CUST 	 = ""
	SBR  	 = ""
	PAPTYPE = ""
	PLINE   = ""
END

	IF NAME = "" THEN NAME = ""
	IF UM = "" THEN UM  = " "
	IF CUST = "" THEN CUST = " "	
	IF SBR = "" THEN CUST = " "
	IF PAPTYPE="" THEN PAPTYPE= " "
	IF PLINE = "" THEN PLINE = " "

	INVENTORYDESCS<1,I> = ID[4,99]:"_":NAME 
	INVENTORYUMS<1,I> = UM<1,2> : " " 
	INVENTORYCUSTS<1,I> = CUST
	INVENTORYSBR<1,I> = SBR
	INVENTORYUM<1,I> = LOWER(UM)
	INVENTORYPAPTYPE<1,I> = PAPTYPE
	INVENTORYINVLINE<1,I> = ID[4,99]: "~" : PLINE

	MATREAD CATG.REC FROM CATEGORY,CONO:PLINE ELSE
		MAT CATG.REC = ""
	END 
	INVENTORYTRKLVL<1,I> = CATG.TRK.LVL
	INVENTORYTRACKQOH<1,I> = CATG.TRACK.QOH
I = I + 1
      *	INVENTORYUMS<1,-1> = UM<1,2>:"-":I
REPEAT

  STATUS = RBO.setProperty('', 'InventoryCodes', INVENTORYCODES)
  STATUS = RBO.setProperty('', 'InventoryDescs', INVENTORYDESCS)
  STATUS = RBO.setProperty('', 'InventoryUMs', INVENTORYUMS)
  STATUS = RBO.setProperty('', 'InventoryCust', INVENTORYCUSTS)
  STATUS = RBO.setProperty('', 'InventorySbr', INVENTORYSBR)
  STATUS = RBO.setProperty('', 'InventoryUM', INVENTORYUM)
  STATUS = RBO.setProperty('', 'InventoryPaptype', INVENTORYPAPTYPE)
  STATUS = RBO.setProperty('', 'InventoryTrkLvl', INVENTORYTRKLVL)
  STATUS = RBO.setProperty('', 'InventoryTrkQOH', INVENTORYTRACKQOH)
  STATUS = RBO.setProperty('', 'InventoryInvLine', INVENTORYINVLINE)
	

  STATUS = RBO.setProperty('', 'ServerStatus', 0)
  STATUS = RBO.setProperty('', 'ServerMessage', ' ')
 

* End of method code
RETURN

93000 
  *STATUS = RBO.setProperty('','ServerStatus',USER.ID : " CONO  : "  : CONO)        
  STATUS = RBO.setProperty('','ServerStatus',1)        
  STATUS = RBO.setProperty('','ServerMessage',ERRMSG) 
  RETURN

99999 
RETURN

