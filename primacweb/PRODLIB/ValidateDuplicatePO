SUBROUTINE ValidateDuplicatePO
********************************************************************************
*   Program name :- ValidateDuplicatePO
*   Created:- 3/9/2004
*------------------------------------------------------------------------------*
*
* PROGRAMMER G.PURUSHOTHAM RAO
* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE POS.CPYLIB MISC.PO

* Insert method code here
   OPEN '','MISC.PO' TO MISC.PO ELSE
      ERRMSG = 'MISC.PO FILE IS MISSING'
      GOTO 93000
   END

   OPEN '','MISC.REQ' TO MISC.REQ ELSE
      ERRMSG = 'MISC.REQ FILE IS MISSING'
      GOTO 93000
   END

STATUS=RBO.getProperty('','ID',MPO.CODE)

STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
USER.ID = PMCProperty<1,3>
CONO = PMCProperty<1,4>

ERRMSG = ""

   MATREAD MPO.REC FROM MISC.PO, CONO:MPO.CODE THEN
      ERRMSG = "PO with number ":MPO.CODE: " already exists"
	GOTO 10
   END
   MATREAD MPO.REC FROM MISC.REQ, CONO:MPO.CODE THEN
      ERRMSG = "Requisition with number ":MPO.CODE:" already exists"
   END 

10*
	STATUS=RBO.setProperty('','ServerMessage',ERRMSG)

* End of method code
RETURN
93000*
STATUS=RBO.setProperty('','ServerMessage',ERRMSG)

