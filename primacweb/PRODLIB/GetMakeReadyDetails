SUBROUTINE GetMakeReadyDetails
********************************************************************************
*   Program name :- GetMakeReadyDetails
*   Created:- 7/11/2003
*   Created By :- B.Krishna
********************************************************************************
$INCLUDE WWINSERT RBO.H

$INCLUDE JES.CPYLIB ESTIMATE
$INCLUDE JES.CPYLIB ESTIMATE.RES
$INCLUDE JES.CPYLIB JES.FILE.VARS
$INCLUDE JES.CPYLIB ESTIMATE.RES.MR.TABLE
$INCLUDE CPYLIB SCREEN.COM
$INCLUDE CPYLIB FILE.VARS
$INCLUDE CPYLIB CHAR

      ERRMSG = ""
      ERRMSG = RBO.getProperty('','ID',ESTIMATE.ID)
      *ERRMSG = RBO.getProperty('','Qty',QSEL)
     
      ERRMSG = RBO.getProperty('','PRESS_CCTR',PRESS.CCTR)

      CONO = ESTIMATE.ID[1,3]
      EST.KEY = TRIM(ESTIMATE.ID[4,99])
      COMP=1
      ERRMSG = "CALL openEstimateFiles PROBLEM"
      CALL openEstimateFiles(ERRMSG,IN_PARAM,OUT_PARAM,MAT FILE.VARS,MAT JES.FILE.VARS)
      
      OPEN '','ESTIMATE.RES' TO ESTIMATE.RES ELSE
     	 ERRMSG='can not open ESTIMATE.RES file'
      END

      MATREAD EST.RL.REC FROM ESTIMATE.RES, ESTIMATE.ID ELSE
      ERRMSG = 'ESTIMATE.RES not on file. Try again!'
      END

* Insert method code here
*PCNT=DCOUNT(EST.RL.PRESS.CCTR<1,1>,SM)
PCNT=DCOUNT(PRESS.CCTR,VM)
	

*  IF EST.RL.MR.DIE<1,COMP,1>="" THEN
   OPEN '','ESTIMATE.RES.MR.TABLE' TO CC.RL.MR.TABLE THEN
      ERRMSG='Cost Center Makeready File Missing...'
  
* END

  FOR P=1 TO PCNT
     * MATREAD CC.RL.MR.REC FROM CC.RL.MR.TABLE,CONO:EST.RL.PRESS.CCTR<1,COMP,P> ELSE
	MATREAD CC.RL.MR.REC FROM CC.RL.MR.TABLE,CONO:PRESS.CCTR<1,P> ELSE

* T21964
        ERRMSG="Cost Center ":EST.RL.PRESS.CCTR<1,COMP,P>:" has to Makre Ready Table"
        ERRMSG="the table will be zero filled for this estimate"
        MAT CC.RL.MR.REC=0
* T21964
      END
      EST.RL.MR.DIE<1,COMP,P>=CC.MR.DIE<1>
      EST.RL.MR.FDIE<1,COMP,P>=CC.MR.FDIE<1>
      EST.RL.MR.FOIL<1,COMP,P>=CC.MR.FOIL<1>
      EST.RL.MR.PLATE<1,COMP,P>=CC.MR.PLATES<1>
      EST.RL.MR.COL.MIX<1,COMP,P>=CC.MR.COL.MIX<1>
      EST.RL.MR.LIN.SLITS<1,COMP,P>=CC.MR.LIN.SLITS<1>
      EST.RL.MR.COLORS<1,COMP,P>=CC.MR.COLORS<1>
      EST.RL.MR.COL.CHANGE<1,COMP,P>=CC.MR.COL.CHANGE
      EST.RL.MR.SPROCKET<1,COMP,P>=CC.MR.SPROCKET<1>
      EST.RL.MR.SSCREEN<1,COMP,P>=CC.MR.SSCREEN<1>
      EST.RL.MR.GRAVURE<1,COMP,P>=CC.MR.GRAVURE
      EST.RL.MR.EMBOSS<1,COMP,P>=CC.MR.EMBOSS
      EST.RL.MR.OVERLAM<1,COMP,P>=CC.MR.OVERLAM
      EST.RL.MR.CSETDOWN<1,COMP,P>=CC.MR.CSETDOWN<1>
      EST.RL.MR.DSETDOWN<1,COMP,P>=CC.MR.DSETDOWN<1>
      EST.RL.MR.FSETDOWN<1,COMP,P>=CC.MR.FSETDOWN<1>
      EST.RL.MR.SSETDOWN<1,COMP,P>=CC.MR.SSETDOWN
      EST.RL.MR.GSETDOWN<1,COMP,P>=CC.MR.GSETDOWN
      EST.RL.MR.ESETDOWN<1,COMP,P>=CC.MR.ESETDOWN
      EST.RL.MR.OSETDOWN<1,COMP,P>=CC.MR.OSETDOWN
    NEXT P
END
  
  STRVAL=''
  PTR=1
 * STRVAL<1,-1>=EST.RL.PRESS.CCTR<1,COMP,PTR>
 * STRVAL<1,-1>=EST.RL.PRESS.CCTR<1,COMP,PTR+1>
 * STRVAL<1,-1>=EST.RL.PRESS.CCTR<1,COMP,PTR+2>

STRVAL<1,-1>=PRESS.CCTR<PTR>
STRVAL<1,-1>=PRESS.CCTR<PTR+1>
STRVAL<1,-1>=PRESS.CCTR<PTR+2>
STRVAL = STRVAL : "!"
 
  N=1
*  FOR P=PTR TO PTR+2
    FOR P =1 TO PCNT
  
    STRVAL<1,-1>=OCONV(EST.RL.MR.DIE<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.FDIE<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.COLORS<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.PLATE<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.COL.CHANGE<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.SPROCKET<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.COL.MIX<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.FOIL<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.LIN.SLITS<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.SSCREEN<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.GRAVURE<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.EMBOSS<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.OVERLAM<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.CSETDOWN<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.DSETDOWN<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.FSETDOWN<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.SSETDOWN<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.GSETDOWN<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.ESETDOWN<1,COMP,P>,'MD2,')
    STRVAL<1,-1>=OCONV(EST.RL.MR.OSETDOWN<1,COMP,P>,'MD2,')
    STRVAL = STRVAL : "^"
    N=N + 1
  NEXT P
STATUS = RBO.setProperty('','MakeReadyInfo',STRVAL)


* End of method code
RETURN

