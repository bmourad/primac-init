SUBROUTINE GetRunEffCodes
********************************************************************************
*   Program name :- GetRunEffCodes
*   Created:- by Jaweed,S.A 6/6/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JES.CPYLIB EQUIPMENT
* Insert method code here

  OPEN "","ESTIMATE.RUN.EFF" TO ESTIMATE.RUN.EFF ELSE
    ERRMSG = "CANNOT OPEN ESTIMATE.RUN.EFF FILE"
    GOTO 93000
  END

  STATUS = RBO.setProperty('','PMCProperty',PMCProperty)
  CONO = PMCProperty<1,4>

CMD = "SSELECT ESTIMATE.RUN.EFF WITH @ID LIKE ":CONO:"...*M*M"
UDTEXECUTE CMD

COLOR.LIST = ""
NEWLIST = ""
DATA = 1
LOOP
	READNEXT EQP.KEY THEN
		COLOR.LIST<1,-1> = EQP.KEY[8,99]				
	END ELSE
		DATA = 0
	END
WHILE DATA DO
REPEAT

FOR I = 1 TO DCOUNT(COLOR.LIST,@VM)
   NEWLIST<1,-1> = COLOR.LIST<1,I>[1,(INDEX(COLOR.LIST<1,I>,"*",1)-1)]
NEXT I

  STATUS = RBO.setProperty('','NO_COLORS',NEWLIST)
* STATUS = RBO.setProperty('','TEST',COLOR.LIST)
RETURN

93000*
  STATUS = RBO.setProperty('','ServerStatus',1)
  STATUS = RBO.setProperty('','ServerMessage',ERRMSG)  
RETURN
 END


