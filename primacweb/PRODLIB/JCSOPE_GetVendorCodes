SUBROUTINE JCSOPE_GetVendorCodes
*********************************************************************
* Copyright 1998 by Primac Systems India
* SYSTEM       - EPRIMAC
* PROGRAM      - GetVendorCodes
* BY           - KHAJA ZIAUDDIN
* DATE         - 07/29/2003
* DESCRIPTION  - This program get the Vendor Codes, Descs, Addr1, Addr2, City, Zipcode, Fax, Terms Net, Terms Per
*                
*                
*                
*                
*ENDDOC
*********************************************************************
$INCLUDE WWINSERT RBO.H
* Insert method code here
$INCLUDE PMC.CPYLIB VEND
* PROG.ID = 'getVendorCodes'
MESG = ''
   OPEN '','VEND' TO VEND ELSE
      MESG = 'Cannot open Vendor file!'
      STATUS = RBO.setProperty('', 'ServerStatus', 1)
      STATUS = RBO.setProperty('', 'ServerMessage', MESG)
      RETURN
   END
OPEN '','CONTROL' TO CONTROL ELSE STOP
   VENDCODES = ''
   VENDDESCS = ''
   VENDADDR1 = ''
   VENDADDR2 = ''
	 CITY = '' 	
   ZIPCODE = ''
   VENDPHONE = '' 	
     VENDFAX = '' 	
   VENDNET = ''
   VENDPER = ''

   VEND_NO = ''
   VEND_NAME = ''
*after readData is done, get the value from VEND_NO and populate the vendor details
   STATUS=RBO.getProperty('','DOS_VEND',VEND_NO)
   STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
   CONO = PMCProperty<1,4>
*CONO = "001"
  CMD = "SSELECT VEND WITH CONO ='":CONO:"'"
  UDTEXECUTE CMD CAPTURING MESG
   DATA = 1
   LOOP
      READNEXT ID ELSE DATA = 0
   WHILE DATA DO
    MATREAD VEND.REC FROM VEND,ID THEN
	VENDNAME 	= VEND.DESC
	VEND_ADDR1	= VEND.ADDR1
	VEND_ADDR2	= VEND.ADDR2 
	CITY_STATE	= VEND.CT.ST
	VEND_ZIP	= VEND.ZIP
	VEND_PHONE	= VEND.PHONE
	VEND_SLSMN_FAX= VEND.SLSMN.FAX
	NET		= VEND.TERMS.NET	
	DISCNT 	= VEND.PD.M.T.D
    END

	IF VEND_ADDR1 = "" THEN VEND_ADDR1 = " "
	IF VEND_ADDR2 = "" THEN VEND_ADDR2 = " "
	IF CITY_STATE = "" THEN CITY_STATE = " "
	IF VEND_ZIP = "" THEN VEND_ZIP = " "
	IF VEND_PHONE = "" THEN VEND_PHONE = " "
	IF VEND_SLSMN_FAX = "" THEN VEND_SLSMN_FAX = " "
IF ID[4,99] # "" THEN
       VENDCODES<1,-1> = ID[4,99]
       VENDDESCS<1,-1> = ID[4,99]:"-":VEND.DESC

      	VENDADDR1<1,-1> = VEND_ADDR1
	VENDADDR2<1,-1> = VEND_ADDR2
	     CITY<1,-1> = CITY_STATE 
      ZIPCODE<1,-1> 	  = VEND_ZIP
      VENDPHONE<1,-1>  = VEND_PHONE
      VENDFAX<1,-1>	  = VEND_SLSMN_FAX
      VENDNET<1,-1>  = CHANGE(NET,@VM,"#")
      VENDPER<1,-1>	  = OCONV(DISCNT,"MD2")
      *PARSE THE STRING HERE & GET THE REMAINING VENDOR DETAILS ...
END
 REPEAT
*
   STATUS = RBO.setProperty('', 'VendCodes', VENDCODES)
   STATUS = RBO.setProperty('', 'VendDescs', VENDDESCS)
   STATUS = RBO.setProperty('', 'VendAddr1', VENDADDR1)
   STATUS = RBO.setProperty('', 'VendAddr2', VENDADDR2)
   STATUS = RBO.setProperty('', 'VendZip', ZIPCODE)
   STATUS = RBO.setProperty('', 'VendCity', CITY)
   STATUS = RBO.setProperty('', 'VendPhone', VENDPHONE)
   STATUS = RBO.setProperty('', 'VendFax', VENDFAX)
   STATUS = RBO.setProperty('', 'VendNet', VENDNET)
   STATUS = RBO.setProperty('', 'VendPer', VENDPER)
RETURN
*
END

