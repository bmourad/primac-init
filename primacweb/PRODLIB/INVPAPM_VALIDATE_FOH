SUBROUTINE INVPAPM_VALIDATE_FOH
********************************************************************************
*   Program name :- INVPAPM_VALIDATE_FOH
*   Created:- 9/16/2005
*   Programmer :- Suhail Hussain
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB FOH.TABLE
  
  OPEN "","FOH.TABLE" TO FOH.TABLE ELSE ERRMSG = "CANNOT OPEN FOH TABLE FILE";GOTO 91000

  STATUS = RBO.getProperty("","PMCProperty",PMCProperty)
  STATUS = RBO.getProperty("","FOH_VAL",ECD.RET.VALUE)
  CONO = PMCProperty<1,4>
  
  BEGIN CASE
    CASE NUM(ECD.RET.VALUE)
      ECD.RET.VALUE = ICONV(ECD.RET.VALUE,"MD2")
      IF ECD.RET.VALUE > "10000" THEN
        ERRMSG = "** OUT OF RANGE **";GOTO 91000
      END
      RET.VALUE = OCONV(ECD.RET.VALUE,"MD2")
    CASE 1
      MATREAD FTR.REC FROM FOH.TABLE,CONO:ECD.RET.VALUE ELSE
        ERRMSG = "INVALID INDIRECT CODE";GOTO 91000
      END
      RET.VALUE = ECD.RET.VALUE
  END CASE
  STATUS = RBO.setProperty("","FOH_VAL",RET.VALUE)
  RETURN
91000*
  STATUS = RBO.setProperty("","ServerStatus",1)
  STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
RETURN

