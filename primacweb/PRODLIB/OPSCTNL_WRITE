SUBROUTINE OPSCTNL_WRITE
********************************************************************************
*   Program name :- OPSCTNL_WRITE
*   BY           :- JAWEED,S.A
*   Created:- 8/19/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE OPS.CPYLIB BOL
$INCLUDE OPS.CPYLIB CARTON
$INCLUDE OPS.CPYLIB ORDER
$INCLUDE PMC.CPYLIB SHIP.TO
$INCLUDE CPYLIB CHAR
ERRMSG = ''
OPEN '', 'BOL' TO BOL ELSE
  ERRMSG='BOL'
  GOTO 93000
END
OPEN '', 'CARTON' TO CARTON ELSE
  ERRMSG='CARTON'
  GOTO 93000
END
OPEN '', 'CUSTOMER' TO CUSTOMER ELSE 
  ERRMSG='CUSTOMER'
  GOTO 93000
END
OPEN '', 'ORDER' TO ORDER ELSE 
  ERRMSG='ORDER'
  GOTO 93000
END
OPEN '', 'SHIP.TO' TO SHIP.TO ELSE 
  ERRMSG='SHIP.TO'
  GOTO 93000
END

STATUS=RBO.getProperty('','ID',ID)
CONO=ID[1,3]
ID=ID[4,99]
STATUS=RBO.getProperty('','ORD_BOL',ORD_BOL)
STATUS=RBO.getProperty('','BOL_SHIP_TO',BOL_SHIP_TO)
STATUS=RBO.getProperty('','CARTON_NEEDED',CARTON.NEEDED)
REF.CNT = DCOUNT(ORD.BOL,VM)
 NUM.ON.SCREEN = 1
  FOR I = 1 TO REF.CNT
    CARTON.ID = CONO:"!":ID:"!":ORD_BOL<1,I>
    MATREAD CARTON.REC FROM CARTON,CARTON.ID ELSE 
      MAT CARTON.REC = ""
    END
    CARTON.SHIP.TO = BOL_SHIP_TO<1,I>
    CARTON.NEED = CARTON.NEEDED<1,I>
    MATWRITE CARTON.REC ON CARTON,CARTON.ID
    NUM.ON.SCREEN = NUM.ON.SCREEN + 1
  NEXT I


93000
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN
