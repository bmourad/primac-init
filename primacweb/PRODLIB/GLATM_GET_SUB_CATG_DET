SUBROUTINE GLATM_GET_SUB_CATG_DET
********************************************************************************
*   Program name :- GLATM_GET_SUB_CATG_DET
*   Created:- 6/21/2003
*------------------------------------------------------------------------------*
*
* In Properties:
* --------------
*  Cono,CATG_CODE,SUB_CATG_CODE
*
* Out Properties:
* ---------------
*  SUB_CATG_DESC,SUB_CATG_CURR,SUB_CATG_FIX,SUB_CATG_PROD
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE GLS.CPYLIB ACCT.SUB.CATG
$INCLUDE GLS.CPYLIB CATG.AND.SUB
* Insert method code here

STATUS = RBO.getProperty('','SUB_CATG_CODE',SUB.CATG.CODE)
STATUS = RBO.getProperty('','CATG_CODE',CATG.CODE)
STATUS = RBO.getProperty('','Cono',CONO)

ERRMSG = ''
OPEN '','ACCT.SUB.CATG' TO ACCT.SUB.CATG ELSE
	ERRMSG = 'Cannot open ACCT.SUB.CATG file!'
      	GOTO 99999
END

OPEN '','CATG.AND.SUB' TO CATG.AND.SUB ELSE
	ERRMSG = 'Cannot open CATG.AND.SUB file!'
      	GOTO 99999
END

MATREAD ASC.REC FROM ACCT.SUB.CATG, SUB.CATG.CODE ELSE
	MAT ASC.REC = ''
    	IF SUB.CATG.CODE = '000' THEN ASC.DESC = 'GENERAL'
END

MATREAD CAS.REC FROM CATG.AND.SUB, CONO:CATG.CODE:SUB.CATG.CODE ELSE
	MAT CAS.REC = ''
END

STATUS = RBO.setProperty('','SUB_CATG_DESC',ASC.DESC)
STATUS = RBO.setProperty('','SUB_CATG_CURR',CAS.CURR)
STATUS = RBO.setProperty('','SUB_CATG_FIX',CAS.FIX)
STATUS = RBO.setProperty('','SUB_CATG_PROD',CAS.PROD)

* End of method code
99999
IF ERRMSG # "" THEN
	STATUS = RBO.setProperty('','ServerStatus','1')
	STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
END ELSE
	STATUS = RBO.setProperty('','ServerStatus','')
	STATUS = RBO.setProperty('','ServerMessage','')
END
RETURN

