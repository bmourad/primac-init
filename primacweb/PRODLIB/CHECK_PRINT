SUBROUTINE CHECK_PRINT
********************************************************************************
*   Program name :- CHECK_PRINT
*   Created:- 4/10/2007
********************************************************************************
$INCLUDE WWINSERT RBO.H
      
      IF ANS= "N" OR ANS = "/" THEN
	      ERRMSG = "CHECKS MUST BE RE-RUN OR CASH DISB AND CHECK REG WILL NOT BALANCE"
360 *
	      ERRMSG = "ENTER REPRINT VENDOR# OR (ALL): ":
         IF ANSW # "ALL" THEN
            LST = DCOUNT(VENDOR,VM)
            NEW.MV = DCOUNT(PCS.START.UNUSED,VM) + 1
            LOCATE ANSW IN VENDOR<1>,1 SETTING FND ELSE GOTO 360
            PCS.START.VOID<1,NEW.MV> = CHECK<1,FND>
            PCS.END.VOID<1,NEW.MV> = CHECK<1,LST>
            PCS.VOID.DATE<1,NEW.MV> = CKDT
            PCS.VOID.MOD<1,NEW.MV> = "APS"
            PCS.START.UNUSED<1,NEW.MV> = ""
            PCS.END.UNUSED<1,NEW.MV> = ""
            PCS.LST.CHK.NO=CHECK<1,LST>
            MATREAD VEND.REC FROM VEND,CONO:ANSW ELSE GOTO 360
         END ELSE
            CNT = DCOUNT(CHECK,VM)
            PCS.START.VOID<1,NEW.MV> = CHECK<1,1>
            PCS.END.VOID<1,NEW.MV> = CHECK<1,CNT>
            PCS.VOID.DATE<1,NEW.MV> = CKDT
            PCS.VOID.MOD<1,NEW.MV> = "APS"
            PCS.START.UNUSED<1,NEW.MV> = ""
            PCS.END.UNUSED<1,NEW.MV> = ""
            PCS.LST.CHK.NO = CHECK<1,CNT>
         END
370*
         MATWRITE PCS.REC ON CHECK.STATS,CONO:ACCT.NO:"!":DIV.OWNER
         BUFFER = REPLACE(BUFFER,2,0,0,ANSW)
         WRITEV ANSW ON CONTROL , CONO:"REPRINT":DIV.OWNER,1
         PROCWRITE BUFFER 
         GOTO 99999
      END
      IF ANS#"Y" THEN GOTO 355
      ANS=''
      WRITEV ANS ON CONTROL , CONO:"REPRINT":DIV.OWNER,1
      WRITEV CKNO ON D.CKP,CONO:"CHECKNO",1
      PCS.LST.CHK.NO = CKNO - 1
      MATWRITE PCS.REC ON CHECK.STATS,CONO:ACCT.NO:"!":DIV.OWNER
      BUFFER=REPLACE(BUFFER,2,0,0,"Y")
      PROCWRITE BUFFER
*T22081 v
      IF LASER.FLAG = 1 THEN
         OPEN '',"SECURITY" TO SECURITY ELSE ERRMSG = "SECURITY FILE MISSING";GOTO 93000
           *
         READ TEMP.REC FROM SECURITY, CONO:OCONV(@LOGNAME,'MCU'):'!LASER' THEN
            DELETE SECURITY, CONO:OCONV(@LOGNAME,'MCU'):'!LASER'
         END
      END
*T22081 ^
      GOTO 99999
   END


* End of method code
RETURN

