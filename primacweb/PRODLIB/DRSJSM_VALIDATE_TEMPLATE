SUBROUTINE DRSJSM_VALIDATE_TEMPLATE
********************************************************************************
*   Program name :- DRSJSM_VALIDATE_TEMPLATE
*   Created:- 6/8/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB CUST.TEMPLATE.LIST
*
*---- OPEN FILES
*
  OPEN '','CUST.TEMPLATE.LIST' TO CUST.TEMPLATE.LIST ELSE ERRMSG = 'CUST.TEMPLATE.LIST FILE MISSING'; GOTO 93000
*
*---- INITIALIZATION
*
MAT CTL.REC = ''
CUST.KEY = ''
ERRMSG = ''

STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
STATUS=RBO.getProperty('','Template_No',TEMP.NO)
STATUS=RBO.getProperty('','Cust_Number',CUST.KEY)
CONO = PMCProperty<1,4>

*
*---- VALIDATE TEMPLATE NO.
*
100 *
  IF TEMP.NO # '' THEN
    MATREAD CTL.REC FROM CUST.TEMPLATE.LIST, CONO:CUST.KEY:"!":TEMP.NO:"!001" ELSE
      MAT CTL.REC =''
      ERRMSG = 'Please note: This template does not belong to customer'
      GOSUB 93000
    END
  END
  STATUS = RBO.setProperty('', 'DJS_TEMPLATE_DESC',CTL.DESC)
RETURN
*
*---- ERROR ROUTINE
*
93000*
   IF ERRMSG # "" THEN
	STATUS = RBO.setProperty('', 'ServerStatus',1)
   	STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)
   END
* End of method code
RETURN
