SUBROUTINE APVOUM_POENTRIES_OUTSIDE
********************************************************************************
*   Program name :- APVOUM_POENTRIES_OUTSIDE
*   Created:- 2/6/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE APS.CPYLIB VEND.PO.STATS
$INCLUDE JCS.CPYLIB CATEGORY.OSP
$INCLUDE POS.CPYLIB OUTSIDE.PO
$INCLUDE CPYLIB CHAR

* Insert method code here
     OPEN '','MISC.PO' TO MISC.PO ELSE ERRMSG = 'MISC.PO FILE IS MISSING';GOTO 1000
     OPEN '','OUTSIDE.PO' TO OUTSIDE.PO ELSE ERRMSG = 'OUTSIDE.PO FILE IS MISSING';GOTO 1000
     OPEN '','VEND.PO.STATS' TO VEND.PO.STATS ELSE ERRMSG = 'VEND.PO.STATS FILE IS MISSING';GOTO 1000

    STATUS        = RBO.getProperty('','ID',ID)

    TVO.VEND      = FIELD(ID,'!',1)
    TVO.PO.TYPE   = FIELD(ID,'!',2)
    TVO.PO 	    = FIELD(ID,'!',3)
    CONO          = TVO.VEND[1,3]
    ERRMSG        = ""
    VSTAT.KEY     = TVO.VEND:"!":TVO.PO.TYPE
    TEMP_VALUES   = ""

*  MATREAD VPS.REC FROM VEND.PO.STATS , VSTAT.KEY :"!": TVO.PO ELSE
  MATREAD VPS.REC FROM VEND.PO.STATS ,ID ELSE
*   MAT VPS.REC = ""
  END
  TEMP_VALUES = TVO.PO
  MATREAD OPO.REC FROM OUTSIDE.PO,CONO:TVO.PO ELSE MAT OPO.REC=''
  PCNT = COUNT(VPS.PROD,VM) + (VPS.PROD # "")
  IF PCNT = 1 THEN
    TEMP_VALUES = TEMP_VALUES:"^":VPS.PROD<1,1>:"^":VPS.PROD.DESC<1,1>:"^":FIELD(VPS.WHSE<1,1>,"@",1)
*T25755 v
*   TEMP.VALUES<4> = VPS.WHSE<1,1>
*   GOSUB 2500
*   MATREAD CAOS.REC FROM CATEGORY.OSP, CONO : VPS.WHSE<1,1> ELSE
  END

  STATUS=RBO.setProperty('','TVO_VEND',TEMP_VALUES)
1000*
     
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
* End of method code
RETURN

