SUBROUTINE GET_SHIPVIA_DETAILS
********************************************************************************
*   Program name :- GET_SHIPVIA_DETAILS
*   Created:- 9/24/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB SHIP.TO

* Insert method code here

   OPEN "","SHIP.VIA" TO SHIP.VIA ELSE
      ERRMSG = "Cannot locate the SHIP.VIA file";GOTO 93000
   END

   SHIPVIACODES = ""
   SHIPVIADESCS = ""

   SHIPVIACODES<1,1> = '00'
   SHIPVIADESCS<1,1> = '--Select--'

   STATUS = RBO.getProperty('', 'PMCProperty', PMCProperty)
   CONO = PMCProperty<1,4>

   CMD = "SSELECT SHIP.VIA WITH CO_ =  " : CONO
   UDTEXECUTE CMD

   DATA = 1
   I = 2
   LOOP
      READNEXT CODE ELSE DATA = 0
   WHILE DATA DO
      READV DESC FROM SHIP.VIA,CODE,1 ELSE DESC = CODE[4,99]

	SHIPVIACODES<1,I> = CODE[4,99]
	SHIPVIADESCS<1,I> = CODE[4,99] : "-" : DESC
	I = I + 1
   REPEAT

   STATUS = RBO.setProperty('', 'ShipViaCodes',SHIPVIACODES)
   STATUS = RBO.setProperty('', 'ShipViaDescs', SHIPVIADESCS)

* End of method code
RETURN
93000*
   STATUS = RBO.setProperty('', 'ServerStatus', '1')
   STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)

