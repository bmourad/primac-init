SUBROUTINE chkLocation
********************************************************************************
*   Program name :- 
*   Created:- 6/20/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
* CONO,WIPTP.LOC
*
* Out Properties:
* ---------------
*  ServerStatus, ServerMessage
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE WTR.CPYLIB WIPT.STORAGE.LOC
* Insert method code here

	STATUS = RBO.getProperty('','Cono',CONO)
	STATUS = RBO.getProperty('','WIPTP_LOC',WIPTP.LOC)

	OPEN "","WIPT.STORAGE.LOC" TO WIPT.STORAGE.LOC ELSE
    ERRMSG = "CANNOT OPEN WIPT.STORAGE.LOC FILE"
    GOTO 93000
  END

  ERRMSG = ""
  STMT = 'SSELECT WIPT.STORAGE.LOC WITH RANGE.START <= "':WIPTP.LOC:'"'
  STMT = STMT:' AND WITH RANGE.END >= "':WIPTP.LOC:'"'
  STMT = STMT:' AND WITH CONO = "':CONO:'"'
  PERFORM STMT CAPTURING GARBAGE
  MAT WIPSL.REC = ""
  READNEXT SL.ID THEN
    MATREAD WIPSL.REC FROM WIPT.STORAGE.LOC, SL.ID ELSE MAT WIPSL.REC = ""
    CLEARSELECT
  END ELSE
    ERRMSG = "*Undefined Location*"
  END

93000
IF ERRMSG # "" THEN
	STATUS = RBO.setProperty('','ServerStatus',1)
	STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
END ELSE
	STATUS = RBO.setProperty('','ServerStatus',0)
	STATUS = RBO.setProperty('','ServerMessage','')
END
RETURN

