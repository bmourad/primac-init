SUBROUTINE AVOUM_GetVendInfo
********************************************************************************
*   Program name :- AVOUM_GetVendInfo
*   Created:- 28/6/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB VEND

IF FILEINFO(VEND,0)=0 THEN
  OPEN '','VEND' TO VEND ELSE
    ERRMSG='VEND FILE IS MISSING'
    GOTO 93000
  END
END
STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
CONO=PMCProperty<1,4>
STATUS=RBO.getProperty('','AVO_VEND',AVO.VEND)
VEND.ID=CONO:AVO.VEND
MATREAD VEND.REC FROM VEND,VEND.ID ELSE
  ERRMSG=AVO.VEND:' is not a valid Vendor'
  GOTO 93000
END
STATUS=RBO.setProperty('','VendCity',VEND.CT.ST[1,19])
STATUS=RBO.setProperty('','VendAddr1',VEND.ADDR1)
STATUS=RBO.setProperty('','VendName',VEND.DESC)
STATUS=RBO.setProperty('','VendZip',VEND.ZIP)
STATUS=RBO.setProperty('','VendAutoDist',VEND.AUTO.DIST)

IF VEND.TERMS<1,2>[1,1]='P' THEN
  STATUS=RBO.setProperty('','VendTerms',VEND.TERMS)
  STATUS=RBO.setProperty('','VendAutoDist',VEND.AUTO.DIST)
END
 STATUS=RBO.setProperty('','TEST',AVO.VEND[6,1])

IF AVO.VEND<1,1>[9,1]='-' THEN
 
  DIM SVEND.REC(50)
  EQU SVEND.DESC TO SVEND.REC(1)
  EQU SVEND.ADDR1 TO SVEND.REC(2)
  EQU SVEND.CT.ST TO SVEND.REC(4)
  EQU SVEND.ZIP TO SVEND.REC(5)
  EQU SVEND.TERMP TO SVEND.REC(6)

  MATREAD SVEND.REC FROM VEND,CONO:AVO.VEND<1,1>[4,99] ELSE
    MAT SVEND.REC="??????????????"
  END
  STATUS=RBO.setProperty('','SVEND_ID',AVO.VEND<1,1>[4,99])
  STATUS=RBO.setProperty('','SVEND_DESC',SVEND.DESC)
  STATUS=RBO.setProperty('','SVEND_ADDR1',SVEND.ADDR1)
  STATUS = RBO.setProperty('', 'SVEND_CT_ST', SVEND.CT.ST[1,19])
  STATUS = RBO.setProperty('', 'SVEND_ZIP',SVEND.ZIP)
  *STATUS=RBO.setProperty('','SVendCtStzIP',SVENDREC)
 *STATUS=RBO.setProperty('','SVendCtStzIP',SVEND.CT.ST[1,19]:" ":SVEND.ZIP) 


END

GOTO 99999

93000 
  STATUS = RBO.setProperty('','ServerStatus',1)        
  STATUS = RBO.setProperty('','ServerMessage',ERRMSG) 

99999 
  RETURN
