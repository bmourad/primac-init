SUBROUTINE APPREQMN_CHK_GRID_COL_VAL
********************************************************************************
*   Program name :- APPREQMN_CHK_GRID_COL_VAL BY ZUBAIR TO VALIDATE THE GRID VALUES
*   Created:- 2/16/2005
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE POS.CPYLIB APP.REQ
$INCLUDE CPYLIB CHAR

OPEN '','APP.REQ' TO APP.REQ ELSE ERRMSG="APP.REQ FILE IS MISSING";GOTO 91000

STATUS = RBO.getProperty('','USER_ID',VALUE) ; * VALUE ENTERED IN THE GRID
STATUS = RBO.getProperty('', 'CONO', CONO) ; * COMPANY ID
STATUS = RBO.getProperty('', 'DIV_ID', DIV) ; * DIVISION ID
STATUS = RBO.getProperty('', 'GRID_INDX', PO.POS) ; *INDX OF THE GRID
STATUS = RBO.getProperty('', 'LEVEL', APP.PO.LEVEL) ; * PO LEVEL

*PO.POS = 1 ;* REGULAR
*PO.POS = 2 ;* OUTSIDE
*PO.POS = 3 ;* MISC.  


ERRMSG=""
PO.TYPE = "Regular":AM:"Outside":AM:"Misc."

* Insert method code here

*idval - ZUBAIR!001!06!1

INVALID.ID = 0
CHK.ID = CONO:VALUE:"!ALL"
READ CHECK.REC FROM APP.REQ,CHK.ID THEN
  IF CHECK.REC<2> = "Y" THEN
    NULL
  END ELSE
    CHK.ID = CONO:VALUE:"!":DIV
    READ CHECK.REC FROM APP.REQ,CHK.ID ELSE
      INVALID.ID = 1 
    END
  END
END ELSE
  CHK.ID = CONO:VALUE:"!":DIV             
  READ CHECK.REC FROM APP.REQ,CHK.ID ELSE 
    INVALID.ID = 1                        
  END                                     
END

*STATUS = RBO.setProperty('','ServerMessage','INVALID ID --' :INVALID.ID)
*RETURN


        IF NOT(INVALID.ID) THEN
*	   IF INVALID.ID # 1 THEN
            IF CHECK.REC<2> = "N" THEN
              ERRMSG = "Approver ":VALUE:" is inactive."
              GOTO 91000
            END ELSE
              IF CHECK.REC<6> = APP.PO.LEVEL-1 THEN
                IF CHECK.REC<3,PO.POS> = "N" THEN 
                  ERRMSG = "Approver ":VALUE:" is not setup to approve ":PO.TYPE<PO.POS>:" PO's."
                  GOTO 91000
                END ELSE
                  *APP.PO.ID<1,PO.POS,LN>=VALUE
                  *LINES=DCOUNT(APP.PO.ID<1,PO.POS>,SVM)
                  EOI = 1
                END
              END ELSE
                ERRMSG = "Invalid Approver level for ":PO.TYPE<PO.POS>:" PO's.  It has to be in level ":APP.PO.LEVEL-1:"."
                GOTO 91000
              END
            END
        END ELSE
          ERRMSG = "Invalid Approver Id."
          GOTO 91000
        END
STATUS = RBO.setProperty('', 'ServerStatus', 0)
RETURN

* End of method code
91000 *
STATUS = RBO.setProperty('', 'ServerStatus', 1)
STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)
RETURN

