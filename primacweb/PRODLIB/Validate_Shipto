SUBROUTINE Validate_Shipto
********************************************************************************
*   Program name :- Validate_Shipto
*   Created:- 5/15/2007
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB CUSTOMER
$INCLUDE PMC.CPYLIB SHIP.TO 
$INCLUDE CPYLIB CHAR
* Insert method code here
*OPEN '','JOB' TO JOB ELSE ERRMSG='JOB FILE IS MISSING';GOTO 90000
OPEN '','CUSTOMER' TO CUSTOMER ELSE ERRMSG='CUSTOMER FILE IS MISSING';GOTO 90000
OPEN '','SHIP.TO' TO SHIP.TO ELSE ERRMSG='SHIP.TO FILE IS MISSING';GOTO 90000
OPEN '','CONTROL' TO CONTROL ELSE ERRMSG='CONTROL FILE IS MISSING';GOTO 90000

*STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
*CONO= PMCProperty<1,4>
*STATUS=RBO.getProperty('','CONO',CONO)

STATUS=RBO.getProperty('','ID',ID)
*STATUS=RBO.getProperty('','BILL_TO',MIV.CUST.NO)
*STATUS=RBO.getProperty('','SHIP_TO',ECD.RET.VALUE)
CONO = FIELD(ID,"!",1)
BILL_TO = FIELD(ID,"!",2)
SHIP_TO = FIELD(ID,"!",3)

*SHP.REC.SIZE = 6
  DIM SHP.REC(8)
  EQU TEMP.DSP.NAME           TO SHP.REC(1)
  EQU TEMP.DSP.ADDR1          TO SHP.REC(2)
  EQU TEMP.DSP.ADDR2          TO SHP.REC(3)
  EQU TEMP.DSP.ADDR3          TO SHP.REC(4)
  EQU TEMP.DSP.ADDR4          TO SHP.REC(5)
  EQU TEMP.ZIP                TO SHP.REC(6)
  EQU TEMP.DSP.ATTN           TO SHP.REC(8)
   MAT SHP.REC = ""
 *MATREAD JOB.REC FROM JOB,CONO:IVC.JOB.NO ELSE MAT JOB.REC = ""
CUSTFLG = 0
 MATREAD SHP.REC FROM SHIP.TO,  CONO:BILL_TO:'!':SHIP_TO ELSE
   CUSTFLG = 1
      MATREAD SHP.REC FROM CUSTOMER,  CONO:SHIP_TO ELSE
	 ERRMSG = 'Customer Ship-To record ':SHIP_TO:' is not on file.'
	 * ERRMSG = 'Ship-To record ':ECD.RET.VALUE:' is not on file.'
         GOTO 90000
      END
 END
 IF CUSTFLG AND SHIP_TO # "" THEN
       READ CUST_ATT FROM CUSTOMER, CONO:SHIP_TO ELSE CUST_ATT = ""
       TEMP.DSP.ATTN = CUST_ATT<58>
 END
STATUS=RBO.setProperty('','SHIP_NAME',TEMP.DSP.NAME)
STATUS=RBO.setProperty('','SHIP_ADDR1',TEMP.DSP.ADDR1)
STATUS=RBO.setProperty('','SHIP_ADDR2',TEMP.DSP.ADDR2)
STATUS=RBO.setProperty('','SHIP_ADDR3',TEMP.DSP.ADDR3)
STATUS=RBO.setProperty('','SHIP_ADDR4',TEMP.DSP.ADDR4:"  ":TEMP.ZIP)
STATUS=RBO.setProperty('','SHIP_ATTN',TEMP.DSP.ATTN)


* End of method code
RETURN

90000
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN



