SUBROUTINE GET_GLH_INQ
*********************************************************************
*
* REVISION - [12.0]
*
* PROGRAM  - GET_GLH_INQ
*
* AUTHOR   - CHRIS MYKLEBUST, PRIMAC SYSTEMS
*
* DATE     - 10/07/2002
*
* DESCRIPTION
*
* This program gets the data for the G/L history inquiry screen.
*
*********************************************************************
*
*---- FILE COPY STATEMENTS
*
   $INCLUDE WWINSERT RBO.H
   $INCLUDE PMC.CPYLIB COA
   $INCLUDE PMC.CPYLIB COA.FILE.VARS
   $INCLUDE CPYLIB FILE.VARS
   $INCLUDE CPYLIB CHAR
   $INCLUDE GLS.CPYLIB COA.BAL
*
*---- OPEN ALL FILES
*
OPEN '','CONTROL' TO CONTROL ELSE ERRMSG = 'CONTROL FILE IS MISSING';GOTO 1000
OPEN '','CO.COA.BAL' TO CO.COA.BAL ELSE ERRMSG = 'CO.COA.BAL FILE IS MISSING'; GOTO 1000
         
      

   IN_PARAM = "" ; OUT_PARAM = ""
 ERRMSG = "CALL OPENGLSFILES PROBLEM"
  CALL OPENGLSFILES(ERRMSG,IN_PARAM,OUT_PARAM,MAT FILE.VARS,MAT COA.FILE.VARS,GLH,GLHX)
  IF ERRMSG # "" THEN GOTO 1000
*
*---- INITIALIZATION
*
   STATUS = RBO.getProperty('','ID',ID)
   STATUS = RBO.getProperty('','PERIOD',PER)
   STATUS = RBO.getProperty('','ACCT',ACCT.NO)
   STATUS = RBO.getProperty('','DIV',DIV.CODE)
   STATUS = RBO.getProperty('','DEPT',DEPT.CODE)
   STATUS = RBO.getProperty('','CCTR',CCTR.CODE)
   CONO = ID[1,3]
   MATREAD COA.REC FROM COA, CONO : ACCT.NO ELSE
  ERRMSG = 'Chart of Accounts record not on file. Try again!'
  GOTO 1000
  END
   IN_PARAM = ""
   IN_PARAM<1> = CONO
   IN_PARAM<2> = PER
   IN_PARAM<3> = ACCT.NO
   IN_PARAM<4> = DIV.CODE
   IN_PARAM<5> = DEPT.CODE
   IN_PARAM<6> = CCTR.CODE
   *ERRMSG = "CALL GET_GLH_INQ_SUB"
    CALL GET_GLH_INQ_SUB(ERRMSG,IN_PARAM,OUT_PARAM,MAT FILE.VARS,MAT COA.FILE.VARS,MAT COA.REC,GLHX,GLH)
IF ERRMSG # "" THEN GOTO 1000

1000 *
IF ERRMSG # "" THEN
   STATUS = RBO.setProperty('','ServerStatus',1)
   STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
END
   RETURN

