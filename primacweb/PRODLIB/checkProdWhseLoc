SUBROUTINE checkProdWhseLoc
********************************************************************************
*   Program name :- checkProdWhseLoc
*   Created:- 09/25/2003  
*------------------------------------------------------------------------------*
*
*T28141 lross 05/21/2004 * LOC can be chg'd to other than where recp is.-----REV12 CHANGES
*T28141 ADDED BY FAHEEM
* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INV.WHSE.LOC
$INCLUDE CPYLIB CHAR
$INCLUDE OPS.CPYLIB BOL
* Insert method code here
	
	OPEN "","CONTROL" TO CONTROL ELSE
	    ERRMSG = "CANNOT OPEN CONTROL FILE"
	END

	OPEN "","INV.WHSE.LOC" TO INV.WHSE.LOC ELSE
	    ERRMSG = "CANNOT OPEN INV.WHSE.LOC FILE"
	END
	OPEN "","DAILY.BOL" TO DAILY.BOL ELSE
	    ERRMSG = "CANNOT OPEN DAILY.BOL FILE"
	END
		
	ERRMSG=""
	STATUS=RBO.getProperty('','ProdWhseLoc',ProdWhseLocID)
	STATUS=RBO.getProperty('','BOLRECPNO',BOLRECPNO)
	STATUS=RBO.getProperty('','LINES',INDX)
	
       READ CHECK.REC FROM INV.WHSE.LOC, ProdWhseLocID ELSE
          ERRMSG = "Invalid location. Try again! "
          GOTO 93000
       END

	*BOL.RECP=FIELD(CHECK.REC<3>,'!',1)
	*BOL.RECP.NO1=BOL.RECP[2,99]
	
		VALUE = FIELD(ProdWhseLocID,"!",3,1)
		WHSE = FIELD(ProdWhseLocID,"!",2,1)
*T28141 v     
	*	TST.SERIAL='R':BOL.RECP.NO<1,INDX,1>:"!":BOL.WHSE<1,INDX,1>:"!":VALUE 
		TST.SERIAL='R':BOLRECPNO:"!":WHSE:"!":VALUE 
		LOCATE TST.SERIAL IN CHECK.REC<3> SETTING SFND ELSE
             		ERRMSG="Receipt not available in this location!"
        		GOTO 93000
              END
		
*T28141 ^
* End of method code
RETURN

93000: 
	STATUS = RBO.setProperty('','ServerStatus',1)        
	STATUS = RBO.setProperty('','ServerMessage',ERRMSG) 
	STATUS = RBO.setProperty('','LINES',INDX)

RETURN


