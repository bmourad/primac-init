SUBROUTINE CK_GEN_DIV_PROC_SUB
********************************************************************************
*   Program name :- CK_GEN_DIV_PROC_SUB
*   Created:- 6/3/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  Cono,DIV_CODE
*
* Out Properties:
* ---------------
*  This program validates General (00) or 'ALL' division processing.
*  If the company has elected to Post/Close by division,
*  Gen Div and 'ALL' processing is invalid.
********************************************************************************
$INCLUDE WWINSERT RBO.H

* Insert method code here
  OPEN '','CONTROL' TO CONTROL ELSE
      ERRMSG = "CONTROL FILE IS MISSING"
      GOTO 99999
  END
  
  ERRMSG = ''  
  STATUS = RBO.getProperty('','Cono',CONO)
  STATUS = RBO.getProperty('','DIV_CODE',DIV.CODE)
      
  XX<1> = CONO
  XX<99> = DIV.CODE

  READ SECURITY.REC FROM CONTROL, CONO:"DIV.SECURITY" ELSE GOTO 99999
  IF SECURITY.REC<1> # 'Y' THEN GOTO 99999
  IF SECURITY.REC<1> = "Y" AND SECURITY.REC<2> = "Y" THEN
      IF DIV.CODE = "00" OR DIV.CODE = "ALL" THEN
          ERRMSG = " 'ALL' OR '00' INVALID WHEN DIVISION-LEVEL POSTING & CLOSING IS SELECTED"
          GOTO 99999
      END
  END
  STATUS = RBO.setProperty('','INPUT_BUFF',LOWER(XX))

* End of method code
99999
  IF (TRIM(ERRMSG) # "") THEN
       STATUS = RBO.setProperty('','ServerStatus','E')
       STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
  END ELSE
       STATUS = RBO.setProperty('','ServerStatus','')
       STATUS = RBO.setProperty('','ServerMessage','')
  END 
RETURN

