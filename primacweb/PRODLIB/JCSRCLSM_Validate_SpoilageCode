SUBROUTINE JCSRCLSM_Validate_SpoilageCode
********************************************************************************
*   Program name :- JCSRCLSM_Validate_SpoilageCode
*   Created:- 11/10/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB SPOILAGE.CODES
* Insert method code here

OPEN '','SPOILAGE.CODES' TO SPOILAGE.CODES ELSE
      ERRMSG = 'SPOILAGE.CODES FILE IS MISSING'; GOTO 99999
END

STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
STATUS = RBO.getProperty('','DRC_SPOIL_CODE',DRC.SPOIL.CODE)
CONO = PMCProperty<1,4>
ERRMSG = ''
 MATREAD SPLG.REC FROM SPOILAGE.CODES, CONO:DRC.SPOIL.CODE ELSE
   *     ERRMSG = "INVALID SPOILAGE CODE"
  	  ERRMSG = DRC.SPOIL.CODE :" IS NOT ON FILE TRY AGAIN !"
	  MAT SPLG.REC = ""
         GOSUB 99999
END
STATUS = RBO.setProperty('','SPLG_DESC',SPLG.DESC)

* End of method code
RETURN
99999 
  IF (TRIM(ERRMSG) # "") THEN
       STATUS = RBO.setProperty('','ServerStatus',1)
       STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
  END
* End of method code
RETURN


