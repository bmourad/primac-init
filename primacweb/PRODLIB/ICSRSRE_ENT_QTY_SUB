SUBROUTINE ICSRSRE_ENT_QTY_SUB
********************************************************************************
*   Program name :- ICSRSRE_ENT_QTY_SUB
*   Created:- 4/5/2005
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INV_SERIAL
$INCLUDE ICS.CPYLIB DAILY_STOCK


OPEN "","DAILY_STOCK" TO DAILY_STOCK ELSE
      ERRMSG="CANNOT OPEN DAILY_STOCK FILE";GOTO 91000
END
OPEN "","INV_SERIAL_DELETED" TO INV_SERIAL_DELETED ELSE
      ERRMSG = "CANNOT OPEN INV_SERIAL_DELETED FILE";GOTO 91000
END
OPEN "","INV_SERIAL" TO INV_SERIAL ELSE
      ERRMSG = "CANNOT OPEN INV_SERIAL FILE";GOTO 91000
END
OPEN '','INVENTORY' TO INVENTORY ELSE 
	ERRMSG = 'INVENTORY FILE IS MISSING'; GOTO 91000
END
OPEN "","CATEGORY" TO CATEGORY ELSE
      ERRMSG = "CATEGORY FILE IS MISSING"; GOTO 91000
END
OPEN "","PO" TO PO ELSE
   ERRMSG = "CANNOT OPEN PO FILE"; GOTO 91000
END
CONO="001"
MATREAD PO.REC FROM PO, "0011000" THEN

         MATREAD INV.REC FROM INVENTORY, "001":PO.PROD.NUM<1,PO.LINE.PTR> ELSE MAT INV.REC = ""
         MATREAD CATG.REC FROM CATEGORY,"001":INV.LINE ELSE MAT CATG.REC=''

   DSR.ID = "0011000!1008"
   MATREADU DSR.REC FROM DAILY_STOCK,DSR.ID THEN
      LINE.CNT = 0
      S.CNT = DCOUNT(S.SERIAL,@VM)
      LINE.CNT = S.CNT
      FOR SS=1 TO S.CNT
         MATREAD ISTK.REC FROM INV_SERIAL,CONO:S.SERIAL<1,SS> ELSE            
            MATREAD ISTK.REC FROM INV_SERIAL_DELETED,CONO:S.SERIAL<1,SS> ELSE  
               MAT ISTK.REC = ""                                                  
               ERRMSG = "Serial information record cannot be found":S.SERIAL<1,SS>
               GOTO 91000                                                         
            END                                                                  
         END
*         INV.ID=CONO:ISTK.PROD
*         IWH.ID=INV.ID:"!":ISTK.WHSE
*         GOSUB CHECK.DATA

DSR.SERIAL=S.SERIAL<1,SS>

         FIND S.SERIAL<1,SS> IN DSR.SERIAL SETTING FLD,VL,SVL THEN
		SS = REF.NO
		S.PO.LINE.NO<1,SS>=POLINE
		S.INV.PAP.WIDTH<1,SS> = INV.PAP.WIDTH ; *ADDED
		S.INV.M.WT<1,SS> = INV.M.WT
		FOR I = 1 TO 4
		       *S.INV.UNIT<1,SS,I> = INV.UNIT<1,I>
			S.INV.UNIT<1,SS,-1> = INV.UNIT<1,I>
		NEXT I
		S.INV.SBR<1,SS> = INV.SBR ;*T28300
		GOSUB GET.CONV
	  END
      NEXT SS
   END
END
91000*	
	STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
	STATUS = RBO.setProperty("","ServerStatus",S.INV.UNIT)
RETURN

