SUBROUTINE EST_INVENTORY
********************************************************************************
*   Program name :- EST_INVENTORY
*   Created:- 10/26/2004   RAZI MOHIUDDIN
*------------------------------------------------------------------------------*
* This method will fetch INVENTORY CODES
* -----------------------------------------------------------------------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INVENTORY


OPEN '','INVENTORY' TO INVENTORY ELSE ERRMSG = 'Cannot open INVENTORY file!'


INVIDS=''
INVDESC=''
INVCODDSC=''

STATUS = RBO.getProperty('', 'PMCProperty', PMCProperty)
CONO   = PMCProperty<1,4>

CMD="SSELECT INVENTORY WITH @ID LIKE '":CONO:"...'"

UDTEXECUTE CMD
DATA = 1
S=1
LOOP
    READNEXT CODE ELSE DATA = 0
WHILE DATA DO
*CUSTID<1,-1> = CODE

	MATREAD INV.REC FROM INVENTORY, CODE THEN 
		INVIDS<1,S> = CODE[4,99]
		INVDESC<1,S>=INV.DESC
		INVCODDSC<1,S>=CODE[4,99]:"_":INV.DESC
       END
       S=S+1
REPEAT

SWAP "'" WITH "" IN INVDESC 
SWAP '"' WITH "" IN INVDESC
SWAP "'" WITH "" IN INVCODDSC 
SWAP '"' WITH "" IN INVCODDSC

STATUS = RBO.setProperty('','INVIDS',INVIDS)
STATUS = RBO.setProperty('','INVDESC',INVDESC)
STATUS = RBO.setProperty('','INVCODDSC',INVCODDSC)


RETURN

90000*
   STATUS = RBO.setProperty('','ServerStatus',1)
   STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN



