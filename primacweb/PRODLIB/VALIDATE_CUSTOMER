SUBROUTINE VALIDATE_CUSTOMER
********************************************************************************
*   Program name :- VALIDATE_CUSTOMER
*   Created:- 6/27/2007
*   By     :- ABDUL GAFOOR
* 
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB CUSTOMER
     ERRMSG=""
     OPEN "","CUSTOMER" TO CUSTOMER ELSE ERRMSG="ERROR IN OPENING CUSTOMER FILE.";GOTO 91000
*
* CUSTOMER
*
1000 *
      STATUS = RBO.getProperty('','ID',ID)
      CONO = FIELD(ID,'#',1)
      CUST.ID = FIELD(ID,'#',2)

      MATREAD CUST.REC FROM CUSTOMER, CONO:CUST.ID ELSE
          ERRMSG = CUST.ID :" IS NOT ON FILE TRY AGAIN !"
	   GOTO 91000
      END
      IF CUST.TYPE = "F" THEN
  	   ERRMSG = "Customer Type is Frozen - Cannot Enter Job"
	   GOTO 91000
      END
      IF CUST.CREDIT = "DEL" THEN
          ERRMSG = 'This customer has credit code "DEL", cannot enter a Job for this customer.'
	   GOTO 91000
      END
      IF CUST.CREDIT = "N" THEN
          ERRMSG = "THERE IS NO CREDIT FOR THIS CUSTOMER"
	   GOTO 91000
      END
	STATUS=RBO.setProperty('','Job_CustomerName',CUST.NAME)
RETURN
91000*
	STATUS=RBO.setProperty('','ServerStatus',1)
	STATUS=RBO.setProperty('','ServerMessage',ERRMSG)
RETURN

