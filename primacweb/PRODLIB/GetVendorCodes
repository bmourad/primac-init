SUBROUTINE getVendorCodes
*********************************************************************
* Copyright 1998 by Primac Systems India
* SYSTEM       - EPRIMAC
* PROGRAM      - GetVendorCodes
* BY           - KHAJA ZIAUDDIN
* DATE         - 05/29/2003
* DESCRIPTION  - This program get the Vendor Codes, Descs, Addr1, Addr2, City, Zipcode, Fax, Terms Net, Terms Per
*                
*                
*                
*                
*ENDDOC
*********************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB VEND
* Insert method code here

 PROG.ID = 'getVendorCodes'
   *
   OPEN '','VEND' TO VEND ELSE
      MESG = 'Cannot open Vendor file!'
      STATUS = RBO.setProperty('', 'ServerStatus', 1)
      STATUS = RBO.setProperty('', 'ServerMessage', MESG)
      RETURN
   END
*

   *VENDCODES = '00000000'
  * VENDDESCS = '-Select-'
*after readData is done, get the value from VEND_NO and populate the vendor details
STATUS = RBO.getProperty('','PMCProperty',PMCProperty)

CONO = PMCProperty<1,4>

*   STATUS=RBO.getProperty('','VendNo',VEND_NO)

VENDCODES = ''
   VENDDESCS = ''

   VENDADDR1 = ''
   VENDADDR2 = ''
	 CITY = '' 	
   ZIPCODE = ''
   VENDPHONE = '' 	
     VENDFAX = '' 	
   VENDNET = ''
   VENDPER = ''
   *VendShipTo = ''
   VENDSHIPTO = ''

   VEND_NO = ''
   VEND_NAME = ''
   VendEmail_POR = ''

  * SELECT VEND 
CMD="SSELECT VEND WITH CONO= '" :CONO:"'"
UDTEXECUTE CMD
   DATA = 1
   LOOP
      READNEXT ID ELSE DATA = 0
   WHILE DATA DO
*STATUS=RBO.setProperty('','WarehouseDescs',ID)

       VENDCODES<1,-1> = ID[4,99]
 	READV VENDNAME FROM VEND,ID,1 ELSE VENDNAME = ID
     
	READV VEND_ADDR1 FROM VEND,ID,2 ELSE VEND_ADDR1 = ID
	READV VEND_ADDR2 FROM VEND,ID,3 ELSE VEND_ADDR2 = ID
       READV CITY_STATE FROM VEND,ID,4 ELSE CITY_STATE = ID
	
       READV VEND_ZIP FROM VEND,ID,5 ELSE VEND_ZIP = ID
	READV VEND_PHONE FROM VEND,ID,17 ELSE VEND_PHONE = ID
	READV VEND_SLSMN_FAX FROM VEND,ID,34 ELSE VEND_SLSMN_FAX = ID
       READV VEND_SHIP_VIA FROM VEND,ID,29 ELSE VEND_SHIP_VIA = ID
	READV NET FROM VEND,ID,6 ELSE NET = ID
	READV DISCNT FROM VEND,ID,7 ELSE DISCNT = ID
	
	READV VEND_EMAIL_ADDR FROM VEND,ID,60 ELSE VEND_EMAIL_ADDR = ID
	

       VENDDESCS<1,-1> = ID[4,99]:"-":VENDNAME

	IF VEND_ADDR1 = "" THEN VEND_ADDR1 = " "
	IF VEND_ADDR2 = "" THEN VEND_ADDR2 = " "
	IF CITY_STATE = "" THEN CITY_STATE = " "
	IF VEND_ZIP = "" THEN VEND_ZIP = " "
	IF VEND_PHONE = "" THEN VEND_PHONE = " "
	IF VEND_SLSMN_FAX = "" THEN VEND_SLSMN_FAX = " "
	IF VEND_SHIP_VIA = "" THEN VEND_SHIP_VIA = " "
	IF VendEmail_POR = "" THEN VendEmail_POR = " "


      	VENDADDR1<1,-1> = VEND_ADDR1
	VENDADDR2<1,-1> = VEND_ADDR2
	     CITY<1,-1> = CITY_STATE 
      ZIPCODE<1,-1> 	  = VEND_ZIP
      VENDPHONE<1,-1>  = VEND_PHONE
      VENDFAX<1,-1>	  = VEND_SLSMN_FAX
      VENDSHIPTO<1,-1> = VEND_SHIP_VIA
	VendEmail_POR<1,-1> = VEND_EMAIL_ADDR


	NET<1,1> = OCONV(NET<1,1>,"MD2")
	NET<1,2> = OCONV(NET<1,2>,"MD2")

      VENDNET<1,-1>  = CHANGE(NET,@VM,"#")
      VENDPER<1,-1>	  = OCONV(DISCNT,"MD2")
      *PARSE THE STRING HERE & GET THE REMAINING VENDOR DETAILS ...

   REPEAT
*
   STATUS = RBO.setProperty('', 'VendCodes', VENDCODES)
   STATUS = RBO.setProperty('', 'VendDescs', VENDDESCS)
   STATUS = RBO.setProperty('', 'VendAddr1', VENDADDR1)
   STATUS = RBO.setProperty('', 'VendAddr2', VENDADDR2)
   STATUS = RBO.setProperty('', 'VendZip', ZIPCODE)
   STATUS = RBO.setProperty('', 'VendCity', CITY)
   STATUS = RBO.setProperty('', 'VenPhone', VENDPHONE)
   STATUS = RBO.setProperty('', 'VendFax', VENDFAX)
   STATUS = RBO.setProperty('', 'VendNet', VENDNET)
   STATUS = RBO.setProperty('', 'VendPer', VENDPER)
   STATUS = RBO.setProperty('', 'VendShipTo', VENDSHIPTO)
   STATUS = RBO.setProperty('','VendEmail_POR',VendEmail_POR)


   *STATUS = RBO.setProperty('', 'ServerStatus', 0)
   *STATUS = RBO.setProperty('', 'ServerMessage', '')
*
   RETURN
*
END

