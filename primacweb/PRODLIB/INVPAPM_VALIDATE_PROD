SUBROUTINE INVPAPM_VALIDATE_PROD
********************************************************************************
*   Program name :- INVPAPM_VALIDATE_PROD
*   Created:- 9/28/2005
*   Programmer :- Suhail Hussain S  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE ICS.CPYLIB INVENTORY
* Insert method code here
OPEN "","INVENTORY" TO INVENTORY ELSE ERRMSG = "CANNOT OPEN INVENTORY FILE";GOTO 91000
OPEN "","COMPANY" TO COMPANY ELSE ERRMSG = "CANNOT OPEN COMPANY FILE";GOTO 91000

  STATUS = RBO.getProperty("","CONO",CONO)
  STATUS = RBO.getProperty("","ID",ID)
  ERRMSG = ""
  MATREAD COMP.REC FROM COMPANY,CONO ELSE ERRMSG = "CANNOT READ COMPANY FILE ON : " : CONO ; GOTO 91000

  MATREAD INV.REC FROM INVENTORY, ID THEN
    IF INV.M.LINE = 'FNGD' THEN
      IF CO.OPS = 'Y' THEN
         ERRMSG = 'This product is a Finished Goods Product'
      END
    END ELSE
      IF INV.PAP.TYPE = 'REGULAR' THEN
        ERRMSG = 'This product is not a Paper Product'
      END
    END
  END

91000:
  IF ERRMSG # "" THEN
    STATUS = RBO.setProperty("","ServerStatus",1)
  END
  STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
   
* End of method code
RETURN

