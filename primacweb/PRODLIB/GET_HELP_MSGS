SUBROUTINE GET_HELP_MSGS
********************************************************************************
*   Program name :- GET_HELP_MSGS
*   Created:- 8/5/2005
*   By:- Syed Suhail Hussain
*   Description:- This subroutine takes the input as the processId and gets all
*                 the available help messages for the inputs from its 
*                 corresponding screen file
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB PMC_PROCESS

  STATUS = RBO.getProperty('','SCRN_FILE',SCRN)
  STATUS = RBO.getProperty('','PROC_NAME',PROCESS_NAME)

  OPEN "",SCRN: ".SCREENS" TO SCREEN ELSE ERRMSG = SCREEN : " FILE IS MISSING";GOTO 91000

  CMD = "SSELECT " : SCRN : ".SCREENS WITH @ID LIKE '" : PROCESS_NAME : "*HMSG...' DESC"
  UDTEXECUTE CMD CAPTURING JUNK

  XML = ''
  XML = '<?xml version="1.0"?>'
  XML = '<Main>'
  TEMP.REC.SIZE = 1
  PROMPT_NO = ""
  HMSG = ''
  TMP_HMSG = ''
  MSG.CNT = ''
  DATA = 0
  LOOP
    READNEXT KEY ELSE DATA = 1
    WHILE DATA = 0 DO
    PROMPT_NO = KEY
    SWAP PROCESS_NAME : "*HMSG" WITH "" IN PROMPT_NO
    XML = XML : @VM : '<PROMPT_NO ID="' : PROMPT_NO : '">'
    READU TEMP.REC FROM SCREEN,KEY THEN
       HMSG = TEMP.REC(1)
       SWAP @AM WITH @VM IN HMSG
       SWAP "ü" WITH "!" IN HMSG
       MSG.CNT = DCOUNT(HMSG,@VM)
       FOR I = 1 TO MSG.CNT
         TMP_HMSG = HMSG<1,I>
         SWAP "<" WITH "" IN TMP_HMSG
         SWAP ">" WITH "" IN TMP_HMSG
         SWAP '"' WITH "" IN TMP_HMSG
         SWAP "'" WITH "" IN TMP_HMSG
         SWAP "." WITH "" IN TMP_HMSG
         XML = XML :  @VM : '<HMSG >' : TMP_HMSG : "</HMSG>"
       NEXT I
    END
    RELEASE
    XML = XML :  @VM : "</PROMPT_NO>"
  REPEAT
  XML = XML :  @VM : "</Main>"

  STATUS = RBO.setProperty('','XML_DATA',XML)
RETURN

91000:
  STATUS = RBO.setProperty('','ServerStatus',1)
  STATUS = RBO.setProperty('','ServerMessage',ERRMSG)	
RETURN
