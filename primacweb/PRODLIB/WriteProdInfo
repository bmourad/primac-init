SUBROUTINE WriteProdInfo
********************************************************************************
*   Program name :- WriteProdInfo

*   Created:- 7/25/2003

*   AUTHOR   - IRFAN M SALEEM
*
*
* DESCRIPTION
*
* The program to write into est.desc.code
*********************************************************************
*
*---- FILE COPY STATEMENTS
*
  $INCLUDE WWINSERT RBO.H
  $INCLUDE JES.CPYLIB EST.DESC.CODE
  $INCLUDE CPYLIB CHAR

*
**** OPEN FILES
*
ERRMSG = ''
IF FILEINFO(EST.DESC.CODE,0) = 0 THEN
   OPEN '','EST.DESC.CODE' TO EST.DESC.CODE ELSE
     ERRMSG = 'Cannot open EST.DESC.CODE file!'
      GOTO SET.ERROR
    END
END

   STATUS = RBO.getProperty('', 'CODE', CODE)
   STATUS = RBO.getProperty('', 'HEADING', HEADING)
   STATUS = RBO.getProperty('', 'HeadDescs', DESCARR)

   STATUS = RBO.getProperty('','PMCProperty', PMCProperty)
CONO = PMCProperty<1,4>
*---- INITIALIZATION
*
TEST=''
FOR X = 1 TO DCOUNT(CODE,@VM)
	IF CODE<1,X> # "" THEN
	  MATREADU EDC.REC FROM EST.DESC.CODE,CONO:CODE<1,X> THEN
		EDC.HEADING =HEADING<1,X>
		EDC.DESC =FIELD(DESCARR,@SVM,X)
		MATWRITE EDC.REC ON EST.DESC.CODE,CONO:CODE<1,X> 
	   END  	
	END	
NEXT X
   
RETURN
   
SET.ERROR:
	STATUS = RBO.setProperty('','ServerStatus',1)
	STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN



