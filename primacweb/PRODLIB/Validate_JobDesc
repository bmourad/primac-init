SUBROUTINE Validate_JobDesc
********************************************************************************
*   Program name :- 
*   Created:- 11/1/2004
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB JOB 
* Insert method code here
TEMP_DESC= ''
ID_LIST = ''
TMP_CNT = 0

OPEN '','JOB' TO JOB ELSE ERRMSG='JOB FILE IS MISSING';GOTO 99999
STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
CONO = PMCProperty<1,4>

CMD = "SSELECT JOB WITH CONO ='":CONO:"'"
UDTEXECUTE CMD

DATA = 1
LOOP
	READNEXT ID ELSE DATA = 0
WHILE DATA DO
	ID_LIST<1,-1> = ID
REPEAT

TMP_CNT  = DCOUNT(ID_LIST,@VM)
FOR X = 1 TO TMP_CNT
	MATREAD JOB.REC FROM JOB, ID_LIST<1,X> THEN
	 IF JOB.DESC <> "" THEN	
		 TEMP_DESC<1,X> = JOB.DESC
	 END
	END
NEXT X

STATUS = RBO.setProperty('','VALID_JOB_DESC',TEMP_DESC)

RETURN
99999
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
* End of method code
RETURN

