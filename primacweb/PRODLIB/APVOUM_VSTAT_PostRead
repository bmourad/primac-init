SUBROUTINE APVOUM_VSTAT_PostRead
********************************************************************************
*   Program name :- APVOUM_VSTAT_PostRead
*   Created:- 1/22/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB VEND
$INCLUDE APS.CPYLIB VEND.STATS
$INCLUDE CPYLIB CHAR

ERRMSG=''
IF FILEINFO(VEND,0)=0 THEN
   OPEN '','VEND' TO VEND ELSE
      ERRMSG='VEND FILE IS MISSING'
      GOTO 93000
   END
END
IF FILEINFO(VEND.STATS,0)=0 THEN
   OPEN '','VEND.STATS' TO VEND.STATS ELSE
      ERRMSG='VEND.STATS FILE IS MISSING'
      GOTO 93000
   END
END
UNKNOWN=STR('?',29)
STATUS=RBO.getProperty('','ID',ID)
CONO=ID[1,3]
MATREAD VSTAT.REC FROM VEND.STATS,ID ELSE
   ERRMSG='Cannot locate the VEND.STATS record ':ID; GOTO 93000
END
ORDER.BAL=0
RECVD.BAL=0
FOR I = 1 TO DCOUNT(VSTAT.PO,VM)
  ORDER.BAL<1,I> = VSTAT.PO.ORDERD<1,I> - VSTAT.PO.VOUCH<1,I>
  IF ORDER.BAL<1,I> < 0 THEN ORDER.BAL<1,I> = 0
  ORDER.BAL<1,I> = OCONV(ORDER.BAL<1,I>,'MD2')
  RECVD.BAL<1,I> = VSTAT.PO.RECV<1,I> - VSTAT.PO.VOUCH<1,I>
  IF RECVD.BAL<1,I> < 0 THEN RECVD.BAL<1,I> = 0
  RECVD.BAL<1,I> = OCONV(RECVD.BAL<1,I>,'MD2')
NEXT I
STATUS=RBO.setProperty('','OrderBalance',ORDER.BAL)
STATUS=RBO.setProperty('','RecvBalance',RECVD.BAL)
GOTO 99999

93000 
STATUS = RBO.setProperty('','ServerStatus',1)        
STATUS = RBO.setProperty('','ServerMessage',ERRMSG) 

99999 
RETURN

