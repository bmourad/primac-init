SUBROUTINE SYSONPM_REVIEW
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB OVERNIGHT.REQUESTS
ERRMSG = ""
DIS = ""
INDEX=""

OPEN "","CONTROL" TO CONTROL ELSE
  ERRMSG = "CANNOT OPEN CONTROL FILE"
  GOTO 91000
END

OPEN "","REPORT.PROC.FILE" TO REPORT.PROC.FILE ELSE
   ERRMSG = "CANNOT OPEN REPORT.PROC.FILE"
   GOTO 91000    
END

MATREAD OR.REC FROM CONTROL, "OVERNIGHT.REQUESTS" ELSE
	ERRMSG="Processor not currently available for maintenance."
	GOTO 91000
END

STATUS=RBO.getProperty('','INDEX',INDEX)

Z=DCOUNT(OR.FIELDS,@VM)
FOR I=1 TO Z
IF I = INDEX THEN
	FOR J=1 TO DCOUNT(OR.FIELDS<1,I>,@SM)	
		READV DESC FROM REPORT.PROC.FILE,OR.FIELDS<1,I,J>,1 ELSE DESC = "UNKNOWN OPTION"
		DIS<1,-1>=DESC
	NEXT	
END
NEXT
STARTDATE=""
STARTTIME=""
ENDDATE=""
ENDTIME=""
K=DCOUNT(OR.START.DATE,@VM)
	FOR I=1 TO K
IF I = INDEX THEN	
		STARTDATE<1,I>=OCONV(OR.START.DATE<1,I>,"D2/")
		STARTTIME<1,I>=OCONV(OR.START.TIME<1,I>,"MTS")
		ENDDATE<1,I>=OCONV(OR.END.DATE<1,I>,"D2/")
		ENDTIME<1,I>=OCONV(OR.END.TIME<1,I>,"MTS")
END
	NEXT

STATUS_R=OR.STATUS

STATUS=RBO.setProperty('','REQUESTEDPROCEDURE',OR.REPORT.NAME<1,INDEX>)
STATUS=RBO.setProperty('','COMPANYNO',OR.COMPANY.NO<1,INDEX>)
STATUS=RBO.setProperty('','USERID',OR.USER.ID<1,INDEX>)
STATUS=RBO.setProperty('','STATUS_R',OR.STATUS<1,INDEX>)
STATUS=RBO.setProperty('','ACCOUNTNAME',OR.ACCOUNT.NAME<1,INDEX>)
STATUS=RBO.setProperty('','MDPROCO',OR.MD.PROC<1,INDEX>)
STATUS=RBO.setProperty('','FIELDS',OR.FIELDS<1,INDEX>)
STATUS=RBO.setProperty('','DIS',DIS)
STATUS=RBO.setProperty('','PARAMETERS',OR.PARAMETERS<1,INDEX>)
STATUS=RBO.setProperty('','STARTDATE',STARTDATE)
STATUS=RBO.setProperty('','STARTTIME',STARTTIME)
STATUS=RBO.setProperty('','ENDDATE',ENDDATE)
STATUS=RBO.setProperty('','ENDTIME',ENDTIME)
RETURN
91000 
STATUS=RBO.setProperty('','ServerStatus',1)
STATUS=RBO.setProperty('','ServerMessage',ERRMSG)
RETURN

