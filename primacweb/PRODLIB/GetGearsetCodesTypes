SUBROUTINE GetGearsetCodesTypes
********************************************************************************
*   Program name :- GetGearsetCodes
*   Created:- 08th May, 2003.
*   Created by :- Bhaskar Goteti
*------------------------------------------------------------------------------*
*
* In Properties:
* --------------
*  
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
* Insert method code here

PROG.ID = 'GetGearsetCodes'
MESG = ''
   *
   OPEN '','ESTIMATE.RES.GEARSET' TO ESTIMATE.RES.GEARSET ELSE
      MESG = 'Cannot open ESTIMATE.RES.GEARSET file!'
	GOTO 93000
   END
*
  STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
CONO = PMCProperty<1,4>
 
   GEARSETCODES = ''   
   GEARID_TYPE = ''

   CMD = "SSELECT ESTIMATE.RES.GEARSET WITH @ID LIKE ":CONO:"..."
   UDTEXECUTE CMD 

   DATA = 1
   LOOP
      READNEXT CODE ELSE DATA = 0
   WHILE DATA DO
      GEARSETCODES  = CODE[4,99]
      
      READV FBIMPRESSION FROM ESTIMATE.RES.GEARSET,CODE,3 ELSE FBIMPRESSION = ''
      FBIMPRESSION <1,-1> = FBIMPRESSION
 	
	IF GEARID_TYPE = "" THEN
	     GEARID_TYPE =  CODE[4,99] : "-" : FBIMPRESSION
	END ELSE
	     GEARID_TYPE = GEARID_TYPE : @VM : CODE[4,99] : "-" : FBIMPRESSION  
       END

   REPEAT

STATUS = RBO.setProperty('', 'RLDIE_TYPES', GEARID_TYPE )
  
RETURN

93000*
   STATUS = RBO.setProperty('', 'ServerStatus', 1)
   STATUS = RBO.setProperty('', 'ServerMessage', MESG )
*
* End of method code
RETURN

END

