SUBROUTINE VALID_INV_NUM
********************************************************************************
*   Program name :- VALID_INV_NUM
*   Created:- 5/7/2007
*------------------------------------------------------------------------------*
$INCLUDE WWINSERT RBO.H
* Insert method code here
    OPEN "","CONTROL" TO CONTROL ELSE ERRMSG="ERROR IN OPENING CONTROL FILE " ; GOTO 93000 
    VALID.INV.NUM = ""
    ERRMSG = ""	
    STATUS = RBO.getProperty('','ID',CONO)
    STATUS = RBO.getProperty('','TEMP',MODULE)
    
    IF MODULE = 'JCS' THEN
	GOTO 9000
    END ELSE IF MODULE = 'ARS' THEN
       GOTO 9100
    END ELSE
       GOTO 9200
    END
9000 *
    READ PNCN FROM CONTROL,CONO:"JCSNEXT.PNCN" THEN
	VALID.INV.NUM = PNCN
    END ELSE
      ERRMSG= "ERROR IN READING CONTROL RECORD CONO:JCSNEXT.PNCN" 
      GOTO 93000
    END

    STATUS = RBO.setProperty('','VALID_INVNUM',VALID.INV.NUM)   
* End of method code
RETURN

9100 *
    READ PNCN FROM CONTROL,CONO:"ARSNEXT.PNCN" THEN
	VALID.INV.NUM = PNCN
    END ELSE
      ERRMSG= "ERROR IN READING CONTROL RECORD CONO:ARSNEXT.PNCN" 
      GOTO 93000
    END

    STATUS = RBO.setProperty('','VALID_INVNUM',VALID.INV.NUM)   
* End of method code
RETURN

9200 *
    READ PNCN FROM CONTROL,CONO:"JCSNEXTCM.PNCN" THEN
	VALID.INV.NUM = PNCN
    END ELSE
      ERRMSG= "ERROR IN READING CONTROL RECORD CONO:ARSNEXT.PNCN" 
      GOTO 93000
    END

    STATUS = RBO.setProperty('','VALID_INVNUM',VALID.INV.NUM)   
* End of method code
RETURN


93000 *
    STATUS = RBO.setProperty('','ServerStatus',1)
    STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
END

