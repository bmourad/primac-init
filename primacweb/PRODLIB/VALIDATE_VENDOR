SUBROUTINE VALIDATE_VENDOR
********************************************************************************
*   Program name :- VALIDATE_VENDOR
*   Created:- 4/12/2007
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE APS.CPYLIB CKP
  ERRMSG=""
  OPEN '','CONTROL' TO CONTROL ELSE ERRMSG="ERROR IN OPENING THE CONTROL FILE "; GOTO 9999
  OPEN '',"CKP" TO CKP ELSE ERRMSG = "CKP FILE MISSING";GOTO 9999
* Insert method code here
  CMD=""
  FND=""
  VENDOR=""
  VEND=""
  STATUS = RBO.getProperty('','BUFF_VAL',ID)
  CONO = FIELD(ID,"!",1)
  DIV.OWNER = FIELD(ID,"!",2)
  IVEND = FIELD(ID,"!",3)
  READV VEND FROM CONTROL ,CONO:"REPRINT":DIV.OWNER,1 ELSE RETURN
WRITE "VEND IS ":VEND ON CONTROL,"JYKB"
*v
IF VEND # "" AND VEND # "ALL" THEN
    CMD = "SSELECT CKP BY VEND_ WITH CO_ = '": CONO :"' AND WITH VEND_ >= '":VEND:"' AND WITH VCH.DIV.OWNER ='":DIV.OWNER:"'"
END ELSE
     * CMD = "SSELECT CKP BY VEND_ WITH CO_ = '": CONO :"' AND WITH VEND_ >= '":VEND:"' AND WITH VCH.DIV.OWNER ='":DIV.OWNER:"'"
    CMD = "SSELECT CKP BY VEND_ WITH CO_ = '": CONO :"' AND WITH VCH.DIV.OWNER ='":DIV.OWNER:"'"

END
*^
*  CMD = "SSELECT CKP BY VEND_ WITH CO_ = '": CONO :"' AND WITH VEND_ >= '":VEND:"' AND WITH VCH.DIV.OWNER ='":DIV.OWNER:"'"
  UDTEXECUTE CMD CAPTURING MSG
  UDTEXECUTE "SAVE-LIST ABD"
  UDTEXECUTE "GET-LIST ABD"
*  WRITE "CMD MSG ":MSG ON CONTROL,"GFRMSG"

    FLAG = 1
    LOOP
    WHILE FLAG DO
    READNEXT ID ELSE FLAG=0
    MATREAD CKP.REC FROM CKP,ID THEN
        VENDOR<1,-1> =  CKP.VEND ;*:" ":ID
    END
   REPEAT

  * IF IVEND # 'ALL' THEN
  *    LOCATE IVEND IN VENDOR<1>,1 SETTING FND ELSE FND=0
  * END ELSE
  *    FND = 1
  * END

  STATUS = RBO.setProperty('','LIST_NAME',VENDOR)
  *STATUS = RBO.setProperty('','LIST_NAME',FND)

* End of method code
RETURN
9999 *
  STATUS = RBO.setProperty('','ServerStatus',1) 
  STATUS = RBO.setProperty('','ServerMessage',ERRMSG)   
RETURN

