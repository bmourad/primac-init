SUBROUTINE CHECKADJPERIOD
*************************************************************
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - EPRIMAC
* PROGRAM     - CHECKADJPERIOD
* BY          - KHAJA ZIAUDDIN
* DATE        - 07/15/03  (mm/dd/yy)
* DESCRIPTION
*ENDDOC
*************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE ICS.CPYLIB WAREHOUSE

STATUS = RBO.getProperty('','PMCProperty',PMCPROPERTY)
STATUS = RBO.getProperty('','Period',PERIOD)
STATUS = RBO.getProperty('','OrgWhse',WHSE)

CONO = PMCPROPERTY<1,4>
MAT COMP.REC = ''

OPEN '','COMPANY' TO COMPANY ELSE	ERRMSG = 'COMPANY FILE IS MISSING'; GOTO 93000
OPEN '','CONTROL' TO CONTROL ELSE	ERRMSG = 'CONTROL FILE IS MISSING'; GOTO 93000
OPEN '','WAREHOUSE' TO WAREHOUSE ELSE ERRMSG = 'WAREHOUSE FILE IS MISSING'; GOTO 93000

MATREAD WHSE.REC FROM WAREHOUSE, CONO:WHSE THEN
   DIV.CODE = WHS.DIV
END ELSE 
   MAT WHSE.REC = ''
   DIV.CODE = "00"
END

  MATREAD COMP.REC FROM COMPANY, CONO ELSE
    ERR.FLG = 2
    ERR = "Company Record Is Missing"
    GOTO 93000
  END

ERR.FLG = ""
ERRMSG = ""
CALL CHECK_PERIOD_DATE(CONO,"",PERIOD,DIV.CODE,ERR.FLG,ERRMSG,COMPANY,CONTROL)
IF ERR.FLG = 1 OR ERR.FLG = 2 THEN
       STATUS = RBO.setProperty('','ServerStatus',1)
	STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
	STATUS = RBO.setProperty('','Period','')
	RETURN
END ELSE
       STATUS = RBO.setProperty('','ServerStatus',0)
	STATUS = RBO.setProperty('','ServerMessage','')
END


RETURN

*****
93000
*****
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)

