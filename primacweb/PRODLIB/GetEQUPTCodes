SUBROUTINE GetEQUPTCodes
*******************************************************************************
*   Program name :- GetEQUPTCodes
*   Created:- 11/12/2002 G.PURUSHOTHAM RAO
*------------------------------------------------------------------------------*
*Programmer : G.PURUSHOTHAM RAO

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JES.CPYLIB EQUIPMENT

ERRMSG1 = RBO.getProperty('','PMCProperty',PMCProperty)

* Insert method code here
  OPEN "","COST.CNTR" TO COST.CNTR ELSE
   ERRMSG = "CANNOT OPEN COST.CNTR FILE";GOTO 93000
  END

  OPEN "","EQUIPMENT" TO EQUIPMENT ELSE
   ERRMSG = "CANNOT OPEN EQUIPMENT FILE";GOTO 93000
  END
  
EQUIP.CODES.LIST = '0'
EQUIP.DESCS.LIST = '-Select-'
EQUIP.TYPE.LIST = '0'
*EQUIP.CODES-TYPE.LIST = '0'

CONO = PMCProperty<1,4>

CMD = "SSELECT EQUIPMENT WITH CONO = '" : CONO : "'"
UDTEXECUTE CMD

LOOP
	EOF = 1
	READNEXT EQUIP.ID ELSE EOF = 0
WHILE EOF DO
	MATREAD EQUIPMENT.REC FROM EQUIPMENT,EQUIP.ID THEN 
		   EQUIP.TYPE.LIST<1,-1> = EQP.TYPE
		   READV CCTR.DESC FROM COST.CNTR, EQUIP.ID, 1 THEN
			EQUIP.CODES.LIST<1,-1> = EQUIP.ID[4,99]
			EQUIP.DESCS.LIST<1,-1> = EQUIP.ID[4,99] : "_" : CCTR.DESC : "_" : EQP.TYPE	
	
		   END ELSE 
			ERRMSG = "NO RECORD FOUND"
		   END
	END
REPEAT
	*1000*
	STATUS=RBO.setProperty('','CostCenterCodes',EQUIP.CODES.LIST)
	STATUS=RBO.setProperty('','CostCenterCodesDescs',EQUIP.DESCS.LIST)
*	STATUS=RBO.setProperty('','EqpIDTypes',EQUIP.CODESTYPE.LIST)

RETURN

93000*
	STATUS=RBO.setProperty('','ServerStatus',1)
	STATUS=RBO.setProperty('','ServerMessage',ERRMSG )

* End of method code
RETURN

