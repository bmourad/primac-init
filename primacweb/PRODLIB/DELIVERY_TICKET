SUBROUTINE DELIVERY_TICKET
********************************************************************************
*   Program name :- DELIVERY_TICKET
*   Created:- 2/18/2005
*   Written by :- Rama Krishna
*------------------------------------------------------------------------------*
*
* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

* Insert method code here

STATUS = RBO.getProperty('', 'MULTIREPID', REPORT_ID)

	OPEN '','CONTROL' TO CONTROL ELSE
		MESG = 'Cannot open CONTROL file!'
		STATUS = RBO.setProperty('', 'ServerStatus', 1)
		STATUS = RBO.setProperty('', 'ServerMessage', MESG)
		RETURN
	END
	OPEN '','REPORT_DET' TO REPORT_DET ELSE
		MESG = 'Cannot open REPORT_DET file!'
		STATUS = RBO.setProperty('', 'ServerStatus', 1)
		STATUS = RBO.setProperty('', 'ServerMessage', MESG)
		RETURN
	END
	READ  REPORTVALS FROM REPORT_DET, REPORT_ID ELSE
		MESG = 'Cannot Read REPORT_DET file from CONTROL File!'
		STATUS = RBO.setProperty('', 'ServerStatus', 'E')
		STATUS = RBO.setProperty('', 'ServerMessage', MESG)
		RETURN
	END

STATUS = RBO.getProperty('', 'ID', IDVAL)
CONO = FIELD(IDVAL, "!", 5)
RET = ""
ERR = ""
CMD3 = ""
CALL REPORT_SCRN(CONO,REPORT_ID)

READ RVALS FROM CONTROL, "REPORT_VALUES" ELSE
	ERR = 'Cannot Read REPORT_VALUES file from CONTROL File!'
	GOTO 999
END

STATUS = RBO.getProperty('','PPDField02',PPDField02)
STATUS = RBO.getProperty('','PPDField03',PPDField03)
STATUS = RBO.getProperty('','PPDField04',PPDField04)

*CMD = "SSELECT DAILY.SHIP WITH CONO =":RVALS<1> 
CMD = "SSELECT DAILY.SHIP WITH CONO =":CONO 
IF RVALS<3>  # "ALL" THEN
  CMD := " AND WITH JOB.NUM =":RVALS<3>
END 

CALL DELIVERY_TICKET_MAIN(CONO,PPDField02,PPDField03,PPDField04,CMD)

* End of method code
999
RETURN

