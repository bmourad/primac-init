SUBROUTINE UpdateMakeReady
********************************************************************************
*   Program name :- UpdateMakeReady
*   Created:- 8/30/2003
*   Author  : B.Krishna
*   This program is to update the MakeReady details of Production defn to ESTIMATE.RES 
********************************************************************************
   $INCLUDE WWINSERT RBO.H
   $INCLUDE JES.CPYLIB JES.FILE.VARS
   $INCLUDE CPYLIB FILE.VARS
   *$INCLUDE JES.CPYLIB ESTIMATE
   $INCLUDE JES.CPYLIB ESTIMATE.RES
   $INCLUDE CPYLIB CHAR

OPEN "", "ESTIMATE.RES" TO ESTIMATE.RES ELSE
ERRMSG = "CAN NOT OPEN ESTIMATE.RES"
END
 
OPEN "", "CONTROL" TO CONTROL ELSE STOP

*---- INITIALIZATION
*
STATUS = RBO.getProperty('','MakeReadyStr',DATA)

MATREAD EST.RL.REC FROM ESTIMATE.RES,FIELD(DATA,"^",1) ELSE MAT EST.RL.REC = ''

EST.RL.MR.DIE 		= FIELD(DATA,"^",2)*100.00
EST.RL.MR.FDIE 		= FIELD(DATA,"^",3)*100.00
EST.RL.MR.PLATE		= FIELD(DATA,"^",4)*100.00
EST.RL.MR.FOIL		= FIELD(DATA,"^",5)*100.00
EST.RL.MR.COL.MIX		= FIELD(DATA,"^",6)*100.00
EST.RL.MR.LIN.SLITS		= FIELD(DATA,"^",7)*100.00
EST.RL.MR.COL.CHANGE		= FIELD(DATA,"^",8)*100.00
EST.RL.MR.COLORS		= FIELD(DATA,"^",9)*100.00
EST.RL.MR.CSETDOWN		= FIELD(DATA,"^",10)*100.00
EST.RL.MR.DSETDOWN		= FIELD(DATA,"^",11)*100.00
EST.RL.MR.FSETDOWN		= FIELD(DATA,"^",12)*100.00
EST.RL.MR.SSCREEN		= FIELD(DATA,"^",13)*100.00
EST.RL.MR.GRAVURE		= FIELD(DATA,"^",14)*100.00
EST.RL.MR.EMBOSS		= FIELD(DATA,"^",15)*100.00
EST.RL.MR.SSETDOWN		= FIELD(DATA,"^",16)*100.00
EST.RL.MR.GSETDOWN		= FIELD(DATA,"^",17)*100.00
EST.RL.MR.ESETDOWN		= FIELD(DATA,"^",18)*100.00
EST.RL.MR.OVERLAM		= FIELD(DATA,"^",19)*100.00
EST.RL.MR.OSETDOWN		= FIELD(DATA,"^",20)*100.00
EST.RL.MR.SPROCKET		= FIELD(DATA,"^",21)*100.00
*EST.RL.PRESS.CCTR 		= FIELD(DATA,"^",22)

*''' this to be Uncommented
*EST.RL.PRESS.CCTR 		= FIELD(DATA,"^",23)

*STATUS = RBO.setProperty('','OperCodes',"checking OCONVERT --" : FIELD(DATA,"^",2)*100.00 )
WRITE EST.RL.PRESS.CCTR ON CONTROL,"02FF"
MATWRITE EST.RL.REC ON ESTIMATE.RES,FIELD(DATA,"^",1)
RETURN

1000 *
   IF ERRMSG # "" THEN 
	   STATUS = RBO.setProperty('','ServerStatus',1)
	   STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
   END
RETURN

