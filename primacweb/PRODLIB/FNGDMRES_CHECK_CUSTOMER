SUBROUTINE FNGDMRES_CHECK_CUSTOMER
********************************************************************************
*   Program name :- FNGDMRES_CHECK_CUSTOMER
*   Created:- 6/7/2006
*------------------------------------------------------------------------------*
*VALIDATE CUSTOMER  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB CUSTOMER
$INCLUDE ICS.CPYLIB INV.WHSE
$INCLUDE ICS.CPYLIB INV.STATS
$INCLUDE CPYLIB CHAR

ERRMSG = ""
OPEN "","CUSTOMER" TO CUSTOMER ELSE ERRMSG = "CANNOT OPEN CUSTOMER FILE";GOTO 91000
OPEN "","INV.WHSE" TO INV.WHSE ELSE ERRMSG = "CANNOT OPEN INV.WHSE FILE";GOTO 91000
OPEN "","INV.STATS" TO INV.STATS ELSE ERRMSG = "CANNOT OPEN INV.STATS FILE";GOTO 91000

* Insert method code here
STATUS = RBO.getProperty("","PMCProperty",PMCProperty)
STATUS = RBO.getProperty("","INV_CUST",CustomerCode)
CONO = PMCProperty<1,4>

  MATREAD CUST.REC FROM CUSTOMER,CONO:CustomerCode ELSE 
    ERRMSG = "Cannot locate customer # " : CustomerCode
    GOTO 91000
  END
  STATUS = RBO.setProperty("","CustomerDescs",CUST.NAME)

*v
   STATUS = RBO.getProperty("","INV_WHSE_CODE",INV.WHSE.CODE)
   STATUS = RBO.getProperty("","ID",PDNO)
   PDNO = PDNO[4,99]
   QTY.OH = 0
   WCNT = DCOUNT(INV.WHSE.CODE,VM)
   FOR W = 1 TO WCNT
      IWH.ID = CONO:PDNO:"!":INV.WHSE.CODE<1,W>
      MATREAD IWH.REC FROM INV.WHSE, IWH.ID THEN
         IF IWH.ON.HAND > 0 THEN
            QTY.OH = 1
         END ELSE
            MATREAD INV.STAT.REC FROM INV.STATS, IWH.ID THEN
               IF SUM(ISTAT.PO.QTY) > 0 OR ISTAT.JOB # "" THEN
                  QTY.OH = 1
               END
            END
         END
      END
   NEXT W
   STATUS = RBO.setProperty("","QtyOh",QTY.OH)
*^

RETURN
* End of method code
91000
  STATUS = RBO.setProperty("","ServerStatus",1)
  STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
RETURN

