SUBROUTINE ORDINVSM_VALID_PROD
********************************************************************************
* REVISION    - [e12.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM    - PRIMAC
* AUTHOR - ABED ALI
*   Program name :- ORDINVSM_VALID_PROD
*   Created:- 9/16/2003
*------------------------------------------------------------------------------*
* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE PMC.CPYLIB COMP.OPS
* Insert method code here
ERRMSG = ''
MAT INV.REC = ''
MAT OPCO.REC = ''
OPEN '','INVENTORY' TO INVENTORY ELSE
	ERRMSG = 'CANNOT OPEN INVENTORY'
	GOTO 99999
END
OPEN "","CONTROL" TO CONTROL ELSE
	ERRMSG = "CONTROL FILE IS MISSING"
	GOTO 99999
END
VAL = RBO.getProperty('','IVC_PROD',IVC.PROD) ;* CONO : CODE

CONO = IVC.PROD[1,3]

MATREAD OPCO.REC FROM CONTROL, CONO:"OPS" ELSE MAT OPCO.REC = ""

MATREAD INV.REC FROM INVENTORY,IVC.PROD ELSE
	ERRMSG = "Invalid Product ID. Try again! "
	GOTO 99999
END

IF INV.M.LINE # "FNGD" THEN
	ERRMSG = "Invalid Product Type. Try again! "
	GOTO 99999
END

VAL = RBO.setProperty('','SPT_NAME',INV.UNIT<1,5>)
VAL = RBO.setProperty('','IVC_PALLET',INV.SELL.UNIT)
VAL = RBO.setProperty('','IVC_TERMS',INV.BASE.SKU) ;* BASE PROD
VAL = RBO.setProperty('','OPCO_INV_DISPLAY',OPCO.INV.DISPLAY)

99999
IF ERRMSG # '' THEN
	VAL = RBO.setProperty('','ServerStatus','E')
	VAL = RBO.setProperty('','ServerMessage',ERRMSG)
END ELSE
	VAL = RBO.setProperty('','ServerStatus','')
END
* End of method code
RETURN

