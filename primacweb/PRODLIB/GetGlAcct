SUBROUTINE GetGlAcct
********************************************************************************
*   Program name :- GetGlAcct
*   Created:- 3/12/2004
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB GLTABLE
* Insert method code here

  OPEN '','CONTROL' TO CONTROL ELSE
    ERRMSG = 'CONTROL FILE IS MISSING'
    GOTO 93000
  END

*MAT GLTABLE.REC = ''
ERRMSG = ''
STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
CONO   = PMCProperty<1,4>
USER = PMCProperty<1,3>
NEW = 0

    	MATREADU GLTABLE.REC FROM CONTROL, CONO:'GLTABLE' LOCKED 
    		ERRMSG = 'GENERAL LEDGER TABLE record is locked by user - ': USER 
    		GOTO 93000
  	END ELSE
  		* T26126 ^
  		  NEW = 1 ; MAT GLTABLE.REC = ''
 	END

 *GLTBLM  
   CASH = ''
   AP = ''
   AR = ''
   RE = ''
 	
   CASH = GLTB.CASH 
   AP = GLTB.AP 
   AR = GLTB.AR 
   RE = GLTB.RET.EARN 

STATUS = RBO.setProperty('','CashAccount',CASH)
STATUS = RBO.setProperty('','AccountPayable',AP)
STATUS = RBO.setProperty('','AccountReceivable',AR)
STATUS = RBO.setProperty('','RetainedEarnings',RE)
STATUS = RBO.setProperty('','new_item',NEW)

*FAS
	  FASDepreciationAllow  = ''
	  FASDepreciationExp  = ''       

	  FASDepreciationAllow = GLTB.DEPR.ALLOW 
         FASDepreciationExp = GLTB.DEPR.EXP

 
    STATUS = RBO.setProperty('','FASDepreciationAllow',FASDepreciationAllow )
    STATUS = RBO.setProperty('','FASDepreciationExp',FASDepreciationExp)


* ICS
   ICSInventory = ''
   ICSPurchaseDiscount = ''
   ICSAdjustments = ''
   ICSFNGDVariance = ''
   ICSShipped_NotBilled = ''
   ICSInterDivision = ''

    ICSInventory = GLTB.INV
    ICSPurchaseDiscount = GLTB.PUR.DISC
    ICSAdjustments = GLTB.INV.ADJ
    ICSFNGDVariance = GLTB.FNGD.VAR
    ICSShipped_NotBilled = GLTB.SHIP.WIP
    ICSInterDivision = GLTB.IC.INT.DIV

STATUS = RBO.setProperty('','ICSInventory',ICSInventory )
STATUS = RBO.setProperty('','ICSPurchaseDiscount',ICSPurchaseDiscount)
STATUS = RBO.setProperty('','ICSAdjustments',ICSAdjustments)
STATUS = RBO.setProperty('','ICSFNGDVariance',ICSFNGDVariance)
STATUS = RBO.setProperty('','ICSShipped_NotBilled',ICSShipped_NotBilled)
STATUS = RBO.setProperty('','ICSInterDivision',ICSInterDivision)

*PRS
   PRSPayrollCash= ''
   PRSPayrollEarnings= ''
   PRSPayrollFICA = ''
   PRSPayrollEIC =  ''
   PRSFederalIncomeTax = ''
   PRSSavingsBond = ''

      PRSPayrollCash = GLTB.PR.CASH 
      PRSPayrollEarnings = GLTB.PR.EARN 
      PRSPayrollFICA = GLTB.FICA 
      PRSPayrollEIC = GLTB.PR.EIC 
      PRSFederalIncomeTax = GLTB.PR.FIT 
      PRSSavingsBond = GLTB.PR.SAV.BOND 


STATUS = RBO.setProperty('','PRSPayrollCash',PRSPayrollCash)
STATUS = RBO.setProperty('','PRSPayrollEarnings',PRSPayrollEarnings)
STATUS = RBO.setProperty('','PRSPayrollFICA',PRSPayrollFICA)
STATUS = RBO.setProperty('','PRSPayrollEIC',PRSPayrollEIC)
STATUS = RBO.setProperty('','PRSFederalIncomeTax',PRSFederalIncomeTax)
STATUS = RBO.setProperty('','PRSSavingsBond',PRSSavingsBond)

*JCS
   JCSMainSalesAccount= ''
   JCSMainSalesTaxAccount= ''
   JCSMainTradeDiscount= ''
   JCSMainPreBillAccount=  ''
   JCSMainFreightAccount= ''
   JCSMainReturnsAllow= ''
   JCSMainWIPClearingAccount  = ''

         JCSMainSalesAccount = GLTB.SALES 
         JCSMainSalesTaxAccount = GLTB.SALES.TAX
         JCSMainTradeDiscount = GLTB.TRADE.DISC 
         JCSMainPreBillAccount = GLTB.PRE.BILL
         JCSMainFreightAccount = GLTB.FRT 
         JCSMainReturnsAllow = GLTB.RET.ALLOW 
         JCSMainWIPClearingAccount = GLTB.WIP.CLR

STATUS = RBO.setProperty('','JCSMainSalesAccount',JCSMainSalesAccount)
STATUS = RBO.setProperty('','JCSMainSalesTaxAccount',JCSMainSalesTaxAccount)
STATUS = RBO.setProperty('','JCSMainTradeDiscount',JCSMainTradeDiscount)
STATUS = RBO.setProperty('','JCSMainPreBillAccount',JCSMainPreBillAccount)
STATUS = RBO.setProperty('','JCSMainFreightAccount',JCSMainFreightAccount)
STATUS = RBO.setProperty('','JCSMainReturnsAllow',JCSMainReturnsAllow)
STATUS = RBO.setProperty('','JCSMainWIPClearingAccount',JCSMainWIPClearingAccount)

*JCS LB
   JCSLBDirectWorkInProgress= ''
   JCSLBDirectCostOfGoods= ''
   JCSLBDirectApplied= ''
   JCSLBVariableFOHWorkInProgress=  ''
   JCSLBVariableFOHCostOfGoods= ''
   JCSLBVariableFOHApplied= ''
   JCSLBFixedFOHWorkInProgress= ''
   JCSLBFixedFOHCostOfGoods= ''
   JCSLBFixedFOHApplied= ''
   JCSLBSelling_AdminWorkInProgress=  ''
   JCSLBSelling_AdminCostOfGoods = ''
   JCSLBSelling_AdminAppliedCOGS= ''

         JCSLBDirectWorkInProgress = GLTB.LB.DIR.WIP
         JCSLBDirectCostOfGoods = GLTB.LB.DIR.COG
         JCSLBDirectApplied = GLTB.LB.DIR.APL 
         JCSLBVariableFOHWorkInProgress = GLTB.LB.VOH.WIP 
         JCSLBVariableFOHCostOfGoods = GLTB.LB.VOH.COG
         JCSLBVariableFOHApplied = GLTB.LB.VOH.APL 
         JCSLBFixedFOHWorkInProgress = GLTB.LB.FOH.WIP 
         JCSLBFixedFOHCostOfGoods = GLTB.LB.FOH.COG 
         JCSLBFixedFOHApplied = GLTB.LB.FOH.APL 
         JCSLBSelling_AdminWorkInProgress = GLTB.LB.S.A.WIP
         JCSLBSelling_AdminCostOfGoods = GLTB.LB.S.A.COG 
         JCSLBSelling_AdminAppliedCOGS = GLTB.LB.S.A.APL 

STATUS = RBO.setProperty('','JCSLBDirectWorkInProgress',JCSLBDirectWorkInProgress)
STATUS = RBO.setProperty('','JCSLBDirectCostOfGoods',JCSLBDirectCostOfGoods)
STATUS = RBO.setProperty('','JCSLBDirectApplied',JCSLBDirectApplied)
STATUS = RBO.setProperty('','JCSLBVariableFOHWorkInProgress',JCSLBVariableFOHWorkInProgress)
STATUS = RBO.setProperty('','JCSLBVariableFOHCostOfGoods',JCSLBVariableFOHCostOfGoods)
STATUS = RBO.setProperty('','JCSLBVariableFOHApplied',JCSLBVariableFOHApplied)
STATUS = RBO.setProperty('','JCSLBFixedFOHWorkInProgress',JCSLBFixedFOHWorkInProgress)
STATUS = RBO.setProperty('','JCSLBFixedFOHCostOfGoods',JCSLBFixedFOHCostOfGoods)
STATUS = RBO.setProperty('','JCSLBFixedFOHApplied',JCSLBFixedFOHApplied)
STATUS = RBO.setProperty('','JCSLBSelling_AdminWorkInProgress',JCSLBSelling_AdminWorkInProgress)
STATUS = RBO.setProperty('','JCSLBSelling_AdminCostOfGoods',JCSLBSelling_AdminCostOfGoods)
STATUS = RBO.setProperty('','JCSLBSelling_AdminAppliedCOGS',JCSLBSelling_AdminAppliedCOGS)

*JCS MT
   JCSMTAccrualAccruedAPLiab= ''
   JCSMTAccrualCostOfSales= ''
   JCSMTAccrualAccountsPayable= ''
   JCSMTDirectWorkInProgress=  ''
   JCSMTDirectCostOfGoods= ''
   JCSMTVariableFOHWorkInProgress= ''
   JCSMTVariableFOHCostOfGoods= ''
   JCSMTVariableFOHApplied= ''
   JCSMTFixedFOHWorkInProgress= ''
   JCSMTFixedFOHCostOfGoods=  ''
   JCSMTFixedFOHApplied = ''

         JCSMTAccrualAccruedAPLiab = GLTB.MT.ACCRU.LIAB  
         JCSMTAccrualCostOfSales = GLTB.MT.COS
         JCSMTAccrualAccountsPayable = GLTB.MT.AP.ACCT
         JCSMTDirectWorkInProgress = GLTB.MT.DIR.WIP 
         JCSMTDirectCostOfGoods =  GLTB.MT.DIR.COG 
         JCSMTVariableFOHWorkInProgress =  GLTB.MT.VOH.WIP
         JCSMTVariableFOHCostOfGoods = GLTB.MT.VOH.COG 
         JCSMTVariableFOHApplied =  GLTB.MT.VOH.APL
         JCSMTFixedFOHWorkInProgress = GLTB.MT.FOH.WIP  
         JCSMTFixedFOHCostOfGoods = GLTB.MT.FOH.COG  
         JCSMTFixedFOHApplied  = GLTB.MT.FOH.APL 

STATUS = RBO.setProperty('','JCSMTAccrualAccruedAPLiab',JCSMTAccrualAccruedAPLiab)
STATUS = RBO.setProperty('','JCSMTAccrualCostOfSales',JCSMTAccrualCostOfSales)
STATUS = RBO.setProperty('','JCSMTAccrualAccountsPayable',JCSMTAccrualAccountsPayable)
STATUS = RBO.setProperty('','JCSMTDirectWorkInProgress',JCSMTDirectWorkInProgress)
STATUS = RBO.setProperty('','JCSMTDirectCostOfGoods',JCSMTDirectCostOfGoods)
STATUS = RBO.setProperty('','JCSMTVariableFOHWorkInProgress',JCSMTVariableFOHWorkInProgress)
STATUS = RBO.setProperty('','JCSMTVariableFOHCostOfGoods',JCSMTVariableFOHCostOfGoods)
STATUS = RBO.setProperty('','JCSMTVariableFOHApplied',JCSMTVariableFOHApplied)
STATUS = RBO.setProperty('','JCSMTFixedFOHWorkInProgress',JCSMTFixedFOHWorkInProgress)
STATUS = RBO.setProperty('','JCSMTFixedFOHCostOfGoods',JCSMTFixedFOHCostOfGoods)
STATUS = RBO.setProperty('','JCSMTFixedFOHApplied',JCSMTFixedFOHApplied )

*JCS OS
   JCSOSAccrualAccruedLiability= ''
   JCSOSAccrualAccountsPayable= ''
   JCSOSDirectWorkInProgress= ''
   JCSOSDirectCostOfGoods=  ''
   JCSOSDirectApplied= ''
   JCSOSFixedFOHWorkInProgress= ''
   JCSOSFixedFOHCostOfGoods= ''
   JCSOSFixedFOHApplied = ''

        JCSOSAccrualAccruedLiability = GLTB.OS.ACCRU.LIAB
        JCSOSAccrualAccountsPayable = GLTB.OS.AP.ACCT 
        JCSOSDirectWorkInProgress = GLTB.OS.DIR.WIP 
        JCSOSDirectCostOfGoods = GLTB.OS.DIR.COG 
        JCSOSDirectApplied = GLTB.OS.DIR.APL 
        JCSOSFixedFOHWorkInProgress = GLTB.OS.FOH.WIP 
        JCSOSFixedFOHCostOfGoods = GLTB.OS.FOH.COG 
        JCSOSFixedFOHApplied = GLTB.OS.FOH.APL

STATUS = RBO.setProperty('','JCSOSAccrualAccruedLiability',JCSOSAccrualAccruedLiability)
STATUS = RBO.setProperty('','JCSOSAccrualAccountsPayable',JCSOSAccrualAccountsPayable)
STATUS = RBO.setProperty('','JCSOSDirectWorkInProgress',JCSOSDirectWorkInProgress)
STATUS = RBO.setProperty('','JCSOSDirectCostOfGoods',JCSOSDirectCostOfGoods)
STATUS = RBO.setProperty('','JCSOSDirectApplied',JCSOSDirectApplied)
STATUS = RBO.setProperty('','JCSOSFixedFOHWorkInProgress',JCSOSFixedFOHWorkInProgress)
STATUS = RBO.setProperty('','JCSOSFixedFOHCostOfGoods',JCSOSFixedFOHCostOfGoods)
STATUS = RBO.setProperty('','JCSOSFixedFOHApplied',JCSOSFixedFOHApplied)

*JCS SP
   JCSSPDirectWorkInProgress= ''
   JCSSPDirectCostOfGoods= ''
   JCSSPDirectApplied= ''
   JCSSPFixedFOHWorkInProgress=  ''
   JCSSPFixedFOHCostOfGoods= ''
   JCSSPFixedFOHApplied= ''

        JCSSPDirectWorkInProgress = GLTB.SP.DIR.WIP
        JCSSPDirectCostOfGoods = GLTB.SP.DIR.COG 
        JCSSPDirectApplied = GLTB.SP.DIR.APL 
        JCSSPFixedFOHWorkInProgress = GLTB.SP.FOH.WIP 
        JCSSPFixedFOHCostOfGoods = GLTB.SP.FOH.COG 
        JCSSPFixedFOHApplied = GLTB.SP.FOH.APL 

STATUS = RBO.setProperty('','JCSSPDirectWorkInProgress',JCSSPDirectWorkInProgress)
STATUS = RBO.setProperty('','JCSSPDirectCostOfGoods',JCSSPDirectCostOfGoods)
STATUS = RBO.setProperty('','JCSSPDirectApplied',JCSSPDirectApplied)
STATUS = RBO.setProperty('','JCSSPFixedFOHWorkInProgress',JCSSPFixedFOHWorkInProgress)
STATUS = RBO.setProperty('','JCSSPFixedFOHCostOfGoods',JCSSPFixedFOHCostOfGoods)
STATUS = RBO.setProperty('','JCSSPFixedFOHApplied',JCSSPFixedFOHApplied)

*JCS MS

   JCSMSAccrualAccountsPayable= ''
   JCSMSAccrualAccruedLiability= ''
   JCSMSAccrualExpenseAccount= ''
   JCSMSDirectWorkInProgress=  ''
   JCSMSDirectCostOfGoods= ''
   JCSMSDirectApplied= ''
   JCSMSFixedFOHWorkInProgress= ''
   JCSMSFixedFOHCostOfGoods= ''
   JCSMSFixedFOHApplied= ''

        JCSMSAccrualAccountsPayable = GLTB.MS.AP.ACCT
        JCSMSAccrualAccruedLiability = GLTB.MS.CRED.EXP   
        JCSMSAccrualExpenseAccount = GLTB.MS.EXP.ACCT 
        JCSMSDirectWorkInProgress = GLTB.MS.DIR.WIP
        JCSMSDirectCostOfGoods =  GLTB.MS.DIR.COG
        JCSMSDirectApplied =  GLTB.MS.DIR.APL 
        JCSMSFixedFOHWorkInProgress = GLTB.MS.FOH.WIP   
        JCSMSFixedFOHCostOfGoods =GLTB.MS.FOH.COG 
        JCSMSFixedFOHApplied = GLTB.MS.FOH.APL  


STATUS = RBO.setProperty('','JCSMSAccrualAccountsPayable',JCSMSAccrualAccountsPayable)
STATUS = RBO.setProperty('','JCSMSAccrualAccruedLiability',JCSMSAccrualAccruedLiability)
STATUS = RBO.setProperty('','JCSMSAccrualExpenseAccount',JCSMSAccrualExpenseAccount)
STATUS = RBO.setProperty('','JCSMSDirectWorkInProgress',JCSMSDirectWorkInProgress)
STATUS = RBO.setProperty('','JCSMSDirectCostOfGoods',JCSMSDirectCostOfGoods)
STATUS = RBO.setProperty('','JCSMSDirectApplied',JCSMSDirectApplied)
STATUS = RBO.setProperty('','JCSMSFixedFOHWorkInProgress',JCSMSFixedFOHWorkInProgress)
STATUS = RBO.setProperty('','JCSMSFixedFOHCostOfGoods',JCSMSFixedFOHCostOfGoods)
STATUS = RBO.setProperty('','JCSMSFixedFOHApplied',JCSMSFixedFOHApplied)

* End of method code
RETURN

93000* 
  IF ERRMSG # "" THEN

      STATUS = RBO.setProperty('', 'ServerStatus', 1)

      STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG ) 

   END
 RETURN 
