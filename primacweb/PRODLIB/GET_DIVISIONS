SUBROUTINE GET_DIVISIONS
********************************************************************************
*   Program name :- GET_DIVISIONS
*   Created:- 9/16/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB DIVISION

* Insert method code here

   OPEN "","DIVISION" TO DIVISION ELSE
      ERRMSG = "Cannot locate the DIVISION file";GOTO 93000
   END

   STATUS = RBO.getProperty('', 'PMCProperty', PMCProperty)
   CONO = PMCProperty<1,4>

   CMD = "SSELECT DIVISION WITH CONO = '" : CONO : "'"
   UDTEXECUTE CMD

  DIVISION_CODES = '00'
  DIVISION_DESCS = '--Select--'

   DATA = 1
   LOOP
      READNEXT CODE ELSE DATA = 0
   WHILE DATA DO
	DIVISION_CODES<1,-1> = CODE[4,99]
	READV DESC FROM DIVISION,CODE,1 ELSE DESC = CODE[4,99]
	DIVISION_DESCS<1,-1> = CODE[4,99] : "-" : DESC
   REPEAT

   STATUS = RBO.setProperty('', 'DivisionsCodes', DIVISION_CODES)
   STATUS = RBO.setProperty('', 'DivisionsDescs', DIVISION_DESCS)


* End of method code
RETURN

93000*
   STATUS = RBO.setProperty('', 'ServerStatus', '1')
   STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)

