SUBROUTINE VALIDATE_CCTR
********************************************************************************
*   Program name :- VALIDATE_CCTR
*   Created:- 7/4/2005
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB COST.CNTR
$INCLUDE PMC.CPYLIB DIVISION
$INCLUDE PMC.CPYLIB DEPARTMENT
$INCLUDE JCS.CPYLIB JOB

ERRMSG = ""

   OPEN '','JOB' TO JOB ELSE ERRMSG='JOB FILE IS MISSING';GOTO 91000
   OPEN '','DIVISION' TO DIVISION ELSE ERRMSG='DIVISION FILE IS MISSING';GOTO 91000
   OPEN '','DEPARTMENT' TO DEPARTMENT ELSE ERRMSG='DEPARTMENT FILE IS MISSING';GOTO 91000
   OPEN '','COST.CNTR' TO COST.CNTR ELSE ERRMSG='COST.CNTR FILE IS MISSING';GOTO 91000

* Insert method code here

STATUS = RBO.getProperty('','Cono',CONO)
STATUS = RBO.getProperty('','CCTR_VAL',CCTR_ID)
STATUS = RBO.getProperty('','CCDIV',DIV_ID)
STATUS = RBO.getProperty('','DSP_JOB',JOB_ID)

MAT CCTR.REC = ""
MAT JOB.REC = ""
MAT DIV.REC = ""
MAT DEPT.REC = ""

     MATREAD CCTR.REC FROM COST.CNTR, CONO:CCTR_ID ELSE
         ERRMSG = "CAN NOT READ COST CENTER FILE ON ID " : CONO:CCTR_ID
         GOTO 91000
     END
     MATREAD DIV.REC FROM DIVISION, CONO:DIV_ID ELSE
         ERRMSG = "CANNOT READ DIVISION FILE FROM ID " : DIV_ID
         GOTO 91000
     END
     MATREAD JOB.REC FROM JOB,CONO:JOB_ID ELSE
         ERRMSG = "CAN NOT READ JOB FILE FROM ID " : JOB_ID
         GOTO 91000
     END

     IF JOB.DEPT # CCTR.DEPT[1,LEN(JOB.DEPT)] THEN
         ERRMSG = "JOB BELONGS TO DIFFERENT DEPARTMENT"
         GOTO 91000
     END
     IF CCTR.TYPE = 'F' THEN
         ERRMSG = "THIS COST CENTER IS FROZEN"
         GOTO 91000
     END
     LOCATE CCTR.DEPT IN DIV.DEPT<1>,1 SETTING POS ELSE
         ERRMSG = "THIS COST CENTER IN NOT ALLOWED FOR THIS DIVISION"
         GOTO 91000
     END
     MATREAD DEPT.REC FROM DEPARTMENT, CONO:CCTR.DEPT ELSE
         ERRMSG = "COST CENTER DEPARTMENT IS MISSING"
         GOTO 91000
     END
     CCDEP = ""
     CCDEP = CCTR.DEPT:"-":DEPT.DESC
     STATUS = RBO.setProperty('','CCDEP',CCDEP)
* End of method code
91000:
     STAT = 0
     IF ERRMSG # "" THEN
         STAT = 1
     END

     STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
     STATUS = RBO.setProperty('','ServerStatus',STAT)

RETURN

