SUBROUTINE NEWITEM_ONHAND
********************************************************************************
*   Program name :- NEWITEM_ONHAND
*   Created:- 12/18/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INV.WHSE
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE ICS.CPYLIB INV.CNV
* Insert method code here

OPEN '', 'INV.WHSE' TO INV.WHSE ELSE
	ERRMSG = 'INV.WHSE FILE IS MISSING'
	GOTO 93000
END

OPEN '', 'INVENTORY' TO INVENTORY ELSE
	ERRMSG = 'INVENTORY FILE IS MISSING'
	GOTO 93000
END


STATUS = RBO.getProperty('','PMCProperty',PMCPROPERTY)
CONO = PMCPROPERTY<1,4>
STATUS = RBO.getProperty('','NEW_PROD',PROD)
STATUS = RBO.getProperty('','NEW_WHSE',WHSE)

MATREAD INV.REC FROM INVENTORY,CONO:PROD ELSE MAT INV.REC = ""
$INCLUDE ICSBP INV.UM.CNV

MATREAD IWH.REC FROM INV.WHSE, CONO:PROD:"!":WHSE THEN
	*NEW_ONHAND = OCONV(IWH.ON.HAND,"MD3")
        NEW_ONHAND = OCONV(INT((((IWH.ON.HAND)/ICR.DV1<1>) * ICR.MT1<1>)/ICR.DV2<1> + .5),ICR.CNV)
END ELSE
	MAT IWH.REC = ''
	NEW_ONHAND=  " "
END 

STATUS = RBO.setProperty('','NEW_ONHAND',NEW_ONHAND) 
RETURN

* End of method code
93000 
STATUS = RBO.setProperty('','ServerStatus',1)        
STATUS = RBO.setProperty('','ServerMessage',ERRMSG) 
RETURN

