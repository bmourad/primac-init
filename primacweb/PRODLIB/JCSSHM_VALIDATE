SUBROUTINE JCSSHM_VALIDATE
********************************************************************************
*   Program name :- JCSSHM_VALIDATE
*   Created:- 24/07/2003
*------------------------------------------------------------------------------*
*   Program Written by RAZI MOHIUDDIN

* In Properties:
* --------------
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB JOB
$INCLUDE CPYLIB CHAR

  OPEN '','JOB' TO JOB ELSE ERRMSG='JOB FILE IS MISSING'; GOTO 1000
  
JOB_CODES = ""
CONO=""
DMS_JOB="" 
JCODES=''
JOB_DIV=''
JOB_STATUS=''
JOB_CUST=''
JOB_TRACK_DATE=''
JOB_QTY=''

STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
CONO = PMCProperty<1,4>
	CMD = "SSELECT JOB WITH CONO = '" : CONO : "'"
	UDTEXECUTE CMD	
	DATA = 1	
	LOOP
  	READNEXT ID THEN
		JOB_CODES<1,-1> = ID 
	END ELSE
		DATA = 0
  	END
WHILE DATA DO
REPEAT
*MULTI VALUE FIELD WILL GET SEPERATED BY UM	
	FOR Y = 1 TO DCOUNT(JOB_CODES,VM)
		MATREAD JOB.REC FROM JOB,JOB_CODES<1,Y> THEN
			JCODES<1,Y>     =JOB_CODES<1,Y>[4,99]
			JOB_DIV<1,Y>    = LOWER(JOB.DIV)			
			JOB_STATUS<1,Y> = LOWER(JOB.STATUS)
			JOB_CUST<1,Y>=JOB.CUST			
			JOB_TRACK_DATE<1,Y>=LOWER(JOB.TRACK.DATE)	
			FOR J = 1 TO DCOUNT(JOB_TRACK_DATE<1,Y>,"ü")
			    	JOB_TRACK_DATE<1,Y,J> =  OCONV(JOB_TRACK_DATE<1,Y,J>,"D2/")
			NEXT J
			JOB_QTY<1,Y>=LOWER(JOB.QTY)
			
		END ELSE
			JCODES<1,Y>=''
			JOB_DIV<1,Y>= ''
			JOB_STATUS<1,Y>=''
			JOB_CUST<1,Y>=''
			JOB_TRACK_DATE<1,Y>=''
			JOB_QTY<1,Y>=''
		END
	NEXT Y	

*SWAP @VM WITH "~" IN JOB_TRACK_DATE ITS LIKE REPLACE
STATUS = RBO.setProperty('','JCODES',JCODES)
STATUS = RBO.setProperty('','JOB_DIV',JOB_DIV)
STATUS = RBO.setProperty('','JOB_STATUS',JOB_STATUS)
STATUS = RBO.setProperty('','JOB_CUST',JOB_CUST)
STATUS = RBO.setProperty('','JOB_TRACK_DATE',JOB_TRACK_DATE)
STATUS = RBO.setProperty('','JOB_QTY',JOB_QTY)


* End of method code
RETURN

1000*
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN
