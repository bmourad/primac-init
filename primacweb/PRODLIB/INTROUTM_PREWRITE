SUBROUTINE INTROUTM_PREWRITE
*********************************************************************
* SYSTEM      - EPRIMAC
* PROGRAM     - INTROUTM_PREWRITE
* BY          - KHAJA ZIAUDDIN
* MODIFIED BY - S.SUHAIL HUSSAIN
* MODIFIED ON - 06/14/2005
*ENDDOC
*********************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB WAREHOUSE

OPEN '','WAREHOUSE' TO WAREHOUSE ELSE ERRMSG = 'WAREHOUSE FILE IS MISSING'; GOTO 93000
OPEN '','INTR_SERIAL_XREF' TO INTR_SERIAL_XREF ELSE ERRMSG = 'INTR_SERIAL_XREF FILE IS MISSING'; GOTO 93000

*following commented lines have been replaced using RBO.getProperty()
*STATUS = RBO.getDBVals("@ID", TRANS.ID)
*STATUS = RBO.getDBVals("IDM_FROM_WHSE", FROMWHSE)
*STATUS = RBO.getDBVals("IDM_PROD_NO", PROD.ARRAY)
*STATUS = RBO.getDBVals("IDM_SERIAL", RS.ARRAY)
STATUS = RBO.getProperty('','ID',TRANS.ID)
STATUS = RBO.getProperty('','FromWhse',FROMWHSE)
STATUS = RBO.getProperty('','ProdNo',PROD.ARRAY)
STATUS = RBO.getProperty('','Serial',RS.ARRAY)
STATUS = RBO.getProperty('','SERIAL_ARR_VALS',SERIAL_ARR)
STATUS = RBO.getProperty('','PMCProperty',PMCPROPERTY)
CONO = PMCPROPERTY<1,4>

MATREAD WHSE.REC FROM WAREHOUSE, CONO:FROMWHSE ELSE MAT WHSE.REC = ""
STATUS = RBO.setDBVals("IDM_FROM_DIV", WHS.DIV)
STATUS = RBO.setProperty('','FromDiv',WHS.DIV);*added

*PROD.CNT = DCOUNT(PROD.ARRAY<1>, @VM)
*FOR PROD.PTR = 1 TO PROD.CNT
*   ROLL.CNT = DCOUNT(RS.ARRAY<PROD.PTR>, @SVM)
*   FOR ROLL.PTR = 1 TO ROLL.CNT
*      WRITE TRANS.ID ON INTR_SERIAL_XREF, RS.ARRAY<1,PROD.PTR,ROLL.PTR>
*   NEXT ROLL.PTR
*NEXT PROD.PTR
XX = ""
FOR SER_CNT = 1 TO DCOUNT(SERIAL_ARR,@VM)
   WRITE TRANS.ID ON INTR_SERIAL_XREF, CONO:SERIAL_ARR<1,SER_CNT>
NEXT SER_CNT

RETURN



93000
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage', ERRMSG)
RETURN


