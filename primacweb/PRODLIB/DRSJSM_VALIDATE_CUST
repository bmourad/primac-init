SUBROUTINE DRSJSM_VALIDATE_CUST
********************************************************************************
*   Program name :- DRSJSM_VALIDATE_CUST
*   Created:- 6/8/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

$INCLUDE PMC.CPYLIB CUSTOMER
*
*---- OPEN FILES
*
  OPEN '','CUSTOMER' TO CUSTOMER ELSE ERRMSG = 'CUSTOMER FILE MISSING'; GOTO 93000
*---- INITIALIZATION
*
MAT CUST.REC = ''
ERRMSG = ''

STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
STATUS=RBO.getProperty('','Cust_Number',CUST.KEY)
CONO = PMCProperty<1,4>

*
*---- VALIDATE CUSTOMER NO.
*
100 *
 MATREAD CUST.REC FROM CUSTOMER, CONO:CUST.KEY ELSE
      ERRMSG = 'CUSTOMER record does not exist.'
      GOTO 93000
  END
  STATUS = RBO.setProperty('', 'Cust_Name',CUST.NAME)
RETURN
*
*---- ERROR ROUTINE
*
93000*
   IF ERRMSG # "" THEN
	STATUS = RBO.setProperty('', 'ServerStatus',1)
   	STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)
   END
* End of method code
RETURN
