SUBROUTINE GetEquipmentCodesDescs
********************************************************************************
*   Program name :- GetEquipmentCodesDescs
*   Created:- 5/20/2003
*   Created By:- B.Krishna
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JES.CPYLIB EQUIPMENT

* Insert method code here
ERRORMSG1 = RBO.getProperty('','ID',ID)
ERRMSG = ""
OPEN "","EQUIPMENT" TO EQUIPMENT ELSE
  ERRMSG = "CANNOT OPEN EQUIPMENT FILE"
  GOTO 93000	
END

OPEN "","COST.CNTR" TO COST.CNTR ELSE
  ERRMSG = "CANNOT OPEN COST.CNTR FILE"
 GOTO 93000
END

CONO = ID[1,3]

EQUIPMENT.CODES.LIST=''
EQUIPMENT.DESCS.LIST=''
DIE.TYPE.LIST =''

CMD = "SSELECT EQUIPMENT WITH @ID LIKE ":CONO:"..." 
UDTEXECUTE CMD
LOOP
EOF=1
READNEXT EQUIP.ID ELSE EOF =0
WHILE EOF DO
	MATREAD EQUIPMENT.REC FROM EQUIPMENT,EQUIP.ID THEN
		
		IF EQP.TYPE = 40 THEN
		
			DIE.TYPE.LIST<1,-1>	= EQP.RL.PRESS.DIE.TYPE

			READV CCTR.DESC FROM COST.CNTR, EQUIP.ID, 1 THEN
				EQUIPMENT.CODES.LIST<1,-1> = EQUIP.ID[4,99]
				EQUIPMENT.DESCS.LIST<1,-1> = EQUIP.ID[4,99] : "_" : CCTR.DESC
			END ELSE 
				EQUIPMENT.CODES.LIST<1,-1> = EQUIP.ID[4,99]
				EQUIPMENT.DESCS.LIST<1,-1> = EQUIP.ID[4,99]
			END

		END ELSE
		
		END
		
	END ELSE

	END

REPEAT

	STATUS=RBO.setProperty('','EquipmentCodes',EQUIPMENT.CODES.LIST)
	STATUS=RBO.setProperty('','EquipmentCodesDescs',EQUIPMENT.DESCS.LIST)
	STATUS=RBO.setProperty('','DieTypes',DIE.TYPE.LIST)

RETURN
93000*
	STATUS=RBO.setProperty('','ServerStatus',1)
	STATUS=RBO.setProperty('','ServerMessage',ERRMSG )
* End of method code
RETURN

