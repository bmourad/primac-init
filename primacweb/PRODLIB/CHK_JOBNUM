SUBROUTINE CHK_JOBNUM
********************************************************************************
*   Program name :- CHK_JOBNUM 
*   Created:- 12/16/2003 BY ZUBAIR TO CHECK THE JOB NUMBER 
*------------------------------------------------------------------------------*
*
* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB JOB
$INCLUDE ICS.CPYLIB WAREHOUSE
$INCLUDE ICS.CPYLIB INVENTORY

ERRMSG = ""
OPEN "","JOB" TO JOB ELSE ERRMSG="JOB FILE IS MISSING"; GOTO 99999
OPEN '','WAREHOUSE' TO WAREHOUSE ELSE ERRMSG = 'WAREHOUSE FILE IS MISSING'; GOTO 99999
OPEN "","INVENTORY" TO INVENTORY ELSE ERRMSG="INVENTORY FILE IS MISSING"; GOTO 99999

* Insert method code here
STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
CONO   = PMCProperty<1,4>

* GET JOB NO
STATUS = RBO.getProperty('','JOB_NO',JOB_NO)
STATUS = RBO.getProperty('','PO_WHSE',PO_WHSE)
STATUS = RBO.getProperty('','PRODUCT_ID',PRODUCT_ID)

ServerStatus = 0

MATREAD JOB.REC FROM JOB, CONO:JOB_NO THEN
	IF JOB.STATUS<1,1> > 3  THEN
	    ERRMSG = 'Job can not be used due to Job status.'
	    GOTO 99999
	END
       MATREAD INV.REC FROM INVENTORY,CONO:PRODUCT_ID THEN
         IF INV.CUST # "" THEN
           IF "X":INV.CUST # "X":JOB.CUST THEN
             ERRMSG = "THIS INVENTORY IS OWNED BY CUSTOMER ":INV.CUST
             GOTO 99999
           END
         END
       END

	*MATREAD WHSE.REC FROM WAREHOUSE, CONO:PO.WHSE<1,1> ELSE MAT WHSE.REC = ''
	MATREAD WHSE.REC FROM WAREHOUSE, CONO:PO_WHSE ELSE MAT WHSE.REC = ''
	IF JOB.DIV # WHS.DIV THEN
	    ERRMSG = "THE JOB DIVISION DOES NOT MATCH THE PRODUCT'S WAREHOUSE DIVISION"
	   GOTO 99999
	END
END ELSE
    ERRMSG="Cannot Locate Job Number" :"-": JOB_NO
    GOTO 99999
END
RETURN
*IF INV.CUST # "" THEN
*    IF "X":INV.CUST # "X":JOB.CUST THEN
*      ERRMSG = "THIS INVENTORY IS OWNED BY CUSTOMER ":INV.CUST
*      GOSUB 91000   
*    END
*END

* End of method code
99999*
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN

