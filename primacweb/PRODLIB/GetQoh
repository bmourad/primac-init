SUBROUTINE GetQoh
*********************************************************************
* Copyright 1998 by Primac Systems India
* SYSTEM       - EPRIMAC
* PROGRAM      - GetQoh
* BY           - KHAJA ZIAUDDIN
* DATE         - 05/13/2003 (mm/dd/yyyy)
* DESCRIPTION  - This program will get the Quantity on Hand from Inv_Whse table
*                
*                
*                
*                
*ENDDOC
*********************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INV.WHSE
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE ICS.CPYLIB CATEGORY

* Insert method code here
MAT IWH.REC = ''
MAT CATG.REC = ''
MAT INV.REC = ''
OPEN '', 'CATEGORY' TO CATEGORY ELSE 
	ERRMSG = 'CATEGORY FILE IS MISSING'
	GOTO 93000
END
OPEN '', 'INVENTORY' TO INVENTORY ELSE
	ERRMSG = 'INVENTORY FILE IS MISSING'
	GOTO 93000
END
OPEN '','INV_WHSE' TO INV.WHSE ELSE
	ERRMSG = "INV_WHSE FILE IS MISSING"
	GOTO 93000
END

STATUS = RBO.getProperty('','PMCProperty',PMCPROPERTY)
STATUS = RBO.getProperty('','QOHPROD',PROD)
STATUS = RBO.getProperty('','QOHWHSE',WHSE)
CONO = PMCPROPERTY<1,4>

  MATREAD INV.REC FROM INVENTORY, CONO : PROD ELSE
	MAT INV.REC = ""
  END
  MATREAD CATG.REC FROM CATEGORY,CONO:INV.LINE ELSE
	MAT CATG.REC = ""
  END
  MATREAD IWH.REC FROM INV.WHSE, CONO:PROD:"!":WHSE THEN
	STATUS = RBO.setProperty('','QOH',OCONV(IWH.ON.HAND,"MD3"))
  END ELSE
      STATUS = RBO.setProperty('','QOH',"0.00")
  END

STATUS = RBO.setProperty('','ServerStatus',0)
STATUS = RBO.setProperty('','ServerMessage','')

* End of method code
RETURN

93000
	STATUS = RBO.setProperty('','ServerStatus',1)
	STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN

99000
RETURN

