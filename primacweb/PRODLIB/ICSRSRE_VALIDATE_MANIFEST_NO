SUBROUTINE ICSRSRE_VALIDATE_MANIFEST_NO
********************************************************************************
*   Program name :- ICSRSRE_VALIDATE_MANIFEST_NO
*   Created:- 3/29/2005
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB PO.MAN.XREF
* Insert method code here

OPEN '','PO.MAN.XREF' TO PO.MAN.XREF ELSE
   STATS = 1
   ERRMSG = 'PO.RSMAN.XREF FILE IS MISSING'
   GOTO 99999
END
   OPEN "","CONTROL" TO CONTROL ELSE
      ERRMSG = "CANNOT OPEN CONTROL FILE";GOTO 99999 
   END

STATUS = RBO.getProperty('','ID',ID)
*WRITE "ID ":ID ON CONTROL,"01IDIS"
ERRMSG="NO ERROR"
MATREAD RSMAN.REC FROM PO.MAN.XREF,ID THEN
	STATUS = RBO.setProperty('','newitem',0)
	STATUS = RBO.setProperty('','ReceiptsDate',OCONV(RSMAN.ENTRY.DATE,"D2/"))	
	S.SERIAL = RSMAN.RS.NO
*	MATREAD DSR.REC FROM DAILY_STOCK, ID THEN
*		STATUS = RBO.setProperty('','Period',DSR.PERIOD)
*		STATUS = RBO.setProperty('','ReceiptsDate',OCONV(DSR.DATE,"D2/"))
*		STATUS = RBO.setProperty('','ShipmentTot',OCONV(DSR.SHPMNT.TOT,"MD2"))
*	END
	NEWITEM = 0
END ELSE
NEWITEM = 1
GOTO 93000
END 

RETURN
93000
STATUS = RBO.setProperty('','newitem',NEWITEM)
99999*
IF ERRMSG # "" THEN
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
STATUS = RBO.setProperty('','ServerStatus',1)
END 
* End of method code
RETURN

