SUBROUTINE GET_FILE_DATA
********************************************************************************
*   Program name :- GET_FILE_DATA
*   Created:- 5/10/2005
*------------------------------------------------------------------------------*
*
* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

ERRMSG = ''
OBJECT_ID = ''
FILENAME = ''

STATUS = RBO.getProperty('','FILENAME',FILENAME)
*FILENAME = 'VEND'
OPEN '',FILENAME TO FILENAME ELSE ERRMSG = 'CANNOT LOCATE': FILENAME :'FILE'; GOTO 99999
STATUS = RBO.getProperty('','LOCATIONS',LOCATIONS)
STATUS = RBO.getProperty('','OBJECT_ID',OBJECT_ID)
*OBJECT_ID = '00120000'

OBJECT_VALS = ''
OBJECT_REC = ''
VARA = ""
*LOCATIONS = 1:@VM:2:@VM:3:@VM:4:@VM:6

	READ OBJECT_REC FROM FILENAME,OBJECT_ID THEN
		FOR JJ=1 TO DCOUNT(LOCATIONS,@VM)
			VARA  = FIELD(LOCATIONS,@VM,JJ)
		  IF OBJECT_VALS # "" THEN
			  OBJECT_VALS = OBJECT_VALS :"#": OBJECT_REC<VARA> 
	         END ELSE		
		 	  OBJECT_VALS =  OBJECT_REC<VARA> 
		  END 		
		NEXT
	END ELSE
		ERRMSG = OBJECT_ID[4,99]:" Item ID missing from "
		GOTO 99999
	END 	

STATUS = RBO.setProperty('','OBJECT_VALS',OBJECT_VALS)
RETURN

99999:
	STATUS = RBO.setProperty('','ServerStatus',1)
	STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN
