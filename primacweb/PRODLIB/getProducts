SUBROUTINE getProducts
********************************************************************************
*   Program name :- 
*   Created:- 6/27/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  CONO,
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE ICS.CPYLIB CATEGORY


* Insert method code here
OPEN '','INVENTORY' TO INVENTORY ELSE ERRMSG='INVENTORY FILE IS MISSING' ; GOTO 99999
OPEN '','CATEGORY' TO CATEGORY ELSE ERRMSG='CATEGORY FILE IS MISSING' ; GOTO 99999

STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
CONO = PMCProperty<1,4>
ID = ''
INVCODES = ''
INVDESCS = ''
PRODSETUP = ''
EMSETUP = ''

CMD = "SSELECT INVENTORY WITH CONO = '" : CONO : "' AND INV_M_LINE # 'FNGD'"
UDTEXECUTE CMD
DATA = 1
K = 1
* looping thro entire file getting the ID<>reading the entire ID until data = 0
LOOP 	
    READNEXT CODE ELSE DATA = 0
WHILE DATA
    ID<1,K> = CODE  
    K += 1
* ID<1,-1> adds at last automatically everytim
REPEAT

*STATUS = RBO.setProperty('','ServerMessage',CMD)

MAT INV.REC = ''
COUNT = 1
FOR X = 1 TO DCOUNT(ID,@VM)
   MATREAD INV.REC FROM INVENTORY, ID<1,X>  ELSE MAT INV.REC = ""
	MATREAD CATG.REC FROM CATEGORY, CONO:INV.LINE THEN
	       	EM=''
       		IF CATG.INV='' THEN EM='INVENTORY A/C'
       		IF CATG.ACCRU.LIAB='' THEN
	          	IF EM # '' THEN EM=EM:' AND'
       	   		EM=EM:' ACCRUED LIABILITY A/C'
      			END
			IF INV.WHSE.CODE = "" THEN
				PRODSETUP<1,-1> = 0
			END ELSE
				PRODSETUP<1,-1> = 1
			END
       		IF EM # '' THEN
	   			EMSETUP<1,-1> = 0
			END ELSE
		   		EMSETUP<1,-1> = 1
       		END				
		INVCODES<1,COUNT> = ID<1,X>[4,99]
		INVDESCS<1,COUNT> = ID<1,X>[4,99] : "_" :INV.FULL.DESC	
		COUNT + = 1
	END
			
NEXT
SWAP "'" WITH "" IN INVDESCS
SWAP '"' WITH "" IN INVDESCS

STATUS = RBO.setProperty('','INVCODES',INVCODES)
STATUS = RBO.setProperty('','INVDESCS',INVDESCS)
STATUS = RBO.setProperty('','PRODSETUP',PRODSETUP)
STATUS = RBO.setProperty('','EMSETUP',EMSETUP)
RETURN

* End of method code
99999*
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN

