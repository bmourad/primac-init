SUBROUTINE JOB_CUST_VALUES
********************************************************************************
*   Program name :- JOB_CUST_VALUES
*   Created:- 9/9/2005
*   Programmer :- S.Suhail Hussain
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB JOB
$INCLUDE PMC.CPYLIB CUSTOMER

   
   OPEN "","JOB" TO JOB ELSE ERRMSG = "CANNOT OPEN JOB FILE";GOTO 91000
   OPEN "","CUSTOMER" TO CUSTOMER ELSE ERRMSG = "CANNOT OPEN CUSTOMER FILE";GOTO 91000

   STATUS = RBO.getProperty("","DRV_JOB",JOB_NO)
   STATUS = RBO.getProperty("","PMCProperty",PMCProperty)
   
   CONO = PMCProperty<1,4> 
   DIV.CODE = "";USER.ID = ""
   JOB_DESC = "";JOB_CUST = "";CUST_NAME = "";RET_VALUE = ""

**** START
   MATREAD JOB.REC FROM JOB, CONO:JOB_NO ELSE
      ERRMSG = "CANNOT LOCATE JOB - " : JOB_NO
      GOTO 91000
   END
   
   BEGIN CASE
      CASE JOB.STATUS<1,1>=7
         ERRMSG = "JOB # (":JOB_NO:") IS READY TO PURGE"
         GOTO 91000
      CASE JOB.STATUS<1,1>=8
         ERRMSG = "JOB # (":JOB_NO:") HAS BEEN PURGED"
         GOTO 91000
      CASE JOB.STATUS<1,1>=9
         ERRMSG = "JOB # (":JOB_NO:") HAS BEEN CANCELLED"
         GOTO 91000
   END CASE
   DIV.CODE = JOB.DIV; USER.ID = UPCASE(@LOGNAME); ERRMSG = ''
   CALL CK_DIV_SEC_SUB(CONO,DIV.CODE,USER.ID,ERRMSG)
   IF ERRMSG # '' THEN
      GOTO 91000
   END
   *DRV_JOB = JOB_NO
   JOB_DESC = JOB.DESC<1,1>
   MATREAD CUST.REC FROM CUSTOMER,CONO:JOB.CUST ELSE CUST.NAME = "UNKNOWN"
   *DRV_CUST = JOB.CUST; DRV_DIV = JOB.DIV; DRV_DEPT = JOB.DEPT
   JOB_CUST = JOB.CUST
   CUST_NAME = CUST.NAME
   RET.VALUE = ""
   RET.VALUE = JOB_DESC : @VM : JOB_CUST : @VM : CUST_NAME
   STATUS = RBO.setProperty("","JOB_CUST_VALUES",RET.VALUE)
RETURN
****** END
91000:
   STATUS = RBO.setProperty("","ServerStatus",1)
   STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
RETURN
