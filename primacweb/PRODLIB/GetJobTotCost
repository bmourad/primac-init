SUBROUTINE GetJobTotCost
********************************************************************************
*   Program name :- GetJobTotCost
*   Created:- 6/24/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB JOB
$INCLUDE PMC.CPYLIB JOB.SALES.STATS
	
* Insert method code here
STATUS = RBO.getProperty('','ID',ID)
  CONO = ID[1,3] ; JOB.NO = TRIM(ID[4,99])

OPEN '','JOB.SALES.STATS' TO JOB.SALES.STATS ELSE
      ERRMSG = 'Cannot open JOB.SALES.STATS file!'
      GOTO 91000
END

OPEN '','JOB' TO JOB ELSE
      ERRMSG = 'Cannot open JOB file!'
      GOTO 91000
END
JOB_CONF_AMT = ""
 MATREAD JOB.REC FROM JOB,CONO:JOB.NO ELSE
      ERRMSG = "JOB NUMBER ":JOB.NO:" NOT ON FILE"
      GOTO 91000
 END 
 NEW.JSS = "N"

 MATREADU JSS.REC FROM JOB.SALES.STATS,CONO:JOB.NO LOCKED
    ERRMSG = 'JOB SALES STATS record is locked by user - ':GETUSERNAME(STATUS())
    JOB.NO = ''
    GOTO 91000
 END ELSE
   
    MAT JSS.REC = ""
    NEW.JSS = "Y"
 END
  JSS.COST.TOTAL = JOB.TOT.COST
  
IF NEW.JSS = "Y" THEN
  JOB.TOT.COST = JOB.TOT.COST
END

STATUS = RBO.setProperty('','JSS_COST_TOTAL',OCONV(JSS.COST.TOTAL,"MD2"))
STATUS = RBO.setProperty('','JOB_CONF_AMT',OCONV(JOB.CONF.AMT,"MD2"))
RETURN

91000:*
  STATUS = RBO.setProperty('','ServerStatus',1)
  STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
  RETURN

* End of method code
RETURN

