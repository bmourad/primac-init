SUBROUTINE GetShiptoInfo
********************************************************************************
*   Program name :- GetShiptoInfo
*   Created:- 6/30/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB SHIPTO.MASTER

* Insert method code here
MESG = ""
   OPEN '','SHIPTO.MASTER' TO SHIPTO.MASTER ELSE
      MESG = 'Cannot open SHIPTO.MASTER file!'
      GOTO 91000
   END
*
STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
CONO = PMCProperty<1,4>

IDD = ""
SHM_SP_STORE_1 = ""
SHM_SP_NAME_1 = ""
SHM_DT_NAME_1 = ""
CMD = "SELECT SHIPTO.MASTER WITH @ID LIKE '" : CONO :"...'"
UDTEXECUTE CMD CAPTURING X
EOF = 1
LOOP
	READNEXT ID ELSE EOF = 0
	MATREAD SHM.REC FROM SHIPTO.MASTER, ID THEN
		IDD<1,-1> = ID[4,99]
		SHM_SP_STORE_1<1,-1> = SHM.SP.STORE
		SHM_SP_NAME_1<1,-1> = SHM.SP.NAME
		SHM_DT_NAME_1<1,-1> = SHM.DT.NAME
	END
WHILE EOF
REPEAT

STATUS = RBO.setProperty('','SHIPS',IDD)
STATUS = RBO.setProperty('','STORE',SHM_SP_STORE_1)
STATUS = RBO.setProperty('','SP_NAME',SHM_SP_NAME_1)
STATUS = RBO.setProperty('','DT_NAME',SHM_DT_NAME_1)
RETURN

91000*
	STATUS = RBO.setProperty('', 'ServerStatus', 1)
   	STATUS = RBO.setProperty('', 'ServerMessage', MESG)
RETURN

