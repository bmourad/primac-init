SUBROUTINE GetMiscPOCodes
********************************************************************************
*   Program name :- GetMiscPOCodes
*   Created:- 3/16/2004
*------------------------------------------------------------------------------*
*
* BY G.PURUSHOTHAM RAO
* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB COMPANY 

* Insert method code here
   OPEN '','COMPANY' TO COMPANY ELSE
      ERRMSG = 'COMPANY FILE IS MISSING'
      GOTO 93000
   END
MISC.PO.LIST = ''
STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
STATUS = RBO.getProperty('','Req_Type',REQ_TYPE)
USER.ID = PMCProperty<1,3>
CONO = PMCProperty<1,4>

MATREAD COMP.REC FROM COMPANY,CONO ELSE
	MAT COMP.REC = ""	
END 
STATUS=RBO.setProperty('','CO_NAME',CO.NAME)
STATUS=RBO.setProperty('','CO_ADDRESS',CO.ADDRESS)
STATUS=RBO.setProperty('','CO_CITY',CO.CITY)
STATUS=RBO.setProperty('','CO_STATE',CO.STATE)
STATUS=RBO.setProperty('','CO_ZIP',CO.ZIP)

MISC.REQ.LIST = ""
CMD = "SSELECT MISC.PO WITH CONO LIKE '" : CONO : "...'"

UDTEXECUTE CMD
DATA = 1
LOOP
	READNEXT MISC.PO.ID THEN
		MISC.PO.LIST<1,-1> = MISC.PO.ID[4,99]
	END ELSE
		DATA = 0  
	END

WHILE DATA DO
REPEAT

STATUS = RBO.setProperty('','MISC_PO_LIST',MISC.PO.LIST)

*STATUS = RBO.setProperty('','ID',CMD)

* End of method code
RETURN
93000*
STATUS=RBO.setProperty('','ServerMessage',ERRMSG)
