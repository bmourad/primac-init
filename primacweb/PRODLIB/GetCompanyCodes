SUBROUTINE GetGetCompanyCodes
********************************************************************************
*   Program name :- GetCompanyCodes
*   Created:- 04/03/2002
*------------------------------------------------------------------------------*
*
* In Properties:
* --------------
*	Edited by Abed Ali  
 
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

* Insert method code here

 PROG.ID = 'GetCompanyCodes'
   *
    OPEN '','COMPANY' TO F.COMPANY ELSE
      MESG = 'Cannot open COMPANY file!'
      STATUS = RBO.setProperty('', 'ServerStatus', 1)
      STATUS = RBO.setProperty('', 'ServerMessage', MESG)
      RETURN
   END
*
   COMPCODES = '00000000'
   COMPDESCS = '-Select-'
   
   SELECT F.COMPANY
   DATA = 1
   LOOP
      READNEXT CODE ELSE DATA = 0
   WHILE DATA DO
      COMPCODES<1,-1> = CODE
      READV DESC FROM F.COMPANY,CODE,1 ELSE DESC = CODE
      COMPDESCS<1,-1> = CODE:"-":DESC
   REPEAT

   STATUS = RBO.setProperty('', 'ConoCodes', COMPCODES)
   STATUS = RBO.setProperty('', 'ConoCodesDescs', COMPDESCS)
 
   STATUS = RBO.setProperty('', 'ServerStatus', 0)
   STATUS = RBO.setProperty('', 'ServerMessage', '')
*
   RETURN
*
END

