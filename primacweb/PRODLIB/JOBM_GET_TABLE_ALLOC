SUBROUTINE JOBM_GET_TABLE_ALLOC
********************************************************************************
*   Program name :- JOBM_GET_TABLE_ALLOC
*   Created:- 8/6/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB GANG.ALLOC
$INCLUDE PMC.CPYLIB COST.CNTR
* Insert method code here

ERRMSG = ""
OPEN "","GANG.ALLOC" TO GANG.ALLOC ELSE
	ERRMSG = "UNABLE TO OPEN GANG.ALLOC"
	GOTO 99999
END

OPEN "","COST.CNTR" TO CCTR ELSE
	ERRMSG = "UNABLE TO OPEN COST.CNTR"
	GOTO 99999
END


VAL = RBO.getProperty('','ID',TAB.ID)
CONO = TAB.ID[1,3]

MATREAD GAT.REC FROM GANG.ALLOC, TAB.ID ELSE
	ERRMSG = "Invalid Table ID. Try again! "
	GOTO 99999
END

CCTR.DESC.LIST = ""

CNT = DCOUNT(GAT.CCTR,@VM)
FOR I = 1 TO CNT
	MATREAD CCTR.REC FROM CCTR,CONO:GAT.CCTR<1,I> ELSE
		MAT CCTR.REC = ""
	END
	CCTR.DESC.LIST<1,I> = CCTR.DESC
NEXT I


STATUS=RBO.setProperty('','JOB_OP_NUM',GAT.DEPT)
STATUS=RBO.setProperty('','JOB_OP_VEND',GAT.CCTR)
STATUS=RBO.setProperty('','JOB_OP_EXP_DATE',CCTR.DESC.LIST)
STATUS=RBO.setProperty('','JOB_OP_CATG',GAT.TYPE)
STATUS=RBO.setProperty('','JOB_OP_OPEN_AMT',GAT.DESC)

99999
IF ERRMSG # "" THEN
	STATUS = RBO.setProperty('','ServerStatus','1')
	STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
END ELSE
	STATUS = RBO.setProperty('','ServerStatus','')
	STATUS = RBO.setProperty('','ServerMessage','')
END
* End of method code
RETURN
