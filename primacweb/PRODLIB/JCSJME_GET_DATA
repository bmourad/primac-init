SUBROUTINE JCSJME_GET_DATA
********************************************************************************
*   Program name :- JCSJME_GET_DATA
*   Created:- 7/27/2005
*   By :- S.Suhail Hussain
*------------------------------------------------------------------------------*
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB DAILY.MATL
$INCLUDE PMC.CPYLIB COST.CNTR


  OPEN '','COST.CNTR' TO COST.CNTR ELSE ERRMSG='COST.CNTR FILE IS MISSING'; GOTO 93000
  OPEN '','CONTROL' TO CONTROL ELSE ERRMSG='CONTROL FILE IS MISSING'; GOTO 93000
  OPEN '','DAILY.MATL' TO DAILY.MATL ELSE ERRMSG='DAILY.MATL FILE IS MISSING'; GOTO 93000

STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
CONO   = PMCProperty<1,4>

**********DAILY.MATL VALUES
DAILY_LIST = ""

CMD = "SSELECT DAILY.MATL WITH CONO='" : CONO : "'"
UDTEXECUTE CMD

DATA = 1
LOOP
	READNEXT ID THEN
		DAILY_LIST<1,-1> = ID[4,99]
	END ELSE
		DATA = 0
	END
WHILE DATA DO
REPEAT

**************COST.CENTER VALUES
CCTR_LIST = ""
CCTR_LIST_DESC = ""
CCTR_TYPE = ""
CCTR_DEPT = ""

CMD = "SSELECT COST.CNTR WITH CONO = '" : CONO : "'"
UDTEXECUTE CMD

DATA = 1
LOOP
	READNEXT ID ELSE DATA = 0
WHILE DATA DO
  	CCTR_LIST<1,-1> = ID[4,99]
REPEAT
	CCTR_COUNT = DCOUNT(CCTR_LIST,@VM)

	FOR I = 1 TO CCTR_COUNT
		MATREAD CCTR.REC FROM COST.CNTR , CONO:CCTR_LIST<1,I> THEN
			CCTR_TYPE<1,I> = CCTR.TYPE
			CCTR_LIST_DESC<1,I> = CCTR_LIST<1,I> : "_" : CCTR.DESC
		END
	NEXT I

SWAP '"' WITH "" IN CCTR_LIST_DESC


STATUS = RBO.setProperty('','CCTR_TYPE',CCTR_TYPE)
STATUS = RBO.setProperty('','CCTR_LIST',CCTR_LIST)
STATUS = RBO.setProperty('','CCTR_LIST_DESC',CCTR_LIST_DESC)
STATUS = RBO.setProperty('','DAILY_LIST',DAILY_LIST)
RETURN

93000:
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN
