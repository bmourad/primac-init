SUBROUTINE MANPOP_VALIDATE_VEND
********************************************************************************
*   Program name :- MANPOP_VALIDATE_VEND
*   Created:- 2/28/2006
*   Auther :- Sk. Zahoor Ahmed
*   Description:-This Program is Used to validate vendor and PO
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE ICS.CPYLIB INV.CNV
$INCLUDE PMC.CPYLIB VEND
$INCLUDE PMC.CPYLIB PO
$INCLUDE POS.CPYLIB MISC.PO
$INCLUDE POS.CPYLIB OUTSIDE.PO
$INCLUDE APS.CPYLIB VEND.STATS
$INCLUDE APS.CPYLIB VEND.PO.STATS
VPS_FLAG = ''
 OPEN "","VEND.PO.STATS" TO VEND.PO.STATS ELSE ERRMSG = "CANNOT OPEN VEND.PO.STATS FILE"; GOTO 93000
 OPEN "","VEND" TO VEND ELSE ERRMSG = "CANNOT OPEN VEND FILE"; GOTO 93000
 OPEN "","INVENTORY" TO INVENTORY ELSE ERRMSG = "CANNOT OPEN INVENTORY FILE"; GOTO 93000
 OPEN "","PO" TO  PO ELSE ERRMSG = "CANNOT OPEN PO FILE"; GOTO 93000
 OPEN "","MISC.PO" TO  MISC.PO ELSE ERRMSG = "CANNOT OPEN MISC.PO FILE"; GOTO 93000
 OPEN "","OUTSIDE.PO" TO  OUTSIDE.PO ELSE ERRMSG = "CANNOT OPEN OUTSIDE.PO FILE"; GOTO 93000
 OPEN "","SECURITY" TO SECURITY ELSE ERRMSG = "CANNOT OPEN SECURITY FILE"; GOTO 93000
 OPEN "","VEND.STATS" TO VEND.STATS ELSE ERRMSG = "CANNOT OPEN VEND.STATS FILE"; GOTO 93000
  STATUS = RBO.getProperty('','Cono',CONO)
  STATUS = RBO.getProperty('','VEND_NO',VEND_NO)
  STATUS = RBO.getProperty('','PO_NO',PO_NO)
  STATUS = RBO.getProperty('','PO_TYPE',PO.TYPE)
  MATREAD VSTAT.REC FROM VEND.STATS, CONO:VEND_NO:"!":PO.TYPE ELSE
        ERRMSG = "Vendor ( ":VEND_NO:" )is not active"
        RELEASE VEND.STATS, CONO:VEND_NO:"!":PO.TYPE
        GOTO 93000
      END
      MATREAD VEND.REC FROM VEND, CONO:VEND_NO ELSE VEND.DESC = "UNKOWN"
IF(PO_NO#"") THEN
      LOCATE PO_NO IN VSTAT.PO<1> SETTING FND ELSE
        ERRMSG = "Cannot locate PO ( ":PO_NO:" ) for this vendor"
        GOTO 93000
      END
      ID = CONO:VEND_NO:"!":PO.TYPE:"!":PO_NO
      MATREAD VPS.REC FROM VEND.PO.STATS, ID ELSE
        RELEASE VEND.PO.STATS, ID
        ERRMSG = "This Vendor PO is not active"
        GOTO 93000
      END
END
STATUS = RBO.setProperty('', 'VPS_FLAG', VPS.FLAG)
STATUS = RBO.setProperty('','VEND_DESC',VEND.DESC)
RETURN 
93000*
  STATUS = RBO.setProperty('','ServerStatus',1)
  STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
END

