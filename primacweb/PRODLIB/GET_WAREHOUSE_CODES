SUBROUTINE GET_WAREHOUSE_CODES
********************************************************************************
*   Program name :- GET_WAREHOUSE_CODES
*   Created:- 9/18/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB WAREHOUSE
$INCLUDE PMC.CPYLIB COMPANY

* Insert method code here

   OPEN "","WAREHOUSE" TO WAREHOUSE ELSE
      ERRMSG = "Cannot locate the WAREHOUSE file";GOTO 93000
   END

   OPEN '','CONTROL' TO CONTROL ELSE
      ERRMSG = 'CANNOT LOCATE CONTROL FILE'
      GOTO 93000
   END

   OPEN '','COMPANY' TO COMPANY ELSE
      ERRMSG = 'CANNOT LOCATE COMPANY FILE'
      GOTO 93000
   END

   STATUS = RBO.getProperty('', 'PMCProperty', PMCProperty)
   CONO = PMCProperty<1,4>

   CMD = "SSELECT WAREHOUSE WITH CONO = '" : CONO : "'"
   UDTEXECUTE CMD

  WAREHOUSE_CODES = '00'
  WAREHOUSE_DESCS = '-SELECT-'
  DEFAULT_PERIODS = "00"
  DIV_CODES = "00"

   DATA = 1
   LOOP
      READNEXT CODE ELSE DATA = 0
   WHILE DATA DO

	WAREHOUSE_CODES<1,-1> = CODE[4,99]
	READV DESC FROM WAREHOUSE,CODE,1 ELSE DESC = CODE[4,99]
	READV WHS_DIV FROM WAREHOUSE,CODE,9 ELSE WHS_DIV = "00"
	DIV_CODES<1,-1> = WHS_DIV
      PERIOD = "";ERR.FLG = "";ERRMSG = ""
      CALL CHECK_PERIOD_DATE1(CONO,DATE(),PERIOD,WHSE_DIV,ERR.FLG,ERRMSG,COMPANY,CONTROL)
      DEFAULT_PERIODS<1,-1> = PERIOD
      WAREHOUSE_DESCS<1,-1> = CODE[4,99] : "-" : DESC

   REPEAT

   STATUS = RBO.setProperty('', 'WarehouseCodes', WAREHOUSE_CODES)
   STATUS = RBO.setProperty('', 'WarehouseDescs', WAREHOUSE_DESCS)
   STATUS = RBO.setProperty('', 'DefaultPeriods', DEFAULT_PERIODS)
*   STATUS = RBO.setProperty('', 'ServerMessage', DIV_CODES)

* End of method code
RETURN

93000*
   STATUS = RBO.setProperty('', 'ServerStatus', '1')
   STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)

