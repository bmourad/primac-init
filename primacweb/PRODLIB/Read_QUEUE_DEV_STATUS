SUBROUTINE Read_QUEUE_DEV_STATUS
********************************************************************************
*   Program name :- Read_QUEUE_DEV_STATUS
*   Created:- 5/24/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB PMC_PRINTERS

* Insert method code here
OPEN '','PMC_PRINTERS' TO PMC_PRINTERS ELSE ERRMSG = "PMC_PRINTERS FILE IS MISSING"; GOTO 1000

    LN = 1
    PRTQUEUE = ""
    PRTDEV   = ""
    PRTSTATUS= ""
    CMD = "SSELECT PMC_PRINTERS"
    UDTEXECUTE CMD	
    DATA = 1	
    LOOP
        READNEXT PTRID ELSE DATA = 0		
    WHILE DATA		
        MATREADU PRTRS.REC FROM PMC_PRINTERS,PTRID ELSE MAT PRTRS.REC=''
            PRTQUEUE<1,LN>  = PTRID            
            PRTDEV<1,LN> = PRTRS_DEVICE
            PRTSTATUS<1,LN>    = PRTRS_PATH
        LN = LN + 1
    REPEAT
* End of method code
    STATUS = RBO.setProperty('', 'QUEUE', PRTQUEUE)
    STATUS = RBO.setProperty('', 'PATH',PRTDEV:"~":PRTSTATUS)
RETURN
1000*
   IF ERRMSG # "" THEN
      STATUS = RBO.setProperty('', 'ServerStatus', 1)
      STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)
   END
* End of method code
RETURN
