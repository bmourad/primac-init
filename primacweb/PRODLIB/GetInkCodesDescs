SUBROUTINE GetInkCodesDescs
********************************************************************************
*   Program name :- GetInkCodesDescs
*   Created:- 6/26/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JES.CPYLIB ESTIMATE.MATL

ERRMSG1 = RBO.getProperty('','ID',ID)

* Insert method code here
  OPEN "","ESTIMATE.MATL" TO ESTIMATE.MATL ELSE
    ERRMSG = "CANNOT OPEN ESTIMATE.MATL FILE"
  END

Ink.Codes.List = ''
Ink.Codes.Desc.List = ''
StrCodes =''
CONO = ID[1,3]

  SELECT ESTIMATE.MATL
LOOP
	EOF = 1
	READNEXT EST.ID ELSE EOF = 0
WHILE EOF DO
		MATREAD ESTM.REC FROM ESTIMATE.MATL,EST.ID THEN 

			IF  EST.ID = "001I" THEN
				
				Ink.Codes.List<1,-1> = ESTM.PROD
				Ink.Codes.Desc.List<1,-1> = ESTM.DESC 
				
			END ELSE

			END 
			
		END ELSE
				
		END
REPEAT
SWAP '"' WITH "" IN Ink.Codes.Desc.List
SWAP "'" WITH "" IN Ink.Codes.Desc.List

	*1000*

	STATUS=RBO.setProperty('','InkCodes',Ink.Codes.List)
	STATUS=RBO.setProperty('','InkDescs',Ink.Codes.Desc.List)
		
	STATUS=RBO.setProperty('','ServerStatus',1)
	STATUS=RBO.setProperty('','ServerMessage',ERRMSG )

* End of method code
RETURN
