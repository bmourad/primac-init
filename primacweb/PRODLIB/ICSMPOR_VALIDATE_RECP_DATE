SUBROUTINE ICSMPOR_VALIDATE_RECP_DATE
********************************************************************************
*   Program name :- ICSMPOR_VALIDATE_RECP_DATE
*   Created:- 8/12/2003
*------------------------------------------------------------------------------*
*
* AUTHOR G.PURUSHOTHAM RAO 
* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

* Insert method code here
   OPEN '','CONTROL' TO CONTROL ELSE
      ERRMSG = 'CONTROL FILE IS MISSING'
      GOTO 93000
   END
   OPEN '','COMPANY' TO COMPANY ELSE
      ERRMSG = 'COMPANY FILE IS MISSING'
      GOTO 93000
   END

STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
STATUS = RBO.getProperty('','MPO.DIV.OWNER',DIV.CODE)

USER.ID = PMCProperty<1,3>
CONO = PMCProperty<1,4>

      DEF.PERIOD = ""; ERR.FLG = ""; ERRMSG = ""
      CALL CHECK_PERIOD_DATE(CONO,ECD.RET.VALUE,DEF.PERIOD,DIV.CODE,ERR.FLG,ERRMSG,COMPANY,CONTROL)
      BEGIN CASE
         CASE ERRMSG = ""
            MPO.DATE.RECVD = ECD.RET.VALUE
         CASE ERR.FLG = 0
            MPO.DATE.RECVD = ECD.RET.VALUE
            *GOSUB 91000
         CASE ERR.FLG = 1
            *GOSUB 91000; GOTO 100
         CASE ERR.FLG = 2
            *GOSUB 91000; ECD.RET.VALUE = "END"
      END CASE

	STATUS = RBO.setProperty('','ServerMessage',ERRMSG : "^" : ERR.FLG ) 

99999*
RETURN

93000* 
  STATUS = RBO.setProperty('','ServerStatus',1)
  STATUS = RBO.setProperty('','ServerMessage',ERR) 

