SUBROUTINE GetVendStatPOs
********************************************************************************
*   Program name :- GetVendStatPOs
*   Created:- 7/31/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE APS.CPYLIB VEND.STATS
* Insert method code here
IDLIST = ""
RPOLIST = ""
OPOLIST = ""
MPOLIST = ""
I = 1
ERRMSG = ""
PTYPE   = ""
	OPEN '','VEND.STATS' TO VEND.STATS ELSE ERRMSG = 'VENDSTATS FILE IS MISSING';GOTO 1000
	STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
	CONO = PMCProperty<1,4>

	CMD = "SSELECT VEND.STATS WITH CONO = '" : CONO : "'"
	UDTEXECUTE CMD	
	DATA = 1	
	LOOP
   		READNEXT ID ELSE DATA = 0		
	WHILE DATA		
		PTYPE = FIELD(ID,"!",2)
		READV VSTAT.PO FROM VEND.STATS ,ID,1 ELSE VSTAT.PO = ID
		BEGIN CASE
			CASE PTYPE = "R"
				RPOLIST<1,-1> = LOWER(VSTAT.PO)
			CASE PTYPE = "O"
				OPOLIST<1,-1> = LOWER(VSTAT.PO)
			CASE PTYPE = "M"
				MPOLIST<1,-1> = LOWER(VSTAT.PO)
		END CASE
		I = I + 1
	REPEAT

STATUS = RBO.setProperty('', 'VENDPOLIST',RPOLIST:"#":OPOLIST:"#":MPOLIST)	

1000*
   IF ERRMSG # "" THEN
      STATUS = RBO.setProperty('', 'ServerStatus', 1)
      STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)            
   END
* End of method code
RETURN

