SUBROUTINE GETPERIOD_ERRMSG
********************************************************************************
*   Program name :- GETPERIOD_ERRMSG
*   Created:- 2/14/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB FISCAL

* Insert method code here
ERRMSG = ""
   OPEN '','CONTROL' TO CONTROL ELSE
      ERRMSG = 'Cannot open Control file!'
      GOTO 1000
   END
STATUS = RBO.getProperty('','ID',ID)
CONO = ID[1,3]
*CONO='001'
MAXV = '12'

STATUS = RBO.getProperty('','PRD_FLAG',PRD_FLG)
STATUS = RBO.getProperty('','ENTERED_PERIOD',ENTERED_PERIOD)

MATREAD FISCAL.REC FROM CONTROL , CONO:"FISCAL" ELSE
      ERRMSG = "CONTROL FISCAL IS NOT ON FILE";GOTO 1000
END
YEAR = FR.CURR.PER[1,4]


IF PRD_FLG = "LY" THEN
      IF LEN(ENTERED_PERIOD) = 6 THEN
         IF ENTERED_PERIOD[1,4] # (YEAR-1) THEN
            ERRMSG = "THE YEAR ENTERED IS NOT LAST YEAR"
            GOTO 1000
         END
         
     END
      MON = ENTERED_PERIOD[5,2]
      IF MON GE 1 AND MON LE MAXV THEN NULL ELSE
         ERRMSG = "INVALID PERIOD FOR LAST YEAR"
         GOTO 1000
      END
   END ELSE
      IF LEN(ENTERED_PERIOD) = 6 THEN
         IF ENTERED_PERIOD[1,4] # YEAR THEN
            ERRMSG = "THE YEAR ENTERED IS NOT THE CURRENT YEAR"
            GOTO 1000
         END
         
      END
      MON = ENTERED_PERIOD[5,2]
      IF MON GE 1 AND MON LE MAXV THEN NULL ELSE
         ERRMSG = "INVALID PERIOD FOR CURRENT YEAR"
         GOTO 1000
      END
   END
	


1000
STATUS = RBO.setProperty('','ServerStatus',1)        
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
99999
RETURN




