SUBROUTINE popINV_SERIAL_Values
********************************************************************************
*   Program name :- 
*   Created:- 6/23/2003
*   Author:- Mohammed Abdul Malik
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE ICS.CPYLIB INV_SERIAL
$INCLUDE ICS.CPYLIB WAREHOUSE
$INCLUDE ICS.CPYLIB INV.WHSE
$INCLUDE ICS.CPYLIB INV.WHSE.LOC
$INCLUDE ICS.CPYLIB CATEGORY
$INCLUDE CPYLIB CHAR

ERRMSG=''
WHSE.LOC.LIST.TEMP = ''
IF FILEINFO(INV_SERIAL,0)=0 THEN
  OPEN '','INV_SERIAL' TO INV_SERIAL ELSE
    ERRMSG<1,-1>='INV_SERIAL FILE IS MISSING'
  END
END
IF FILEINFO(WAREHOUSE,0)=0 THEN
  OPEN '','WAREHOUSE' TO WAREHOUSE ELSE
    ERRMSG<1,-1>='WAREHOUSE FILE IS MISSING'
   END
END
   OPEN '','INV.WHSE' TO INV.WHSE ELSE
      ERRMSG = 'INV.WHSE IS MISSING' 
   END
   OPEN '','INV.WHSE.LOC' TO INV.WHSE.LOC ELSE
      ERRMSG = 'INV.WHSE.LOC IS MISSING' 
   END


IF FILEINFO(INVENTORY,0)=0 THEN
  OPEN '','INVENTORY' TO INVENTORY  ELSE
    ERRMSG<1,-1>='INVENTORY FILE IS MISSING'
   END
END

IF FILEINFO(CATEGORY,0)=0 THEN
  OPEN '','CATEGORY' TO CATEGORY ELSE
    ERRMSG<1,-1>='CATEGORY FILE IS MISSING'
   END
END

IF ERRMSG THEN GOTO 93000

STATUS=RBO.getProperty('','SLT_DIVISION',SLT_DIVISION)
STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
CONO=PMCProperty<1,4>
STATUS=RBO.getProperty('','SLT_LOG_PROD',ISTK_PROD)

*STATUS=RBO.getProperty('','SLT_LOG_PROD',ISTK_PROD)
*STATUS=RBO.getProperty('','SLT_LOG_PROD',ISTK_PROD)

;***CMD = "SSELECT INV_SERIAL WITH @ID LIKE '" : CONO : "...' AND WITH ISTK_PROD='": ISTK_PROD : "'"
*CMD = "SSELECT INV_SERIAL WITH @ID LIKE ":CONO:"...";*WITH ISTK_PROD='": ISTK_PROD : "' "

*UDTEXECUTE CMD
*UDTEXECUTE "SAVE-LIST 2"
*UDTEXECUTE "GET-LIST 2"

*N = 1
;* get an ID AND PROD NUMBER

*MAT ISTK.REC = ""
*ISTK_WHSE = ""
*ISTK_LOC = ""
*ISTK_UOM=""
*WHSE_LOC=""

*N = 1
*LOOP
*	EOF = 1
*	READNEXT INV_SERIAL.ID ELSE EOF = 0
*	STATUS=RBO.setProperty('','ServerMessage',INV_SERIAL.ID)
*	RETURN
*WHILE EOF DO
*	MATREAD ISTK.REC FROM INV_SERIAL,INV_SERIAL.ID THEN
*       IF ISTK.LOC # ""  THEN
	 *	MATREAD WHSE.REC FROM WAREHOUSE,ISTK.WHSE THEN
		* IF SLT_DIVISION = WHS.DIV THEN
	*STATUS=RBO.setProperty('','ServerMessage',"SLT_DIVISION :"SLT_DIVISION:" WHS.DIV :":WHS.DIV)
	*RETURN
*			ISTK_WHSE<1,N>=ISTK.WHSE:"_":ISTK.LOC              		;* It sets Only      _ whse _ loc
*			ISTK_LOC<1,N>=INV_SERIAL.ID[4,45]:"~":ISTK.WHSE:"_":ISTK.LOC  ;* It sets serial_no _ whse _ loc
*			ISTK_UOM<1,N>=ISTK.UOM   						;* future usage
*			N += 1         
            *   END

	* END  ;* END MATREAD WHSE.REC
                    
*       END
	
*	END
*REPEAT


	****22/04/04****STATUS=RBO.setProperty('','INV_SERIAL_WHSE_LOC',ISTK_WHSE)
	****22/04/04****STATUS=RBO.setProperty('','INV_SERIALNO_WHSE_LOC',ISTK_LOC)
*	STATUS=RBO.setProperty('','WHSE_LOC',WHSE_LOC)

          UDTEXECUTE "CLEAR-LIST 2"   

	MATREAD INV.REC FROM INVENTORY,CONO:ISTK_PROD THEN
	STATUS=RBO.setProperty('','CHK_OTHER_ATTRIBS',INV.M.WT:"/":INV.PAP.TYPE:"/":INV.COLOR:"/":INV.UNIT<1,2>)

		STATUS=RBO.setProperty('','SLT_SLIT_STK_UOM',INV.UNIT<1,2>)
		STATUS=RBO.setProperty('','SLT_SLIT_CST_UOM',INV.UNIT<1,3>)
		*******STATUS=RBO.setProperty('','INV_SERIAL_WHSE_LOC',INV.WHSE.CODE)
*///////
TEMP_W_L = ""
ALL_SERIALNO = ""
ALL_SERIALNO_WL = ""

ALLWHSELOC = ""

	      	WHSE.CNT=DCOUNT(INV.WHSE.CODE,VM)      
		FOR I = 1 TO WHSE.CNT
	         	  IWH.ID = CONO:ISTK_PROD:"!":INV.WHSE.CODE<1,I>
		         MATREAD IWH.REC FROM INV.WHSE, IWH.ID THEN
	           	    IF IWH.LOC = "" THEN
	                     IWHLOC_TEMP<1,I> ='No locations have been setup for this warehouse.'
				TEMP_W_L<1,I> =  INV.WHSE.CODE<1,I>:"_":'No locations have been setup for this warehouse.'
			    END ELSE	
		         	TEMP_W_L<1,I> =   INV.WHSE.CODE<1,I>:"_":CHANGE(IWH.LOC,VM,SVM) ;** CHANGE(IWH.LOC<1,I>,VM,SVM) ;***   IWH.LOC<1,I>
				*********************************************// change the delimiter
		                  *IWLO.ID=CONO:SLT.SLIT.PROD<1,SLC>:"!":SLT.SLIT.WHSE<1,SLC>:"!":SLT.SLIT.LOC<1,SLC>

	
			    END;	*// END OF IF
	
			  END;		*// END OF MATREAD IWH.REC
		NEXT I

STATUS=RBO.setProperty('','INV_SERIAL_WHSE_LOC',TEMP_W_L)
***STATUS=RBO.setProperty('','INV_SERIALNO_WHSE_LOC',SERIAL.LOC.LIST)
STATUS=RBO.setProperty('','INV_SERIALNO_WHSE_LOC',WHSE.LOC.LIST.TEMP)



*//////
	END
****************************
INVENTORY.CODES.LIST=""
INVENTORY.ID.LIST = ""
INVENTORY.DESCS.LIST =""
TEMPCOLOR=""
TEMPPAPTYPE=""
***STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
***STATUS=RBO.getProperty('','SLT_LOG_PROD',SLT_LOG_PROD)
***STATUS=RBO.getProperty('','SLT_LOG_PROD',ISTK_PROD)
CONO=PMCProperty<1,4>
		MATREAD INV.REC FROM INVENTORY,CONO:ISTK_PROD THEN
		MATREAD CATG.REC FROM CATEGORY,CONO:INV.LINE ELSE MAT CATG.REC=''
         		IF CATG.TRK.LVL#'S' THEN
				MAT INV.REC = ""

				TEMPCOLOR=INV.COLOR
				TEMPPAPTYPE=INV.PAP.TYPE
        		 END
		END
				TEMPCOLOR=INV.COLOR
				TEMPPAPTYPE=INV.PAP.TYPE
	IF INV.COLOR # "" OR INV.PAP.TYPE # "" THEN

		CMD = "SSELECT INVENTORY WITH INV.COLOR='" :TEMPCOLOR :"' AND INV.PAP.TYPE='": TEMPPAPTYPE : "'":"AND WITH @ID LIKE '":CONO:"'"
		UDTEXECUTE CMD
N = 1
LOOP
	EOF = 1
	READNEXT INVENTORY.ID ELSE EOF = 0
WHILE EOF DO
		MATREAD INV.REC FROM INVENTORY,INVENTORY.ID THEN
		MATREAD CATG.REC FROM CATEGORY,CONO:INV.LINE ELSE MAT CATG.REC=''
         		IF CATG.TRK.LVL='S' THEN
				INVENTORY.CODES.LIST<1,N> = INVENTORY.ID[4,99]
				INVENTORY.DESCS.LIST<1,N> = INVENTORY.ID[4,99]:"_":INV.FULL.DESC
			N += 1
        		 END
		END
REPEAT

	END

   STATUS = RBO.setProperty('', 'INV_CHILD_PROD_NO', INVENTORY.CODES.LIST)
   STATUS = RBO.setProperty('', 'INV_CHILD_PROD_DESC', INVENTORY.DESCS.LIST)
* End of method code
GOTO 99999

*************************************************************************
93000 
STATUS = RBO.setProperty('','ServerStatus',1)        
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)  
99999 
RETURN
