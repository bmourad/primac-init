SUBROUTINE POSPOM_CONV_JOB_VALS
********************************************************************************
*   Program name :- POSPOM_CONV_JOB_VALS
*   Created:- 7/5/2006
*   Programmer :- Suhail Hussain S
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE ICS.CPYLIB INV.CNV
$INCLUDE CPYLIB CHAR

OPEN "","INVENTORY" TO INVENTORY ELSE ERRMSG = "CANNOT OPEN INVENTORY FILE";GOTO 91000

STATUS = RBO.getProperty("","PMCProperty",PMCProperty)
STATUS = RBO.getProperty("","ProdNum",PRODS)
STATUS = RBO.getProperty("","JBOnOrd",PO_JB_ONORD)
STATUS = RBO.getProperty("","JBReceved",PO_JB_RECV)
STATUS = RBO.getProperty("","JBOpen",PO_JB_OPEN)

CONO = PMCProperty<1,4>

   FOR J=1 TO DCOUNT(PRODS,VM)
      MATREAD INV.REC FROM INVENTORY,CONO:PRODS<1,J> ELSE 
         MAT INV.REC = ""
         GOTO 1111
      END
      $INCLUDE ICSBP INV.UM.CNV
      FOR A = 1 TO DCOUNT(PO_JB_ONORD<1,J>,SVM)
         IF ICR.CNV = "MD0" THEN
            PO_JB_ONORD<1,J,A> = ICONV(PO_JB_ONORD<1,J,A>,"MD0")
            PO_JB_RECV<1,J,A> = ICONV(PO_JB_RECV<1,J,A>,"MD0")
            PO_JB_OPEN<1,J,A> = ICONV(PO_JB_OPEN<1,J,A>,"MD0")
         END ELSE
            PO_JB_ONORD<1,J,A> = ICONV(PO_JB_ONORD<1,J,A>,"MD2")
            PO_JB_RECV<1,J,A> = ICONV(PO_JB_RECV<1,J,A>,"MD2")
            PO_JB_OPEN<1,J,A> = ICONV(PO_JB_OPEN<1,J,A>,"MD2")
         END
      NEXT A
1111
   NEXT J

   STATUS = RBO.setProperty("","JBOnOrd",PO_JB_ONORD)
   STATUS = RBO.setProperty("","JBReceved",PO_JB_RECV)
   STATUS = RBO.setProperty("","JBOpen",PO_JB_OPEN)
RETURN

91000*
   STATUS = RBO.setProperty("","ServerStatus",1)
   STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
RETURN

