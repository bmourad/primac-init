SUBROUTINE PreWrite_GLTBLM
********************************************************************************
*   Program name :- PreWrite_GLTBLM
*   Created:- 3/16/2004
*------------------------------------------------------------------------------*
*
*  Server event triggered after the database image has been updated, but prio- *
*  r to the physical update occurring. Any changes to the database image at t- *
*  his point must be made via the API functions RBO.setDBVals() and RBO.getDB- *
*  Vals().
*  
*       - *

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB GLTABLE
* Insert method code here

  OPEN '','CONTROL' TO CONTROL ELSE
    ERRMSG = 'CONTROL FILE IS MISSING'
    GOSUB 93000
  END

MAT GLTABLE.REC = ''
ERRMSG = ''
STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
CONO   = PMCProperty<1,4>
USER = PMCProperty<1,3>
NEW = 0

    	MATREADU GLTABLE.REC FROM CONTROL, CONO:'GLTABLE' LOCKED 
    		ERRMSG = 'GENERAL LEDGER TABLE record is locked by user - ': USER 
    		GOTO 93000
  	END ELSE
  		* T26126 ^
  		  NEW = 1 ; MAT GLTABLE.REC = ''
 	END

  STATUS = RBO.getProperty('','ID',ID)
	@ID = ID
  STATUS = RBO.setProperty('','ServerStatus',@ID)

 *GLTBLM  
   CASH = ''
   AP = ''
   AR = ''
   RE = ''

  STATUS = RBO.getProperty('','CashAccount',CASH)
  STATUS = RBO.getProperty('','AccountPayable',AP)
  STATUS = RBO.getProperty('','AccountReceivable',AR)
  STATUS = RBO.getProperty('','RetainedEarnings',RE)
  STATUS = RBO.getProperty('','new_item',NEW)	

   GLTB.CASH = CASH
   GLTB.AP = AP
   GLTB.AR = AR 
   GLTB.RET.EARN = RE  

*FAS
	  FASDepreciationAllow  = ''
	  FASDepreciationExp  = ''       
  
    STATUS = RBO.getProperty('','FASDepreciationAllow',FASDepreciationAllow )
    STATUS = RBO.getProperty('','FASDepreciationExp',FASDepreciationExp)
	  
	  GLTB.DEPR.ALLOW = FASDepreciationAllow 
         GLTB.DEPR.EXP = FASDepreciationExp  

 * ICS
   ICSInventory = ''
   ICSPurchaseDiscount = ''
   ICSAdjustments = ''
   ICSFNGDVariance = ''
   ICSShipped_NotBilled = ''
   ICSInterDivision = ''

STATUS = RBO.getProperty('','ICSInventory',ICSInventory )
STATUS = RBO.getProperty('','ICSPurchaseDiscount',ICSPurchaseDiscount)
STATUS = RBO.getProperty('','ICSAdjustments',ICSAdjustments)
STATUS = RBO.getProperty('','ICSFNGDVariance',ICSFNGDVariance)
STATUS = RBO.getProperty('','ICSShipped_NotBilled',ICSShipped_NotBilled)
STATUS = RBO.getProperty('','ICSInterDivision',ICSInterDivision)

    GLTB.INV = ICSInventory 
    GLTB.PUR.DISC =ICSPurchaseDiscount 
    GLTB.INV.ADJ = ICSAdjustments
    GLTB.FNGD.VAR = ICSFNGDVariance 
    GLTB.SHIP.WIP =ICSShipped_NotBilled
    GLTB.IC.INT.DIV = ICSInterDivision 

*PRS
   PRSPayrollCash= ''
   PRSPayrollEarnings= ''
   PRSPayrollFICA = ''
   PRSPayrollEIC =  ''
   PRSFederalIncomeTax = ''
   PRSSavingsBond = ''

STATUS = RBO.getProperty('','PRSPayrollCash',PRSPayrollCash)
STATUS = RBO.getProperty('','PRSPayrollEarnings',PRSPayrollEarnings)
STATUS = RBO.getProperty('','PRSPayrollFICA',PRSPayrollFICA)
STATUS = RBO.getProperty('','PRSPayrollEIC',PRSPayrollEIC)
STATUS = RBO.getProperty('','PRSFederalIncomeTax',PRSFederalIncomeTax)
STATUS = RBO.getProperty('','PRSSavingsBond',PRSSavingsBond)

      GLTB.PR.CASH  = PRSPayrollCash 
      GLTB.PR.EARN  = PRSPayrollEarnings
      GLTB.FICA  = PRSPayrollFICA 
      GLTB.PR.EIC = PRSPayrollEIC 
      GLTB.PR.FIT  = PRSFederalIncomeTax
      GLTB.PR.SAV.BOND = PRSSavingsBond 

*JCS
   JCSMainSalesAccount= ''
   JCSMainSalesTaxAccount= ''
   JCSMainTradeDiscount= ''
   JCSMainPreBillAccount=  ''
   JCSMainFreightAccount= ''
   JCSMainReturnsAllow= ''
   JCSMainWIPClearingAccount  = ''

STATUS = RBO.getProperty('','JCSMainSalesAccount',JCSMainSalesAccount)
STATUS = RBO.getProperty('','JCSMainSalesTaxAccount',JCSMainSalesTaxAccount)
STATUS = RBO.getProperty('','JCSMainTradeDiscount',JCSMainTradeDiscount)
STATUS = RBO.getProperty('','JCSMainPreBillAccount',JCSMainPreBillAccount)
STATUS = RBO.getProperty('','JCSMainFreightAccount',JCSMainFreightAccount)
STATUS = RBO.getProperty('','JCSMainReturnsAllow',JCSMainReturnsAllow)
STATUS = RBO.getProperty('','JCSMainWIPClearingAccount',JCSMainWIPClearingAccount)

         GLTB.SALES = JCSMainSalesAccount 
         GLTB.SALES.TAX = JCSMainSalesTaxAccount 
         GLTB.TRADE.DISC =  JCSMainTradeDiscount
         GLTB.PRE.BILL = JCSMainPreBillAccount 
         GLTB.FRT = JCSMainFreightAccount 
         GLTB.RET.ALLOW  = JCSMainReturnsAllow
         GLTB.WIP.CLR = JCSMainWIPClearingAccount

*JCS LB
   JCSLBDirectWorkInProgress= ''
   JCSLBDirectCostOfGoods= ''
   JCSLBDirectApplied= ''
   JCSLBVariableFOHWorkInProgress=  ''
   JCSLBVariableFOHCostOfGoods= ''
   JCSLBVariableFOHApplied= ''
   JCSLBFixedFOHWorkInProgress= ''
   JCSLBFixedFOHCostOfGoods= ''
   JCSLBFixedFOHApplied= ''
   JCSLBSelling_AdminWorkInProgress=  ''
   JCSLBSelling_AdminCostOfGoods = ''
   JCSLBSelling_AdminAppliedCOGS= ''

STATUS = RBO.getProperty('','JCSLBDirectWorkInProgress',JCSLBDirectWorkInProgress)
STATUS = RBO.getProperty('','JCSLBDirectCostOfGoods',JCSLBDirectCostOfGoods)
STATUS = RBO.getProperty('','JCSLBDirectApplied',JCSLBDirectApplied)
STATUS = RBO.getProperty('','JCSLBVariableFOHWorkInProgress',JCSLBVariableFOHWorkInProgress)
STATUS = RBO.getProperty('','JCSLBVariableFOHCostOfGoods',JCSLBVariableFOHCostOfGoods)
STATUS = RBO.getProperty('','JCSLBVariableFOHApplied',JCSLBVariableFOHApplied)
STATUS = RBO.getProperty('','JCSLBFixedFOHWorkInProgress',JCSLBFixedFOHWorkInProgress)
STATUS = RBO.getProperty('','JCSLBFixedFOHCostOfGoods',JCSLBFixedFOHCostOfGoods)
STATUS = RBO.getProperty('','JCSLBFixedFOHApplied',JCSLBFixedFOHApplied)
STATUS = RBO.getProperty('','JCSLBSelling_AdminWorkInProgress',JCSLBSelling_AdminWorkInProgress)
STATUS = RBO.getProperty('','JCSLBSelling_AdminCostOfGoods',JCSLBSelling_AdminCostOfGoods)
STATUS = RBO.getProperty('','JCSLBSelling_AdminAppliedCOGS',JCSLBSelling_AdminAppliedCOGS) 

         GLTB.LB.DIR.WIP = JCSLBDirectWorkInProgress 
         GLTB.LB.DIR.COG = JCSLBDirectCostOfGoods
         GLTB.LB.DIR.APL  = JCSLBDirectApplied
         GLTB.LB.VOH.WIP = JCSLBVariableFOHWorkInProgress 
         GLTB.LB.VOH.COG = JCSLBVariableFOHCostOfGoods
         GLTB.LB.VOH.APL = JCSLBVariableFOHApplied 
         GLTB.LB.FOH.WIP = JCSLBFixedFOHWorkInProgress 
         GLTB.LB.FOH.COG =  JCSLBFixedFOHCostOfGoods
         GLTB.LB.FOH.APL  = JCSLBFixedFOHApplied
         GLTB.LB.S.A.WIP = JCSLBSelling_AdminWorkInProgress
         GLTB.LB.S.A.COG  = JCSLBSelling_AdminCostOfGoods
         GLTB.LB.S.A.APL  = JCSLBSelling_AdminAppliedCOGS

*JCS MT
   JCSMTAccrualAccruedAPLiab= ''
   JCSMTAccrualCostOfSales= ''
   JCSMTAccrualAccountsPayable= ''
   JCSMTDirectWorkInProgress=  ''
   JCSMTDirectCostOfGoods= ''
   JCSMTVariableFOHWorkInProgress= ''
   JCSMTVariableFOHCostOfGoods= ''
   JCSMTVariableFOHApplied= ''
   JCSMTFixedFOHWorkInProgress= ''
   JCSMTFixedFOHCostOfGoods=  ''
   JCSMTFixedFOHApplied = ''

STATUS = RBO.getProperty('','JCSMTAccrualAccruedAPLiab',JCSMTAccrualAccruedAPLiab)
STATUS = RBO.getProperty('','JCSMTAccrualCostOfSales',JCSMTAccrualCostOfSales)
STATUS = RBO.getProperty('','JCSMTAccrualAccountsPayable',JCSMTAccrualAccountsPayable)
STATUS = RBO.getProperty('','JCSMTDirectWorkInProgress',JCSMTDirectWorkInProgress)
STATUS = RBO.getProperty('','JCSMTDirectCostOfGoods',JCSMTDirectCostOfGoods)
STATUS = RBO.getProperty('','JCSMTVariableFOHWorkInProgress',JCSMTVariableFOHWorkInProgress)
STATUS = RBO.getProperty('','JCSMTVariableFOHCostOfGoods',JCSMTVariableFOHCostOfGoods)
STATUS = RBO.getProperty('','JCSMTVariableFOHApplied',JCSMTVariableFOHApplied)
STATUS = RBO.getProperty('','JCSMTFixedFOHWorkInProgress',JCSMTFixedFOHWorkInProgress)
STATUS = RBO.getProperty('','JCSMTFixedFOHCostOfGoods',JCSMTFixedFOHCostOfGoods)
STATUS = RBO.getProperty('','JCSMTFixedFOHApplied',JCSMTFixedFOHApplied )

         GLTB.MT.ACCRU.LIAB  =JCSMTAccrualAccruedAPLiab
         GLTB.MT.COS = JCSMTAccrualCostOfSales
         GLTB.MT.AP.ACCT = JCSMTAccrualAccountsPayable
         GLTB.MT.DIR.WIP = JCSMTDirectWorkInProgress
         GLTB.MT.DIR.COG = JCSMTDirectCostOfGoods
         GLTB.MT.VOH.WIP = JCSMTVariableFOHWorkInProgress
         GLTB.MT.VOH.COG = JCSMTVariableFOHCostOfGoods
         GLTB.MT.VOH.APL = JCSMTVariableFOHApplied
         GLTB.MT.FOH.WIP = JCSMTFixedFOHWorkInProgress
         GLTB.MT.FOH.COG = JCSMTFixedFOHCostOfGoods
         GLTB.MT.FOH.APL = JCSMTFixedFOHApplied

*JCS OS
   JCSOSAccrualAccruedLiability= ''
   JCSOSAccrualAccountsPayable= ''
   JCSOSDirectWorkInProgress= ''
   JCSOSDirectCostOfGoods=  ''
   JCSOSDirectApplied= ''
   JCSOSFixedFOHWorkInProgress= ''
   JCSOSFixedFOHCostOfGoods= ''
   JCSOSFixedFOHApplied = ''

STATUS = RBO.getProperty('','JCSOSAccrualAccruedLiability',JCSOSAccrualAccruedLiability)
STATUS = RBO.getProperty('','JCSOSAccrualAccountsPayable',JCSOSAccrualAccountsPayable)
STATUS = RBO.getProperty('','JCSOSDirectWorkInProgress',JCSOSDirectWorkInProgress)
STATUS = RBO.getProperty('','JCSOSDirectCostOfGoods',JCSOSDirectCostOfGoods)
STATUS = RBO.getProperty('','JCSOSDirectApplied',JCSOSDirectApplied)
STATUS = RBO.getProperty('','JCSOSFixedFOHWorkInProgress',JCSOSFixedFOHWorkInProgress)
STATUS = RBO.getProperty('','JCSOSFixedFOHCostOfGoods',JCSOSFixedFOHCostOfGoods)
STATUS = RBO.getProperty('','JCSOSFixedFOHApplied',JCSOSFixedFOHApplied)

        GLTB.OS.ACCRU.LIAB = JCSOSAccrualAccruedLiability
        GLTB.OS.AP.ACCT = JCSOSAccrualAccountsPayable 
        GLTB.OS.DIR.WIP  = JCSOSDirectWorkInProgress
        GLTB.OS.DIR.COG  = JCSOSDirectCostOfGoods
        GLTB.OS.DIR.APL  = JCSOSDirectApplied
        GLTB.OS.FOH.WIP = JCSOSFixedFOHWorkInProgress  
        GLTB.OS.FOH.COG = JCSOSFixedFOHCostOfGoods 
        GLTB.OS.FOH.APL = JCSOSFixedFOHApplied

*JCS SP
   JCSSPDirectWorkInProgress= ''
   JCSSPDirectCostOfGoods= ''
   JCSSPDirectApplied= ''
   JCSSPFixedFOHWorkInProgress=  ''
   JCSSPFixedFOHCostOfGoods= ''
   JCSSPFixedFOHApplied= ''

STATUS = RBO.getProperty('','JCSSPDirectWorkInProgress',JCSSPDirectWorkInProgress)
STATUS = RBO.getProperty('','JCSSPDirectCostOfGoods',JCSSPDirectCostOfGoods)
STATUS = RBO.getProperty('','JCSSPDirectApplied',JCSSPDirectApplied)
STATUS = RBO.getProperty('','JCSSPFixedFOHWorkInProgress',JCSSPFixedFOHWorkInProgress)
STATUS = RBO.getProperty('','JCSSPFixedFOHCostOfGoods',JCSSPFixedFOHCostOfGoods)
STATUS = RBO.getProperty('','JCSSPFixedFOHApplied',JCSSPFixedFOHApplied)

        GLTB.SP.DIR.WIP = JCSSPDirectWorkInProgress
        GLTB.SP.DIR.COG = JCSSPDirectCostOfGoods 
        GLTB.SP.DIR.APL = JCSSPDirectApplied 
        GLTB.SP.FOH.WIP = JCSSPFixedFOHWorkInProgress 
        GLTB.SP.FOH.COG = JCSSPFixedFOHCostOfGoods 
        GLTB.SP.FOH.APL = JCSSPFixedFOHApplied  


*JCS MS

   JCSMSAccrualAccountsPayable= ''
   JCSMSAccrualAccruedLiability= ''
   JCSMSAccrualExpenseAccount= ''
   JCSMSDirectWorkInProgress=  ''
   JCSMSDirectCostOfGoods= ''
   JCSMSDirectApplied= ''
   JCSMSFixedFOHWorkInProgress= ''
   JCSMSFixedFOHCostOfGoods= ''
   JCSMSFixedFOHApplied= ''

STATUS = RBO.getProperty('','JCSMSAccrualAccountsPayable',JCSMSAccrualAccountsPayable)
STATUS = RBO.getProperty('','JCSMSAccrualAccruedLiability',JCSMSAccrualAccruedLiability)
STATUS = RBO.getProperty('','JCSMSAccrualExpenseAccount',JCSMSAccrualExpenseAccount)
STATUS = RBO.getProperty('','JCSMSDirectWorkInProgress',JCSMSDirectWorkInProgress)
STATUS = RBO.getProperty('','JCSMSDirectCostOfGoods',JCSMSDirectCostOfGoods)
STATUS = RBO.getProperty('','JCSMSDirectApplied',JCSMSDirectApplied)
STATUS = RBO.getProperty('','JCSMSFixedFOHWorkInProgress',JCSMSFixedFOHWorkInProgress)
STATUS = RBO.getProperty('','JCSMSFixedFOHCostOfGoods',JCSMSFixedFOHCostOfGoods)
STATUS = RBO.getProperty('','JCSMSFixedFOHApplied',JCSMSFixedFOHApplied)


        GLTB.MS.AP.ACCT  = JCSMSAccrualAccountsPayable
        GLTB.MS.CRED.EXP = JCSMSAccrualAccruedLiability 
        GLTB.MS.EXP.ACCT = JCSMSAccrualExpenseAccount
        GLTB.MS.DIR.WIP  = JCSMSDirectWorkInProgress
        GLTB.MS.DIR.COG  = JCSMSDirectCostOfGoods
        GLTB.MS.DIR.APL  = JCSMSDirectApplied
        GLTB.MS.FOH.WIP  = JCSMSFixedFOHWorkInProgress
        GLTB.MS.FOH.COG  = JCSMSFixedFOHCostOfGoods
        GLTB.MS.FOH.APL  = JCSMSFixedFOHApplied

        MATWRITE GLTABLE.REC ON CONTROL , CONO:"GLTABLE"

* End of method code
RETURN

93000* 
  IF ERRMSG # "" THEN

      STATUS = RBO.setProperty('', 'ServerStatus', 1)

      STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG ) 

   END

