SUBROUTINE ESTOPGM_UpdateGrpXref
********************************************************************************
*   Program name :- ESTOPGM_UpdateGrpXref
*   Created:- 8/23/2007
*------------------------------------------------------------------------------*
*
*  Server event triggered after the database has been updated. Note that the - *
*  API function RBO.getDBVals() should be used to retrieve values from the da- *
*  tabase image, as values from the uObject data aware properties may have be- *
*  en amended via the {m:WW:uObject=PreWrite} server event.
*  
*                                                        - *

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JES.CPYLIB ESTIMATE.GRP.XREF
* Insert method code here
ERRMSG = ""
OPEN "","ESTIMATE.GRP.XREF" TO ESTIMATE.GRP.XREF ELSE
      ERRMSG = "CANNOT OPEN ESTIMATE.GRP.XREF FILE"
      GOTO 93000
END

*ID is Cono:Dept Id:'!':Group Id.
STATUS =RBO.getProperty('','ID',ID)
STATUS =RBO.getProperty('','ESTG_DESC',ESTG_DESC)
CONO = ID[1,3]
DEPT = FIELD(ID[4,99],"!",1)
GROUP = FIELD(ID,"!",2)

         MATREADU ESTGX.REC FROM ESTIMATE.GRP.XREF, CONO:DEPT ELSE
            MAT ESTGX.REC = ""
         END
         LOCATE GROUP IN ESTGX.GRP<1>,1 BY "AL" SETTING P ELSE
            ESTGX.GRP = INSERT(ESTGX.GRP,1,P,0,GROUP)
            ESTGX.GRP.DESC = INSERT(ESTGX.GRP.DESC,1,P,0,"")
         END
         ESTGX.GRP.DESC<1,P> = ESTG_DESC
         MATWRITE ESTGX.REC ON ESTIMATE.GRP.XREF, CONO:DEPT
         RELEASE

93000 *
   IF ERRMSG # "" THEN
      STATUS = RBO.setProperty('','ServerStatus',1)
      STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
   END

* End of method code
RETURN

