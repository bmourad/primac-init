SUBROUTINE CHECK_SERIAL
*********************************************************************
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - EPRIMAC
* PROGRAM     - CHECK_SERIAL
* BY          - KHAJA ZIAUDDIN
* DATE        - 07/07/2003  (mm/dd/yyyy)
* DESCRIPTION   
*		   
*ENDDOC
*************************************************************

$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INV_SERIAL

MAT ISTK.REC = ''

OPEN '','INV_SERIAL' TO INV_SERIAL ELSE ERRMSG = 'INV_SERIAL FILE IS MISSING'; GOTO 93000

STATUS = RBO.getProperty('','PMCProperty',PMCPROPERTY)
STATUS = RBO.getProperty('','Serial',Serial)
STATUS = RBO.getProperty('','Po',PO.NO)
ERRMSG = 'TEST 123.....'
CONO = PMCPROPERTY<1,4>

MATREADU ISTK.REC FROM INV_SERIAL,CONO:Serial THEN
	IF ISTK.POST.DATE # '' THEN
	   ERRMSG = 'Serial was received on ':OCONV(ISTK.POST.DATE,'D2/')
	   GOTO 93000
	END
	IF ISTK.MANIFEST.NO # '' THEN
	   ERRMSG = 'Serial belongs to Purchase order ':ISTK.PO.NO:' manifest ':ISTK.MANIFEST.NO
	   GOTO 93000
	END
	IF ISTK.PO.NO # PO.NO THEN                            
	   ERRMSG = 'Serial belongs to Purchase order ':ISTK.PO.NO
	   GOTO 93000
	END
END

STATUS = RBO.setProperty('','ServerStatus',0)
STATUS = RBO.setProperty('','ServerMessage','')

RETURN



93000
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN
