SUBROUTINE ORDM_VALIDATE_WAREHOUSE
********************************************************************************
*   Program name :- ORDM_VALIDATE_WAREHOUSE
*   Created:- 3/16/2006
*   Programmer :- Suhail Hussain S
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB WAREHOUSE

OPEN "","WAREHOUSE" TO WAREHOUSE ELSE ERRMSG = "CANNOT OPEN WAREHOUSE FILE"; GOTO 91000
* Insert method code here
  STATUS = RBO.getProperty("","PMCProperty",PMCProperty)
  STATUS = RBO.getProperty("","INARR",INPARAM)

  CONO = PMCProperty<1,4>
  WHSE_ID = INPARAM<1,1>
  JOB_DIV = INPARAM<1,2>

  MATREAD WHSE.REC FROM WAREHOUSE,CONO:WHSE_ID ELSE
     ERRMSG=WHSE_ID:' Is an invalid Warehouse'
     GOTO 91000
  END
  IF WHS.DIV # '00' AND WHS.DIV # JOB_DIV THEN
     ERRMSG='Whse/Job division mismatch'
     GOTO 91000
  END
RETURN

* End of method code
91000
   STATUS = RBO.setProperty("","ServerStatus",1)
   STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
RETURN

