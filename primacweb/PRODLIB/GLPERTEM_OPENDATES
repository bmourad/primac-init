SUBROUTINE GLPERTEM_OPENDATES
********************************************************************************
*   Program name :- GLPERTEM_OPENDATES
*   Created:- 4/25/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB>FISCAL
$INCLUDE CPYLIB>CHAR
 OPEN '','CONTROL' TO CONTROL ELSE ERRMSG = "CONTROL FILE IS MISSING"; GOTO 93000
NUM.PERIODS=12
STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
CONO=PMCProperty<1,4>
DIM DATES(55)
MATREAD DATES FROM CONTROL,CONO:"OPENDATES" THEN
  FOR I= 1 TO 12
    OPEN.DATES<1,I>=OCONV(DATES(I),"D2/")
  NEXT I 
END

*FOR K=1 TO M
 *MON = FIELD(OCONV(OPEN.DATES(K-1),"D2-"),"-",1) + 0
 * TEST.MON = 0
 * IF MON = NUM.PERIODS THEN NEXT.MON = 1 ELSE NEXT.MON = MON + 1
 * FOR I = 28 TO 31 WHILE NEXT.MON # TEST.MON
  *  TEST.DATE = OPEN.DATES(K-1) + I
 *   TEST.MON = FIELD(OCONV(TEST.DATE,"D2-"),"-",1) + 0
 * NEXT I
 * IF NEXT.MON = TEST.MON THEN
 *   DATES = TEST.DATE
 * END
*NEXT K
STATUS=RBO.setProperty('','Dates',OPEN.DATES)
RETURN

93000
STATUS = RBO.setProperty('', 'ServerStatus', 1)
STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)
RETURN

