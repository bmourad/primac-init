SUBROUTINE ARMCRM_GetDefaults
********************************************************************************
*   Program name :- ARMCRM_GetDefaults
*   Created:- 01/08/2003
*------------------------------------------------------------------------------*
*
* In Properties:
* --------------
*  PMCProperty
*
* Out Properties:
* ---------------
* CO_GLS,DC_BANK_ACCT,BANK_ACCT_DESC,ReadOnlyFields,CO_ACCT_MASK,ACCT_LEN
********************************************************************************
$INCLUDE WWINSERT RBO.H

* Insert method code here
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE PMC.CPYLIB GLTABLE
$INCLUDE ARS.CPYLIB DAILY.CASH
$INCLUDE CPYLIB CHAR

ERRMSG = ''

CantGetProperty='Cannot get property '
CantSetProperty='Cannot set property '

* Open files
OPEN '','COMPANY' TO COMPANY ELSE
  ERRMSG='Cannot open COMPANY file!'
  GOTO 93000
END
OPEN '','CONTROL' TO CONTROL ELSE
  ERRMSG='Cannot open CONTROL file!'
  GOTO 93000
END
OPEN '','DAILY.CASH' TO DAILY.CASH ELSE
  ERRMSG='Cannot open DAILY.CASH file!'
  GOTO 93000
END

* Get all properties
STATUS = RBO.getProperty('','PMCProperty',PMCProperty)

* Get CONO
CONO=PMCProperty<1,4>

MATREAD COMP.REC FROM COMPANY, CONO ELSE
  ERRMSG='Cannot read Company record!'
  GOTO 93000
END
MATREAD GLTABLE.REC FROM CONTROL, CONO:'GLTABLE' ELSE MAT GLTABLE.REC = ''
*
* Set properties

STATUS = RBO.setProperty('','CO_GLS',CO.GLS)

IF CO.GLS # 'Y' THEN
  DC_BANK_ACCT = GLTB.CASH
  BANK_ACCT_DESC = 'Cash Account'
  STATUS = RBO.setProperty('','DC_BANK_ACCT',DC_BANK_ACCT)
  STATUS = RBO.setProperty('','BANK_ACCT_DESC',BANK_ACCT_DESC)
  ROF='DC_BANK_ACCT'
  ROF<1,-1>='BANK_ACCT_DESC'
  STATUS = RBO.setProperty('','ReadOnlyFields',ROF)
END
STATUS = RBO.setProperty('','CO_ACCT_MASK',CO.ACCT.MASK)
ACCT.LEN = LEN(CO.ACCT.PIC)
STATUS = RBO.setProperty('','ACCT_LEN',ACCT.LEN)
GOTO 99999

93000
IF ERRMSG THEN
  CALL RBO_ERROR_SUB(ERRMSG)
END

* End of method code
99999
RETURN
