SUBROUTINE APD_EOY_CLOSE
********************************************************************************
*   Program name :- APD_EOY_CLOSE
*   Created:- 01/31/2006
*   Program By :- Sk. Zahoor Ahmed
* DESCRIPTION - This program move Y.T.D Paid to Last Year paid.
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  CONO
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB VEND
* Insert method code here
ERRMSG = ''

      OPEN 'VEND' TO VEND ELSE ERRMSG='VEND FILE IS MISSING';GOTO 90000 
      OPEN 'CONTROL' TO CONTROL ELSE ERRMSG='CONTROL FILE IS MISSING';GOTO 90000
STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
CONO = PMCProperty<1,4>
CMD= ''
*
***** MAIN PROCESSING
*
*
     CMD = "SELECT VEND WITH CONO =":CONO
     UDTEXECUTE CMD CAPTURING MESG
     DATA=1
     LOOP
        READNEXT VEND.ID ELSE DATA=0
     WHILE DATA DO
	MATREADU VEND.REC FROM VEND, VEND.ID ELSE
           RELEASE VEND, VEND.ID
           GOTO 2999
        END
        VEND.PD.L.YR = VEND.PD.Y.T.D
        VEND.PD.Y.T.D = ''
        MATWRITE VEND.REC ON VEND, VEND.ID
2999 REPEAT
     WRITEV DATE() ON CONTROL,CONO:'APD.EOY.CLOSE',1
     GOTO 90000

* End of method code
RETURN

90000 *
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
END
