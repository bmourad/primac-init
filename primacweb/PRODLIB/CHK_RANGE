SUBROUTINE CHK_RANGE
********************************************************************************
*   Program name :- CHK_RANGE
*   Created:- 6/1/2005
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE WTR.CPYLIB WIPT.STORAGE.LOC
* Insert method code here
*File Opens
   OPEN '','WIPT.STORAGE.LOC' TO WIPT.STORAGE.LOC ELSE ERRMSG="WIPT.STORAGE.LOC FILE MISSING"; GOTO 93000
   OPEN '','CONTROL' TO CONTROL ELSE ERRMSG="CONTROL FILE MISSING"; GOTO 93000

RANGE_IDS = ""

STATUS = RBO.getProperty('','RANGE_ID',RANGE_IDS)
CONO = FIELD(RANGE_IDS,"!",1)
RANGE_IDS = FIELD(RANGE_IDS,"!",2)

RANGE.START =  FIELD(RANGE_IDS,"*",1)
RANGE.END = FIELD(RANGE_IDS,"*",2)

RANGE.KEY = RANGE.START:"*":RANGE.END
ERRMSG = ""
10000 *
      STMT = 'SELECT WIPT.STORAGE.LOC WITH RANGE.START <= "':RANGE.END:'"'
      STMT = STMT:' AND WITH RANGE.END >= "':RANGE.START:'"'
      PERFORM STMT CAPTURING GARBAGE
      WRITE GARBAGE:STMT  ON CONTROL,"01F"
      EOF = 0
      OVERLAP.FLG = 0
      LOOP
         READNEXT TEST ELSE EOF = 1
      UNTIL EOF DO
         IF TEST # CONO:RANGE.KEY THEN
            ERRMSG='LOCATION RANGES OVERLAP ANOTHER STORAGE LOCATION DEFINITION!'
	     OVERLAP.FLG = 1		
            GOTO 91000
         END
     REPEAT
*RETURN
91000 *
	IF OVERLAP.FLG = 1	THEN
		STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
	END 
93000 *
* End of method code
RETURN

