SUBROUTINE JOBM_CHK_SEL_PROD_WHSE
********************************************************************************
*   Program name :- JOBM_CHK_SEL_PROD_WHSE
*   Created:- 12/09/2002
*------------------------------------------------------------------------------*
*
*  
* In Properties:
* --------------
*  
IN_PARAM=''
*
* Out Properties:
* ---------------
*  
OUT_PARAM=''
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE CPYLIB CHAR
$INCLUDE ICS.CPYLIB INV.WHSE
$INCLUDE ICS.CPYLIB WAREHOUSE

ERRMSG=''
OPEN '','INVENTORY' TO INVENTORY ELSE
	ERRMSG = 'INVENTORY FILE IS MISSING'
    	GOTO 93000
END
OPEN '','CATEGORY' TO CATEGORY ELSE
	ERRMSG = 'CATEGORY FILE IS MISSING'
    	GOTO 93000
END
OPEN "","INV.WHSE" TO INV.WHSE ELSE
	ERRMSG = "INV.WHSE IS MISSING"
	GOTO 93000
END
OPEN "","WAREHOUSE" TO WAREHOUSE ELSE
	ERRMSG = "WAREHOUSE IS MISSING"
	GOTO 93000
END
;* initialize

STATUS=RBO.getProperty('','ID',ID);*CONO:JOB NUM
STATUS=RBO.getProperty('','JOB_RESV_MATL',JOB.RESV.MATL);*PROD-ID
STATUS=RBO.getProperty('','JOB_RESV_WHSE',JOB.RESV.WHSE);*WHSE CODE
STATUS=RBO.getProperty('','JOB_DIV',JOB.DIV);*JOB DIV-ID
STATUS=RBO.getProperty('','FLG',FLG);*RS - RESERVE, RD - REQUIRED, FGD - FINISHED GOODS

IF JOB.RESV.MATL = 0 THEN JOB.RESV.MATL = ""

CONO=ID[1,3]
JOB_NO=ID[4,99]

* get database values
MATREAD INV.REC FROM INVENTORY,CONO:JOB.RESV.MATL ELSE
	MAT INV.REC = ''
END

IF INV.WHSE.CODE = '' THEN
	ERRMSG = 'INVENTORY (':JOB.RESV.MATL:') HAS NO WAREHOUSES'
    	GOTO 93000
END

IWH.ID = CONO : JOB.RESV.MATL : '!' : JOB.RESV.WHSE
MATREAD IWH.REC FROM INV.WHSE, IWH.ID ELSE
      ERRMSG = 'WAREHOUSE (':JOB.RESV.WHSE:') IS MISSING'
      GOTO 93000
END

MATREAD WHSE.REC FROM WAREHOUSE, CONO:JOB.RESV.WHSE ELSE MAT WHSE.REC = ""

IF WHS.DIV # JOB.DIV AND WHS.DIV # "00" THEN
	IF FLG = "RS" THEN
		ERRMSG = "WAREHOUSE DIVISION DOES NOT MATCH JOB DIVISION"
	END ELSE
		ERRMSG = "JOB DIVISION DOES NOT MATCH PRODUCT'S WAREHOUSE DIVISION"
	END
      	GOTO 93000
END

GOTO 99999

93000 
STATUS = RBO.setProperty('','ServerStatus','1')
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)

99999
RETURN

