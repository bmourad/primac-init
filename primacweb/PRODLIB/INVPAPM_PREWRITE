SUBROUTINE INVPAPM_PREWRITE
********************************************************************************
*   Program name :- INVPAPM_PREWRITE
*   Created:- 11/7/2002
*   Author- Edvard Pitka
*   Description
*           This program provides the maintenance facility for
*           paper inventory.
*  T070207 By Abdul Gafoor : To fix the description display length problem on 07/01/07
*********************************************************************
*
$INCLUDE WWINSERT RBO.H
$INSERT ICS.CPYLIB INVENTORY

IF FILEINFO(CONTROL,0)=0 THEN
  OPEN '','CONTROL' TO CONTROL ELSE
    GOTO 93000
  END
END
*T070207 vvv
OPEN "","INVENTORY" TO INVENTORY ELSE ERRMSG="ERROR IN OPENING INVENTORY"; GOTO 93000
PROD_ID = ""
*T070207 ^^^
;* get an ID
STATUS=RBO.getProperty('','ID',ID)
CONO=ID[1,3]
*T070207 vvv
PROD_ID=ID[4,99]
MATREAD INV.REC FROM INVENTORY, CONO:PROD_ID ELSE
	ERRMSG = 'ERROR WHILE READING INVENTORY FOR PRODUCT ':CONO:PROD_ID
	GOTO 93000
END
*T070207 ^^^
;* retrieve database values
NAMES='' ; VALUES=''
NAMES<1>='INV_DESC'
NAMES<2>='INV_M_LINE'
NAMES<3>='INV_COLOR'
NAMES<4>='INV_PAP_LEN'
NAMES<5>='INV_PAP_WIDTH'
NAMES<6>='INV_M_WT'
NAMES<7>='INV_PAP_FINISH'
NAMES<8>='INV_BRIGHT'
NAMES<9>='INV_PPI'
NAMES<10>='INV_BAS_WT'
STATUS=RBO.getDBVals(NAMES,VALUES)
INV.DESC=VALUES<1>
INV.M.LINE=VALUES<2>
INV.COLOR=VALUES<3>
INV.PAP.LEN=VALUES<4>
INV.PAP.WIDTH=VALUES<5>
INV.M.WT=VALUES<6>
INV.PAP.FINISH=VALUES<7>
INV.BRIGHT=VALUES<8>
INV.PPI=VALUES<9>
INV.BAS.WT=VALUES<10>
STATUS=RBO.getProperty('','InvFactor',INV.FACTOR)
STATUS=RBO.getProperty('','CatgTrkLvl',CatgTrkLvl)

GOSUB SetInvFullDesc
GOSUB SetInvFactor

ERRMSG=''
GOTO 99999
*************************************************************************
*
***************
SetInvFullDesc:
***************
  IN_PARAM=''
  OUT_PARAM=''
  IN_PARAM<1>=CONO
*T070207 vvv
  IN_PARAM<2>=PROD_ID
*T070207 ^^^
  CALL InvFullDescSub(ERRMSG,IN_PARAM,OUT_PARAM,CONTROL,MAT INV.REC)
RETURN
*
*************
SetInvFactor:
*************
*
IF CatgTrkLvl='S' THEN                                             
  IF INV.FACTOR#'' THEN                                                          
    IF INV.PAP.TYPE='ROLL' THEN                                                                         
      INV.FACTOR=FIELD(INV.FACTOR,".",1)*100000+FIELD(INV.FACTOR,".",2)
    END                                                                                                                     
   IF INV.PAP.TYPE='LROLL' OR INV.PAP.TYPE='PCOAT' THEN
      INV.FACTOR = ICONV(INV.FACTOR,'MD2')                          
    END                                                                                                   
  END
  STATUS=RBO.setDBVals('INV_FACTOR',INV.FACTOR)
END 
                                                   
 RETURN
93000 
STATUS = RBO.setProperty('','ServerStatus',1)        
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)  
99999 
RETURN
