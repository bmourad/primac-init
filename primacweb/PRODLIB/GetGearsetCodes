SUBROUTINE GetGearsetCodes
********************************************************************************
*   Program name :- GetGearsetCodes
*   Created:- 05/05/2003
*   Created by :- Jaweed

*------------------------------------------------------------------------------*
*
*  This is a server event which is triggered after the object has been create- *
*  d on the RedBack Server. Note "Server Events" are pre-defined events to wh- *
*  ich application developers can assign BASIC code routines.                                                      - *

* In Properties:
* --------------
*  
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
* Insert method code here

PROG.ID = 'GetGearsetCodes'
MESG = ''
   *
   OPEN '','ESTIMATE.RES.GEARSET' TO ESTIMATE.RES.GEARSET ELSE
      MESG = 'Cannot open ESTIMATE.RES.GEARSET file!'
      GOTO 93000
   END
*
   STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
CONO = PMCProperty<1,4>
   
   GEARSETCODES = ''
   GEARSETCODESDESC = ''
   PITCH = ''
   FULL_GEARSETCODE = ''

   CMD="SSELECT ESTIMATE.RES.GEARSET WITH @ID LIKE ":CONO:"..."
   UDTEXECUTE CMD
   DATA = 1
   LOOP
      READNEXT CODE ELSE DATA = 0
   WHILE DATA DO
      
      GEARSETCODES  = CODE[4,99]
      
      READV DESC FROM ESTIMATE.RES.GEARSET,CODE,1 ELSE GEARSETCODESDESC = ''
      READV PT FROM ESTIMATE.RES.GEARSET,CODE,2 ELSE PITCH = ''
      GEARSETCODESDESC <1,-1> = DESC
      PITCH <1,-1> = OCONV(PT,'MD4')
	IF FULL_GEARSETCODE # "" THEN
	      FULL_GEARSETCODE = FULL_GEARSETCODE : @VM : CODE[4,99] : "-" : DESC
	END ELSE
	      FULL_GEARSETCODE = CODE[4,99] : "-" : DESC
	END
   REPEAT
*
   STATUS = RBO.setProperty('', 'ESTGSCodes', FULL_GEARSETCODE )
   STATUS = RBO.setProperty('', 'ESTGSPitch', PITCH)

RETURN

93000*
   STATUS = RBO.setProperty('','ServerStatus', 1)
   STATUS = RBO.setProperty('','ServerMessage', MESG)
* End of method code
RETURN

END

