SUBROUTINE WriteAll_Data
********************************************************************************
*   Program name :- WriteAll_Data
*   Created:-by yakub 3/9/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB COMPANY
* Insert method code here
 
ERRMSG = ""
CONO=''
SECURITY.REC=''
DIV_SEC=''
DIV_CLO=''

ARPrepay_Num=''
ARCheck_Num=''
AROnAcct_Num=''
ARCashRef_Num=''
ARMan_Purge=''

APVou_Num=''
REF_NO=''
I=''
APAutoVou_Num=''
APRepair_Num=''
APVend_Num=''


PRUnion_Code =''
PRPetty_Code=''
PRKBM_Code=''
PRKBU_Code=''
PRKAM_Code=''
PRKAU_Code=''

GLNum_PeriodFisaclYear=''
GLFiscal=''
GLAPVFiscal=''
GLAPDFiscal=''
GLARSFiscal=''
GLARCFiscal=''
GLPRFiscal=''
GLJCFiscal=''
GLICFiscal=''
GLFAFiscal=''
GLOPFiscal=''


OPCOrder=''
OP_Bill_Mat=''
OP_Bill_Lad=''
OP_Order_Inv=''
OP_Inv_Purg=''


ICTransfer=''
ICCostAdjustment=''
ICHistoryAdjustment=''
ICReceiptAdjustment=''

PONumber=''
POOutsidePONumber=''
POMiscellaneousPONumber=''

JEEstimateNumber=''

JCDFTime=''
JCDFMaterial=''
JCDFShipping=''
JCDFOutsidePurchase=''
JCDFMiscellaneous=''
JCDFReverse=''
JCDFReclassification=''
JCPJStartingJobNumber=''
JCPJReverse=''
JCPJReclassification=''
JCPJInvoice=''
JCOCustomer=''
JCOInvoicePurge=''

 OPEN '','CONTROL' TO CONTROL ELSE ERRMSG = "CONTROL FILE IS MISSING"; GOTO 1000
OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = "COMPANY FILE IS MISSING"; GOTO 1000

STATUS = RBO.getProperty('','ID',CONO)
STATUS = RBO.getProperty('','EditFlag',EDIT.MODE)
STATUS = RBO.getProperty('','CCSDivisionSecurity',DIV_SEC)
STATUS = RBO.getProperty('','CCSDivisionClosing',DIV_CLO)

*Accounts Recievable
STATUS = RBO.getProperty('','ARPrepaymentNumber',ARPrepay_Num)
STATUS = RBO.getProperty('','ARBadChecksNumber',ARCheck_Num)
STATUS = RBO.getProperty('','AROnAccountNumber',AROnAcct_Num)
STATUS = RBO.getProperty('','ARCashReconciliationReference',ARCashRef_Num)
STATUS = RBO.getProperty('','ARManualInvoicePurge',ARMan_Purge)
STATUS = RBO.getProperty('','ARManualInvoicePurge',ARMan_Purge)

*Account Payable
STATUS = RBO.getProperty('','APVoucherNumber',APVou_Num)
*SWAP @VM WITH @AM IN APVou_Num
STATUS = RBO.getProperty('','APAutoVoucher',APAutoVou_Num)
STATUS = RBO.getProperty('','APRepairNumber',APRepair_Num)
STATUS = RBO.getProperty('','APVendorNumber',APVend_Num)

*Payroll
STATUS = RBO.getProperty('','PCreditUnionCode',PRUnion_Code)
STATUS = RBO.getProperty('','PPettyCashCode',PRPetty_Code)
STATUS = RBO.getProperty('','PKBMCode',PRKBM_Code)
STATUS = RBO.getProperty('','PKBUCode',PRKBUC_Code)
STATUS = RBO.getProperty('','PKAMCode',PRKAM_Code)
STATUS = RBO.getProperty('','PKAUCode',PRKAU_Code)

*General Ledger
STATUS = RBO.getProperty('','GLNumberOfPeriodsInFiscalYear',GLNum_PeriodFisaclYear)
STATUS = RBO.getProperty('','GLFiscal',GLFiscal)
STATUS = RBO.getProperty('','GLAPVFiscal',GLAPVFiscal)
STATUS = RBO.getProperty('','GLAPDFiscal',GLAPDFiscal)
STATUS = RBO.getProperty('','GLARSFiscal',GLARSFiscal)
STATUS = RBO.getProperty('','GLARCFiscal',GLARCFiscal)
STATUS = RBO.getProperty('','GLPRFiscal',GLPRFiscal)
STATUS = RBO.getProperty('','GLJCFiscal',GLJCFiscal)
STATUS = RBO.getProperty('','GLICFiscal',GLICFiscal)
STATUS = RBO.getProperty('','GLFAFiscal',GLFAFiscal)
STATUS = RBO.getProperty('','GLOPFiscal',GLOPFiscal)

*Order Processing
STATUS = RBO.getProperty('','OPCOrder',OPCOrder)
STATUS = RBO.getProperty('','OPCBillOfMaterial',OP_Bill_Mat)
STATUS = RBO.getProperty('','OPCBillOfLading',OP_Bill_Lad)
STATUS = RBO.getProperty('','OPCOrderInvoice',OP_Order_Inv)
STATUS = RBO.getProperty('','OPCInvoicePurge',OP_Inv_Purg)

*Inventory Control
STATUS = RBO.getProperty('','ICTransfer',ICTransfer)
STATUS = RBO.getProperty('','ICCostAdjustment',ICCostAdjustment)
STATUS = RBO.getProperty('','ICHistoryAdjustment',ICHistoryAdjustment)
STATUS = RBO.getProperty('','ICReceiptAdjustment',ICReceiptAdjustment)
STATUS = RBO.getProperty('','ICBarcodeInventory',ICBarcodeInventory)

*Purchase Order
STATUS = RBO.getProperty('','PONumber',PONumber)
STATUS = RBO.getProperty('','POOutsidePONumber',POOutsidePONumber)
STATUS = RBO.getProperty('','POMiscellaneousPONumber',POMiscellaneousPONumber)

*Job Estimating/Quoting
STATUS = RBO.getProperty('','JEEstimateNumber',JEEstimateNumber)

*Job Costing & Control
STATUS = RBO.getProperty('','JCDFTime',JCDFTime)
STATUS = RBO.getProperty('','JCDFMaterial',JCDFMaterial)
STATUS = RBO.getProperty('','JCDFShipping',JCDFShipping)
STATUS = RBO.getProperty('','JCDFOutsidePurchase',JCDFOutsidePurchase)
STATUS = RBO.getProperty('','JCDFMiscellaneous',JCDFMiscellaneous)
STATUS = RBO.getProperty('','JCDFReverse',JCDFReverse)
STATUS = RBO.getProperty('','JCDFReclassification',JCDFReclassification)
STATUS = RBO.getProperty('','JCPJStartingJobNumber',JCPJStartingJobNumber)
STATUS = RBO.getProperty('','JCPJReverse',JCPJReverse)
STATUS = RBO.getProperty('','JCPJReclassification',JCPJReclassification)
STATUS = RBO.getProperty('','JCPJInvoice',JCPJInvoice)
STATUS = RBO.getProperty('','JCOCustomer',JCOCustomer)
STATUS = RBO.getProperty('','JCOInvoicePurge',JCOInvoicePurge)





SECURITY.REC<1>=DIV_SEC
SECURITY.REC<2>=DIV_CLO
  IF EDIT.MODE = 1 THEN

	 WRITE SECURITY.REC ON CONTROL, CONO:"DIV.SECURITY"
	IF ARPrepay_Num # "" THEN
		WRITE ARPrepay_Num ON CONTROL, CONO:"PPINV#"
	END 
	
	IF ARCheck_Num # "" THEN
	 	WRITE ARCheck_Num ON CONTROL, CONO:"BCINV#"
	END
	IF AROnAcct_Num # "" THEN
		WRITE AROnAcct_Num ON CONTROL, CONO:"ACINV#"
	END
	IF ARCashRef_Num # "" THEN
		WRITE ARCashRef_Num ON CONTROL, CONO:"CRREF"
	END
	IF ARMan_Purge # "" THEN
		WRITE ARMan_Purge ON CONTROL, CONO:"MANUAL.INVOICE.PURGE"
	END




	IF APVou_Num # "" THEN
		REF_NO = DCOUNT(APVou_Num,@VM)
	   FOR I=1 TO REF_NO 
		WRITEV APVou_Num<1,I> ON CONTROL, CONO:"VOUNUMBERS",I
	
	   NEXT I
	END
	IF APAutoVou_Num # "" THEN
		WRITE APAutoVou_Num ON CONTROL, CONO:"AUTOVOUCHER"
	END
	
	IF APRepair_Num # "" THEN
		WRITE APRepair_Num ON CONTROL, CONO:"REPAIR-NO"
	END
	IF APVend_Num # "" THEN
		WRITE APVend_Num ON CONTROL, CONO:"VEND"
	END 



	IF PRUnion_Code # "" THEN
		WRITE PRUnion_Code ON CONTROL, CONO:"CREDITUNION"
	END
	IF PRPetty_Code # "" THEN
		WRITE PRPetty_Code ON CONTROL, CONO:"PETTY.CASH.CODE"
	END
	IF PRKBM_Code # "" THEN
		WRITEV PRKBM_Code ON CONTROL, CONO:"401K",1
	END
	IF PRKBUC_Code # "" THEN	
		WRITEV PRKBUC_Code ON CONTROL, CONO:"401K",2
	END
	IF PRKAM_Code # "" THEN
		WRITEV PRKAM_Code ON CONTROL, CONO:"401K",3
	END

	IF PRKAU_Code # "" THEN
		WRITEV PRKAU_Code ON CONTROL, CONO:"401K",4
	END
	IF GLNum_PeriodFisaclYear # "" THEN
	 WRITE GLNum_PeriodFisaclYear ON CONTROL, CONO:"ACCT.PERIODS"
	END
	IF GLFiscal # "" THEN
		WRITE GLFiscal ON CONTROL, CONO:"FISCAL"
       	WRITE "" ON CONTROL, CONO:GLFiscal[1,4]:"GLS.TAPE"
	END
	IF GLAPVFiscal # "" THEN
		WRITE GLAPVFiscal ON CONTROL, CONO:"APVFISCAL"
	END
	IF GLAPDFiscal # "" THEN
		WRITE GLAPDFiscal ON CONTROL, CONO:"APDFISCAL"
	END

	IF GLARSFiscal # "" THEN
		WRITE GLARSFiscal ON CONTROL, CONO:"ARSFISCAL"
	END
	IF GLARCFiscal # "" THEN
		WRITE GLARCFiscal ON CONTROL, CONO:"ARCFISCAL"
	END
	IF GLPRFiscal # "" THEN
		WRITE GLPRFiscal ON CONTROL, CONO:"PRFISCAL"
	END
	IF GLJCFiscal # "" THEN
		WRITE GLJCFiscal ON CONTROL, CONO:"JCFISCAL"
	END
	IF GLICFiscal # "" THEN
		WRITE GLICFiscal ON CONTROL, CONO:"ICFISCAL"
	END
	IF GLFAFiscal # "" THEN
		WRITE GLFAFiscal ON CONTROL, CONO:"FAFISCAL"
	END
	IF GLOPFiscal # "" THEN
		WRITE GLOPFiscal ON CONTROL, CONO:"OPFISCAL"
	END


	IF OPCOrder # "" THEN
		WRITE OPCOrder ON CONTROL, CONO:"ORDER"
	END
	IF OP_Bill_Mat # "" THEN
		 WRITE OP_Bill_Mat ON CONTROL, CONO:"BOM"
	END
	IF OP_Bill_Lad # "" THEN
		 WRITE OP_Bill_Lad ON CONTROL, CONO:"DAILY.BOL"
	END
	IF OP_Order_Inv # "" THEN
		WRITE OP_Order_Inv ON CONTROL, CONO:"NEXT.INVOICE.NO"
	END
	IF OP_Inv_Purg # "" THEN
		WRITE OP_Inv_Purg ON CONTROL, CONO:"ORDER.INVOICE.PURGE"
	END



	IF ICTransfer # "" THEN
		 WRITE ICTransfer ON CONTROL, CONO:"TRANSFER"
	END
	IF ICCostAdjustment # "" THEN
		 WRITE ICCostAdjustment ON CONTROL, CONO:"INV.COST.ADJ"
	END
	IF ICHistoryAdjustment # "" THEN
		WRITE ICHistoryAdjustment ON CONTROL, CONO:"INV.ADJ.HIST"
	END
	IF ICReceiptAdjustment # "" THEN
		WRITE ICReceiptAdjustment ON CONTROL, CONO:"INV.REC.ADJ"
	END
	IF ICBarcodeInventory # "" THEN
		WRITE ICBarcodeInventory ON CONTROL, CONO:"BARCODE.INV.SEQ"
	END


	IF PONumber # "" THEN
		 WRITE PONumber ON CONTROL, CONO:"POCODE"
	END
	IF POOutsidePONumber # "" THEN
		 WRITE POOutsidePONumber ON CONTROL, CONO:"OPOCODE"
	END
	IF POMiscellaneousPONumber # "" THEN
		 WRITE POMiscellaneousPONumber ON CONTROL, CONO:"MPOCODE"	
	END
	IF JEEstimateNumber # "" THEN
		 WRITE JEEstimateNumber ON CONTROL, CONO:"EST.SEQ.NUM"
	END
	IF JCDFTime # "" THEN
		WRITE JCDFTime ON CONTROL, CONO:"DAILY.TIME"
	END
	IF JCDFMaterial # "" THEN
		 WRITE JCDFMaterial ON CONTROL, CONO:"DAILY.MATL"
	END
	IF JCDFShipping # "" THEN
		WRITE JCDFShipping ON CONTROL, CONO:"DAILY.SHIP"
	END
	IF JCDFOutsidePurchase # "" THEN
		WRITE JCDFOutsidePurchase ON CONTROL, CONO:"DAILY.OSP"
	END
	IF JCDFMiscellaneous # "" THEN
		 WRITE JCDFMiscellaneous ON CONTROL, CONO:"DAILY.MISC"
	END
	IF JCDFReverse # "" THEN
		 WRITE JCDFReverse ON CONTROL, CONO:"DAILY.REVERSE"
	END
	IF JCDFReclassification # "" THEN
		WRITE JCDFReclassification ON CONTROL, CONO:"DAILY.RCLS"	
	END
	IF JCPJReverse # "" THEN
		 WRITE JCPJReverse ON CONTROL, CONO:"JOB.REVERSE"
	END
	IF JCPJReclassification # "" THEN
		WRITE JCPJReclassification ON CONTROL, CONO:"JOB.RCLS"
	END
	IF JCPJInvoice # "" THEN
		 WRITE JCPJInvoice ON CONTROL, CONO:"NEXT.INVOICE.NO"
	END
	IF JCOCustomer # "" THEN
		 WRITE JCOCustomer ON CONTROL, CONO:"CUSTOMER"
	END
	IF JCOInvoicePurge # "" THEN
		 WRITE JCOInvoicePurge ON CONTROL, CONO:"INVOICE.PURGE"
	END
	IF JCPJStartingJobNumber # "" THEN
		WRITE JCPJStartingJobNumber ON CONTROL, CONO:"JOBNO"
	END
  END 
* End of method code
RETURN

1000*
STATUS = RBO.setProperty('','ServerStatus',1)        
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN

