SUBROUTINE PQUEM_WRITE_AND_TEST
********************************************************************************
*   Program name :- PQUEM_WRITE_AND_TEST
*   Created:- 5/26/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

* Insert method code here
$INCLUDE PMC.CPYLIB PMC_PRINTERS
$INCLUDE CPYLIB CHAR
* Insert method code here

* Insert method code here
ERRMSG = ""
OPEN '','PMC_PRINTERS' TO PMC_PRINTERS ELSE ERRMSG = "PMC_PRINTERS FILE IS MISSING"; GOTO 1000
OPEN '','CONTROL' TO CONTROL ELSE ERRMSG = "CONTROL FILE IS MISSING"; GOTO 1000

*MATREAD PRTRS.REC ON PMC_PRINTERS,PRTRS_KEY ELSE MAT PRTRS.REC = "";

STATUS = RBO.getProperty('', 'ID', PRTRS_KEY)
STATUS = RBO.getProperty('', 'PRTRS_DESC', PRTRS_DESC)
STATUS = RBO.getProperty('', 'PRTRS_COLUMN', PRTRS_COLUMN)
STATUS = RBO.getProperty('', 'PRTRS_PATH', PRTRS_PATH)
STATUS = RBO.getProperty('', 'PRTRS_LASER', PRTRS_LASER)
STATUS = RBO.getProperty('', 'PRTRS_ORIENT', PRTRS_ORIENT)
STATUS = RBO.getProperty('', 'PRTRS_FONT', PRTRS_FONT)
STATUS = RBO.getProperty('', 'PRTRS_FONTSIZE', PRTRS_FONTSIZE)
STATUS = RBO.getProperty('', 'PRTRS_TOP', PRTRS_TOP)
STATUS = RBO.getProperty('', 'PRTRS_BOTTOM', PRTRS_BOTTOM)
PRTRS_TOP = ICONV(PRTRS_TOP,"MD2")
PRTRS_BOTTOM = ICONV(PRTRS_BOTTOM,"MD2")
STATUS = RBO.getProperty('', 'PRTRS_DEVICE', PRTRS_DEVICE)

MATWRITE PRTRS.REC ON PMC_PRINTERS,PRTRS_KEY


***   PMC_SETPTR CODE
   MATREAD PRTRS.REC FROM PMC_PRINTERS, PRTRS_KEY ELSE
      ERRMSG = "PMC PRINT QUEUE IS NOT SET IN PRIMAC"
      GOTO 1000
   END
   OS = "OS"
   OS = SYSTEM(33)
   SYS_PLATFORM = UPCASE(OS)[1,7]
   BEGIN CASE
   CASE SYS_PLATFORM = "WINDOWS"
      FORMATSTR = "Orientation=":PRTRS_ORIENT
     FORMATSTR := ",Font=":PRTRS_FONT
     FORMATSTR := ",FontSize=":PRTRS_FONTSIZE
     FORMATSTR := ",TopMargin=":PRTRS_TOP "MD2"
     FORMATSTR := ",BottomMargin=":PRTRS_BOTTOM "MD2"
*     CMD = 'SETPTR 0,132,,,,1,AT ':PRTRS_PATH:',"':FORMATSTR:'",NHEAD,BRIEF'
      CMD = "SETPTR 0," : PRTRS_COLUMN : ",,,,1"
      CMD := ',AT ':PRTRS_PATH:',"':FORMATSTR:'",NHEAD,BRIEF'
   CASE SYS_PLATFORM = "UNIX"
      CMD = "SETPTR ," : PRTRS_COLUMN : ",,,,1"
      CMD := ',NHEAD,BRIEF,DEST ':PRTRS_PATH:',NOMESSAGE'
   CASE 1
   END CASE      
   EXECUTE CMD CAPTURING JUNK

    IF ERRMSG # "" THEN
      GOSUB 1000
    END ELSE
      LINE = STR("-",80)
      LINE<2> = "   Printer Alias  : ":PRTRS_KEY
      LINE<3> = STR("-",80)
      LINE<4> = "   Description    : ":PRTRS_DESC
      LINE<5> = "   Characters Wide: ":PRTRS_COLUMN
      LINE<6> = "   Printer Path   : ":PRTRS_PATH
      LINE<7> = "   Device (Unix)  : ":PRTRS_DEVICE
      LINE<8> = "   Laser (Y/N)    : ":PRTRS_LASER
      LINE<9> = "   Orientation    : ":PRTRS_ORIENT
      LINE<10> = "   Font           : ":PRTRS_FONT
      LINE<11> = "   Font Size      : ":PRTRS_FONTSIZE
      LINE<12> = "   Top Margin     : ":PRTRS_TOP "MD2"
      LINE<13> = "   Bottom Margin  : ":PRTRS_BOTTOM "MD2"
      LINE<14> = STR("-",80)
      PRINTER ON
      FOR I = 1 TO 14
          PRINT LINE<I>
      NEXT I
      PRINTER OFF
      PRINTER CLOSE
      MORE = 1
   END

1000*
     STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)
RETURN
* End of method code


