SUBROUTINE JOBM_GET_TOT_ALLOC_QTY
********************************************************************************
*   Program name :- JOBM_GET_TOT_ALLOC_QTY
*   Created:- 9/8/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB FNGD.STATS
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE ICS.CPYLIB INV.CNV
* Insert method code here

OPEN "","FNGD.STATS" TO FNGD.STATS ELSE
       ERRMSG = "FNGD.STATS"
	GOTO 99999
END
OPEN "","INVENTORY" TO INVENTORY ELSE
       ERRMSG = "FNGD.STATS"
	GOTO 99999
END
STATUS=RBO.getProperty('','ID',ID);*JOB NUM
STATUS=RBO.getProperty('','JOB_RESV_MATL',JOB.RESV.MATL);*PROD-ID
STATUS=RBO.getProperty('','JOB_RESV_WHSE',JOB.RESV.WHSE);*WHSE CODE
STATUS=RBO.getProperty('','JFS_A_QTY',JFS_A_QTY);*FOR FNGD
CONO = ID[1,3]

IWH.ID = CONO : JOB.RESV.MATL : '!' : JOB.RESV.WHSE

* get database values
MATREAD INV.REC FROM INVENTORY,CONO:JOB.RESV.MATL ELSE
	MAT INV.REC = ''
END

$INCLUDE ICSBP INV.UM.CNV

MATREAD FGS.REC FROM FNGD.STATS, IWH.ID ELSE
	MAT FGS.REC = ""
END

JFS_A_QTY = ICONV(((JFS_A_QTY/ICR.MT1)*ICR.DV1)*ICR.DV2+.5,ICR.CNV);*INT(((JFS_A_QTY/ICR.MT1)*ICR.DV1)*ICR.DV2+.5)

TOT.ALOC = SUM(FGS.B.QTY) + JFS_A_QTY

STATUS = RBO.setProperty('','JFS_BAL',TOT.ALOC)

99999
IF ERRMSG # "" THEN
	STATUS = RBO.setProperty('','ServerStatus','1')
	STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
END ELSE
	STATUS = RBO.setProperty('','ServerStatus','')
END
RETURN

