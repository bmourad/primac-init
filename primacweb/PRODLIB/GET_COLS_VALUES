SUBROUTINE GET_COLS_VALUES
********************************************************************************
*   Program name :- 
*   Created:- 2/19/2004
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE CPYLIB CHAR
$INCLUDE PMC.CPYLIB COUNTRY.CODE
* T25159 INCLUDE PMC.CPYLIB COUNTRY.CODE, since the
*                         COUNTRY.CODE file can hold multiple attributes
*                         of data.
* Insert method code here
ERRMSG      = ''
COLS_VALUES = ""
ERR 	     = RBO.getProperty('','FILE_NAME',FILE.NAME) ;* NAME OF THE FILE...Its Sent From ASP
ERR 	     = RBO.getProperty('','ID',ID) ;* CONO:ID...Its Sent From ASP..Its Not Of the Dict File
ERR 	     = RBO.getProperty('','COLS',COLS) ;* COL. POSITION

	OPEN "",FILE.NAME TO C.FILE ELSE
		ERRMSG = "UNABLE TO OPEN " : FILE.NAME : " FILE"
		GOTO 93000
	END
   	OPEN '',"COUNTRY.CODE" TO COUNTRY.CODE ELSE
      		ERRMSG = "Cannot locate the COUNTRY.CODE file"
		 GOTO 93000
   	END

	FOR I = 1 TO DCOUNT(COLS,VM)
		READV VAL FROM C.FILE,ID,COLS<1,I> THEN
			COLS_VALUES = COLS_VALUES : "~" : VAL
		END ELSE				
			ERRMSG = "INVALID ID TRY AGAIN!"
			GOTO 93000
		END
	NEXT I
	READV SVAL FROM C.FILE,ID,46 THEN 
		SHIP.TO.CNTY = SVAL<1,4>
	END ELSE
		SHIP.TO.CNTY	= ''
	END
*T25159 v
	MATREAD CTY.REC FROM COUNTRY.CODE, ID[1,3]:SHIP.TO.CNTY ELSE MAT CTY.REC = ''
   	SHIP.TO.CNTY = CTY.DESC
*T25159 ^
	COLS_VALUES = COLS_VALUES[2,LEN(COLS_VALUES)]
*T25159 v
       COLS_VALUES = COLS_VALUES : "~" : SHIP.TO.CNTY
*T25159 ^
	ERR = RBO.setProperty('','COLS',COLS_VALUES) ;* NAME OF THE FILE

93000*
	IF ERRMSG # "" THEN
		STATUS = RBO.setProperty('','ServerStatus','1')
		STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
	END ELSE
		STATUS = RBO.setProperty('','ServerStatus','')
		STATUS = RBO.setProperty('','ServerMessage','')
	END
* End of method code
RETURN


