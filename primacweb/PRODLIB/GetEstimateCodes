SUBROUTINE GetEstimateCodes
********************************************************************************
*   Program name :- GetEstimateCodes
*   Created:- 5/11/2005
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JES.CPYLIB ESTIMATE
$INCLUDE CPYLIB CHAR
* Insert method code here
ERRMSG=''
  OPEN '','ESTIMATE' TO ESTIMATE ELSE ERRMSG='ESTIMATE FILE IS MISSING'; GOTO 93000

STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
CONO   = PMCProperty<1,4>
* Insert method code here
EST_LIST = ""
EST_STATUS = ""
ESTMAST = ""

CMD1 = "SSELECT ESTIMATE WITH CONO = '" : CONO : "'"
UDTEXECUTE CMD1
KK = 1
EOF = 1
LOOP
	READNEXT ID ELSE EOF = 0		
WHILE EOF DO
	EST_LIST<1,-1> =ID[4,99] 	
REPEAT

COUNT=DCOUNT(EST_LIST,VM)
FOR I= 1 TO COUNT
   MATREAD EST.REC FROM ESTIMATE,CONO:EST_LIST<1,I> THEN
       EST_STATUS<1,I>=EST.STATUS
       ESTMAST<1,I>=EST.MASTER
   END 
NEXT I

	STATUS=RBO.setProperty('','EST_LIST',EST_LIST)
       STATUS=RBO.setProperty('','EST_STAT',EST_STATUS)
       STATUS=RBO.setProperty('','ESTMAST',ESTMAST)
RETURN


93000 *
	STATUS=RBO.setProperty('','ServerStatus',1)
	STATUS=RBO.setProperty('','ServerMessage',ERRMSG)
RETURN


