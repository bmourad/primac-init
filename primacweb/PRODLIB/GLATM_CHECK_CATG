  SUBROUTINE GLATM_CHECK_CATG
*********************************************************************
*
* REVISION - [12.0]
*
* PROGRAM  - GLATM_CHECK_CATG
*
* AUTHOR   - ALEJANDRO DELGADO
*
* DATE     - 01/02/2003
*
* DESCRIPTION
*
* The program builds the RBO string for Account Type Maintenance.
*
*********************************************************************
*
*---- FILE COPY STATEMENTS
*
  $INCLUDE WWINSERT RBO.H
  $INCLUDE GLS.CPYLIB ACCT.CATG
  $INCLUDE CPYLIB CHAR
  $INCLUDE CPYLIB FILE.VARS
*
**** OPEN FILES
*
  IF FILEINFO(ACCT.CATG,0) = 0 THEN
    OPEN '','ACCT.CATG' TO ACCT.CATG ELSE
      ERRMSG = 'Cannot open ACCT.CATG file!'
      GOTO SET.ERROR
    END
  END
*
*---- INITIALIZATION
*
  ERRMSG = RBO.getProperty('','ID',ID)
  ERRMSG = RBO.getProperty('','ACCT_CATG',ACCT.ID)
  CONO = ID[1,3]
  TYPE.ID = TRIM(ID[4,99])
  *
  MATREAD AC.REC FROM ACCT.CATG, ACCT.ID ELSE
    MAT AC.REC = ''
    AC.DESC = 'UNKNOWN'
  END
  IF AC.TYPE # '' AND AC.TYPE # TYPE.ID THEN
    ERRMSG = 'THIS CATEGORY IS FOR TYPE ':AC.TYPE
    GOTO SET.ERROR
  END
*
  STATUS = RBO.setProperty('','ACCT_TYPE',AC.TYPE)
  RETURN
*
SET.ERROR: 
*
  STATUS = RBO.setProperty('','ServerStatus',1)
  STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
  RETURN
END
