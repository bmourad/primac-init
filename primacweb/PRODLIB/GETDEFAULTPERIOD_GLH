SUBROUTINE GETDEFAULTPERIOD_GLH
********************************************************************************
*   Program name :- GETDEFAULTPERIOD_GLH
*   Created:- BY YAKUB ON 2/23/2006

*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB FISCAL
* Insert method code here
ERRMSG = ""
   OPEN '','CONTROL' TO CONTROL ELSE
      ERRMSG = 'Cannot open Control file!'
      GOTO 1000
   END
PERIOD.DEFAULT=''
CONO=''
STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
CONO = PMCProperty<1,4>


*WRITE "U R HERE" ON CONTROL ,"01PR"
MATREAD FISCAL.REC FROM CONTROL , CONO:"FISCAL" ELSE
      ERRMSG = "CONTROL FISCAL IS NOT ON FILE";GOTO 1000
END
 READ NUM.PERIODS FROM CONTROL,CONO:"ACCT.PERIODS" ELSE
      NUM.PERIODS = 12
   END
*T26619 ^
   READV ALL.DIV FROM CONTROL , CONO:"DIVISIONS" , 1 ELSE ALL.DIV = "01"
   DIV.CNT = DCOUNT(ALL.DIV,@VM)
YEAR = FR.CURR.PER[1,4]
CURR = FR.CURR.PER[5,2]
PERIOD.DEFAULT=FR.CURR.PER
STATUS = RBO.setProperty('','PERIOD_DEFAULT',PERIOD.DEFAULT)
STATUS = RBO.setProperty('','NUM_PERIODS',NUM.PERIODS)
STATUS = RBO.setProperty('','PERIOD_YEAR',YEAR)
STATUS = RBO.setProperty('','CURR',CURR)




* End of method code
RETURN

1000
STATUS = RBO.setProperty('','ServerStatus',1)        
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
99999
RETURN


