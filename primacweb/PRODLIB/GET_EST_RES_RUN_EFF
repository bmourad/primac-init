SUBROUTINE GET_EST_RES_RUN_EFF
********************************************************************************
*   Program name :- GET_EST_RES_RUN_EFF
*   Created:- 5/13/2005
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JES.CPYLIB ESTIMATE.RUN.EFF
* Insert method code here

ERRMSG = ""
OPEN "","ESTIMATE.RES.RUN.EFF" TO ESTIMATE.RES.RUN.EFF ELSE ERRMSG = "CANNOT OPEN ESTIMATE.RES.RUN.EFF FILE"; GOTO 90000

*MATREAD REFF.REC FROM ESTIMATE.RES.RUN.EFF, CONO:S$VALUE ELSE
*    ERRMSG = "Cannot locate run efficiency table. Try again! "
*        GOSUB 90000
*        GOTO 100
*END

STATUS = RBO.getProperty('','PMCProperty',PMCProperty) 
CONO   = PMCProperty<1,4>

CMD = "SSELECT ESTIMATE.RES.RUN.EFF WITH CONO = '" : CONO : "'"
UDTEXECUTE CMD
ID = ''
DATA = 1
K = 1
* looping thro entire file getting the ID<>reading the entire ID until data = 0
LOOP
    READNEXT CODE ELSE DATA = 0
WHILE DATA
    ID<1,K> = CODE[4,99]
    K += 1
* ID<1,-1> adds at last automatically everytim
REPEAT

STATUS = RBO.setProperty('','EquipCodes',ID)
RETURN
* End of method code

90000*
STATUS = RBO.setProperty('',ServerStatus,1)
STATUS = RBO.setProperty('',ServerMessage,ERRMSG)
RETURN

