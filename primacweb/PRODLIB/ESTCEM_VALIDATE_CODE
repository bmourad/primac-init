SUBROUTINE ESTCEM_VALIDATE_CODE
********************************************************************************
*   Program name :- ESTCEM_VALIDATE_CODE
*   Created:- 6/9/2005
*   Written by   :- Ramakrishna Pusuluri
*------------------------------------------------------------------------------*
*
* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

$INCLUDE JCS.CPYLIB CATEGORY.OSP
$INCLUDE PMC.CPYLIB SHIP.VIA

   OPEN '','CATEGORY.OSP' TO CATEGORY.OSP ELSE 
	ERRMSG = 'Cannot open CATEGORY.OSP file!'
	GOTO 9999
   END

   OPEN '','SHIP.VIA' TO SHIP.VIA ELSE 
	ERRMSG = 'Cannot open SHIP.VIA file!'
	GOTO 9999
   END


  	ERR = RBO.getProperty('','DREFCREF',VALUECONTENT)
 	ERR = RBO.getProperty('','PMCProperty',PMCProperty)


ESTDEPTINFO 	= ""
ERRMSG		= ""

	CONO          = PMCProperty<1,4>
	TEMP.TYPE	= FIELD(VALUECONTENT,"^",1)
	QUOTE         = FIELD(VALUECONTENT,"^",2)

	BEGIN CASE	
	      CASE TEMP.TYPE[1,1]="P"		 
		 MATREAD CAOS.REC FROM CATEGORY.OSP,CONO:QUOTE ELSE
		    ERRMSG="Invalid O/P category code. Try again! "
		    GOTO 9999
		 END

		 TEMP.IND.1=CAOS.FOH.PCT
		 TEMP.MARKUP=CAOS.MARKUP
		 TEMP.DESC=CAOS.DESC

		 ESTDEPTINFO = TEMP.IND.1:"^":TEMP.MARKUP :"^": TEMP.DESC
	      CASE TEMP.TYPE[1,1]="S"

		 MATREAD SHIP.VIA.REC FROM SHIP.VIA,CONO:QUOTE ELSE
		    ERRMSG="Invalid carrier ID. Try again! "
		    GOTO 9999
		 END

		 TEMP.DESC=SHPV.DESC
		ESTDEPTINFO = TEMP.DESC
	END CASE
STATUS = RBO.setProperty('', 'ESTDEPTINFO', ESTDEPTINFO)
9999*	
	IF ERRMSG # "" THEN
	      	STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)	   
	END
RETURN

