SUBROUTINE FGRM_PREWRITE
*********************************************************************
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - EPRIMAC
* PROGRAM     - FGRM_PREWRITE
* BY          - KHAJA ZIAUDDIN
* DATE        - 07/09/2003  (mm/dd/yyyy)
* DESCRIPTION   This program the cost qty
*		   
*ENDDOC
*************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INV.CNV
$INCLUDE ICS.CPYLIB INVENTORY

DEFFUN CALC_COST_QTY(STK.QTY,MAT INV.CNV.REC,ROND,LN)
VAL1 = ''
VAL2 = ''
OPEN '','INVENTORY' TO INVENTORY ELSE ERRMSG = 'INVENTORY FILE IS MISSING';   GOTO 93000

STATUS = RBO.getDBVals('DFR_PROD',PROD)
STATUS = RBO.getDBVals('DFR_TOT_SQTY',TOTSQTY)
STATUS = RBO.getDBVals('DFR_SQTY',SQTY)
STATUS = RBO.getProperty('','PMCProperty',PMCPROPERTY)
CONO = PMCPROPERTY<1,4>

MATREAD INV.REC FROM INVENTORY, CONO:PROD ELSE MAT INV.REC = ""
$INCLUDE ICSBP INV.UM.CNV

VAL1 = CALC_COST_QTY(TOTSQTY, MAT INV.CNV.REC,'.5','')

FOR X = 1 TO DCOUNT(SQTY,@VM)
   VAL2<1,X> = CALC_COST_QTY(SQTY<1,X>, MAT INV.CNV.REC,'.5','')
NEXT

STATUS = RBO.setDBVals('DFR_TOT_QTY', VAL1)
STATUS = RBO.setDBVals('DFR_QTY', VAL2)

RETURN

93000
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN



