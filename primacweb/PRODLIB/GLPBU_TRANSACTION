SUBROUTINE GLPBU_TRANSACTION
********************************************************************************
*   Program name :- GLPBU_TRANSACTION
*   Created:- 3/10/2006
*   Auther :- Sk. Zahoor Ahmed
*   DESCRIPTION -
*   This program selects Transaction from FILE.NAME (GLA 0r GLM)
*                 In Properties must be :
*                                      1- CONO
*                                      2- SEELCT QUERY
*                                      3- FILE NAME 
  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE GLS.CPYLIB>GLA
$INCLUDE GLS.CPYLIB>GLM
   STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
   STATUS = RBO.getProperty('','FILE_NAME',FILE.NAME)
   STATUS = RBO.getProperty('','SELECTCMD',SELECTCMD)
   CONO = PMCProperty<1,4>
   USER.ID = UPCASE(PMCProperty<1,3>)
   ERRMSG = ''
*
**** OPEN FILE
*
ERRMSG = ''
ERRMSG = SELECTCMD
  OPEN '','CONTROL' TO CONTROL ELSE
      ERRMSG = 'Cannot open CONTROL file!'
      GOTO 93000
   END
   OPEN '','VOC' TO F.VOC ELSE
      ERRMSG = 'Cannot open VOC file!'
      GOTO 93000
   END
     OPEN "",FILE.NAME TO F.NAME ELSE 
        ERRMSG = FILE.NAME :" IS MISSING"
        GOTO 93000
     END
    OPEN "",'GLR' TO GLR ELSE 
        ERRMSG = "GLR FILE IS MISSING"
        GOTO 93000
     END
*
****BUILD PROC
*
   PORT_NO = "TTY"
   CALL SYSVARS.SUB(PORT_NO)
UDTEXECUTE SELECTCMD CAPTURING PROCMESG
DATA = 1
LOOP
WHILE DATA DO
      READNEXT GLR.ID ELSE DATA = 0
      MATREAD GLA.REC FROM F.NAME, GLR.ID THEN
         MATWRITE GLA.REC ON GLR, GLR.ID
      END
   REPEAT
**** END OF JOB
93000 *
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
END


