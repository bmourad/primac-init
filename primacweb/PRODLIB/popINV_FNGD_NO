SUBROUTINE popINV_FNGD_NO
********************************************************************************
*   Program name :- popINV_FNGD_NO
*   Created:- 5/29/2003  
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE CPYLIB CHAR
* Insert method code here
ERRMSG = ''
  OPEN "","INVENTORY" TO INVENTORY ELSE
    ERRMSG = "CANNOT OPEN INVENTORY FILE"
    GOTO 93000
  END
INVENTORY.CODES.LIST=""
INVENTORY.ID.LIST = ""
INVENTORY.DESCS.LIST =""
INVENTORY.CUST_INV.LIST =""
STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
CONO=PMCProperty<1,4>

CMD = "SSELECT INVENTORY WITH  CONO = '" : CONO : "' AND WITH INV_M_LINE = 'FNGD'"
UDTEXECUTE CMD

LOOP
	EOF = 1
	READNEXT INVENTORY.ID ELSE EOF = 0
WHILE EOF DO
		MATREAD INV.REC FROM INVENTORY,INVENTORY.ID THEN
			IF INV.M.LINE = "FNGD" THEN
				INVENTORY.CODES.LIST<1,-1> = INVENTORY.ID[4,99]
				INVENTORY.DESCS.LIST<1,-1> = INVENTORY.ID[4,99]:"_":INV.DESC
				INVENTORY.CUST_INV.LIST<1,-1> = INV.CUST:"_":INVENTORY.ID[4,99]
			END
			
		END
REPEAT

   STATUS = RBO.setProperty('', 'INV_FNGD_NO', INVENTORY.CODES.LIST)
   STATUS = RBO.setProperty('', 'INV_FNGD_DESC', INVENTORY.DESCS.LIST)
   STATUS = RBO.setProperty('', 'CUST_INV_CODE', INVENTORY.CUST_INV.LIST)
RETURN

93000*
   STATUS = RBO.setProperty('', 'ServerStatus',1)
   STATUS = RBO.setProperty('', 'ServerMessage',ERRMSG)
* End of method code
RETURN

