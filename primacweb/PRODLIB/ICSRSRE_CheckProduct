SUBROUTINE ICSRSRE_CheckProduct
********************************************************************************
*   Program name :  ICSRSRE_CheckProduct
*   Programmer name :- P.V.B.V.S.RAMAKRISHNA
*   Created:- 3/29/2005
*------------------------------------------------------------------------------*
*

* In Properties: ProductID
* --------------
*  
*
* Out Properties: ProdReview
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE ICS.CPYLIB CATEGORY

OPEN '','INVENTORY' TO INVENTORY ELSE 
	ERRMSG = 'INVENTORY FILE IS MISSING'; GOTO 91000
END
OPEN "","CATEGORY" TO CATEGORY ELSE
      ERRMSG = "CATEGORY FILE IS MISSING"; GOTO 91000
END


STATUS = RBO.getProperty('','PMCProperty',PMCPROPERTY)
STATUS = RBO.getProperty('','ProductID',ProductID)


CONO = PMCPROPERTY<1,4>

   MATREAD INV.REC FROM INVENTORY,CONO:ProductID ELSE
      ERRMSG='Invalid Product ID'
      GOTO 91000
   END
*T27902 v
   MATREAD CATG.REC FROM CATEGORY,CONO:INV.LINE ELSE MAT CATG.REC = ""
   IF CATG.TRK.LVL # "S" THEN
      ERRMSG='Product is not serially tracked - use Regular Stock Receipts.'
      GOTO 91000
   END
   IF CATG.INV="" OR CATG.ACCRU.LIAB="" OR CATG.AP.ACCT="" THEN
      ERRMSG="ACCOUNT DETAILS NOT SET UP FOR PRODUCT LINE '":INV.LINE:"'"
      GOTO 91000
   END
   IF INV.M.LINE="FNGD" THEN
      ERRMSG="FINISHED GOODS INVENTORY CAN'T BE RECEIVED"
      GOTO 91000
   END

    ProdReview = ProductID:" , ":INV.FULL.DESC:" , ":INV.PAP.TYPE
    WarehouseID = INV.WHSE.CODE<1,1>
   
    FOR I = 2 TO DCOUNT(INV.WHSE.CODE,@VM)
      WarehouseID := ',':INV.WHSE.CODE<1,I>   
    NEXT I

    OrderingUM = INV.UNIT<1,1>

    IF INV.UNIT<1,1> # INV.UNIT<1,2> THEN
      OrderingUM=OrderingUM:',':INV.UNIT<1,2>
    END
    IF INV.UNIT<1,1> # INV.UNIT<1,3> THEN
      OrderingUM=OrderingUM:',':INV.UNIT<1,3>
    END


 	STATUS = RBO.setProperty("","ProdReview",ProdReview)
	STATUS = RBO.setProperty("","WarehouseID",WarehouseID)
	STATUS = RBO.setProperty("","OrderingUM",OrderingUM)
IF ERRMSG # "" THEN
	STATUS = RBO.setProperty("","ServerStatus",1)
	STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
END

RETURN

91000*  
	STATUS = RBO.setProperty("","ServerStatus",1)
	STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
RETURN




