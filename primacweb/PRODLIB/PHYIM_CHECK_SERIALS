SUBROUTINE PHYIM_CHECK_SERIALS
********************************************************************************
*   Program name :- PHYIM_CHECK_SERIALS
*   Created:- 6/6/2006
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INV_SERIAL
$INCLUDE CPYLIB CHAR

OPEN "","INV_SERIAL" TO INV_SERIAL ELSE ERRMSG = "CANNOT OPEN INV_SERIAL FILE";GOTO 91000
OPEN "","INV_SERIAL_DELETED" TO INV_SERIAL_DELETED ELSE ERRMSG = "CANNOT OPEN INV_SERIAL_DELETED FILE";GOTO 91000

* Insert method code here
STATUS = RBO.getProperty("","PMCProperty",PMCProperty)
STATUS = RBO.getProperty("","INARR",PHYSI.SERIAL)
CONO = PMCProperty<1,4>
RET_VALUE = ""
   FOR N = 1 TO DCOUNT(PHYSI.SERIAL,VM)
      IF PHYSI.SERIAL<1,N> # "" THEN 
         MATREAD ISTK.REC FROM INV_SERIAL, CONO:PHYSI.SERIAL<1,N> ELSE
            MATREAD ISTK.REC FROM INV_SERIAL_DELETED,CONO:PHYSI.SERIAL<1,N> ELSE
               RET_VALUE<1,N> = "RO"
            END
         END
      END
   NEXT
   STATUS = RBO.setProperty("","RET_VALUE",RET_VALUE)
RETURN

* End of method code
91000*
   STATUS = RBO.setProperty("","ServerStatus",1)
   STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
RETURN

