SUBROUTINE getEstPressIDs
********************************************************************************
*   Program name :- getEstPressIDs

*   Created:- 6/7/2003

*   Author:- Irfan M Saleem	

*  this method gets the valid pressids,GATHERER,TRIMMER,STICHER,BINDER,folder frm equipment file
********************************************************************************
*---- FILE COPY STATEMENTS
*
  $INCLUDE WWINSERT RBO.H
  $INCLUDE JES.CPYLIB EQUIPMENT
  $INCLUDE PMC.CPYLIB COST.CNTR

ERRMSG = ""
**** OPEN FILES
*
IF FILEINFO(EQUIPMENT,0) = 0 THEN
   OPEN '','EQUIPMENT' TO EQUIPMENT ELSE
     ERRMSG = 'Cannot open EQUIPMENT file!'
      GOTO SET.ERROR
    END
END
IF FILEINFO(COST.CNTR,0) = 0 THEN
   OPEN '','COST.CNTR' TO COST.CNTR ELSE
     ERRMSG = 'Cannot open COST.CNTR file!'
      GOTO SET.ERROR
    END
END
*---- INITIALIZATION
*
DESC=''
PRESSID=''
DESCPRESS=''
STICHID=''
STITCHDESC=''
BINDID=''
BINDDESC=''
GATHERERID=''
GATHERDESC=''
TRIMMID=''
TRIMMDESC=''
FOLDDESC=''
FOLDID=''
CUTDESC=''
CUTID=''
CaseStampID =""
CaseStampDescs=""
CaseINID=""
CaseINIDDescs=""
CMAKERID=""
CMAKERDESC=""
SPOILAGEIDS=""
EQPPRESSTYPE=""
ETYPE=""
EQPPRESSWEBCNT=''
PRESSCODE=''
PDESC=''

STATUS  = RBO.getProperty('','PMCProperty',PMCProperty)
CONO    = PMCProperty<1,4>

CMD = "SSELECT EQUIPMENT WITH CONO = '" : CONO : "'"
UDTEXECUTE CMD

DATA = 1
S=1
A=1
CS=1
CIN=1
LOOP
    READNEXT CODE ELSE DATA = 0
WHILE DATA DO
	MATREAD EQUIPMENT.REC FROM EQUIPMENT,CODE THEN 
	   ETYPE =EQP.TYPE
	   IF ETYPE ='01' THEN
		READV DESCPRESS FROM COST.CNTR,CODE,1 THEN 
			PRESSID<1,S> = CODE[4,99]
			DESC<1,S> = CODE[4,99] : " " :DESCPRESS
			PDESC<1,S> = DESCPRESS
			SPOILAGEIDS<1,S> = EQP.PRESS.RUN.SPOIL
			EQPPRESSTYPE<1,S> =EQP.PRESS.TYPE	
			EQPPRESSWEBCNT<1,S> =EQP.PRESS.WEB.CNT
			PRESSCODE<1,S> =LOWER(EQP.PRESS.DC.CODE)

		END
	     S=S+1
	   END	
	
  	  ELSE IF ETYPE ='08' THEN
		READV DESCPRESS FROM COST.CNTR,CODE,1 THEN 
			STICHID<1,-1> = CODE[4,99]
			STITCHDESC<1,-1> = CODE[4,99] : " " :DESCPRESS
		END
	   END	
	  ELSE IF ETYPE ='10' THEN
		READV DESCPRESS FROM COST.CNTR,CODE,1 THEN 
			BINDID<1,-1> = CODE[4,99]
			BINDDESC<1,-1> = CODE[4,99] : " " :DESCPRESS
		END
	   END	
	  ELSE IF ETYPE ='22' THEN
		READV DESCPRESS FROM COST.CNTR,CODE,1 THEN 
			GATHERERID<1,-1> = CODE[4,99]
			GATHERDESC<1,-1> = CODE[4,99] : " " :DESCPRESS
		END
	   END	
 	  ELSE IF ETYPE ='24' THEN
		READV DESCPRESS FROM COST.CNTR,CODE,1 THEN 
			TRIMMID<1,-1> = CODE[4,99]
			TRIMMDESC<1,-1> = CODE[4,99] : " " :DESCPRESS
		END
	  END	
 	  ELSE IF ETYPE ='06' THEN
		READV DESCPRESS FROM COST.CNTR,CODE,1 THEN 
			FOLDID<1,-1> = CODE[4,99]
			FOLDDESC<1,-1> = CODE[4,99] : " " :DESCPRESS
		END
	  END	
  	  ELSE IF ETYPE ='04' THEN
		READV DESCPRESS FROM COST.CNTR,CODE,1 THEN 
			CUTID<1,-1> = CODE[4,99]
			CUTDESC<1,-1> = CODE[4,99] : " " :DESCPRESS
		END
	  END	
	  ELSE IF ETYPE ='26' THEN
		READV DESCPRESS FROM COST.CNTR,CODE,1 THEN 
			CMAKERID<1,A> = CODE[4,99]
			CMAKERDESC<1,A> = CODE[4,99] : " " :DESCPRESS
			A=A+1
		END

	  END
         ELSE IF ETYPE ='28' THEN
		READV DESCPRESS FROM COST.CNTR,CODE,1 THEN 
			CaseStampID<1,CS> = CODE[4,99]
			CaseStampDescs<1,CS> = CODE[4,99] : " " :DESCPRESS
			CS=CS+1
		END
	  END
         ELSE IF ETYPE ='30' THEN
		READV DESCPRESS FROM COST.CNTR,CODE,1 THEN 
			CaseINID<1,CIN> = CODE[4,99]
			CaseINIDDescs<1,CIN> = CODE[4,99] : " " :DESCPRESS
			CIN=CIN+1
		END
	  END

	END
REPEAT

STATUS = RBO.setProperty('', 'PressID', PRESSID)
STATUS = RBO.setProperty('', 'PressDescs', DESC)
STATUS = RBO.setProperty('', 'PDescs', PDESC)
STATUS = RBO.setProperty('', 'PressCode', PRESSCODE)

STATUS = RBO.setProperty('', 'SPOILAGEIDS', SPOILAGEIDS)
STATUS = RBO.setProperty('', 'EQPPRESSTYPE', EQPPRESSTYPE)
STATUS = RBO.setProperty('', 'EQPPRESSWEBCNT', EQPPRESSWEBCNT)
STATUS = RBO.setProperty('', 'StichID', STICHID)
STATUS = RBO.setProperty('', 'StichDescs', STITCHDESC)
STATUS = RBO.setProperty('', 'BindID', BINDID)
STATUS = RBO.setProperty('', 'BindDescs', BINDDESC)
STATUS = RBO.setProperty('', 'GatherID', GATHERERID)
STATUS = RBO.setProperty('', 'GatherDescs', GATHERDESC)
STATUS = RBO.setProperty('', 'TrimID', TRIMMID)
STATUS = RBO.setProperty('', 'TrimDescs', TRIMMDESC)
STATUS = RBO.setProperty('', 'FoldID', FOLDID)
STATUS = RBO.setProperty('', 'FoldDescs', FOLDDESC)
STATUS = RBO.setProperty('', 'CutID', CUTID)
STATUS = RBO.setProperty('', 'CutDescs', CUTDESC)
STATUS = RBO.setProperty('', 'CaseID', CMAKERID)
STATUS = RBO.setProperty('', 'CaseDescs', CMAKERDESC)
STATUS = RBO.setProperty('', 'CaseStampID', CaseStampID)
STATUS = RBO.setProperty('', 'CaseStampDescs', CaseStampDescs)
STATUS = RBO.setProperty('', 'CaseINID', CaseINID)
STATUS = RBO.setProperty('', 'CaseINIDDescs', CaseINIDDescs)


SET.ERROR:
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)

