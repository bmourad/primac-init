SUBROUTINE ESTRLM_Inv_Validate
********************************************************************************
*   Program name :- ESTRLM_Inv_Validate
*   Created:- 10/1/2005
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

* Insert method code here

$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE ICS.CPYLIB CATEGORY
$INCLUDE CPYLIB CHAR


ERRMSG = RBO.getProperty('','Inv_XREF_ID',INV_ID)
*INV_ID = "001!RPAPER111"

CONO 	= FIELD(INV_ID,"!",1)
INV.ID	= FIELD(INV_ID,"!",2)


OPEN "","INVENTORY" TO INVENTORY ELSE
	ERRMSG="CAN NOT OPEN INVENTORY FILE"
END

OPEN "","CATEGORY" TO CATEGORY ELSE
	ERRMSG="CAN NOT OPEN CATEGORY FILE"
END

ERRMSG = ''

	MATREAD INV.REC FROM INVENTORY,CONO:INV.ID ELSE
            ERRMSG="Invalid inventory item. Try again! "
            GOSUB 90000
	     RETURN	
       END

        MATREAD CATG.REC FROM CATEGORY, CONO:INV.LINE ELSE
            ERRMSG="Invalid Inventory Category. Try again! "
            GOSUB 90000
	     RETURN
        END
         IF CATG.TYPE # 'RL' THEN
            ERRMSG='Not a Roll Label product'
            GOSUB 90000
	     RETURN
         END


90000 *
	IF ERRMSG # '' THEN
		STATUS = RBO.setProperty('','ESTRLM_Inv_Vald', ERRMSG)
	END
RETURN

* End of method code
RETURN

