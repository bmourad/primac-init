SUBROUTINE NEW_GETDATA
********************************************************************************
*   Program name :- NEW_GETDATA
*   Created:- 1/4/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE OPS.CPYLIB ORDER

  OPEN "","ORDER" TO ORDER ELSE
      ERRMSG = "Cannot locate the ORDER file"; GOTO 4099
   END


* Insert method code here

STATUS = RBO.getProperty("","PMCProperty",PMCProperty)
STATUS=RBO.getProperty('','BOL_ORDNO',BOL.ORDNO)

CONO=PMCProperty<1,4>
 1111 *
	 ORDNO = BOL.ORDNO
         
         MATREAD ORD.REC FROM ORDER, CONO:ORDNO ELSE
            ERRMSG = "Cannot locate Order # ":CONO:ORDNO
            GOTO 4099
         END
         DIV.CODE = ORD.DIV; USER.ID = UPCASE(PMCProperty<1,3>); ERRMSG = ''
         CALL CK.DIV.SEC.SUB(CONO,DIV.CODE,USER.ID,ERRMSG)
         IF ERRMSG # '' THEN
            GOTO 4099
         END
        
         IF ERRMSG # '' THEN GOTO 4099
         IF ORD.STATUS<1,1> = "CLOSED" OR ORD.STATUS<1,1> = "CANCEL" THEN
            ERRMSG = "Order has either been closed or cancelled"
            GOTO 4099
         END
         IF ORD.PICK.NO # "" THEN
            ERRMSG = "Picking Ticket # required for this order."
            GOTO 4099  
         END
         IF ORD.REL.NO # "" THEN
            ERRMSG = "Release # required for this order."
            GOTO 4099 
         END
         
RETURN


* End of method code
RETURN

4099 *
   STATUS = RBO.setProperty("","ServerStatus",1)
   STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
RETURN




