SUBROUTINE JCSOPE_CAT_ID_DESC
********************************************************************************
*   Program name :- 
*   Created:- 11/3/2004
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JCS.CPYLIB CATEGORY.OSP 
$INCLUDE JCS.CPYLIB DAILY.OSP
* Insert method code here

OPEN '','CATEGORY.OSP' TO CATEGORY.OSP ELSE ERRMSG='CATEGORY.OSP FILE IS MISSING';GOTO 99999
OPEN '','DAILY.OSP' TO DAILY.OSP ELSE ERRMSG='DAILY.OSP FILE IS MISSING';GOTO 99999
OPEN '','CONTROL' TO CONTROL ELSE ERRMSG='CONTROL FILE IS MISSING';GOTO 99999

CAT_ID  = ''
CAT_DESC= ''
ID_LIST = ''
TMP_CNT = 0
DAILY_ID = ''
STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
CONO = PMCProperty<1,4>

CMD = "SSELECT CATEGORY.OSP WITH CONO= '":CONO:"'"
UDTEXECUTE CMD

DATA = 1
LOOP
	READNEXT ID ELSE DATA = 0
WHILE DATA DO
	ID_LIST<1,-1> = ID
REPEAT

TMP_CNT  = DCOUNT(ID_LIST,@VM)
FOR X = 1 TO TMP_CNT
	MATREAD CAOS.REC FROM CATEGORY.OSP,ID_LIST<1,X> THEN	
	 CAT_ID<1,X> = ID_LIST<1,X>
	 CAT_DESC<1,X> = CAOS.DESC
	END
NEXT X
************
CMD = "SSELECT DAILY.OSP WITH CONO= '":CONO:"'"
UDTEXECUTE CMD

DATA = 1
LOOP
	READNEXT ID ELSE DATA = 0
WHILE DATA DO
	ID_LIST<1,-1> = ID
REPEAT

TMP_CNT  = DCOUNT(ID_LIST,@VM)
FOR X = 1 TO TMP_CNT
	MATREAD DOS.REC FROM DAILY.OSP,ID_LIST<1,X> THEN
	 IF ID_LIST<1,X> <> "" THEN
	    DAILY_ID<1,X> = ID_LIST<1,X>
	 END
	END
NEXT X


************

STATUS = RBO.setProperty('','New_PlineCodes',CAT_ID)
STATUS = RBO.setProperty('','New_PlineDescs',CAT_DESC)
STATUS = RBO.setProperty('','DAILY_ID',DAILY_ID)
RETURN

99999
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
* End of method code
RETURN


