SUBROUTINE APCPCDM_GET_VEND_VOUCH_LIST
********************************************************************************
*   Program name :- APCPCDM_GET_VEND_VOUCH_LIST
*   Created:- 2/7/2006
*   Auther:-Sk. Zahoor Ahmed
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE APS.CPYLIB OAP
* Insert method code here
VOUCH_CODES = ''
	ERRMSG = ''
	MAT OAP.REC = ''
	OPEN '','OAP' TO OAP ELSE 
		ERRMSG = 'OAP FILE IS MISSING'
		GOTO 99999
	END
	STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
       CONO = PMCProperty<1,4>
	CNT = 1
       CMD = "SELECT OAP WITH CONO = ":CONO
	UDTEXECUTE CMD CAPTURING CMDMESG
	DATA = 1
   	LOOP
		READNEXT CODE ELSE DATA = 0
	WHILE DATA DO
		IF CONO = CODE[1,3] THEN
			VOUCH_CODES<1,-1> = CODE[4,99]
		END
	REPEAT
	STATUS = RBO.setProperty('','VOUCH_CODES',VOUCH_CODES)
* End of method code
99999
  IF (TRIM(ERRMSG) # "") THEN
       STATUS = RBO.setProperty('','ServerStatus','E')
       STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
  END ELSE
       STATUS = RBO.setProperty('','ServerStatus','')
       STATUS = RBO.setProperty('','ServerMessage','')
  END 
RETURN
