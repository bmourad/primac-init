SUBROUTINE GETSHIPTOMASTER
********************************************************************************
*   Program name :- GETSHIPTOMASTER
*   Created:- 4/11/2005
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE CPYLIB CHAR
$INCLUDE JCS.CPYLIB SHIPTO.MASTER

* Insert method code here
MESG = ""
  OPEN '','SHIPTO.MASTER' TO SHIPTO.MASTER ELSE
      MESG = 'Cannot open SHIPTO.MASTER file!'
      GOTO 91000
   END
*
STATUS=RBO.getProperty('','ID',ID)
STATUS=RBO.getProperty('','PMCProperty',PMCProperty)

CONO = PMCProperty<1,4>
SHM_SP_STORE = ""
SHM_SP_NAME = ""
SHM_DT_NAME = ""

  ID     = CONVERT("ü",VM,ID)
  FOR TY = 1 TO DCOUNT(ID,VM)
	MATREAD SHM.REC FROM SHIPTO.MASTER, CONO:ID<1,TY> ELSE
		MAT SHM.REC = ""
	       GOTO 91000
	END
	SHM_SP_STORE<1,TY> = SHM.SP.STORE
	SHM_SP_NAME<1,TY>  = SHM.SP.NAME 
	SHM_DT_NAME<1,TY>  = SHM.DT.NAME
  NEXT TY

STATUS = RBO.setProperty('','SHM_SP_STORE',SHM_SP_STORE)
STATUS = RBO.setProperty('','SHM_SP_NAME',SHM_SP_NAME)
STATUS = RBO.setProperty('','SHM_DT_NAME',SHM_DT_NAME)

RETURN

91000*
   IF MESG # "" THEN
	STATUS = RBO.setProperty('', 'ServerStatus', 1)
   	STATUS = RBO.setProperty('', 'ServerMessage', MESG)
   END
RETURN

