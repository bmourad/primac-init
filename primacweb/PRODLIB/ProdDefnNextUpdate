SUBROUTINE ProdDefnNextUpdate
********************************************************************************************
*   Program name :- EstrlmUpdate
*   Created:- 8/27/2003
*   AUTHOR  : B.KRISHNA
*   This program gets the data from the PRODUCT DEFN NEXT SCREEN SAVE TO ESTIMATE.RES file
*
*********************************************************************************************
*
*---- FILE COPY STATEMENTS
*
   $INCLUDE WWINSERT RBO.H
   $INCLUDE JES.CPYLIB JES.FILE.VARS
   $INCLUDE CPYLIB FILE.VARS
   $INCLUDE JES.CPYLIB ESTIMATE.RES
   $INCLUDE CPYLIB CHAR

OPEN "", "ESTIMATE.RES" TO ESTIMATE.RES ELSE
ERRMSG="CAN NOT OPEN ESTIMATE.RES"
END
 
*---- INITIALIZATION
*
STATUS = RBO.getProperty('','ProdDefnNextStr',DATA)

*
*---- PROCESSING
*
MATREAD EST.RL.REC FROM ESTIMATE.RES,DATA<1,1> ELSE MAT EST.RL.REC = ''

EST.RL.LINEAL.SLIT		= DATA<1,2>
EST.RL.NO.SLITS		= DATA<1,3>
EST.RL.ROLLS			= DATA<1,4>
EST.RL.NO.PER.ROLL		= DATA<1,5>
EST.RL.CORE 			= DATA<1,6>
EST.RL.CORE.SIZE 		= DATA<1,7>*10000.00
EST.RL.MAX.OD 		= DATA<1,8>*10000.00
EST.RL.DISP.PACK		= DATA<1,9>
EST.RL.APPLY 			= DATA<1,10>
EST.RL.SHEETS 		= DATA<1,11>
EST.RL.NO.PER.PKG 		= DATA<1,12>
EST.RL.FANFOLD 		= DATA<1,13>
EST.RL.NO.PER.BATCH 		= DATA<1,14>
EST.RL.NO.PER.FOLD 		= DATA<1,15>
EST.RL.SHRK.WRP 		= DATA<1,16>
EST.RL.PKG.LABELS 		= DATA<1,17>
EST.RL.LAB.ACR 		= DATA<1,18>
EST.RL.CORE.THICK 		= DATA<1,19>

MATWRITE EST.RL.REC ON ESTIMATE.RES,DATA<1,1>

RETURN

93000 *
   IF ERRMSG # "" THEN 
	   STATUS = RBO.setProperty('','ServerStatus',1)
	   STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
   END
 RETURN
