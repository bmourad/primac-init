SUBROUTINE INVREGM_CATG_READ
********************************************************************************
*   Program name :- INVPAPM_CATEGORY_READ
*   Created:- 6/12/2003
*   Author- Mohammed Abdul Malik
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

$INCLUDE ICS.CPYLIB CATEGORY
$INCLUDE CPYLIB CHAR
$INCLUDE PMC.CPYLIB COMPANY
ERRMSG = ''
* Insert method code here
  OPEN '','CATEGORY' TO CATEGORY ELSE
    ERRMSG = "CANNOT OPEN CATEGORY FILE"
    GOSUB 93000
  END
OPEN '','COMPANY' TO COMPANY ELSE
    ERRMSG = "CANNOT OPEN COMPANY FILE"
    GOSUB 93000
  END
STATUS=RBO.getProperty('','CONO',CONO)
STATUS=RBO.getProperty('','INV_LINE',INV_LINE)

*CATGID=CONO:INV_LINE
CATGID=INV_LINE
COOPS=""
ERRMSG=""
     MATREAD COMP.REC FROM COMPANY,CONO THEN
       COOPS=CO.OPS
     END
	MATREAD CATG.REC FROM CATEGORY,CONO:INV_LINE THEN
  
          IF  CATG.MAJ.LINE = "FNGD" THEN
               
                IF COOPS = 'Y' THEN
                   ERRMSG = "Can't utilize a Finished Goods product line for a Regular product"
                   GOTO 93000 
                END
          END    
          IF CATG.TYPE # "P" AND CATG.TYPE # "I" AND CATG.TYPE # "F" AND CATG.TYPE # "O" THEN
              ERRMSG = "Can't utilize a Paper product line for a Regular product"
             GOTO 93000 
          END
  
  STATUS=RBO.setProperty('','CatgMLine',CATG.MAJ.LINE)
  STATUS=RBO.setProperty('','CatgType',CATG.TYPE)
    
  		
	END

* End of method code
RETURN
93000 
STATUS = RBO.setProperty('','ServerStatus',1)       
STATUS = RBO.setProperty('','ServerMessage',ERRMSG ) 

