SUBROUTINE CLEAR_DATA_CONO
********************************************************************************
*   Program name :- CLEAR_DATA_CONO
*   Created:- 3/9/2006
*   Auther :- Sk. Zahoor Ahmed
*   DESCRIPTION -
*   This program delete items of a select list from a file.
*                 In Prooerties must be :
*                                      1- CONO
*                                      2- SEELCT QUERY
*                                      3- FILE NAME (TO CLEAR)
  
********************************************************************************
$INCLUDE WWINSERT RBO.H
*
   STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
   STATUS = RBO.getProperty('','FILE_NAME',FILE.NAME)
   STATUS = RBO.getProperty('','SELECTCMD',SELECTCMD)
   STATUS = RBO.getProperty('','QUERY_STR',QUERY_STR)
   CONO = PMCProperty<1,4>
   ERRMSG = ''
   IF SELECTCMD = "" THEN SELECTCMD=QUERY_STR
*
**** OPEN FILE
*
     OPEN "",FILE.NAME TO F.NAME ELSE 
        ERRMSG = F.NAME :"IS MISSING"
        GOTO 93000
     END
*
****EXECUTE SEELCT QUERY
*
*
     UDTEXECUTE SELECTCMD CAPTURING SMESG

**** MAIN PROCESS
*
     DATA = 1
     LOOP
        READNEXT ID ELSE DATA = 0
     WHILE DATA = 1 DO
        IF ID[1,3] # CONO THEN GOTO 1999
        READU DUMMY FROM F.NAME, ID ELSE
           RELEASE F.NAME, ID
           GOTO 1999
        END
        DELETE F.NAME , ID
1999 REPEAT
*
**** END OF JOB
93000 *
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
END

