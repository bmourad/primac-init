SUBROUTINE VALIDATE_DATE
********************************************************************************
*   Program name :- VALIDATE_DATE
*   Created:- 1/9/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

*CALL RBO_GET_PROPERTY('CH_DATE', CH_DATE, ERRMSG)
STATUS=RBO.getProperty('','CH_DATE',CH_DATE)

MINV = ""
DATE_ERRMSG = ""
DATE_ERRMSG1 = ""


MINV = ICONV(CH_DATE,"D2/")
IF MINV # "" THEN
   IF ABS(DATE() - MINV ) > 365*10 THEN
      DATE_ERRMSG = "DATE OUTSIDE 10 YEAR RANGE, CONTINUE (Y/N)? "
   END

   MINV = ICONV(CH_DATE,"D4/")
   BEGIN CASE
      CASE MINV GT DATE()+31
        CHECK.DATE=1
      CASE MINV LT DATE()-31
        CHECK.DATE=1
      CASE 1
        CHECK.DATE=''
   END CASE
   IF CHECK.DATE THEN
      DATE_ERRMSG1='THE DATE ':OCONV(MINV,'D4/'):' IS OUT OF RANGE, ACCEPT (Y/N) '
   END
END

*ERRMSG1 = 'DATE_ERRMSG...' :DATE_ERRMSG 
   *GOTO 93000
*RETURN


STATUS=RBO.setProperty('','DATE_ERRMSG',DATE_ERRMSG)
STATUS=RBO.setProperty('','DATE_ERRMSG1',DATE_ERRMSG1)
RETURN

93000*
STATUS = RBO.setProperty('','ServerStatus',"1")
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)


* End of method code
RETURN

