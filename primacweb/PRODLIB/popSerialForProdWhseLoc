SUBROUTINE popSerialForProdWhseLoc
********************************************************************************
*   Program name :- 
*   Created:- 04/27/2003
*   Author:- Mohammed Abdul Malik
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE ICS.CPYLIB INV_SERIAL
$INCLUDE ICS.CPYLIB WAREHOUSE
$INCLUDE ICS.CPYLIB INV.WHSE
$INCLUDE ICS.CPYLIB INV.WHSE.LOC
$INCLUDE ICS.CPYLIB CATEGORY
$INCLUDE CPYLIB CHAR

ERRMSG=''

IF FILEINFO(INV_SERIAL,0)=0 THEN
  OPEN '','INV_SERIAL' TO INV_SERIAL ELSE
    ERRMSG<1,-1>='INV_SERIAL FILE IS MISSING'
  END
END
IF FILEINFO(WAREHOUSE,0)=0 THEN
  OPEN '','WAREHOUSE' TO WAREHOUSE ELSE
    ERRMSG<1,-1>='WAREHOUSE FILE IS MISSING'
   END
END
   OPEN '','INV.WHSE' TO INV.WHSE ELSE
      ERRMSG = 'INV.WHSE IS MISSING' 
   END
   OPEN '','INV.WHSE.LOC' TO INV.WHSE.LOC ELSE
      ERRMSG = 'INV.WHSE.LOC IS MISSING' 
   END


IF FILEINFO(INVENTORY,0)=0 THEN
  OPEN '','INVENTORY' TO INVENTORY  ELSE
    ERRMSG<1,-1>='INVENTORY FILE IS MISSING'
   END
END

IF FILEINFO(CATEGORY,0)=0 THEN
  OPEN '','CATEGORY' TO CATEGORY ELSE
    ERRMSG<1,-1>='CATEGORY FILE IS MISSING'
   END
END

IF ERRMSG THEN GOTO 93000

STATUS=RBO.getProperty('','PROD_W_LO_ID',IWLOID)


    MATREAD IWLO.REC FROM INV.WHSE.LOC,IWLOID THEN
	*SERIAL.LOC.LIST = CHANGE(IWLO.SERIAL,VM,"$")
	SERIAL.LOC.LIST = IWLO.SERIAL
    END

STATUS=RBO.setProperty('','INV_SERIALNO_WHSE_LOC',SERIAL.LOC.LIST)





* End of method code

      
GOTO 99999

*************************************************************************
93000 
STATUS = RBO.setProperty('','ServerStatus',1)        
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)  
99999 

