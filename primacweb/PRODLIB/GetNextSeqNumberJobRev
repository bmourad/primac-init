SUBROUTINE GetNextSeqNumberJobRev
********************************************************************************
*   Program name :- GetNextSeqNumberJobRev
*   Created:- 8/13/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE CPYLIB CHAR		
$INCLUDE JCS.CPYLIB DAILY.REVERSE
ERRMSG = ''
OPEN '','CONTROL' TO CONTROL ELSE
	ERRMSG = "CONTROL FILE IS MISSING"
	GOTO 93000
END
OPEN '','DAILY.REVERSE' TO DAILY.REVERSE ELSE
	ERRMSG = "DAILY.REVERSE FILE IS MISSING"
	GOTO 93000
END

STATUS = RBO.getProperty('','PMCProperty',PMCPROPERTY)
CONO = PMCPROPERTY<1,4>

STATUS = RBO.getProperty('','ID',ID)
WRITE "CONO & ID ":CONO:"~~~":ID ON CONTROL,'01CID'
RCLS.SEQ = ""
RCLS.SEQ.NO = ""
   READU RCLS.SEQ FROM CONTROL,CONO:"DAILY.REVERSE" ELSE RCLS.SEQ = 10001
   RCLS.SEQ.NO = RCLS.SEQ
   MSG = 'Please Note Down New Sequence Number ':RCLS.SEQ.NO
   RCLS.SEQ = RCLS.SEQ + 1
   WRITE RCLS.SEQ ON CONTROL,CONO:"DAILY.REVERSE"
*IF ID = 'N' THEN
*STATUS = RBO.setProperty('','ID',CONO:SEQNUM)
*MSG = 'Please Note Down New Sequence Number ':SEQNUM
STATUS = RBO.setProperty('','ID',CONO:RCLS.SEQ.NO)
MSG = 'Please Note Down New Sequence Number ':RCLS.SEQ.NO
STATUS = RBO.setProperty('','NewMessage',MSG)
*END

STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ID)

RETURN


93000
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
STATUS = RBO.setError(ERRMSG)
RETURN
