SUBROUTINE GetEquipmentIDAndInfo
********************************************************************************
*   Program name :- GetEquipmentIDAndInfo
*------------------------------------------------------------------------------*
*Programmer : B.krishna

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE JES.CPYLIB EQUIPMENT

ERRMSG1 = RBO.getProperty('','ID',ID)

* Insert method code here
  OPEN "","COST.CNTR" TO COST.CNTR ELSE
    ERRMSG = "CANNOT OPEN COST.CNTR FILE"
    GOTO 93000	
  END

  OPEN "","EQUIPMENT" TO EQUIPMENT ELSE
    ERRMSG = "CANNOT OPEN EQUIPMENT FILE"
    GOTO 93000
  END
  
*EQUIP.CODES.LIST = '0'
*EQUIP.DESCS.LIST = '-Select-'
*EQUIP.TYPE.LIST = '0'

EQUIP.CODES.LIST = ''
EQUIP.DESCS.LIST = ''
EQUIP.TYPE.LIST = ''
 
 CONO = ID[1,3]

*SELECT EQUIPMENT 

  CMD = "SSELECT EQUIPMENT WITH @ID LIKE ":CONO:"..."
  UDTEXECUTE CMD 
LOOP
	EOF = 1
	READNEXT EQUIP.ID ELSE EOF = 0
WHILE EOF DO

	IF EQUIP.ID[1,3] = CONO THEN
		READV CCTR.DESC FROM COST.CNTR, EQUIP.ID<0>, 1 THEN
			EQUIP.CODES.LIST<1,-1> = EQUIP.ID<0>[4,99]
			EQUIP.DESCS.LIST<1,-1> = EQUIP.ID<0>[4,99] : "_" : CCTR.DESC
		*END ELSE 
			ERRMSG = "NO RECORD FOUND"
			MATREAD EQUIPMENT.REC FROM EQUIPMENT,EQUIP.ID<0> THEN 
				EQUIP.TYPE.LIST<1,-1> = EQP.TYPE
			END
		END
	END
REPEAT
	*1000*

	STATUS=RBO.setProperty('','CostCenterCodes',EQUIP.CODES.LIST)
	STATUS=RBO.setProperty('','CostCenterCodesDescs',EQUIP.DESCS.LIST)
	STATUS=RBO.setProperty('','EqpTypes',EQUIP.TYPE.LIST)
RETURN
*
93000*
	STATUS=RBO.setProperty('','ServerStatus',1)
	STATUS=RBO.setProperty('','ServerMessage',ERRMSG )

* End of method code
RETURN

