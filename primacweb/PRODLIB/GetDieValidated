SUBROUTINE GetDieValidated
********************************************************************************
*   Program name :- GetDieValidated
*   Created:- 3/14/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

* Insert method code here
STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
STATUS=RBO.getProperty('','DieNo',DieID)
CONO=PMCProperty<1,4>
DIECODES=''
DIEDESC=''
FLAG=1

   OPEN "ESTIMATE.RES.SHAPE" TO ESTIMATE.RES.SHAPE ELSE
      ERRMSG = "CANNOT OPEN ESTIMATE.RES.SHAPE"
      GOTO 90000
   END 
          READ DESC FROM ESTIMATE.RES.SHAPE, CONO:DieID THEN
  		DIECODES=DieID
  		DIEDESC=DESC
	   END ELSE
      	       ERRMSG = "Invalid die shape--"
	       GOSUB 90000
          END
	
    STATUS=RBO.setProperty('','ALLDieCodes',DIECODES)
    STATUS=RBO.setProperty('','ALLDieShape',DIEDESC)
* End of method code
RETURN

90000 *
   STATUS=RBO.setProperty('','ServerStatus',1)
   STATUS=RBO.setProperty('','ServerMessage',ERRMSG)


RETURN

