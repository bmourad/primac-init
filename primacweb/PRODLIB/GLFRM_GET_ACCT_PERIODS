SUBROUTINE GLFRM_GET_ACCT_PERIODS
********************************************************************************
*   Program name :- GLFRM_GET_ACCT_PERIODS
*   Created:- 6/26/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  CONO
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

* Insert method code here
ERRMSG = ""
OPEN '', 'CONTROL' TO CONTROL ELSE
	ERRMSG = 'CONTROL FILE IS MISSING'
    	GOTO 99999
END

STATUS = RBO.getProperty('','Cono',CONO)
PERIOD.REC = ""

READ PERIOD.REC FROM CONTROL, CONO:"ACCT.PERIODS" ELSE
	PERIOD.REC = ""
    	PERIOD.REC<1> = 12
END

NUM.PERIODS = PERIOD.REC<1> -1

STATUS = RBO.setProperty('','NUM_PERIODS',NUM.PERIODS)

99999 
  IF (TRIM(ERRMSG) # "") THEN
       STATUS = RBO.setProperty('','ServerStatus','E')
       STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
  END
RETURN


