   SUBROUTINE EPRIMAC_XREF_SUB (ERRMSG, THIS_INPARAM, THIS_OUTPARAM, EPRIMAC_XREF)
**************************************************************************
*   Program name :- EPRIMAC_XREF_SUB
*   Created:- 11/07/2002
*
**************************************************************************
   $INCLUDE PMC.CPYLIB EPRIMAC_XREF
   $INCLUDE CPYLIB CHAR
* Insert method code here
   ERRMSG = ""
   IF FILEINFO(EPRIMAC_XREF,0) = 0 THEN
      OPEN '','EPRIMAC_XREF' TO EPRIMAC_XREF ELSE
         ERRMSG = 'Cannot open EPRIMAC_XREF file!'
         GOTO 1000
      END
   END
   MATREAD EPMCX_REC FROM EPRIMAC_XREF, "TABLES" ELSE
      ERRMSG = 'Cannot find TABLES list in EPRIMAC_XREF file!'
      GOTO 1000
   END
   CONO = THIS_INPARAM<1>
   ID = THIS_INPARAM<3>
   XREF_ID = THIS_INPARAM<4>
   IF ID = "" THEN GOTO 1000
   IF XREF_ID = "" THEN
      ERRMSG = "data_file is empty"
      GOTO 1000
   END
   LOCATE XREF_ID IN EPMCX_TABLE<1>,1 SETTING LL ELSE GOTO 1000
   IN_PARAM = CONO
   IN_PARAM<2> = ID
   IN_PARAM<3> = XREF_ID
   IN_PARAM<4> = LL
   OUT_PARAM = ""
   CALL EPRIMAC_XREF_SETATT (ERRMSG, IN_PARAM, OUT_PARAM, EPRIMAC_XREF, MAT EPMCX_REC)
1000*
* End of method code
   RETURN
END
