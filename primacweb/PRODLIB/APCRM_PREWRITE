  SUBROUTINE APCRM_PREWRITE
*********************************************************************
*
* REVISION - [12.0]
*
* PROGRAM  - APCRM_PREWRITE
*
* AUTHOR   - ALEJANDRO DELGADO
*
* DATE     - 01/23/2003
*
* DESCRIPTION
*
* Data is retrieve from the APCHECK file to load display through RBO.
*
*********************************************************************
*
*---- FILE COPY STATEMENTS
*
  $INCLUDE WWINSERT RBO.H
  $INCLUDE APS.CPYLIB APCHECK
  $INCLUDE CPYLIB FILE.VARS
  $INCLUDE CPYLIB CHAR
*
*---- INITIALIZATION
*
  STATUS = RBO.getProperty('','ID',ID)
  STATUS = RBO.getProperty('','SAPC_IDS',SAPC.IDS)
  STATUS = RBO.getProperty('','SAPC_CHK_AMT_PAID',SAPC.CHK.AMT.PAID)
  STATUS = RBO.getProperty('','SAPC_C_FLAG',SAPC.C.FLAG)
  STATUS = RBO.getProperty('','SAPC_REM',SAPC.REM)
  CONO = ID[1,3]
*
*---- OPEN FILES
*
  IF FILEINFO(APCHECK,0) = 0 THEN
    OPEN '','APCHECK' TO APCHECK ELSE
      ERRMSG = 'Cannot open APCHECK file!'
      GOTO SET.ERROR
    END
  END
*
*---- MAIN PROCESS
*
  LINES = DCOUNT(SAPC.IDS, VM)
  FOR FF = 1 TO LINES
    MATREADU APCK.REC FROM APCHECK, CONO:SAPC.IDS<1,FF> ELSE
      RELEASE APCHECK , CONO:SAPC.IDS<1,FF> ; CONTINUE
    END
    APCK.AMT.PAID = ICONV(SAPC.CHK.AMT.PAID<1,FF>,'MD2')
    IF SAPC.C.FLAG<1,FF> = "N" THEN
      APCK.SEQ = ""
    END ELSE
      APCK.SEQ = 1
    END
    APCK.COMM = SAPC.REM<1,FF>
    MATWRITE APCK.REC ON APCHECK, CONO:SAPC.IDS<1,FF>
  NEXT FF
  RETURN
*
SET.ERROR: 
*
  STATUS = RBO.setProperty('','ServerStatus',1)
  STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
  RETURN
END
