SUBROUTINE PRODWKM_FETCH_CATEGORIES
********************************************************************************
*   Program name :- PRODWKM_FETCH_CATEGORIES
*   Created:- 3/3/2006
*------------------------------------------------------------------------------*
*
*  This server event is triggered from within the {m:WW:uObject=ReadData}, {m- *
*  :WW:uObject=ReadLockData}, {m:WW:uObject=DeleteData} and {m:WW:uObject=Wri- *
*  teData} server events. In each case, this {m:WW:uObject=PostRead} event oc- *
*  curs after the physical database read, but before values are extracted fro- *
*  m the database record. This provides a window of opportunity in which the - *
*  database values may be directly manipulated. The API functions
*  RBO.setDBVa- *
*  ls() and RBO.getDBVals() are used to do this.
*  
*                                             - *

* In Properties:
* --------------
*  BY : D.JAMAL
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE CPYLIB FILE.VARS


STATUS = RBO.getProperty('','PMCProperty',PMCProperty)
CONO = PMCProperty<1,4>

OPEN '','JOB.CATEGORY' TO JOB.CATEGORY ELSE ERRMSG = "JOB.CATEGORY FILE IS MISSING"; GOTO 93000

CMD = "SSELECT JOB.CATEGORY WITH @ID LIKE '":CONO:"...'"
UDTEXECUTE CMD CAPTURING RESULT

CATEGORY_ID = ''
CATEGORY_DES =''
LOOP
	EOF = 1
	READNEXT ID ELSE EOF = 0
	CATEGORY_ID<1,-1> = ID
WHILE EOF DO	
REPEAT

VM="ý"
FOR N = 1 TO DCOUNT(CATEGORY_ID,VM)
	READ ARRCATEGORY FROM JOB.CATEGORY, CATEGORY_ID<1,N> THEN 
		IF N=1 THEN
			CATEGORY_DES=CATEGORY_ID<1,N>[4,99]:" ":ARRCATEGORY<1,1>
		END ELSE
			CATEGORY_DES=CATEGORY_DES:"ý":CATEGORY_ID<1,N>[4,99]:" ":ARRCATEGORY<1,1>
		END
	END
NEXT N

STATUS=RBO.setProperty('','CATEGORY_CODES',CATEGORY_ID)
STATUS=RBO.setProperty('','CATEGORY_DESCS',CATEGORY_DES)
 
RETURN

93000
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN
