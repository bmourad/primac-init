SUBROUTINE PQUEM_PRE_WRITE
********************************************************************************
*   Program name :- PQUEM_PRE_WRITE
*   Created:- 5/26/2006
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB PMC_PRINTERS
$INCLUDE CPYLIB CHAR
* Insert method code here

* Insert method code here
ERRMSG = ""
OPEN '','PMC_PRINTERS' TO PMC_PRINTERS ELSE ERRMSG = "PMC_PRINTERS FILE IS MISSING"; GOTO 1000
OPEN '','CONTROL' TO CONTROL ELSE ERRMSG = "CONTROL FILE IS MISSING"; GOTO 1000

*MATREAD PRTRS.REC ON PMC_PRINTERS,PRTRS_KEY ELSE MAT PRTRS.REC = "";

STATUS = RBO.getProperty('', 'ID', PRTRS_KEY)
STATUS = RBO.getProperty('', 'PRTRS_DESC', PRTRS_DESC)
STATUS = RBO.getProperty('', 'PRTRS_COLUMN', PRTRS_COLUMN)
STATUS = RBO.getProperty('', 'PRTRS_PATH', PRTRS_PATH)
STATUS = RBO.getProperty('', 'PRTRS_LASER', PRTRS_LASER)
STATUS = RBO.getProperty('', 'PRTRS_ORIENT', PRTRS_ORIENT)
STATUS = RBO.getProperty('', 'PRTRS_FONT', PRTRS_FONT)
STATUS = RBO.getProperty('', 'PRTRS_FONTSIZE', PRTRS_FONTSIZE)
STATUS = RBO.getProperty('', 'PRTRS_TOP', PRTRS_TOP)
STATUS = RBO.getProperty('', 'PRTRS_BOTTOM', PRTRS_BOTTOM)
PRTRS_TOP = ICONV(PRTRS_TOP,"MD2")
PRTRS_BOTTOM = ICONV(PRTRS_BOTTOM,"MD2")
STATUS = RBO.getProperty('', 'PRTRS_DEVICE', PRTRS_DEVICE)

MATWRITE PRTRS.REC ON PMC_PRINTERS,PRTRS_KEY
RETURN
1000*
     STATUS = RBO.setProperty('', 'ServerMessage', ERRMSG)
RETURN


