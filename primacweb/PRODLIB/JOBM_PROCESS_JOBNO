SUBROUTINE JOBM_PROCESS_JOBNO
********************************************************************************
*   Program name :- JOBM_PROCESS_JOBNO
*   Created:- 8/13/2003
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
* ID 
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H

ERRMSG = ''
OPEN '','CONTROL' TO CONTROL ELSE
	ERRMSG = "UNABLE TO OPEN CONTROL FILE"
    	GOTO 99999
END
OPEN "","JOB" TO JOB ELSE
     	ERRMSG = "UNABLE TO OPEN JOB FILE"
    	GOTO 99999
END

* Insert method code here

VAL = RBO.getProperty('','ID',ID)
CONO = ID[1,3]
JOBNO = ID[4,99]
IF JOBNO = "N" THEN
	READU JOBNO FROM CONTROL, CONO:"JOBNO" ELSE
       	JOBNO = 10000
       END
       LOOP
       	FND = 1
          	IF JOBNO > 99999 THEN JOBNO = 1
          	READU O.RECORD FROM JOB, CONO : JOBNO ELSE FND = 0
      	WHILE FND DO
        	RELEASE JOB, CONO : JOBNO
		JOBNO = JOBNO + 1
      	REPEAT
       WRITE JOBNO ON CONTROL, CONO:"JOBNO"
       *ERRMSG = "Please Note Assigned Job Number : ":JOBNO
END

VAL = RBO.setProperty('','ID',JOBNO)

99999
IF ERRMSG # '' THEN
	STATUS = RBO.setProperty('','ServerStatus','1')
	STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
END ELSE
	STATUS = RBO.setProperty('','ServerStatus','')   
	STATUS = RBO.setProperty('','ServerMessage','')
END
RETURN
