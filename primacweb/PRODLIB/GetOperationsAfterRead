SUBROUTINE GETDEPT_DIV
********************************************************************************
*   Program name :- GETDEPT_DIV
*   Created:- 11/3/2004
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  DIVISION,COST CENTER,CONO
*
* Out Properties:
* ---------------
* DIVISION,DIVISION DESC,DEPARTMENT,DEPARTMENT DESC  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB DIVISION
$INCLUDE PMC.CPYLIB DEPARTMENT
$INCLUDE PMC.CPYLIB COST.CNTR
$INCLUDE JCS.CPYLIB OPERATION

ERRMSG = ""
* Insert method code here
OPEN '', 'COST.CNTR' TO COST.CNTR ELSE 
	ERRMSG = "COST.CNTR FILE IS MISSING"
	GOTO 99999
END

OPEN '', 'OPERATION' TO OPERATION ELSE
	ERRMSG = "OPERATION FILE IS MISSING"
	GOTO 99999
END

CTL = 1
CCTR_DEPT = "";CCTR_OPER = "";OPER_DESCS = ""
CCTR_CODES="";OPER_CODES=""
STATUS = RBO.getProperty('','Cono',CONO)
STATUS = RBO.getProperty('','DMT_CCTR',CCTR_NO)
DEPT = "";DIV = "";OPER_DESC_LIST = ""
CCTR_LIST = ""
CCNT = DCOUNT(CCTR_NO,@VM)
	FOR CTL = 1 TO CCNT
		MATREAD CCTR.REC FROM COST.CNTR,CONO:CCTR_NO<1,CTL>  ELSE
			MAT CCTR.REC = ''
		END
		CCTR_CODES<1,CTL> = CCTR_NO<1,CTL>
		OPER_CODES<1,CTL> = LOWER(CCTR.OPER) : @VM : OPER_CODES<1,CTL>
		CNT = DCOUNT(CCTR.OPER,@VM)
		FOR I = 1 TO CNT
			MAT OPER.REC = ""
			MATREAD OPER.REC FROM OPERATION, CONO:CCTR.OPER<1,I> THEN
				OPER_DESCS<1,CTL,I> = CCTR.OPER<1,I>  : "-" : OPER.DESC
			END
		NEXT I
	NEXT CTL	

STATUS = RBO.setProperty('','DMT_DEPT_LIST',OPER_CODES)
STATUS = RBO.setProperty('','OPER_DESC_LIST',OPER_DESCS)
* End of method code
RETURN

99999
  IF (TRIM(ERRMSG) # "") THEN
       STATUS = RBO.setProperty('','ServerStatus','1')
       STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
  END ELSE
       STATUS = RBO.setProperty('','ServerStatus','')
       STATUS = RBO.setProperty('','ServerMessage','')
  END 
RETURN
