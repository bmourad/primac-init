SUBROUTINE ICSDSPR_VALIDATE_DATA
********************************************************************************
*   Program name :- ICSDSPR_VALIDATE_DATA
*   Created:- 10/5/2005
*   Description :- This method is used to find and display any errmsg that could have come up in PROC before running the PROC itself.
********************************************************************************
$INCLUDE WWINSERT RBO.H

  OPEN "","CONTROL" TO CONTROL ELSE ERRMSG = "CANNOT OPEN CONTROL FILE";GOTO 91000

* Insert method code here
   
   STATUS = RBO.getProperty("","PMCProperty",PMCProperty)
   CONO = PMCProperty<1,4>
   ERRMSG = ""

   READ FISCAL.PERIODS FROM CONTROL, CONO:"ICFISCAL" ELSE ERRMSG = "MISSING FISCAL.REC ICFISCAL"; GOTO 91000
   COUNTER=DCOUNT(FISCAL.PERIODS<1>,@VM)
   X = '999999'
   FOR C = 1 TO COUNTER
   CHECK.PERIOD = FISCAL.PERIODS<1,C>
   IF CHECK.PERIOD + 0 GT 0 AND CHECK.PERIOD LT X THEN
      X = CHECK.PERIOD
   END
   NEXT C

   CMD = ""
   CMD = "SSELECT INV.ADJ.HIST WITH MON = '' AND WITH CONO = " : CONO : " AND WITH INV.SPEC = 'S' OR WITH MON GE " : X : " AND WITH CONO = " : CONO : " AND WITH INV.SPEC = 'S'"
   UDTEXECUTE CMD CAPTURING JUNK
   
   READNEXT ID THEN
      ERRMSG = "THERE ARE UNPOSTED E-O-M TRANSACTIONS. <CR> TO CONTINUE";GOTO 91000
   END

RETURN

* End of method code

91000*
   STATUS = RBO.setProperty("","ServerStatus",1)
   STATUS = RBO.setProperty("","ServerMessage",ERRMSG)
RETURN

