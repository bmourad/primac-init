  SUBROUTINE GLATM_POSTREAD
*********************************************************************
*
* REVISION - [12.0]
* PROGRAM  - GLATM_POSTREAD
* AUTHOR   - ALEJANDRO DELGADO
* DATE     - 01/02/2003
* DESCRIPTION
* The program builds the RBO string for Account Type Maintenance.
*
*********************************************************************
*---- FILE COPY STATEMENTS
  $INCLUDE WWINSERT RBO.H
  $INCLUDE GLS.CPYLIB ACCT.TYPE
  $INCLUDE GLS.CPYLIB ACCT.CATG
  $INCLUDE GLS.CPYLIB ACCT.SUB.CATG
  $INCLUDE GLS.CPYLIB CATG.AND.SUB
  $INCLUDE CPYLIB CHAR
  $INCLUDE CPYLIB FILE.VARS
*
**** OPEN FILES
*
  IF FILEINFO(ACCT.TYPE,0) = 0 THEN
    OPEN '','ACCT.TYPE' TO ACCT.TYPE ELSE
      ERRMSG = 'Cannot open ACCT.TYPE file!'
      GOTO SET.ERROR
    END
  END

  IF FILEINFO(ACCT.CATG,0) = 0 THEN
    OPEN '','ACCT.CATG' TO ACCT.CATG ELSE
      ERRMSG = 'Cannot open ACCT.CATG file!'
      GOTO SET.ERROR
    END
  END
  IF FILEINFO(ACCT.SUB.CATG,0) = 0 THEN
    OPEN '','ACCT.SUB.CATG' TO ACCT.SUB.CATG ELSE
      ERRMSG = 'Cannot open ACCT.SUB.CATG file!'
      GOTO SET.ERROR
    END
  END
  IF FILEINFO(CATG.AND.SUB,0) = 0 THEN
    OPEN '','CATG.AND.SUB' TO CATG.AND.SUB ELSE
      ERRMSG = 'Cannot open CATG.AND.SUB file!'
      GOTO SET.ERROR
    END
  END
*
*---- INITIALIZATION
*
  ERRMSG = RBO.getProperty('','ID',ID)
  ERRMSG = RBO.getProperty('','Cono',Cono)

  *CONO = ID[1,3]
  *
CATGDESC=""
PRT.SUB = ""
PRT.CURR = ""
PRT.FIX = ""
PRT.PROD = ""
PRT.S.DESC = ""

    MATREAD AT.REC FROM ACCT.TYPE,ID THEN
      CATG=AT.CATG
      M=DCOUNT(CATG,VM)
      FOR I=1 TO M
        MATREAD AC.REC FROM ACCT.CATG,CATG<1,I> THEN
         CATGDESC<1,I>=AC.DESC
        END
      NEXT I

    
	LINES = DCOUNT(AT.CATG, VM)
  	FOR I = 1 TO LINES
		IF AT.CATG<1,I> # "" THEN
			MATREAD AC.REC FROM ACCT.CATG, AT.CATG<1,I> ELSE
      				MAT AC.REC = ''
	      			AC.DESC = 'UNKNOWN'
    			END
   	    		LINES1 = COUNT(AC.SUB,VM) + (AC.SUB # '')
			FOR J = 1 TO LINES1
      				PRT.SUB<1,I,J> = AC.SUB<1,J>
      				MATREAD ASC.REC FROM ACCT.SUB.CATG, AC.SUB<1,J> ELSE
        				MAT ASC.REC = ''
	        			ASC.DESC = 'UNKNOWN'
      				END
*STATUS=RBO.setProperty('','TESTVAL',Cono:AT.CATG<1,I>:AC.SUB<1,J>)
      				MATREAD CAS.REC FROM CATG.AND.SUB, Cono:AT.CATG<1,I>:AC.SUB<1,J> THEN
        			    PRT.CURR<1,I,J> = CAS.CURR
      				    PRT.FIX<1,I,J> = CAS.FIX
      				    PRT.PROD<1,I,J> = CAS.PROD	      			
                           END ELSE
                               PRT.CURR<1,I,J> = ''
      				    PRT.FIX<1,I,J> = ''
      				    PRT.PROD<1,I,J> = ''
                           END
      				
	      			PRT.S.DESC<1,I,J> = ASC.DESC
    			NEXT J
		END
	NEXT I
  END
*
  STATUS = RBO.setProperty('','SUB_CATG',PRT.SUB)
  STATUS = RBO.setProperty('','SUB_C',PRT.CURR)
  STATUS = RBO.setProperty('','SUB_F',PRT.FIX)
  STATUS = RBO.setProperty('','SUB_P',PRT.PROD)
  STATUS = RBO.setProperty('','SUB_DESC',PRT.S.DESC)
  STATUS = RBO.setProperty('','ORIG_CATG',AT.CATG)
  STATUS = RBO.setProperty('','CATG_DESC',CATGDESC)
  RETURN
*
SET.ERROR: 
*
  STATUS = RBO.setProperty('','ServerStatus',1)
  STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
  RETURN
END

