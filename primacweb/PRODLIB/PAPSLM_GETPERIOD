SUBROUTINE PAPSLM_GETPERIOD
*************************************************************
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - ICSBP
* PROGRAM     - GETPERIOD
* BY          - KHAJA ZIAUDDIN
* MODIFIED BY - Abdul Malik 
* DATE        - 07/08/03  (mm/dd/yy)
* DESCRIPTION
*ENDDOC
*************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB COMPANY

* Insert method code here
SLT_ENT_DATE=""
SLT_DIVISION=""
STATUS = RBO.getProperty('','PMCProperty',PMCPROPERTY)
STATUS = RBO.getProperty('','SLT_ENT_DATE',SLT_ENT_DATE)
STATUS = RBO.getProperty('','SLT_DIVISION',SLT_DIVISION)
*STATUS=  RBO.getProperty('','SLT_PERIOD',PERIOD)
   CONO = PMCPROPERTY<1,4>
   ERR.FLG = ""; ERRMSG = "";PERIOD=""
MAT COMP.REC = ''
OPEN '','COMPANY' TO COMPANY ELSE
	ERRMSG = 'COMPANY FILE IS MISSING'
	GOTO 93000
END
OPEN '','CONTROL' TO CONTROL ELSE
	ERRMSG = 'CONTROL FILE IS MISSING'
	GOTO 93000
END

  MATREAD COMP.REC FROM COMPANY, CONO ELSE
    ERR.FLG = 2
    ERRMSG = "Company Record Is Missing"
    GOTO 93000
  END



*******STATUS = RBO.setProperty('','xy',"SLT_ENT_DATE-> ":SLT_ENT_DATE:" SLT_DIVISION->":SLT_DIVISION:"---":CONO)
 
  CALL CHECK_PERIOD_DATE(CONO,SLT_ENT_DATE,PERIOD,SLT_DIVISION,ERR.FLG,ERR,COMPANY,CONTROL)

IF ERR.FLG = 1 OR ERR.FLG = 2 THEN
	STATUS = RBO.setProperty('','ServerStatus',1)
	STATUS = RBO.setProperty('','ServerMessage',ERR)
       STATUS=RBO.setProperty('','Period',PERIOD)
	RETURN
END ELSE
	STATUS = RBO.setProperty('','ServerStatus',0)
       STATUS = RBO.setProperty('','ServerMessage',ERR)
       STATUS = RBO.setProperty('','Period',PERIOD)

END

STATUS = RBO.getProperty('','Period',PERIOD)
IF CO.ICS.PERIOD.FLG='N' THEN
  ERR.FLG = ""
  ERRMSG = ""
TEMP=''
  CALL CHECK_PERIOD_DATE(CONO,"",PERIOD,SLT_DIVISION,ERR.FLG,ERR,COMPANY,CONTROL)

  IF ERR.FLG = 1 OR ERR.FLG = 2 THEN
	STATUS = RBO.setProperty('','ServerStatus',1)
	STATUS = RBO.setProperty('','ServerMessage',ERR)
	STATUS = RBO.setProperty('','Period',PERIOD)
	RETURN
  END
END ELSE
       
	STATUS = RBO.setProperty('','SLT_PERIOD',PERIOD)
END
        
* End of method code
RETURN

*****
93000
*****
STATUS = RBO.setProperty('','ServerStatus',1)
STATUS = RBO.setProperty('','ServerMessage',ERRMSG)
RETURN

