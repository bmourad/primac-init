SUBROUTINE GetAllValues_CSRMSR
********************************************************************************
*   Program name :- GetAllValues_CSRMSR
*   Created:- 3/20/2006
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB CSR.MEMO.TRACK
$INCLUDE CPYLIB CHAR

* Insert method code here
OPEN "","CONTROL" TO CONTROL ELSE  ERRMSG = "CONTROL FILE IS MISSING";STOP
OPEN "","CSR.MEMO.TRACK" TO CSR.MEMO.TRACK ELSE ERRMSG = "CANNOT OPEN CSR.MEMO.TRACK FILE";GOTO 93000

CONO ='';ID='';CSR_EST_NUM='';CSR_SALES_ORD_NUM ='';CSR_JOB_NUM='';CSR_PO_NUM='';CSR_INVENTORY_NUM=''
CSR_INVOICE_NUM='';CSR_MEMO='';CSR_MEMO_CODE='';CSR_RESP ='';CSR_MEMO_DATE='';CSR_FU_DATE='';I=''
P='';CNT='';CNT1='';CUST_NO='';CSR_CUST_NUM='';CSR_PO_TYPE=''

STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
STATUS = RBO.getProperty('','CSRMemoKey',ID)
STATUS = RBO.getProperty('','CUST_NO',CUST_NO)
*WRITE CONO:ID ON CONTROL,'01CCC'  
CONO   = PMCProperty<1,4>

MATREAD CSR.MEMO.TRACK.REC FROM CSR.MEMO.TRACK,CONO:ID THEN
CSR_CUST_NUM		=CSR.CUST.NUM
CSR_SALES_ORD_NUM	=CSR.SALES.ORD.NUM 
CSR_EST_NUM 		=CSR.EST.NUM 
CSR_JOB_NUM		=CSR.JOB.NUM
CSR_PO_NUM		=CSR.PO.NUM
CSR_INVENTORY_NUM 	=CSR.INVENTORY.NUM 
CSR_INVOICE_NUM 	=CSR.INVOICE.NUM 
CSR_FU_DATE		=OCONV(CSR.FU.DATE,"D2/")
CSR_PO_TYPE		=CSR.PO.TYPE
CNT = DCOUNT(CSR.MEMO,VM)
FOR I=1 TO CNT
	CSR_MEMO<1,-1>	=CSR.MEMO<1,I>
	CSR_MEMO_DATE<1,-1>	=OCONV(CSR.MEMO.DATE<1,I>,"D2/")
	CSR_MEMO_CODE<1,-1>	=CSR.MEMO.CODE<1,I>
NEXT I

CNT1 = DCOUNT(CSR.RESP,SM)
FOR P=1 TO CNT1
	CSR_RESP<1,-1>		=CSR.RESP<1,P>	 
NEXT P

*CSR_MEMO_CODE		=CSR.MEMO.CODE
CSR_STATUS		=CSR.STATUS
CSR.SEC.CODE		=CSR.SEC.CODE

END ELSE
        ERRMSG = "Invalid Item. Try again!"
        GOTO 93000
END
STATUS=RBO.setProperty('','CUST_NO',CSR_CUST_NUM)

STATUS=RBO.setProperty('','SALES_ORDER_NO',CSR_SALES_ORD_NUM)
STATUS=RBO.setProperty('','EST_NO',CSR_EST_NUM)
STATUS=RBO.setProperty('','JOB_NO',CSR_JOB_NUM)
STATUS=RBO.setProperty('','PO_NO',CSR_PO_NUM)
STATUS=RBO.setProperty('','INV_NO',CSR_INVOICE_NUM)
STATUS=RBO.setProperty('','INVENT_NO',CSR_INVENTORY_NUM)

STATUS=RBO.setProperty('','CSR_MEMO',CSR_MEMO)
STATUS=RBO.setProperty('','MEMO_DATES',CSR_MEMO_DATE)
STATUS=RBO.setProperty('','CSR_MEMO_CODE',CSR_MEMO_CODE)

STATUS=RBO.setProperty('','CSR_RESP',CSR_RESP)
STATUS=RBO.setProperty('','CSR_STATUS',CSR_STATUS)
STATUS=RBO.setProperty('','CSR_SEC_CODE',CSR.SEC.CODE)
STATUS=RBO.setProperty('','FU_DATE',CSR_FU_DATE)
STATUS=RBO.setProperty('','PO_TYPE',CSR_PO_TYPE)


* End of method code
RETURN

93000
	STATUS=RBO.setProperty('','ServerStatus',1)
	STATUS=RBO.setProperty('','ServerMessage',ERRMSG )
RETURN

