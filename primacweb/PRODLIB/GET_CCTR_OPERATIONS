 SUBROUTINE GET_CCTR_OPERATIONS
********************************************************************************
*   Program name :- GET_CCTR_OPERATIONS
*   Created:- 9/2/2004
*------------------------------------------------------------------------------*
*

* In Properties:
* --------------
*  
*
* Out Properties:
* ---------------
*  
********************************************************************************
$INCLUDE WWINSERT RBO.H
$INCLUDE PMC.CPYLIB COST.CNTR
$INCLUDE JCS.CPYLIB OPERATION

ERRMSG = ""
* Insert method code here
OPEN '', 'COST.CNTR' TO COST.CNTR ELSE 
	ERRMSG = "COST.CNTR FILE IS MISSING"
	GOTO 93000
END

OPEN '', 'OPERATION' TO OPERATION ELSE 
	ERRMSG = "OPERATION FILE IS MISSING"
	GOTO 93000
END
*STATUS=RBO.getProperty('','PMCProperty',PMCProperty)
STATUS=RBO.getProperty('','Cono',CONO)
STATUS=RBO.getProperty('','ID',ID)

*CONO   = PMCProperty<1,4>

CCTR_OPERS_CODES = ''
CCTR_OPERS_DESCS = ''
COST_CNTR_ARR = ''
COST_CNTR_DESC_ARR = ''
COUNTER = DCOUNT(ID,@VM)
XYZ = ''
FOR X = 1 TO COUNTER
 IF ((ID<1,X>="PRS" OR ID<1,X>="STT" OR ID<1,X>="CUT" OR ID<1,X>="FLD" OR ID<1,X>="BND" OR ID<1,X>="TRM" OR ID<1,X>="CSM" OR ID<1,X>="CSS" OR ID<1,X>="CSI" OR ID<1,X>="PR1" OR ID<1,X>="PR2" OR ID<1,X>="PR3" OR ID<1,X>="PR4" OR ID<1,X>="PR5" OR ID<1,X>="PR6" OR ID<1,X>="PR7" OR ID<1,X>="PR8" OR ID<1,X>="PR9")) THEN
    COST_CNTR_ARR="%"
    COST_CNTR_DESC_ARR="%"

 END ELSE
  
 MATREAD CCTR.REC FROM COST.CNTR,CONO:ID<1,X>  THEN
 CCTR_OPERS_CODES = ''
 CCTR_OPERS_DESCS = ''

   CCTR_OPERS_CODES<1,1>=CCTR.OPER
   CNT = DCOUNT(CCTR_OPERS_CODES,@VM)

		FOR I = 1 TO CNT
		
			 MATREAD OPER.REC FROM OPERATION,CONO:CCTR_OPERS_CODES<1,I> THEN
			       CCTR_OPERS_DESCS<1,1,I>=CCTR_OPERS_CODES<1,I> : "_" : OPER.DESC

				*OPER_DESCS<1,CTL,I> = CCTR.OPER<1,I>  : "-" : OPER.DESC
			END
		NEXT I
 END

 SWAP @VM WITH "ü" IN CCTR_OPERS_CODES
 COST_CNTR_ARR = COST_CNTR_ARR :"#":CCTR_OPERS_CODES
 COST_CNTR_DESC_ARR = COST_CNTR_DESC_ARR : "# " :CCTR_OPERS_DESCS

 END
NEXT X

*SWAP # WITH "," IN COST_CNTR_ARR
*SWAP @VM WITH "," IN COST_CNTR_DESC_ARR

  STATUS=RBO.setProperty('','CCTR_OPERS_CODES',COST_CNTR_ARR)
  STATUS=RBO.setProperty('','CCTR_OPERS_DESCS',COST_CNTR_DESC_ARR)
RETURN
93000
	STATUS=RBO.setProperty('','ServerStatus',1 )
	STATUS=RBO.setProperty('','ServerMessage',ERRMSG )
RETURN


