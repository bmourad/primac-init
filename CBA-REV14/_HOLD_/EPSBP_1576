









  #####  #    #   ####   #    #  #####    ####    ####   #    #
    #    #    #  #    #  ##  ##  #    #  #       #    #  ##   #
    #    ######  #    #  # ## #  #    #   ####   #    #  # #  #
    #    #    #  #    #  #    #  #####        #  #    #  #  # #
    #    #    #  #    #  #    #  #       #    #  #    #  #   ##
    #    #    #   ####   #    #  #        ####    ####   #    #

Wed Jun 28 16:23:34 CDT 2006
####### ######   #####  ######  ######
#       #     # #     # #     # #     #
#       #     # #       #     # #     #
#####   ######   #####  ######  ######
#       #             # #     # #
#       #       #     # #     # #
####### #        #####  ######  #

EPSBP/DET.PAY.INPUT                                                /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/DET.PAY.INPUT
Printed for thompson at 06/28/2006 04:23:34PM

0017 *T21246 lanny 11/20/1996 * Area for Rate in scroll area for sa     *T21246 lanny 11/20/1996 * Area for Rate in scroll area for 
0018 *                          needs to be 99999.9999.                 *                          needs to be 99999.9999.
0019 *T23966 cm 06/03/1999 * When a batch is re-opened any other in     *T23966 cm 06/03/1999 * When a batch is re-opened any other 
0020 *                       was entered in the Employee Payroll In     *                       was entered in the Employee Payroll 
0021 *                       is deleted                                 *                       is deleted
0022 *T26169 edwin 09/24/2001 * Fix problem with access to batch re  |  *T24102 markt 10/27/1999 * Expand the shift code to 2 digits
0023                                                                 >  *C36596 aron 06/21/2000 * SET DIV/DEPT/CCTR WHEN NO LINE ITE
0024                                                                 >  *                         ENTERED.
0025                                                                 >  *C36802 cm 07/31/2000 * Rate field does not allow more than 
0026                                                                 >  *                       entry.

0027                                                                 >  *T25162 cm 08/15/2000 * Add new screen to allow multiple oth
0028                                                                 >  *                       entries and remove access to other i
0029                                                                 >  *                       from this screen.
0030                                                                 >  *T25576 cm 01/05/2001 * Change the vacation and sick times t
0031                                                                 >  *                       2 digits past the decimal place.
0032                                                                 >  *T25568 cm 02/02/2001 * Change vac hours calculation to work
0033                                                                 >  *                       mod.

0034                                                                 >  *T26169 edwin 09/24/2001 * Fix problem with access of batch 
0035 *T26207 lanny 10/03/2001 * Do not allow more than 24 hours in      *T26207 lanny 10/03/2001 * Do not allow more than 24 hours i
0036 *                          'S' type overtime method.               *                          'S' type overtime method.
0037 *T25978 adelgado 02/04/2002 * Add the use of prompts (S,SR,SB,  <  
0038 ***********************************************************        ***********************************************************
0039 * ANY REFERENCE TO SEQ.CNT OR SFC.TEST ARE DEBUG AIDS THEY SHO     * ANY REFERENCE TO SEQ.CNT OR SFC.TEST ARE DEBUG AIDS THEY S
0040 * COMMENTED OUT                                                    * COMMENTED OUT

0057 *COPY>PMC.CPYLIB>DEPARTMENT                                        *COPY>PMC.CPYLIB>DEPARTMENT
0058 *COPY>PMC.CPYLIB>DIVISION                                          *COPY>PMC.CPYLIB>DIVISION
0059 *COPY>PMC.CPYLIB>COST.CNTR                                         *COPY>PMC.CPYLIB>COST.CNTR
0060 *COPY>PRS.CPYLIB>PAY.CONTROL                                       *COPY>PRS.CPYLIB>PAY.CONTROL
0061 *COPY>PRS.CPYLIB>QTD-YTD                                           *COPY>PRS.CPYLIB>QTD-YTD
0062 *T23966 v                                                       |  *COPY>PRS.CPYLIB>OTH.INC.HOLD                    ; * T23966
0063 *COPY>PRS.CPYLIB>OTH.INC.HOLD                                   |  *COPY>CBN.CPYLIB>VACATION.TRANS                  ; * T25568
0064 *T23966 ^                                                       <  
0065 *COPY>CPYLIB>CHAR                                                  *COPY>CPYLIB>CHAR
0066 *COPY>CPYLIB>SYSCOM                                                *COPY>CPYLIB>SYSCOM

0085 OPEN 'JOB.CLASS' TO JOB.CLASS ELSE ERRMSG = 'JOB.CLASS FILE IS     OPEN 'JOB.CLASS' TO JOB.CLASS ELSE ERRMSG = 'JOB.CLASS FILE 
0086 OPEN 'ATTEND.CODE' TO ATTEND.CODE ELSE ERRMSG = 'ATTEND.CODE F     OPEN 'ATTEND.CODE' TO ATTEND.CODE ELSE ERRMSG = 'ATTEND.CODE
0087 OPEN 'WORK.SHIFT' TO WORK.SHIFT ELSE ERRMSG = 'WORK.SHIFT FILE     OPEN 'WORK.SHIFT' TO WORK.SHIFT ELSE ERRMSG = 'WORK.SHIFT FI
0088 OPEN 'QTD-YTD' TO QTD.YTD ELSE ERRMSG = 'QTD-YTD FILE IS MISSI     OPEN 'QTD-YTD' TO QTD.YTD ELSE ERRMSG = 'QTD-YTD FILE IS MIS
0089 OPEN 'CONTROL' TO CONTROL ELSE ERRMSG = 'CONTROL FILE IS MISSI     OPEN 'CONTROL' TO CONTROL ELSE ERRMSG = 'CONTROL FILE IS MIS
0090 OPEN 'PRS.SCREENS' TO M.SCREENS ELSE ERRMSG = "PRS.SCREENS FIL  |  OPEN 'CBN.SCREENS' TO M.SCREENS ELSE ERRMSG = "CBN.SCREENS F
0091 *T23966 v                                                          *T23966 v
0092 OPEN 'OTH.INC.HOLD' TO OTH.INC.HOLD ELSE ERRMSG = "OTH.INC.HOL     OPEN 'OTH.INC.HOLD' TO OTH.INC.HOLD ELSE ERRMSG = "OTH.INC.H
0093 *T23966 ^                                                          *T23966 ^
0094                                                                 >  *T25568 v

0095                                                                 >  OPEN 'VACATION.TRANS' TO VACATION.TRANS ELSE ERRMSG = "VACAT
0096                                                                 >  *T25568 ^
0097 *                                                                  *
0098 *                                                                  *
0099 MATREAD EPSC.REC FROM CONTROL,CONO:"PAY.CONTROL" ELSE ERRMSG =     MATREAD EPSC.REC FROM CONTROL,CONO:"PAY.CONTROL" ELSE ERRMSG
0100 ******************************                                     ******************************
0101 DIM WRK.CONTROL(20)                                                DIM WRK.CONTROL(20)

0166 FILL = '#'                                                         FILL = '#'
0167 PAGE.SIZE = 8                                                      PAGE.SIZE = 8
0168 BEGIN.PAGE = 12                                                    BEGIN.PAGE = 12
0169 LINE.SPACE = 1                                                     LINE.SPACE = 1
0170 MAT EDIT.COM.DRIVER = ''                                           MAT EDIT.COM.DRIVER = ''
0171                                                                 >  ECD.SCRN.CNT = 2
0172 ECD.SCRN.NO = 1                                                    ECD.SCRN.NO = 1
0173 ECD.SCRN.NAME = "DET.EMP.INPUT"                                 |  ECD.SCRN.NAME<1> = "DET.EMP.INPUT"
0174                                                                 >  ECD.SCRN.NAME<2> = "OTH.INC.INPUT"
0175 ECD.ACTION = 1;CALL SCRN.EDIT                                      ECD.ACTION = 1;CALL SCRN.EDIT

0189 GO 100                                                             GO 100
0190 END                                                                END
0191 *T23966 v                                                          *T23966 v
0192 MATREAD OIH.REC FROM OTH.INC.HOLD,EMPKEY:'!':DHC.BATCH ELSE MA     MATREAD OIH.REC FROM OTH.INC.HOLD,EMPKEY:'!':DHC.BATCH ELSE 
0193 *T23966 ^                                                          *T23966 ^
0194 *   MATREADU BHD.REC FROM BATCH.HEADER,CONO:DHC.BATCH ELSE  ;   |  *  MATREADU BHD.REC FROM BATCH.HEADER,CONO:DHC.BATCH ELSE  ;
0195 MATREAD BHD.REC FROM BATCH.HEADER,CONO:DHC.BATCH ELSE              MATREAD BHD.REC FROM BATCH.HEADER,CONO:DHC.BATCH ELSE
0196 ERRMSG="NO BATCH.HEADER RECORD EXISTS FOR THIS BATCH # ":DHC.B     ERRMSG="NO BATCH.HEADER RECORD EXISTS FOR THIS BATCH # ":DHC
0197 GOSUB 900                                                          GOSUB 900
0198 RELEASE BATCH.HEADER,CONO:DHC.BATCH                                RELEASE BATCH.HEADER,CONO:DHC.BATCH

0212 ERRMSG="NO EMPLOYEE MASTER FOR THIS EMPLOYEE NUMBER"               ERRMSG="NO EMPLOYEE MASTER FOR THIS EMPLOYEE NUMBER"
0213 GOSUB 900                                                          GOSUB 900
0214 RELEASE BATCH.HEADER,CONO:DHC.BATCH                                RELEASE BATCH.HEADER,CONO:DHC.BATCH
0215 GO 100                                                             GO 100
0216 END                                                                END
0217                                                                 >  *T25568 v
0218                                                                 >  *
0219                                                                 >  *--- FIGURE THE AVAILABLE VACATION HOURS
0220                                                                 >  *
0221                                                                 >  TODAY = DATE()

0222                                                                 >  VAC.BAL = ''
0223                                                                 >  SETINDEX 'EMP.NO',EMPKEY ON VACATION.TRANS
0224                                                                 >  101 *
0225                                                                 >  READFWD TMP FROM VACATION.TRANS THEN
0226                                                                 >  EMP.ID = FIELD(@ID,'!',1)
0227                                                                 >  IF EMP.ID # EMPKEY THEN GOTO 102
0228                                                                 >  TRAN.DATE = FIELD(@ID,'!',2)

0229                                                                 >  IF TRAN.DATE GT TODAY THEN GOTO 102
0230                                                                 >  MATREAD VAC.TRANS.REC FROM VACATION.TRANS, @ID ELSE MAT.VAC.
0231                                                                 >  VAC.BAL = VAC.BAL + (VT.VAC.EARN - VT.PAID.VAC)
0232                                                                 >  GOTO 101
0233                                                                 >  END
0234                                                                 >  102 *
0235                                                                 >  *T25568 ^

0236                                                                 >  *C36596 v
0237                                                                 >  WK.DIV = EMP.DIV
0238                                                                 >  WK.DEPT = EMP.DEPT
0239                                                                 >  WK.CCTR = EMP.COST.CNTR
0240                                                                 >  *C36596 ^
0241 IF EMP.REHR.DATE - EMP.TERM.DATE < 0 THEN                          IF EMP.REHR.DATE - EMP.TERM.DATE < 0 THEN
0242 ERRMSG = "WARNING : Employee ":EMPKEY[4,4]:" has been terminat     ERRMSG = "WARNING : Employee ":EMPKEY[4,4]:" has been termin

0259 110*                                                               110*
0260 * DISPLAY EMPLOYEE FIXED INFORMATION AND DLY.HRS.CONTROL INFO      * DISPLAY EMPLOYEE FIXED INFORMATION AND DLY.HRS.CONTROL INF
0261 ECD.NUM = 1                                                        ECD.NUM = 1
0262 SCV.REC(ECD.NUM)<1> = DHC.BATCH                                    SCV.REC(ECD.NUM)<1> = DHC.BATCH
0263 ECD.ACTION = 5;CALL SCRN.EDIT                                      ECD.ACTION = 5;CALL SCRN.EDIT
0264                                                                 >  ECD.NUM = 2
0265                                                                 >  SCV.REC(ECD.NUM)<2> = EMPNO
0266                                                                 >  ECD.ACTION = 5;CALL SCRN.EDIT
0267 NAME = TRIM(EMP.LAST.NAME:', ':EMP.FRST.NAME)                      NAME = TRIM(EMP.LAST.NAME:', ':EMP.FRST.NAME)
0268 ECD.NUM = 3                                                        ECD.NUM = 3

0302 END CASE                                                           END CASE
0303 ECD.ACTION = 5;CALL SCRN.EDIT                                      ECD.ACTION = 5;CALL SCRN.EDIT
0304 ECD.NUM = 12                                                       ECD.NUM = 12
0305 SCV.REC(ECD.NUM)<1> = DHC.MDED                                     SCV.REC(ECD.NUM)<1> = DHC.MDED
0306 ECD.ACTION = 5;CALL SCRN.EDIT                                      ECD.ACTION = 5;CALL SCRN.EDIT
0307                                                                 >  *T25162 v
0308                                                                 >  *   ECD.NUM = 13
0309                                                                 >  *   SCV.REC(ECD.NUM)<1> = DHC.OTH.INCAMT
0310                                                                 >  *   ECD.ACTION = 5;CALL SCRN.EDIT
0311                                                                 >  *   ECD.NUM = 14

0312                                                                 >  *   SCV.REC(ECD.NUM)<1> = DHC.OTH.INC
0313                                                                 >  *   ECD.ACTION = 5;CALL SCRN.EDIT
0314                                                                 >  *   OTHINCKEY=CONO:DHC.OTH.INC
0315                                                                 >  *   IF DHC.OTH.INC = '' THEN GO 200
0316                                                                 >  *   READV DESC FROM OTHER.INC,OTHINCKEY,1 ELSE DESC = 'NOT O
0317                                                                 >  *   ECD.NUM = 15
0318                                                                 >  *   SCV.REC(ECD.NUM)<1> = DESC[1,25]

0319                                                                 >  *   ECD.ACTION = 5;CALL SCRN.EDIT
0320 ECD.NUM = 13                                                       ECD.NUM = 13
0321 SCV.REC(ECD.NUM)<1> = DHC.OTH.INCAMT                            |  SCV.REC(ECD.NUM)<1> = SUM(DHC.OTH.INCAMT)
0322 ECD.ACTION = 5;CALL SCRN.EDIT                                      ECD.ACTION = 5;CALL SCRN.EDIT
0323 ECD.NUM = 14                                                    |  *T25162 ^
0324 SCV.REC(ECD.NUM)<1> = DHC.OTH.INC                               <  
0325 ECD.ACTION = 5;CALL SCRN.EDIT                                   <  

0326 OTHINCKEY=CONO:DHC.OTH.INC                                      <  
0327 IF DHC.OTH.INC = '' THEN GO 200                                 <  
0328 READV DESC FROM OTHER.INC,OTHINCKEY,1 ELSE DESC = 'NOT ON FILE  <  
0329 ECD.NUM = 15                                                    <  
0330 SCV.REC(ECD.NUM)<1> = DESC[1,25]                                <  
0331 ECD.ACTION = 5;CALL SCRN.EDIT                                   <  
0332 *************                                                      *************

0379 CASE OPTION = 3                                                    CASE OPTION = 3
0380 ECD.NUM = 12                                                       ECD.NUM = 12
0381 ECD.ACTION = 4;CALL SCRN.EDIT                                      ECD.ACTION = 4;CALL SCRN.EDIT
0382 WC.MDED = ECD.RET.VALUE                                            WC.MDED = ECD.RET.VALUE
0383 GOTO 205                                                           GOTO 205
0384 CASE OPTION = 4                                                 |  *T25162 v
0385 ECD.NUM = 13                                                    |  *        CASE OPTION = 4
0386 ECD.ACTION = 4;CALL SCRN.EDIT                                   |  *             ECD.NUM = 13
0387 WC.OTH.INCAMT = ECD.RET.VALUE                                   |  *             ECD.ACTION = 4;CALL SCRN.EDIT
0388 IF WC.OTH.INCAMT = '' OR WC.OTH.INCAMT = 0 THEN                 |  *             WC.OTH.INCAMT = ECD.RET.VALUE

0389 WC.OTH.INCAMT = '';WC.OTH.INC = ''                              |  *             IF WC.OTH.INCAMT = '' OR WC.OTH.INCAMT = 0 THE
0390 SCV.REC(13)<1>=''; ECD.NUM=13;ECD.ACTION = 5; CALL SCRN.EDIT    |  *                WC.OTH.INCAMT = '';WC.OTH.INC = ''
0391 SCV.REC(14)<1>=''; ECD.NUM=14;ECD.ACTION = 5; CALL SCRN.EDIT    |  *                SCV.REC(13)<1>='';ECD.NUM=13;ECD.ACTION = 5
0392 SCV.REC(15)<1>=''; ECD.NUM=15;ECD.ACTION = 5; CALL SCRN.EDIT    |  *                SCV.REC(14)<1>='';ECD.NUM=14;ECD.ACTION = 5
0393 GOTO 205                                                        |  *                SCV.REC(15)<1>='';ECD.NUM=15;ECD.ACTION = 5
0394 END                                                             |  *                GOTO 205
0395                                                                 >  *             END

0396 220*                                                               220*
0397 ECD.NUM = 14                                                    |  *             ECD.NUM = 14
0398 ECD.ACTION = 4;CALL SCRN.EDIT                                   |  *             ECD.ACTION = 4;CALL SCRN.EDIT
0399 WC.OTH.INC = ECD.RET.VALUE                                      |  *             WC.OTH.INC = ECD.RET.VALUE
0400 OTHINCKEY=CONO:WC.OTH.INC                                       |  *             OTHINCKEY=CONO:WC.OTH.INC
0401 READV DESC FROM OTHER.INC,OTHINCKEY,1 ELSE                      |  *             READV DESC FROM OTHER.INC,OTHINCKEY,1 ELSE
0402 ERRMSG = "INVALID OTHER INCOME CODE"                            |  *                 ERRMSG = "INVALID OTHER INCOME CODE"
0403 GOSUB 900                                                       |  *                 GOSUB 900

0404 GO 220                                                          |  *                 GO 220
0405 END                                                             |  *             END
0406 ECD.NUM = 15                                                    |  *             ECD.NUM = 15
0407 SCV.REC(ECD.NUM)<1> = DESC[1,25]                                |  *             SCV.REC(ECD.NUM)<1> = DESC[1,25]
0408 ECD.ACTION = 5;CALL SCRN.EDIT                                   |  *             ECD.ACTION = 5;CALL SCRN.EDIT
0409 GOTO 205                                                        |  *             GOTO 205
0410                                                                 >  *T25162 ^

0461 END                                                                END
0462 *             SEQ.CNT = SEQ.CNT + 1                                *             SEQ.CNT = SEQ.CNT + 1
0463 *             MATWRITE SV.EPS.REC ON TESTFILE,SEQ.CNT              *             MATWRITE SV.EPS.REC ON TESTFILE,SEQ.CNT
0464 GOSUB 2000                                                         GOSUB 2000
0465 GOTO 205                                                           GOTO 205
0466                                                                 >  *T25162 v
0467                                                                 >  CASE OPTION = 'O'
0468                                                                 >  CALL OTH.INC.INPUT(CONO,EMPNO,MAT EMP.REC,MAT OIH.REC,MAT DH
0469                                                                 >  DHC.OTH.INC = OIH.OTH.INC
0470                                                                 >  DHC.OTH.INCAMT = OIH.OTH.AMT

0471                                                                 >  ECD.SCRN.NO = 1
0472                                                                 >  ECD.ACTION = 1;CALL SCRN.EDIT
0473                                                                 >  GOTO 110
0474                                                                 >  *T25162 ^
0475 CASE OPTION = 'D'                                                  CASE OPTION = 'D'
0476 GOSUB 3000                                                         GOSUB 3000
0477 IF LN.NO THEN                                                      IF LN.NO THEN

0494 LN = START.LINE + PAGE.SIZE                                        LN = START.LINE + PAGE.SIZE
0495 IF LN > LINES THEN LN = 1; OLD.START.LINE = 0                      IF LN > LINES THEN LN = 1; OLD.START.LINE = 0
0496 GOSUB 1000                                                         GOSUB 1000
0497 GOSUB 2000                                                         GOSUB 2000
0498 GOTO 205                                                           GOTO 205
0499 * T25978 v                                                      <  
0500 CASE OPTION = 'SR'                                              <  
0501 ENT.CNT = COUNT(WC.DATE,VM) + (WC.DATE # '')                    <  
0502 LINES = ENT.CNT                                                 <  
0503 FOR I = 1 TO PAGE.SIZE                                          <  

0504 PRINT @(0,(I+BEGIN.PAGE-1)):CL:                                 <  
0505 NEXT I                                                          <  
0506 LN = START.LINE - PAGE.SIZE                                     <  
0507 IF LN < 1 THEN LN = 1; OLD.START.LINE = 0                       <  
0508 GOSUB 1000                                                      <  
0509 GOSUB 2000                                                      <  
0510 GOTO 205                                                        <  

0511 CASE OPTION = 'SB'                                              <  
0512 ENT.CNT = COUNT(WC.DATE,VM) + (WC.DATE # '')                    <  
0513 LN = ENT.CNT ; OLD.START.LINE = 0                               <  
0514 FOR I = 1 TO PAGE.SIZE                                          <  
0515 PRINT @(0,(I+BEGIN.PAGE-1)):CL:                                 <  
0516 NEXT I                                                          <  
0517 GOSUB 1000                                                      <  

0518 GOSUB 2000                                                      <  
0519 GOTO 205                                                        <  
0520 CASE OPTION = 'ST'                                              <  
0521 FOR I = 1 TO PAGE.SIZE                                          <  
0522 PRINT @(0,(I+BEGIN.PAGE-1)):CL:                                 <  
0523 NEXT I                                                          <  
0524 LN = 1 ; OLD.START.LINE = 0                                     <  

0525 GOSUB 1000                                                      <  
0526 GOSUB 2000                                                      <  
0527 GOTO 205                                                        <  
0528 * T25978 ^                                                      <  
0529 CASE OPTION = 'E'                                                  CASE OPTION = 'E'
0530 *             RELEASE ALL LOCKED RECORDS                           *             RELEASE ALL LOCKED RECORDS
0531 RELEASE DLY.HRS.CONTROL,EMPKEY                                     RELEASE DLY.HRS.CONTROL,EMPKEY

0548 CASE CK.TYPE = EPSC.SICK                                           CASE CK.TYPE = EPSC.SICK
0549 CUR.SIC = CUR.SIC + SV.EPS.REG<1,X>                                CUR.SIC = CUR.SIC + SV.EPS.REG<1,X>
0550 END CASE                                                           END CASE
0551 NEXT X                                                             NEXT X
0552 250*                                                               250*
0553 TST.VAC = (ACC.VAC + CUR.VAC)/10                                |  ACC.VAC = VAC.BAL ; * T25568
0554 TST.SIC = (ACC.SIC + CUR.SIC)/10                                |  *T25576 v
0555 IF TST.VAC > EMP.MAX.VAC THEN                                   |  *        TST.VAC = (ACC.VAC + CUR.VAC)/10
0556 EXC.VAC = TST.VAC - EMP.MAX.VAC                                 |  *        TST.SIC = (ACC.SIC + CUR.SIC)/10
0557 ERRMSG = "VAC EXCEEDS MAX BY ":OCONV(EXC.VAC,'MD1'):" ACCEPT (  |  TST.VAC = ACC.VAC + CUR.VAC

0558                                                                 >  TST.SIC = ACC.SIC + CUR.SIC
0559                                                                 >  *T25576 ^
0560                                                                 >  *T25568 v
0561                                                                 >  *        IF TST.VAC > EMP.MAX.VAC THEN
0562                                                                 >  *           EXC.VAC = TST.VAC - EMP.MAX.VAC
0563                                                                 >  IF CUR.VAC GT ACC.VAC THEN
0564                                                                 >  EXC.VAC = CUR.VAC - ACC.VAC

0565                                                                 >  *T25568 ^
0566                                                                 >  *T25576 v
0567                                                                 >  *           ERRMSG = "VAC EXCEEDS MAX BY ":OCONV(EXC.VAC,'MD
0568                                                                 >  ERRMSG = "VAC EXCEEDS MAX BY ":OCONV(EXC.VAC,'MD2'):" ACCEPT
0569                                                                 >  *T25576 ^
0570 GOSUB 900                                                          GOSUB 900
0571 IF ZZ # "Y" THEN GO 200                                            IF ZZ # "Y" THEN GO 200

0602 DHC.DATE = WC.DATE                                                 DHC.DATE = WC.DATE
0603 DHC.KEY = WC.KEY                                                   DHC.KEY = WC.KEY
0604 DHC.DAYS = WC.DAYS                                                 DHC.DAYS = WC.DAYS
0605 DHC.WEEKS = WC.WEEKS                                               DHC.WEEKS = WC.WEEKS
0606 DHC.MDED = WC.MDED                                                 DHC.MDED = WC.MDED
0607 DHC.OTH.INC = WC.OTH.INC                                        |  *T25162       DHC.OTH.INC = WC.OTH.INC
0608 DHC.OTH.INCAMT = WC.OTH.INCAMT                                  |  *T25162       DHC.OTH.INCAMT = WC.OTH.INCAMT
0609 MATWRITE DHC.REC ON DLY.HRS.CONTROL,EMPKEY                         MATWRITE DHC.REC ON DLY.HRS.CONTROL,EMPKEY
0610 *T23966 v                                                          *T23966 v
0611 OIH.OTH.INC = WC.OTH.INC                                        |  *T25162       OIH.OTH.INC = WC.OTH.INC

0612 OIH.OTH.AMT = WC.OTH.INCAMT                                     |  *T25162       OIH.OTH.AMT = WC.OTH.INCAMT
0613 MATWRITE OIH.REC ON OTH.INC.HOLD, EMPKEY:'!':DHC.BATCH             MATWRITE OIH.REC ON OTH.INC.HOLD, EMPKEY:'!':DHC.BATCH
0614 *T23966 ^                                                          *T23966 ^
0615 RELEASE EMPLOYEE,EMPKEY                                            RELEASE EMPLOYEE,EMPKEY
0616 * 26169 v                                                       |  * T26169 v
0617 *             BHD.STATUS = ''                                      *        BHD.STATUS = ''
0618 *             MATWRITE BHD.REC ON BATCH.HEADER,CONO:DHC.BATCH      *        MATWRITE BHD.REC ON BATCH.HEADER,CONO:DHC.BATCH

0619 * 26169 ^                                                       |  * T26169 ^
0620 GOTO 100                                                           GOTO 100
0621 CASE 1                                                             CASE 1
0622 GOTO 200                                                           GOTO 200
0623 END CASE                                                           END CASE
0624 GO 100                                                             GO 100
0625 ***********************************************                    ***********************************************

0640 PRINT @(20,SLN):OCONV(FIELD(WC.KEY<1,N>,"!",5),'MD4') 'R#10'       PRINT @(20,SLN):OCONV(FIELD(WC.KEY<1,N>,"!",5),'MD4') 'R#10'
0641 PRINT @(31,SLN):OCONV(FIELD(WC.KEY<1,N>,"!",2),'D2/')              PRINT @(31,SLN):OCONV(FIELD(WC.KEY<1,N>,"!",2),'D2/')
0642 PRINT @(40,SLN):FIELD(WC.KEY<1,N>,"!",4)                           PRINT @(40,SLN):FIELD(WC.KEY<1,N>,"!",4)
0643 READV DESC FROM ATTEND.CODE,CONO:FIELD(WC.KEY<1,N>,"!",4),1 EL     READV DESC FROM ATTEND.CODE,CONO:FIELD(WC.KEY<1,N>,"!",4),1 
0644 PRINT @(45,SLN):DESC[1,20]                                         PRINT @(45,SLN):DESC[1,20]
0645 PRINT @(70,SLN):FIELD(WC.KEY<1,N>,"!",3)                        |  *C36802 v
0646                                                                 >  *        PRINT @(70,SLN):FIELD(WC.KEY<1,N>,"!",3)
0647                                                                 >  PRINT @(67,SLN):FIELD(WC.KEY<1,N>,"!",3)
0648                                                                 >  *C36802 ^
0649 IF SV.EPS.REG<1,N> # '' THEN                                       IF SV.EPS.REG<1,N> # '' THEN

0650 PRINT @(75,SLN):OCONV(SV.EPS.REG<1,N>,'MD2') 'R#5'              |  *C36802 v
0651                                                                 >  *             PRINT @(75,SLN):OCONV(SV.EPS.REG<1,N>,'MD2') '
0652                                                                 >  PRINT @(73,SLN):OCONV(SV.EPS.REG<1,N>,'MD2') 'R#6'
0653                                                                 >  *C36802 ^
0654 END                                                                END
0655 CNT=CNT+1                                                          CNT=CNT+1
0656 NEXT N                                                             NEXT N

0893 END                                                                END
0894 END                                                                END
0895 **CSF 26378 ^                                                      **CSF 26378 ^
0896 PRINT @(45,SLN):DESC[1,25]:                                        PRINT @(45,SLN):DESC[1,25]:
0897 4090*                                                              4090*
0898 X = 70                                                          |  *C36802 v
0899                                                                 >  *   X = 70
0900                                                                 >  X = 67
0901                                                                 >  *C36802 ^
0902 Y = SLN                                                            Y = SLN

0903 TYP = 1                                                            TYP = 1
0904 MINL = 1                                                           MINL = 1
0905 MAXL = 1                                                        |  MAXL = 2 ;* T24102
0906 DEFAULT = ''                                                       DEFAULT = ''
0907 CALL EDIT.SUB                                                      CALL EDIT.SUB
0908 IF VALUE = '' OR VALUE = 'END' THEN RETURN                         IF VALUE = '' OR VALUE = 'END' THEN RETURN
0909 WK.SHIFT = VALUE                                                   WK.SHIFT = VALUE
0910 IF EMP.WRK.SCHD<1,WK.SHIFT> = '' THEN                              IF EMP.WRK.SCHD<1,WK.SHIFT> = '' THEN
0911 ERRMSG = "THIS EMPLOYEE DOES NOT HAVE A WORK SHIFT SCHEDULE FO     ERRMSG = "THIS EMPLOYEE DOES NOT HAVE A WORK SHIFT SCHEDULE 

0912 GOSUB 900                                                          GOSUB 900
0913 WK.SHIFT = ''                                                      WK.SHIFT = ''
0914 GO 4090                                                            GO 4090
0915 END                                                                END
0916 4100*                                                              4100*
0917 X = 75                                                          |  *C36802 v
0918                                                                 >  *   X = 75
0919                                                                 >  X = 73
0920                                                                 >  *C36802 ^
0921 Y = SLN                                                            Y = SLN

0920                                                                 >  *C36802 ^
0921 Y = SLN                                                            Y = SLN
0922 TYP = 4                                                            TYP = 4
0923 SCALER = 2                                                         SCALER = 2
0924 MINL = 1                                                           MINL = 1
0925 MAXL = 5                                                        |  *C36802 v
0926                                                                 >  *   MAXL = 5
0927                                                                 >  MAXL = 6
0928                                                                 >  *C36802 ^
0929 DEFAULT = ''                                                       DEFAULT = ''


EPSBP/EMPLOYEE.MAINT2                                              /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/EMPLOYEE.MAINT2
Printed for thompson at 06/28/2006 04:23:34PM

0008 * DATE           - 12-03-89                                        * DATE           - 12-03-89
0009 * DESCRIIPTION   - EMPLOYEE MAINTENANCE (SCREEN #2)                * DESCRIIPTION   - EMPLOYEE MAINTENANCE (SCREEN #2)
0010 *                                                                  *
0011 * CSF 26104                                                        * CSF 26104
0012 *T20960 lanny 09/09/1996 * Problem with WORK.SHIFT entry/scrol     *T20960 lanny 09/09/1996 * Problem with WORK.SHIFT entry/scr
0013 *T25978 adelgado 02/05/2002 * Add the use of prompts (S,SR,SB,  |  *T24102 markt 10/12/1999 * Expand the shift code to 2 digits
0014                                                                 >  *T25142 cm 07/13/2000 * Check for rate change and update whe
0015                                                                 >  *                       appropriate.
0016                                                                 >  *ENDDOC
0017 *-------------------------------------------------------------     *-----------------------------------------------------------

0095 CASE OPT='END' OR OPT='E';MORE=0                                   CASE OPT='END' OR OPT='E';MORE=0
0096 CASE OPT='S'                                                       CASE OPT='S'
0097 VN=(PN*LCNT)+1                                                     VN=(PN*LCNT)+1
0098 IF SCV.REC(FAN)<SN,VN>='' THEN VN=1 ELSE VN=(PN*LCNT)+1            IF SCV.REC(FAN)<SN,VN>='' THEN VN=1 ELSE VN=(PN*LCNT)+1
0099 AN=FAN;CALL SCROLL.SUB;PN=INT((VN-1)/LCNT)+1                       AN=FAN;CALL SCROLL.SUB;PN=INT((VN-1)/LCNT)+1
0100 * T25978 v                                                      <  
0101 CASE OPT='SR'                                                   <  
0102 VN=((PN-1)*LCNT)+1                                              <  
0103 VN -= LCNT                                                      <  
0104 IF VN < 1 THEN VN = 1                                           <  

0105 AN=FAN;CALL SCROLL.SUB;PN=INT((VN-1)/LCNT)+1                    <  
0106 CASE OPT='SB'                                                   <  
0107 TMP.CNT = DCOUNT(SCV.REC(FAN)<SN>,VM)                           <  
0108 VN = 1 + INT((TMP.CNT-1)/LCNT)*LCNT                             <  
0109 AN=FAN;CALL SCROLL.SUB;PN=INT((VN-1)/LCNT)+1                    <  
0110 CASE OPT='ST'                                                   <  
0111 VN =1                                                           <  

0112 AN=FAN;CALL SCROLL.SUB;PN=INT((VN-1)/LCNT)+1                    <  
0113 * T25978 ^                                                      <  
0114 CASE OPT='A'                                                       CASE OPT='A'
0115 GOSUB 6000                                                         GOSUB 6000
0116 CASE OPT='C'                                                       CASE OPT='C'
0117 LVN=DCOUNT(SCV.REC(FAN)<SN>,VM)                                    LVN=DCOUNT(SCV.REC(FAN)<SN>,VM)
0118 PMSG='Line';X=0;Y=21;TYP=3;MINV=1;MAXV=LVN                         PMSG='Line';X=0;Y=21;TYP=3;MINV=1;MAXV=LVN

0182 CASE AN=10                                                         CASE AN=10
0183 IF SCV.REC(10)<SN>='' THEN                                         IF SCV.REC(10)<SN>='' THEN
0184 CHG=0                                                              CHG=0
0185 * CSF 26104 v                                                      * CSF 26104 v
0186 WSSNUM = 0                                                         WSSNUM = 0
0187 FOR I = 9 TO 1 STEP -1                                          |  * T24102 EXPAND LIMIT TO 99 v
0188                                                                 >  FOR I = 99 TO 1 STEP -1
0189 IF WRK.SCHD<1,I>#'' THEN                                           IF WRK.SCHD<1,I>#'' THEN
0190 SCV.REC(10)<SN>=I;AN=10;ACT=5;CALL SCRN.EDIT                       SCV.REC(10)<SN>=I;AN=10;ACT=5;CALL SCRN.EDIT
0191 WSSNUM = WSSNUM + 1                                                WSSNUM = WSSNUM + 1

0257 CASE AN=14                                                         CASE AN=14
0258 MATREAD JCC.REC FROM JOB.CLASS,CONO:SCV.REC(14)<SN> ELSE           MATREAD JCC.REC FROM JOB.CLASS,CONO:SCV.REC(14)<SN> ELSE
0259 MSG='* * INVALID JOB CLASS * *';GOSUB 9100                         MSG='* * INVALID JOB CLASS * *';GOSUB 9100
0260 AN=14; GOTO 1000                                                   AN=14; GOTO 1000
0261 END                                                                END
0262                                                                 >  JCC.ID = CONO:SCV.REC(14)<SN>;GOSUB 8000 ; * T25142
0263 VN2=VN;SCV.REC(15)<SN>=JCC.DESC;AN=15;ACT=5;CALL SCRN.EDIT;VN=     VN2=VN;SCV.REC(15)<SN>=JCC.DESC;AN=15;ACT=5;CALL SCRN.EDIT;V
0264 PRINT @(0,23):CL:"DO YOU WANT TO CHANGE RATE TO STANDARD ":OCO     PRINT @(0,23):CL:"DO YOU WANT TO CHANGE RATE TO STANDARD ":
O
0265 INPUT RESP:                                                        INPUT RESP:
0266 IF RESP = "Y" THEN SCV.REC(16)<SN>=JCC.RATE;AN=16;ACT=5;CALL S     IF RESP = "Y" THEN SCV.REC(16)<SN>=JCC.RATE;AN=16;ACT=5;CALL

0280 SCV.REC(AN)<SN,VN>='';ACT=5;CALL SCRN.EDIT                         SCV.REC(AN)<SN,VN>='';ACT=5;CALL SCRN.EDIT
0281 VN=VN2                                                             VN=VN2
0282 NEXT AN                                                            NEXT AN
0283 AN=31;GOTO 1000                                                    AN=31;GOTO 1000
0284 END                                                                END
0285                                                                 >  JCC.ID = CONO:SCV.REC(31)<SN,VN>;GOSUB 8000 ; * T25142
0286 IF SCV.REC(31)<SN,VN> = SCV.REC(14)<SN> THEN                       IF SCV.REC(31)<SN,VN> = SCV.REC(14)<SN> THEN
0287 MSG="* * THIS IS THE EMPLOYEE'S HOME JOB CLASS * *";GOSUB 9100     MSG="* * THIS IS THE EMPLOYEE'S HOME JOB CLASS * *";GOSUB 91
0288 FOR AN=31 TO 32                                                    FOR AN=31 TO 32
0289 VN2=VN                                                             VN2=VN

0496 EMP.SSP=SCV.REC(19)<SN>                                            EMP.SSP=SCV.REC(19)<SN>
0497 EMP.SSP.MET=SCV.REC(20)<SN>                                        EMP.SSP.MET=SCV.REC(20)<SN>
0498 EMP.OVT=SCV.REC(21)<SN>                                            EMP.OVT=SCV.REC(21)<SN>
0499 EMP.VALID.CLASS=SCV.REC(31)<SN>                                    EMP.VALID.CLASS=SCV.REC(31)<SN>
0500 EMP.VAL.CL.RATE=SCV.REC(33)<SN>                                    EMP.VAL.CL.RATE=SCV.REC(33)<SN>
0501                                                                 >  RETURN
0502                                                                 >  *T25142 v
0503                                                                 >  *-----------------------------------------------------------
0504                                                                 >  8000  * CHECK FOR RATE CHANGE
0505                                                                 >  *-----------------------------------------------------------

0506                                                                 >  JFLAG = ''
0507                                                                 >  8001 *
0508                                                                 >  JCNT = DCOUNT(JCC.EFF.DATE<1>,VM)
0509                                                                 >  FOR J = 1 TO JCNT
0510                                                                 >  IF JCC.EFF.DATE<1,J> GT DATE() THEN NULL ELSE
0511                                                                 >  JCC.RATE = JCC.EFF.RATE<1,J>
0512                                                                 >  JCC.EFF.DATE=DELETE(JCC.EFF.DATE,1,J,0)

0513                                                                 >  JCC.EFF.RATE=DELETE(JCC.EFF.RATE,1,J,0)
0514                                                                 >  JFLAG = 1
0515                                                                 >  GOTO 8001
0516                                                                 >  END
0517                                                                 >  NEXT J
0518                                                                 >  IF JFLAG THEN MATWRITE JCC.REC ON JOB.CLASS,JCC.ID
0519 RETURN                                                             RETURN


EPSBP/EPS.DAILY.HOURS.LIST                                         /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/EPS.DAILY.HOURS.LIST
Printed for thompson at 06/28/2006 04:23:35PM

0019 *     AUTHOR               -  SARA CRISMON                         *     AUTHOR               -  SARA CRISMON
0020 *                                                                  *
0021 *     DATE                 -  NOVEMBER 1989                        *     DATE                 -  NOVEMBER 1989
0022 *                                                                  *
0023 *T20021 RICKB 01/16/1996 * MODIFY HEADING TO INCLUDE CHOSEN DI     *T20021 RICKB 01/16/1996 * MODIFY HEADING TO INCLUDE CHOSEN 
0024                                                                 >  *T25218 cm 07/11/2000 * Change report to display the correct
0025                                                                 >  *                       Ending Date.
0026 **************************************************************     ************************************************************
0027 *                                                                  *
0028 *---- INSERT FILE EQUATES                                          *---- INSERT FILE EQUATES

0052 PROCREAD X ELSE                                                    PROCREAD X ELSE
0053 ERRMSG = 'CANNOT PERFORM PROCREAD';GO 93000                        ERRMSG = 'CANNOT PERFORM PROCREAD';GO 93000
0054 END                                                                END
0055 CONO=X<1>                                                          CONO=X<1>
0056 CO.NAME=X<2>                                                       CO.NAME=X<2>
0057 END.DATE=X<3>                                                   |  *T25218 v
0058 *T20021 v                                                       |  *     END.DATE=X<3>
0059 SELECTED.DIV=X<4>                                               |  *     SELECTED.DIV=X<4>
0060 *T20021 ^                                                       |  END.DATE=X<4>
0061                                                                 >  SELECTED.DIV=X<5>

0062                                                                 >  *T25218 ^
0063 MATREAD COMP.REC FROM COMPANY,CONO ELSE                            MATREAD COMP.REC FROM COMPANY,CONO ELSE
0064 ERRMSG='CANNOT READ COMPANY':CONO;GO 93000                         ERRMSG='CANNOT READ COMPANY':CONO;GO 93000
0065 END                                                                END
0066 *                                                                  *
0067 *---- HEADING ROUTINE                                              *---- HEADING ROUTINE
0068 *                                                                  *

0069 REPORT.NAME="DAILY HOURS SUMMARY"                                  REPORT.NAME="DAILY HOURS SUMMARY"
0070 REPORT.NUMBER="XXXX"                                               REPORT.NUMBER="XXXX"
0071 REPORT.DATE=END.DATE                                               REPORT.DATE=END.DATE
0072 HD1='';HD2=''                                                      HD1='';HD2=''
0073 CALL GET.PROG.HEAD(CONO,CO.NAME,REPORT.NAME,REPORT.NUMBER,REPO     CALL GET.PROG.HEAD(CONO,CO.NAME,REPORT.NAME,REPORT.NUMBER,RE
0074 HD2=""                                                          <  
0075 HD2="RPT #-BY : XX-XXXX":SPACE(48):"DAILY HOURS SUMMARY"        <  
0076 *                                                                  *
0077 *---- INITIALIZATION                                               *---- INITIALIZATION
0078 *                                                                  *


EPSBP/EPS.DEPARTMENT.MAINT                                         /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/EPS.DEPARTMENT.MAINT
Printed for thompson at 06/28/2006 04:23:35PM

0006 * SOURCE      - EPSBP                                              * SOURCE      - EPSBP
0007 * BY          - WALID YAMOUT, COMPUTER BUSINESS ASSOCIATES         * BY          - WALID YAMOUT, COMPUTER BUSINESS ASSOCIATES
0008 * DATE        - 09/19/83                                           * DATE        - 09/19/83
0009 * DESCRIPTION  -                                                   * DESCRIPTION  -  
0010 * LAST COMPILE - 992                                               * LAST COMPILE - 992  
0011 *T25978 adelgado 02/05/2002 * Add the use of prompts (S,SR,SB,  <  
0012 **************************************************************     ************************************************************
0013 *                                                                  *  
0014 *--- INSERT CPYLIB                                                 *--- INSERT CPYLIB  
0015 *                                                                  *  

0185 GOSUB 21000                                                        GOSUB 21000
0186 CASE REQUEST = 'S'                                                 CASE REQUEST = 'S'
0187 LN = LN + PAGE.SIZE                                                LN = LN + PAGE.SIZE
0188 IF LN > LINES THEN LN = 1                                          IF LN > LINES THEN LN = 1
0189 GOSUB 21000                                                        GOSUB 21000
0190 * T25978 v                                                      <  
0191 CASE REQUEST = 'SR'                                             <  
0192 LN -= PAGE.SIZE                                                 <  
0193 IF LN < 1 THEN LN = 1                                           <  
0194 GOSUB 21000                                                     <  

0195 CASE REQUEST = 'ST'                                             <  
0196 LN = 1                                                          <  
0197 GOSUB 21000                                                     <  
0198 CASE REQUEST = 'SB'                                             <  
0199 LN = LINES                                                      <  
0200 GOSUB 21000                                                     <  
0201 * T25978 ^                                                      <  


EPSBP/EPS.EL                                                       /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/EPS.EL
Printed for thompson at 06/28/2006 04:23:35PM

0015 *      03/17/97                                                    *      03/17/97
0016 *                                                                  *
0017 *                                                                  *
0018 *T22288 rick 10/15/1997 * Year 2000 compliance. Make sure date     *T22288 rick 10/15/1997 * Year 2000 compliance. Make sure da
0019 *                         4 digit years.                           *                         4 digit years.
0020                                                                 >  *T24102 markt 10/13/1999 * Expand the shift code to 2 digits
0021 *T24450 alex 10/14/1999 * Report is missing fields from Employ     *T24450 alex 10/14/1999 * Report is missing fields from Empl
0022 *                         Maintenance Screens                      *                         Maintenance Screens
0023 *T24450 gil 12/08/1999 * CORRECTING THE WORK SHIFT SCHEDULE TO     *T24450 gil 12/08/1999 * CORRECTING THE WORK SHIFT SCHEDULE 
0024 *                        MULTIVALUE AND RE-NAMED THE WORK SHIF  |  *                        MULTIVALUE AND RE-NAMED THE WORK SH

0025                                                                 >  *T25137 alex 05/18/2000 * Mods to the report to print Depart
0026                                                                 >  *                         Division Number & Name, and Employ
0027                                                                 >  *                         to the listing.
0028                                                                 >  *T25576 cm 01/09/2001 * Change vacation hours and sick hours
0029                                                                 >  *                       digits past the decimal place.
0030 *ENDDOC                                                            *ENDDOC
0031 **************************************************************     ************************************************************

0033 *--- INSERT FILES EQUATES                                          *--- INSERT FILES EQUATES
0034 *                                                                  *
0035 *COPY>PMC.CPYLIB>EMPLOYEE                                          *COPY>PMC.CPYLIB>EMPLOYEE
0036 *COPY>CPYLIB>CHAR                                                  *COPY>CPYLIB>CHAR
0037 *COPY>PRS.CPYLIB>JOB.CLASS      ;*T24450                           *COPY>PRS.CPYLIB>JOB.CLASS      ;*T24450
0038                                                                 >  *COPY>PMC.CPYLIB>DEPARTMENT     ;*T25137
0039                                                                 >  *COPY>PMC.CPYLIB>DIVISION       ;*T25137
0040 CLEAR                                                              CLEAR
0041 PROCREAD X ELSE PRINT "CANNOT READ INPUT BUFFER";INPUT X;STOP      PROCREAD X ELSE PRINT "CANNOT READ INPUT BUFFER";INPUT X;STO
0042 CONO=EXTRACT(X,1,0,0)                                              CONO=EXTRACT(X,1,0,0)

0044 G$ = EXTRACT(X,3,0,0)                                              G$ = EXTRACT(X,3,0,0)
0045 DSH = STR("-",45)                                                  DSH = STR("-",45)
0046 OPEN "","EMPLOYEE" TO EMPLOYEE ELSE PRINT "CAN'T OPEN EMPLOYEE     OPEN "","EMPLOYEE" TO EMPLOYEE ELSE PRINT "CAN'T OPEN EMPLOY
0047 OPEN "","MISCDED" TO MISCDED ELSE PRINT "CAN'T OPEN MISCDED";S     OPEN "","MISCDED" TO MISCDED ELSE PRINT "CAN'T OPEN MISCDED"
0048 OPEN "","JOB.CLASS" TO JOB.CLASS ELSE PRINT "CAN'T OPEN JOB.CL     OPEN "","JOB.CLASS" TO JOB.CLASS ELSE PRINT "CAN'T OPEN JOB.
0049                                                                 >  *T25137 v
0050                                                                 >  OPEN "","DEPARTMENT" TO DEPARTMENT ELSE PRINT "CAN'T OPEN DE
0051                                                                 >  OPEN "","DIVISION" TO DIVISION ELSE PRINT "CAN'T OPEN DIVISI
0052                                                                 >  *T25137 ^
0053 *                                                                  *

0089 IF EMP.DELETE = 'Y' THEN                                           IF EMP.DELETE = 'Y' THEN
0090 IF EMP.TERM.DATE < CHECK.DATE THEN                                 IF EMP.TERM.DATE < CHECK.DATE THEN
0091 GOTO 300                                                           GOTO 300
0092 END                                                                END
0093 END                                                                END
0094                                                                 >  *T25137 v
0095                                                                 >  MATREAD DEPT.REC FROM DEPARTMENT, CONO:EMP.DEPT ELSE MAT DEP
0096                                                                 >  MATREAD DIV.REC FROM DIVISION, CONO:EMP.DIV ELSE MAT DIV.REC
0097                                                                 >  *T25137 ^
0098 EMP.NO = ID[4,4]                                                   EMP.NO = ID[4,4]

0106 DES<Y> = DESC                                                      DES<Y> = DESC
0107 END                                                                END
0108 NEXT Y                                                             NEXT Y
0109 END                                                                END
0110 *T24450 TOP   :  GET SHIFT #                                       *T24450 TOP   :  GET SHIFT #
0111 *WRK.SHIFT = 1                                                  <  
0112 *FOR I = 9 TO 1 STEP -1                                         <  
0113 *  IF EMP.WRK.SCHD<1,I> # '' THEN                               <  
0114 *    WRK.SHIFT = I                                              <  
0115 *  END                                                          <  

0116 *NEXT I                                                         <  
0117 ***    GET JOB CLASSIFICATION INFO                                 ***    GET JOB CLASSIFICATION INFO
0118 CLS.CNT = DCOUNT(EMP.VALID.CLASS,VM) ; JCC.DESC.ARRAY = ''         CLS.CNT = DCOUNT(EMP.VALID.CLASS,VM) ; JCC.DESC.ARRAY = ''
0119 FOR I = 1 TO CLS.CNT                                               FOR I = 1 TO CLS.CNT
0120 MATREAD JCC.REC FROM JOB.CLASS, CONO:EMP.VALID.CLASS<1,I> ELSE     MATREAD JCC.REC FROM JOB.CLASS, CONO:EMP.VALID.CLASS<1,I> EL
0121 MAT JCC.REC = ''                                                   MAT JCC.REC = ''
0122 END                                                                END

0125 *T24450 BOTTOM                                                     *T24450 BOTTOM
0126 NAME=EMP.FRST.NAME:" ":EMP.LAST.NAME                               NAME=EMP.FRST.NAME:" ":EMP.LAST.NAME
0127 STATUS = EMP.STATUS"L#":"-":EMP.PAY.CYCLE"L#"                      STATUS = EMP.STATUS"L#":"-":EMP.PAY.CYCLE"L#"
0128 IF EMP.STATUS="H" THEN RS=OCONV(EMP.RATE,"MD4") ELSE RS=OCONV(     IF EMP.STATUS="H" THEN RS=OCONV(EMP.RATE,"MD4") ELSE RS=OCON
0129 PRINT EMP.NO"R#4":" ":NAME"L#28":"  ":EMP.ADDR1"L#25":" ":EMP.     PRINT EMP.NO"R#4":" ":NAME"L#28":"  ":EMP.ADDR1"L#25":" ":EM
0130 PRINT EMP.STATE"L##":"   ":EMP.ZIP"L#10":"   ":EMP.STATUS"L#":  |  * T24102 v
0131 PRINT SPACE(6):RS"R#7":" ":EMP.DEPT                             |  *PRINT EMP.STATE"L##":"   ":EMP.ZIP"L#10":"   ":EMP.STATUS"L
0132                                                                 >  *PRINT SPACE(6):RS"R#7":" ":EMP.DEPT
0133                                                                 >  PRINT EMP.STATE"L##":"   ":EMP.ZIP"L#10":"   ":EMP.STATUS"L#
0134                                                                 >  PRINT SPACE(5):RS"R#7":" ":EMP.DEPT

0135                                                                 >  * T24102 ^
0136 IF G$="L" THEN                                                     IF G$="L" THEN
0137                                                                 >  *T25137 v
0138                                                                 >  PRINT 'DIV : ':EMP.DIV'L#2':SPACE(2):DIV.DESC'L#24':
0139 IF EMP.ADDR2 # "" THEN                                             IF EMP.ADDR2 # "" THEN
0140 PRINT SPACE(35):EMP.ADDR2 "L#30"                                |  * PRINT SPACE(35):EMP.ADDR2 "L#30"
0141                                                                 >  PRINT  ' ':EMP.ADDR2'L#30':

0142                                                                 >  END ELSE
0143                                                                 >  PRINT SPACE(31):
0144 END                                                                END
0145                                                                 >  PRINT SPACE(1):'DEPT NAME : ':DEPT.DESC'L#25':
0146                                                                 >  IF EMP.K.NUM = 'F' THEN
0147                                                                 >  PRINT SPACE(1):'(FULLTIME)'
0148                                                                 >  END ELSE

0149                                                                 >  PRINT SPACE(1):'(PARTTIME)'
0150                                                                 >  END
0151                                                                 >  *T25137 ^
0152 PRINT                                                              PRINT
0153 GOTO 300                                                           GOTO 300
0154 END                                                                END
0155 ***** LINE 1                                                       ***** LINE 1

0202 PRINT "NORMAL":SPACE(8):"ALT EMP NO:  ":EMP.ALT.NO"R#5":SPACE(     PRINT "NORMAL":SPACE(8):"ALT EMP NO:  ":EMP.ALT.NO"R#5":SPAC
0203 PRINT EMP.CITY.CODE"L#4":"     BONDS:":SPACE(7):OCONV(EMP.BOND     PRINT EMP.CITY.CODE"L#4":"     BONDS:":SPACE(7):OCONV(EMP.BO
0204 PRINT SPACE(5):"DIVISION:":SPACE(6):EMP.DIV"L#2"                   PRINT SPACE(5):"DIVISION:":SPACE(6):EMP.DIV"L#2"
0205 *****  LINE 9                                                      *****  LINE 9
0206 *PRINT SPACE(14):"SICK HOURS:  ":OCONV(EMP.MAX.SIC,'MD1')"R#6"     *PRINT SPACE(14):"SICK HOURS:  ":OCONV(EMP.MAX.SIC,'MD1')"R#
0207 PRINT "SHIFT:":SPACE(4):EMP.NORM.SHFT"L#1":SPACE(3):"SICK HOUR  |  *T25576 v
0208                                                                 >  * PRINT "SHIFT:":SPACE(4):EMP.NORM.SHFT"L#1":SPACE(3):"SICK 
0209                                                                 >  PRINT "SHIFT:":SPACE(4):EMP.NORM.SHFT"L#1":SPACE(3):"SICK HO
0210                                                                 >  *T25576 ^
0211 IF EMP.FIT.CALC<1,2> + 0 # 0 THEN                                  IF EMP.FIT.CALC<1,2> + 0 # 0 THEN

0214 PRINT SPACE(10):"FWH CALC:    ":OCONV(EMP.FIT.CALC<1,1>,"MD2")     PRINT SPACE(10):"FWH CALC:    ":OCONV(EMP.FIT.CALC<1,1>,"MD2
0215 END                                                                END
0216 PRINT SPACE(45):"COST CENTER:   ":EMP.COST.CNTR"L#3"               PRINT SPACE(45):"COST CENTER:   ":EMP.COST.CNTR"L#3"
0217 *PRINT SPACE(14):"VAC HOURS:   ":OCONV(EMP.MAX.VAC,'MD1')"R#6"     *PRINT SPACE(14):"VAC HOURS:   ":OCONV(EMP.MAX.VAC,'MD1')"R#
0218 ***                                                                ***
0219 PRINT "LANGUAGE: ":EMP.LANGUAGE"L#1":SPACE(3):"VAC HOURS:   ":  |  *T25576 v
0220                                                                 >  * PRINT "LANGUAGE: ":EMP.LANGUAGE"L#1":SPACE(3):"VAC HOURS: 
0221                                                                 >  PRINT "LANGUAGE: ":EMP.LANGUAGE"L#1":SPACE(3):"VAC HOURS:   
0222                                                                 >  *T25576 ^
0223 PRINT SPACE(10):"LAST REV.DT: ":OCONV(EMP.REV.DATE<1,1>,"D2/")     PRINT SPACE(10):"LAST REV.DT: ":OCONV(EMP.REV.DATE<1,1>,"D2/


EPSBP/EPS.EMPLOYEE.MAINT                                           /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/EPS.EMPLOYEE.MAINT
Printed for thompson at 06/28/2006 04:23:35PM

0008 * MODIFIED       - 03/16/88 BY KERRY WILSON                        * MODIFIED       - 03/16/88 BY KERRY WILSON
0009 *                - 07/25/89]RRG]#14032]UPDATE MISCDED WITH FLA     *                - 07/25/89]RRG]#14032]UPDATE MISCDED WITH F
0010 * MODIFIED       - 12/05/89 Scott Dickerson,PRISM Software Tec     * MODIFIED       - 12/05/89 Scott Dickerson,PRISM Software T
0011 * DESCRIIPTION   - EMPLOYEE MAINTENANCE                            * DESCRIIPTION   - EMPLOYEE MAINTENANCE
0012 *T21851 lanny 04/28/1997 * Default SICK FICA field to Y.           *T21851 lanny 04/28/1997 * Default SICK FICA field to Y.
0013                                                                 >  *T24102 markt 10/11/1999 * Expand the shift code to 2 digits
0014 *-------------------------------------------------------------     *-----------------------------------------------------------
0015 *COPY>CPYLIB>COM1                                                  *COPY>CPYLIB>COM1
0016 *COPY>CPYLIB>CHAR                                                  *COPY>CPYLIB>CHAR
0017 *COPY>CPYLIB>EDIT.COM                                              *COPY>CPYLIB>EDIT.COM

0066 OPEN 'TAX2' TO TAX2 ELSE MSG='TAX2';GO 92000                       OPEN 'TAX2' TO TAX2 ELSE MSG='TAX2';GO 92000
0067 OPEN 'PAYTYPE' TO PAYTYPE ELSE MSG='PAYTYPE';GO 92000              OPEN 'PAYTYPE' TO PAYTYPE ELSE MSG='PAYTYPE';GO 92000
0068 OPEN 'MISCDED' TO MISCDED ELSE MSG='MISCDED';GO 92000              OPEN 'MISCDED' TO MISCDED ELSE MSG='MISCDED';GO 92000
0069 OPEN 'QTD-YTD' TO QTD.YTD ELSE MSG='QTD-YTD';GO 92000              OPEN 'QTD-YTD' TO QTD.YTD ELSE MSG='QTD-YTD';GO 92000
0070 OPEN 'PRS.SCREENS' TO M.SCREENS ELSE MSG='PRS.SCREENS';GO 9200     OPEN 'PRS.SCREENS' TO M.SCREENS ELSE MSG='PRS.SCREENS';GO 92
0071                                                                 >  OPEN 'CBN.SCREENS' TO SECOND.SCREENS ELSE MSG='CBN.SCREENS';
0072 OPEN 'KEYWORDS' TO KEYWORDS ELSE MSG='KEYWORDS';GO 92000           OPEN 'KEYWORDS' TO KEYWORDS ELSE MSG='KEYWORDS';GO 92000
0073 OPEN 'INVEST.FUND.CODE' TO INVEST.FUND.CODE ELSE MSG='INVEST.F     OPEN 'INVEST.FUND.CODE' TO INVEST.FUND.CODE ELSE MSG='INVEST
0074 IF CO.EMP.XREF='Y' THEN                                            IF CO.EMP.XREF='Y' THEN
0075 OPEN 'EMPLOYEE.XREF' TO EMPLOYEE.XREF ELSE MSG='EMPLOYEE.XREF'     OPEN 'EMPLOYEE.XREF' TO EMPLOYEE.XREF ELSE MSG='EMPLOYEE.XRE

0077 *-------------------------------------------------------------     *-----------------------------------------------------------
0078 * SCREEN                                                           * SCREEN
0079 MAT EDIT.COM.DRIVER=''                                             MAT EDIT.COM.DRIVER=''
0080 ECD.SCRN.CNT=3                                                     ECD.SCRN.CNT=3
0081 ECD.SCRN.NAME<1>='EPS.EMPLOYEE.MAINT'                              ECD.SCRN.NAME<1>='EPS.EMPLOYEE.MAINT'
0082                                                                 >  ECD.SCRN.FLAG<1> = 2 ;* T24102
0083 ECD.SCRN.NAME<2>='EMPLOYEE.MAINT2'                                 ECD.SCRN.NAME<2>='EMPLOYEE.MAINT2'
0084                                                                 >  ECD.SCRN.FLAG<2> = 2 ;* T24102
0085 ECD.SCRN.NAME<3>='EMPLOYEE.MAINT3'                                 ECD.SCRN.NAME<3>='EMPLOYEE.MAINT3'
0086 ACT=1;CALL SCRN.EDIT                                               ACT=1;CALL SCRN.EDIT


EPSBP/EPS.EOM.POST                                                 /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/EPS.EOM.POST
Printed for thompson at 06/28/2006 04:23:36PM

0006 * SOURCE      - PRSBP                                              * SOURCE      - PRSBP
0007 * PROGRAM     - PRS.EOM.POST                                       * PROGRAM     - PRS.EOM.POST
0008 * BY          - ZIAD YAMOUT, C.B.A                                 * BY          - ZIAD YAMOUT, C.B.A
0009 * DATE        - 02/28/87                                           * DATE        - 02/28/87
0010 * DESCRIPTION -                                                    * DESCRIPTION -
0011 *T26695 cmykleb 06/24/2002 * Sub-Dept accts not being carried   |  *T26686 lross 06/19/2002 * Sub-Dept accts not being carried 
0012 *ENDDOC                                                            *ENDDOC
0013 **************************************************************     ************************************************************
0014 *                                                                  *
0015 ***** INSERT FILE EQUETE                                           ***** INSERT FILE EQUETE

0136 GOTO 900                                                           GOTO 900
0137 END                                                                END
0138 KEY = FIELD(MDS.ID,"!",1)                                          KEY = FIELD(MDS.ID,"!",1)
0139 MDS.EMP = KEY[4,4]                                                 MDS.EMP = KEY[4,4]
0140 MDS.DIV = KEY[8,2]                                                 MDS.DIV = KEY[8,2]
0141 *T26695 v                                                       |  *T26686v MDS.DEPT = KEY[10,2]
0142 *     MDS.DEPT = KEY[10,2]                                      <  
0143 MDS.DEPT = FIELD(KEY,"!",1)[10,5]                                  MDS.DEPT = FIELD(KEY,"!",1)[10,5]
0144 *T26695 ^                                                       <  
0145 MDS.CCTR = FIELD(MDS.ID,"!",2)                                     MDS.CCTR = FIELD(MDS.ID,"!",2)

0183 PR.GRS.ACCT<II> = GLTB.PR.EARN                                     PR.GRS.ACCT<II> = GLTB.PR.EARN
0184 PR.GRS.LEVEL<II> = COA.LEVEL                                       PR.GRS.LEVEL<II> = COA.LEVEL
0185 END CASE                                                           END CASE
0186 BEGIN CASE                                                         BEGIN CASE
0187 CASE PR.GRS.LEVEL<II> = 0                                          CASE PR.GRS.LEVEL<II> = 0
0188 T.ACCT = GEN.DIV:GEN.DEPT:GEN.CCTR:PR.GRS.ACCT<II>              |  T.ACCT = GEN.DIV : GEN.DEPT : GEN.CCTR : PR.GRS.ACCT<II>
0189 CASE PR.GRS.LEVEL<II> = 1                                          CASE PR.GRS.LEVEL<II> = 1
0190 T.ACCT = MDS.DIV:GEN.DEPT:GEN.CCTR:PR.GRS.ACCT<II>              |  T.ACCT = MDS.DIV : GEN.DEPT : GEN.CCTR : PR.GRS.ACCT<II>
0191 CASE PR.GRS.LEVEL<II> = 2                                          CASE PR.GRS.LEVEL<II> = 2
0192 *T26695 v                                                       |  *T26686 v         T.ACCT = MDS.DIV : MDS.DEPT : GEN.CCTR : P

0193 *              T.ACCT = MDS.DIV:MDS.DEPT:GEN.CCTR:PR.GRS.ACCT<  |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : GEN.CCTR : PR.GRS.ACCT<II
0194 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:GEN.CCTR:PR.GRS.ACCT<II>         <  
0195 *T26695 ^                                                       <  
0196 CASE 1                                                             CASE 1
0197 *T26695 v                                                       |  *T26686 v         T.ACCT = MDS.DIV : MDS.DEPT : MDS.CCTR : P
0198 *              T.ACCT = MDS.DIV:MDS.DEPT : MDS.CCTR : PR.GRS.A  |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : MDS.CCTR : PR.GRS.ACCT<II
0199 T.ACCT = MDS.DIV:MDS.DEPT[1,2] : MDS.CCTR : PR.GRS.ACCT<II>     <  

0200 *T26695 ^                                                       <  
0201 END CASE                                                           END CASE
0202 PRS.AMT = MDS.EARN<1,II>; TOT.AMT = TOT.AMT + PRS.AMT              PRS.AMT = MDS.EARN<1,II>; TOT.AMT = TOT.AMT + PRS.AMT
0203 MDS.NO = "GR"; GOSUB 1000                                          MDS.NO = "GR"; GOSUB 1000
0204 NEXT II                                                            NEXT II
0205 IF MDS.SWHT + 0 <> 0 OR MDS.DIAB + 0 <> 0 THEN                     IF MDS.SWHT + 0 <> 0 OR MDS.DIAB + 0 <> 0 THEN
0206 MATREAD TAX.TAB.REC FROM TAX2, CONO : EMP.ST.CODE ELSE             MATREAD TAX.TAB.REC FROM TAX2, CONO : EMP.ST.CODE ELSE

0215 MATREAD COA.REC FROM COA, CONO : TTR.TAX.ACCT ELSE COA.LEVEL =     MATREAD COA.REC FROM COA, CONO : TTR.TAX.ACCT ELSE COA.LEVEL
0216 PR.STX.ACCT = TTR.TAX.ACCT; PR.STX.LEVEL = COA.LEVEL               PR.STX.ACCT = TTR.TAX.ACCT; PR.STX.LEVEL = COA.LEVEL
0217 END CASE                                                           END CASE
0218 BEGIN CASE                                                         BEGIN CASE
0219 CASE PR.STX.LEVEL = 0                                              CASE PR.STX.LEVEL = 0
0220 T.ACCT = GEN.DIV:GEN.DEPT:GEN.CCTR:PR.STX.ACCT                  |  T.ACCT = GEN.DIV : GEN.DEPT : GEN.CCTR : PR.STX.ACCT
0221 CASE PR.STX.LEVEL = 1                                              CASE PR.STX.LEVEL = 1
0222 T.ACCT = MDS.DIV:GEN.DEPT:GEN.CCTR:PR.STX.ACCT                  |  T.ACCT = MDS.DIV : GEN.DEPT : GEN.CCTR : PR.STX.ACCT
0223 CASE PR.STX.LEVEL = 2                                              CASE PR.STX.LEVEL = 2
0224 *T26695 v                                                       |  *T26686 v            T.ACCT = MDS.DIV : MDS.DEPT : GEN.CCTR 

0225 *                 T.ACCT = MDS.DIV:MDS.DEPT:GEN.CCTR:PR.STX.AC  |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : GEN.CCTR : PR.STX.ACCT
0226 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:GEN.CCTR:PR.STX.ACCT             <  
0227 *T26695 ^                                                       <  
0228 CASE 1                                                             CASE 1
0229 *T26695 v                                                       |  *T26686 v            T.ACCT = MDS.DIV : MDS.DEPT : MDS.CCTR 
0230 *                 T.ACCT = MDS.DIV:MDS.DEPT:MDS.CCTR:PR.STX.AC  |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : MDS.CCTR : PR.STX.ACCT
0231 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:MDS.CCTR:PR.STX.ACCT             <  

0232 *T26695 ^                                                       <  
0233 END CASE                                                           END CASE
0234 PRS.AMT = MDS.SWHT; TOT.AMT = TOT.AMT - PRS.AMT                    PRS.AMT = MDS.SWHT; TOT.AMT = TOT.AMT - PRS.AMT
0235 MDS.NO = "ST-" : EMP.ST.CODE; GOSUB 2000                           MDS.NO = "ST-" : EMP.ST.CODE; GOSUB 2000
0236 END                                                                END
0237 IF MDS.DIAB + 0 <> 0 THEN                                          IF MDS.DIAB + 0 <> 0 THEN
0238 BEGIN CASE                                                         BEGIN CASE

0243 MATREAD COA.REC FROM COA, CONO : TTR.SUI.ACCT ELSE COA.LEVEL =     MATREAD COA.REC FROM COA, CONO : TTR.SUI.ACCT ELSE COA.LEVEL
0244 PR.SUI.ACCT = TTR.SUI.ACCT; PR.SUI.LEVEL = COA.LEVEL               PR.SUI.ACCT = TTR.SUI.ACCT; PR.SUI.LEVEL = COA.LEVEL
0245 END CASE                                                           END CASE
0246 BEGIN CASE                                                         BEGIN CASE
0247 CASE PR.SUI.LEVEL = 0                                              CASE PR.SUI.LEVEL = 0
0248 T.ACCT = GEN.DIV:GEN.DEPT:GEN.CCTR:TTR.SUI.ACCT                 |  T.ACCT = GEN.DIV : GEN.DEPT : GEN.CCTR : TTR.SUI.ACCT
0249 CASE PR.SUI.LEVEL = 1                                              CASE PR.SUI.LEVEL = 1
0250 T.ACCT = MDS.DIV:GEN.DEPT:GEN.CCTR:TTR.SUI.ACCT                 |  T.ACCT = MDS.DIV : GEN.DEPT : GEN.CCTR : TTR.SUI.ACCT
0251 CASE PR.SUI.LEVEL = 2                                              CASE PR.SUI.LEVEL = 2
0252 *T26695 v                                                       |  *T26686 v            T.ACCT = MDS.DIV : MDS.DEPT : GEN.CCTR 

0253 *                 T.ACCT = MDS.DIV:MDS.DEPT:GEN.CCTR:TTR.SUI.A  |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : GEN.CCTR : TTR.SUI.ACCT
0254 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:GEN.CCTR:TTR.SUI.ACCT            <  
0255 *T26695 ^                                                       <  
0256 CASE 1                                                             CASE 1
0257 *T26695 v                                                       |  *T26686 v            T.ACCT = MDS.DIV : MDS.DEPT : MDS.CCTR 
0258 *                 T.ACCT = MDS.DIV:MDS.DEPT:MDS.CCTR:TTR.SUI.A  |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : MDS.CCTR : TTR.SUI.ACCT
0259 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:MDS.CCTR:TTR.SUI.ACCT            <  

0260 *T26695 ^                                                       <  
0261 END CASE                                                           END CASE
0262 PRS.AMT = MDS.DIAB; TOT.AMT = TOT.AMT - PRS.AMT                    PRS.AMT = MDS.DIAB; TOT.AMT = TOT.AMT - PRS.AMT
0263 MDS.NO = "DB-" : EMP.ST.CODE; GOSUB 2000                           MDS.NO = "DB-" : EMP.ST.CODE; GOSUB 2000
0264 END                                                                END
0265 END                                                                END
0266 IF MDS.CWHT + 0 <> 0 THEN                                          IF MDS.CWHT + 0 <> 0 THEN

0275 MATREAD COA.REC FROM COA, CONO : TTR.TAX.ACCT ELSE COA.LEVEL =     MATREAD COA.REC FROM COA, CONO : TTR.TAX.ACCT ELSE COA.LEVEL
0276 PR.CTX.ACCT = TTR.TAX.ACCT; PR.CTX.LEVEL = COA.LEVEL               PR.CTX.ACCT = TTR.TAX.ACCT; PR.CTX.LEVEL = COA.LEVEL
0277 END CASE                                                           END CASE
0278 BEGIN CASE                                                         BEGIN CASE
0279 CASE PR.CTX.LEVEL = 0                                              CASE PR.CTX.LEVEL = 0
0280 T.ACCT = GEN.DIV:GEN.DEPT:GEN.CCTR:TTR.TAX.ACCT                 |  T.ACCT = GEN.DIV : GEN.DEPT : GEN.CCTR : TTR.TAX.ACCT
0281 CASE PR.CTX.LEVEL = 1                                              CASE PR.CTX.LEVEL = 1
0282 T.ACCT = MDS.DIV:GEN.DEPT:GEN.CCTR:TTR.TAX.ACCT                 |  T.ACCT = MDS.DIV : GEN.DEPT : GEN.CCTR : TTR.TAX.ACCT
0283 CASE PR.CTX.LEVEL = 2                                              CASE PR.CTX.LEVEL = 2
0284 *T26695 v                                                       |  *T26686 v         T.ACCT = MDS.DIV : MDS.DEPT : GEN.CCTR : T

0285 *              T.ACCT = MDS.DIV:MDS.DEPT:GEN.CCTR:TTR.TAX.ACCT  |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : GEN.CCTR : TTR.TAX.ACCT
0286 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:GEN.CCTR:TTR.TAX.ACCT            <  
0287 *T26695 ^                                                       <  
0288 CASE 1                                                             CASE 1
0289 *T26695 v                                                       |  *T26686 v         T.ACCT = MDS.DIV : MDS.DEPT : MDS.CCTR : T
0290 *              T.ACCT = MDS.DIV:MDS.DEPT:MDS.CCTR:TTR.TAX.ACCT  |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : MDS.CCTR : TTR.TAX.ACCT
0291 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:MDS.CCTR:TTR.TAX.ACCT            <  

0292 *T26695 ^                                                       <  
0293 END CASE                                                           END CASE
0294 PRS.AMT = MDS.CWHT; TOT.AMT = TOT.AMT - PRS.AMT                    PRS.AMT = MDS.CWHT; TOT.AMT = TOT.AMT - PRS.AMT
0295 MDS.NO = "CT-" : EMP.CITY.CODE; GOSUB 2000                         MDS.NO = "CT-" : EMP.CITY.CODE; GOSUB 2000
0296 END                                                                END
0297 DCNT = COUNT(MDS.DED.CODE,VM) + (MDS.DED.CODE # '')                DCNT = COUNT(MDS.DED.CODE,VM) + (MDS.DED.CODE # '')
0298 FOR D = 1 TO DCNT                                                  FOR D = 1 TO DCNT

0308 MATREAD COA.REC FROM COA, CONO : MDED.ACCT ELSE COA.LEVEL = 0      MATREAD COA.REC FROM COA, CONO : MDED.ACCT ELSE COA.LEVEL = 
0309 PR.DED.ACCT = MDED.ACCT; PR.DED.LEVEL = COA.LEVEL                  PR.DED.ACCT = MDED.ACCT; PR.DED.LEVEL = COA.LEVEL
0310 END CASE                                                           END CASE
0311 BEGIN CASE                                                         BEGIN CASE
0312 CASE PR.DED.LEVEL = 0                                              CASE PR.DED.LEVEL = 0
0313 T.ACCT = GEN.DIV:GEN.DEPT:GEN.CCTR:MDED.ACCT                    |  T.ACCT = GEN.DIV : GEN.DEPT : GEN.CCTR : MDED.ACCT
0314 CASE PR.DED.LEVEL = 1                                              CASE PR.DED.LEVEL = 1
0315 T.ACCT = MDS.DIV:GEN.DEPT:GEN.CCTR:MDED.ACCT                    |  T.ACCT = MDS.DIV : GEN.DEPT : GEN.CCTR : MDED.ACCT
0316 CASE PR.DED.LEVEL = 2                                              CASE PR.DED.LEVEL = 2
0317 *T26695 v                                                       |  *T26686 v            T.ACCT = MDS.DIV : MDS.DEPT : GEN.CCTR 

0318 *                 T.ACCT = MDS.DIV:MDS.DEPT:GEN.CCTR:MDED.ACCT  |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : GEN.CCTR : MDED.ACCT
0319 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:GEN.CCTR:MDED.ACCT               <  
0320 *T26695 ^                                                       <  
0321 CASE 1                                                             CASE 1
0322 *T26695 v                                                       |  *T26686 v            T.ACCT = MDS.DIV : MDS.DEPT : MDS.CCTR 
0323 *                 T.ACCT = MDS.DIV:MDS.DEPT:MDS.CCTR:MDED.ACCT  |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : MDS.CCTR : MDED.ACCT
0324 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:MDS.CCTR:MDED.ACCT               <  

0325 *T26695 ^                                                       <  
0326 END CASE                                                           END CASE
0327 PRS.AMT = MDS.DED.AMT<1,D>; TOT.AMT = TOT.AMT - PRS.AMT            PRS.AMT = MDS.DED.AMT<1,D>; TOT.AMT = TOT.AMT - PRS.AMT
0328 MDS.NO = "DD-" : MDS.DED.CODE<1,D>; GOSUB 2000                     MDS.NO = "DD-" : MDS.DED.CODE<1,D>; GOSUB 2000
0329 END                                                                END
0330 NEXT D                                                             NEXT D
0331 OCNT = COUNT(MDS.OINC.CODE,VM) + (MDS.OINC.CODE # '')              OCNT = COUNT(MDS.OINC.CODE,VM) + (MDS.OINC.CODE # '')

0342 MATREAD COA.REC FROM COA, CONO : OINC.ACCT ELSE COA.LEVEL = 0      MATREAD COA.REC FROM COA, CONO : OINC.ACCT ELSE COA.LEVEL = 
0343 PR.INC.ACCT = OINC.ACCT; PR.INC.LEVEL = COA.LEVEL                  PR.INC.ACCT = OINC.ACCT; PR.INC.LEVEL = COA.LEVEL
0344 END CASE                                                           END CASE
0345 BEGIN CASE                                                         BEGIN CASE
0346 CASE PR.INC.LEVEL = 0                                              CASE PR.INC.LEVEL = 0
0347 T.ACCT = GEN.DIV:GEN.DEPT:GEN.CCTR:OINC.ACCT                    |  T.ACCT = GEN.DIV : GEN.DEPT : GEN.CCTR : OINC.ACCT
0348 CASE PR.INC.LEVEL = 1                                              CASE PR.INC.LEVEL = 1
0349 T.ACCT = MDS.DIV:GEN.DEPT:GEN.CCTR:OINC.ACCT                    |  T.ACCT = MDS.DIV : GEN.DEPT : GEN.CCTR : OINC.ACCT
0350 CASE PR.INC.LEVEL = 2                                              CASE PR.INC.LEVEL = 2
0351 *T26695 v                                                       |  *T26686 v            T.ACCT = MDS.DIV : MDS.DEPT : GEN.CCTR 

0352 *                 T.ACCT = MDS.DIV:MDS.DEPT:GEN.CCTR:OINC.ACCT  |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : GEN.CCTR : OINC.ACCT
0353 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:GEN.CCTR:OINC.ACCT               <  
0354 *T26695 ^                                                       <  
0355 CASE 1                                                             CASE 1
0356 *T26695 v                                                       |  *T26686 v            T.ACCT = MDS.DIV : MDS.DEPT : MDS.CCTR 
0357 *                 T.ACCT = MDS.DIV:MDS.DEPT:MDS.CCTR:OINC.ACCT  |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : MDS.CCTR : OINC.ACCT
0358 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:MDS.CCTR:OINC.ACCT               <  

0359 *T26695 ^                                                       <  
0360 END CASE                                                           END CASE
0361 PRS.AMT = MDS.OINC.AMT<1,O>; TOT.AMT = TOT.AMT + PRS.AMT           PRS.AMT = MDS.OINC.AMT<1,O>; TOT.AMT = TOT.AMT + PRS.AMT
0362 MDS.NO = "OI-" : MDS.OINC.CODE<1,O>; GOSUB 1000                    MDS.NO = "OI-" : MDS.OINC.CODE<1,O>; GOSUB 1000
0363 END                                                                END
0364 NEXT O                                                             NEXT O
0365 IF MDS.FWHT + 0 <> 0 THEN                                          IF MDS.FWHT + 0 <> 0 THEN

0366 BEGIN CASE                                                         BEGIN CASE
0367 CASE PR.FIT.LEVEL = 0                                              CASE PR.FIT.LEVEL = 0
0368 T.ACCT = GEN.DIV:GEN.DEPT:GEN.CCTR:PR.FIT.ACCT                  |  T.ACCT = GEN.DIV : GEN.DEPT : GEN.CCTR : PR.FIT.ACCT
0369 CASE PR.FIT.LEVEL = 1                                              CASE PR.FIT.LEVEL = 1
0370 T.ACCT = MDS.DIV:GEN.DEPT:GEN.CCTR:PR.FIT.ACCT                  |  T.ACCT = MDS.DIV : GEN.DEPT : GEN.CCTR : PR.FIT.ACCT
0371 CASE PR.FIT.LEVEL = 2                                              CASE PR.FIT.LEVEL = 2
0372 *T26695 v                                                       |  *T26686 v         T.ACCT = MDS.DIV : MDS.DEPT : GEN.CCTR : P
0373 *              T.ACCT = MDS.DIV:MDS.DEPT:GEN.CCTR:PR.FIT.ACCT   |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : GEN.CCTR : PR.FIT.ACCT
0374 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:GEN.CCTR:PR.FIT.ACCT             <  

0375 *T26695 ^                                                       <  
0376 CASE 1                                                             CASE 1
0377 *T26695 v                                                       |  *T26686 v         T.ACCT = MDS.DIV : MDS.DEPT : MDS.CCTR : P
0378 *              T.ACCT = MDS.DIV:MDS.DEPT:MDS.CCTR:PR.FIT.ACCT   |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : MDS.CCTR : PR.FIT.ACCT
0379 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:MDS.CCTR:PR.FIT.ACCT             <  
0380 *T26695 ^                                                       <  
0381 END CASE                                                           END CASE

0383 MDS.NO = "FT"; GOSUB 2000                                          MDS.NO = "FT"; GOSUB 2000
0384 END                                                                END
0385 IF MDS.FICA + 0 <> 0 THEN                                          IF MDS.FICA + 0 <> 0 THEN
0386 BEGIN CASE                                                         BEGIN CASE
0387 CASE PR.FCA.LEVEL = 0                                              CASE PR.FCA.LEVEL = 0
0388 T.ACCT = GEN.DIV:GEN.DEPT:GEN.CCTR:PR.FCA.ACCT                  |  T.ACCT = GEN.DIV : GEN.DEPT : GEN.CCTR : PR.FCA.ACCT
0389 CASE PR.FCA.LEVEL = 1                                              CASE PR.FCA.LEVEL = 1
0390 T.ACCT = MDS.DIV:GEN.DEPT:GEN.CCTR:PR.FCA.ACCT                  |  T.ACCT = MDS.DIV : GEN.DEPT : GEN.CCTR : PR.FCA.ACCT
0391 CASE PR.FCA.LEVEL = 2                                              CASE PR.FCA.LEVEL = 2
0392 *T26695 v                                                       |  *T26686 v         T.ACCT = MDS.DIV : MDS.DEPT : GEN.CCTR : P

0393 *              T.ACCT = MDS.DIV:MDS.DEPT:GEN.CCTR:PR.FCA.ACCT   |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : GEN.CCTR : PR.FCA.ACCT
0394 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:GEN.CCTR:PR.FCA.ACCT             <  
0395 *T26695 ^                                                       <  
0396 CASE 1                                                             CASE 1
0397 *T26695 v                                                       |  *T26686 v         T.ACCT = MDS.DIV : MDS.DEPT : MDS.CCTR : P
0398 *              T.ACCT = MDS.DIV:MDS.DEPT:MDS.CCTR:PR.FCA.ACCT   |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : MDS.CCTR : PR.FCA.ACCT
0399 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:MDS.CCTR:PR.FCA.ACCT             <  

0400 *T26695 ^                                                       <  
0401 END CASE                                                           END CASE
0402 PRS.AMT = MDS.FICA; TOT.AMT = TOT.AMT - PRS.AMT                    PRS.AMT = MDS.FICA; TOT.AMT = TOT.AMT - PRS.AMT
0403 MDS.NO = "FA"; GOSUB 2000                                          MDS.NO = "FA"; GOSUB 2000
0404 END                                                                END
0405 IF MDS.BONDS + 0 <> 0 THEN                                         IF MDS.BONDS + 0 <> 0 THEN
0406 BEGIN CASE                                                         BEGIN CASE

0407 CASE PR.BND.LEVEL = 0                                              CASE PR.BND.LEVEL = 0
0408 T.ACCT = GEN.DIV:GEN.DEPT:GEN.CCTR:PR.BND.ACCT                  |  T.ACCT = GEN.DIV : GEN.DEPT : GEN.CCTR : PR.BND.ACCT
0409 CASE PR.BND.LEVEL = 1                                              CASE PR.BND.LEVEL = 1
0410 T.ACCT = MDS.DIV:GEN.DEPT:GEN.CCTR:PR.BND.ACCT                  |  T.ACCT = MDS.DIV : GEN.DEPT : GEN.CCTR : PR.BND.ACCT
0411 CASE PR.BND.LEVEL = 2                                              CASE PR.BND.LEVEL = 2
0412 *T26695 v                                                       |  *T26686 v         T.ACCT = MDS.DIV : MDS.DEPT : GEN.CCTR : P
0413 *              T.ACCT = MDS.DIV:MDS.DEPT:GEN.CCTR:PR.BND.ACCT   |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : GEN.CCTR : PR.BND.ACCT
0414 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:GEN.CCTR:PR.BND.ACCT             <  

0415 *T26695 ^                                                       <  
0416 CASE 1                                                             CASE 1
0417 *T26695 v                                                       |  *T26686 v         T.ACCT = MDS.DIV : MDS.DEPT : MDS.CCTR : P
0418 *              T.ACCT = MDS.DIV:MDS.DEPT:MDS.CCTR:PR.BND.ACCT   |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : MDS.CCTR : PR.BND.ACCT
0419 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:MDS.CCTR:PR.BND.ACCT             <  
0420 *T26695 ^                                                       <  
0421 END CASE                                                           END CASE

0423 MDS.NO = "BD"; GOSUB 2000                                          MDS.NO = "BD"; GOSUB 2000
0424 END                                                                END
0425 IF MDS.EIC + 0 <> 0 THEN                                           IF MDS.EIC + 0 <> 0 THEN
0426 BEGIN CASE                                                         BEGIN CASE
0427 CASE PR.EIC.LEVEL = 0                                              CASE PR.EIC.LEVEL = 0
0428 T.ACCT = GEN.DIV:GEN.DEPT:GEN.CCTR:PR.EIC.ACCT                  |  T.ACCT = GEN.DIV : GEN.DEPT : GEN.CCTR : PR.EIC.ACCT
0429 CASE PR.EIC.LEVEL = 1                                              CASE PR.EIC.LEVEL = 1
0430 T.ACCT = MDS.DIV:GEN.DEPT:GEN.CCTR:PR.EIC.ACCT                  |  T.ACCT = MDS.DIV : GEN.DEPT : GEN.CCTR : PR.EIC.ACCT
0431 CASE PR.EIC.LEVEL = 2                                              CASE PR.EIC.LEVEL = 2
0432 *T26695 v                                                       |  *T26686 v         T.ACCT = MDS.DIV : MDS.DEPT : GEN.CCTR : P

0433 *              T.ACCT = MDS.DIV:MDS.DEPT:GEN.CCTR:PR.EIC.ACCT   |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : GEN.CCTR : PR.EIC.ACCT
0434 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:GEN.CCTR:PR.EIC.ACCT             <  
0435 *T26695 ^                                                       <  
0436 CASE 1                                                             CASE 1
0437 *T26695 v                                                       |  *T26686 v         T.ACCT = MDS.DIV : MDS.DEPT : MDS.CCTR : P
0438 *              T.ACCT = MDS.DIV:MDS.DEPT:MDS.CCTR:PR.EIC.ACCT   |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : MDS.CCTR : PR.EIC.ACCT
0439 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:MDS.CCTR:PR.EIC.ACCT             <  

0440 *T26695 ^                                                       <  
0441 END CASE                                                           END CASE
0442 PRS.AMT = MDS.EIC; TOT.AMT = TOT.AMT - PRS.AMT                     PRS.AMT = MDS.EIC; TOT.AMT = TOT.AMT - PRS.AMT
0443 MDS.NO = "EC"; GOSUB 2000                                          MDS.NO = "EC"; GOSUB 2000
0444 END                                                                END
0445 BEGIN CASE                                                         BEGIN CASE
0446 CASE PR.CSH.LEVEL = 0                                              CASE PR.CSH.LEVEL = 0

0447 T.ACCT = GEN.DIV:GEN.DEPT:GEN.CCTR:PR.CSH.ACCT                  |  T.ACCT = GEN.DIV : GEN.DEPT : GEN.CCTR : PR.CSH.ACCT
0448 CASE PR.CSH.LEVEL = 1                                              CASE PR.CSH.LEVEL = 1
0449 T.ACCT = MDS.DIV:GEN.DEPT:GEN.CCTR:PR.CSH.ACCT                  |  T.ACCT = MDS.DIV : GEN.DEPT : GEN.CCTR : PR.CSH.ACCT
0450 CASE PR.CSH.LEVEL = 2                                              CASE PR.CSH.LEVEL = 2
0451 *T26695 v                                                       |  *T26686 v      T.ACCT = MDS.DIV : MDS.DEPT : GEN.CCTR : PR.C
0452 *           T.ACCT = MDS.DIV:MDS.DEPT:GEN.CCTR:PR.CSH.ACCT      |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : GEN.CCTR : PR.CSH.ACCT
0453 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:GEN.CCTR:PR.CSH.ACCT             <  

0454 *T26695 ^                                                       <  
0455 CASE 1                                                             CASE 1
0456 *T26695 v                                                       |  *T26686 v      T.ACCT = MDS.DIV : MDS.DEPT : MDS.CCTR : PR.C
0457 *           T.ACCT = MDS.DIV:MDS.DEPT:MDS.CCTR:PR.CSH.ACCT      |  T.ACCT = MDS.DIV : MDS.DEPT[1,2] : MDS.CCTR : PR.CSH.ACCT
0458 T.ACCT = MDS.DIV:MDS.DEPT[1,2]:MDS.CCTR:PR.CSH.ACCT             <  
0459 *T26695 ^                                                       <  
0460 END CASE                                                           END CASE


EPSBP/EPS.PAYCALC                                                  /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/EPS.PAYCALC
Printed for thompson at 06/28/2006 04:23:36PM

0871 * CALCULATE USING TAX BRACKET                                      * CALCULATE USING TAX BRACKET
0872 *                                                                  *
0873 6600 *                                                             6600 *
0874 TAMT = TAX.TAB.REC(PT)<1,2>                                        TAMT = TAX.TAB.REC(PT)<1,2>
0875 EXCESS=TXGR-TAX.TAB.REC(PT)<1,1>                                   EXCESS=TXGR-TAX.TAB.REC(PT)<1,1>
0876 *T27998 v                                                       <  
0877 IF NEG # 'YES' AND EXCESS < 0 THEN EXCESS = 0                   <  
0878 IF NEG = 'YES' AND EXCESS > 0 THEN EXCESS = 0                   <  
0879 *T27998 ^                                                       <  
0880 PERCENT=TAX.TAB.REC(PT)<1,3>/100                                   PERCENT=TAX.TAB.REC(PT)<1,3>/100




EPSBP/EPS.TIME.RATE.2                                              /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/EPS.TIME.RATE.2
Printed for thompson at 06/28/2006 04:23:37PM

0025 *   TO OVERTIME METHOD OF "W" AND "P" ONLY NOT SHIFT METHOD.       *   TO OVERTIME METHOD OF "W" AND "P" ONLY NOT SHIFT METHOD.
0026 *   TASK IS 20749.                                                 *   TASK IS 20749.
0027 *T21110 lanny 10/17/1996 * Error in calc of O/T, D/T on unsche     *T21110 lanny 10/17/1996 * Error in calc of O/T, D/T on unsc
0028 *                          with more than one work class.          *                          with more than one work class.
0029 *T21555 lanny 02/04/1997 * D/T CONVERTING TO T/T INCORRECTLY.      *T21555 lanny 02/04/1997 * D/T CONVERTING TO T/T INCORRECTLY
0030 *******************************************************         |  *T25700 cm 03/19/2001 * Correct overtime calculation problem
0031                                                                 >  *                       are multiple rates and multiple type
0032                                                                 >  *T27765 cmykleb 10/30/2003 * Change to allow negative amount
0033                                                                 >  *                            O/T, D/T, etc.
0034                                                                 >  *T28592 thompson 09/21/2005 * Update to add new paytypes

0035                                                                 >  ************************************************************
0036 *                                                                  *
0037 *COPY>CPYLIB>COM1                                                  *COPY>CPYLIB>COM1
0038 *COPY>CPYLIB>EDIT.COM                                              *COPY>CPYLIB>EDIT.COM
0039 *COPY>CPYLIB>EDIT.COM.DRIVER                                       *COPY>CPYLIB>EDIT.COM.DRIVER
0040 *COPY>CPYLIB>SYSCOM                                                *COPY>CPYLIB>SYSCOM
0041 *COPY>PMC.CPYLIB>COMPANY                                           *COPY>PMC.CPYLIB>COMPANY

0078 OPEN 'WORK.CALC' TO WORK.CALC ELSE ERRMSG = "WORK.CALC FILE IS     OPEN 'WORK.CALC' TO WORK.CALC ELSE ERRMSG = "WORK.CALC FILE 
0079 OPEN 'EMPLOYEE' TO EMPLOYEE ELSE ERRMSG = "EMPLOYEE FILE IS MI     OPEN 'EMPLOYEE' TO EMPLOYEE ELSE ERRMSG = "EMPLOYEE FILE IS 
0080 OPEN 'HOLIDAY' TO HOLIDAY ELSE ERRMSG = "HOLIDAY FILE IS MISSI     OPEN 'HOLIDAY' TO HOLIDAY ELSE ERRMSG = "HOLIDAY FILE IS MIS
0081 OPEN 'WORK.SHIFT' TO WORK.SHIFT ELSE ERRMSG = "WORK.SHIFT.SCHE     OPEN 'WORK.SHIFT' TO WORK.SHIFT ELSE ERRMSG = "WORK.SHIFT.SC
0082 OPEN 'ATTEND.CODE' TO ATTEND.CODE ELSE ERRMSG = "ATTEND CODE F     OPEN 'ATTEND.CODE' TO ATTEND.CODE ELSE ERRMSG = "ATTEND CODE
0083 *    OPEN 'SFC.TEST' TO TESTFILE ELSE ERRMSG = "SFC.TEST FILE   <  
0084 *                                                                  *
0085 *                                                                  *
0086 *******************************************                        *******************************************
0087 PROCREAD BUF ELSE ERRMSG = "CANNOT READ PROC FROM PROGRAM EPS.     PROCREAD BUF ELSE ERRMSG = "CANNOT READ PROC FROM PROGRAM EP

0088 CONO = BUF<1>                                                      CONO = BUF<1>
0089 *                                                               <  
0090 10*                                                                10*
0091 MATREAD EPSC.REC FROM CONTROL,CONO:"PAY.CONTROL" ELSE              MATREAD EPSC.REC FROM CONTROL,CONO:"PAY.CONTROL" ELSE
0092 ERRMSG = "CANNOT READ EPS.PAY.CONTROL FROM PROGRAM - EPS.TIME.     ERRMSG = "CANNOT READ EPS.PAY.CONTROL FROM PROGRAM - EPS.TIM
0093 GO 90000                                                           GO 90000
0094 END                                                                END
0095 *********************                                              *********************

0096 100*                                                               100*
0097 READNEXT ID ELSE GO 99999                                          READNEXT ID ELSE GO 99999
0098 *   PRINT 'ID ':ID                                              <  
0099 MATREADU WKC.REC FROM WORK.CALC,ID ELSE                            MATREADU WKC.REC FROM WORK.CALC,ID ELSE
0100 ERRMSG = "CANNOT READ WORK.CALC RECORD ":ID:" FROM PROGRAM - E     ERRMSG = "CANNOT READ WORK.CALC RECORD ":ID:" FROM PROGRAM -
0101 GO 90000                                                           GO 90000
0102 END                                                                END
0103 EMP.KEY = FIELD(ID,"!",1)                                          EMP.KEY = FIELD(ID,"!",1)
0104                                                                 >  PRINT @(45,10):EMP.KEY'L#10'

0123 REG = ''                                                           REG = ''
0124 OVT = ''                                                           OVT = ''
0125 DBT = ''                                                           DBT = ''
0126 TPT = ''                                                           TPT = ''
0127 TST.DATE = FIELD(ID,"!",2)                                         TST.DATE = FIELD(ID,"!",2)
0128 *   PRINT 'DATE ':OCONV(TST.DATE,'D2/')                         <  
0129 TST.SHIFT = FIELD(ID,"!",3)                                        TST.SHIFT = FIELD(ID,"!",3)
0130 *******************                                                *******************
0131 * ROUTINE TO PROCESS EACH WORK AREA                                * ROUTINE TO PROCESS EACH WORK AREA
0132 FOR X = 1 TO X+1                                                   FOR X = 1 TO X+1

0135 TST.DIV=FIELD(WKC.AREA<1,X>,"!",1)                                 TST.DIV=FIELD(WKC.AREA<1,X>,"!",1)
0136 TST.DEPT=FIELD(WKC.AREA<1,X>,"!",2)                                TST.DEPT=FIELD(WKC.AREA<1,X>,"!",2)
0137 TST.CCTR=FIELD(WKC.AREA<1,X>,"!",3)                                TST.CCTR=FIELD(WKC.AREA<1,X>,"!",3)
0138 TST.CLASS=FIELD(WKC.AREA<1,X>,"!",4)                               TST.CLASS=FIELD(WKC.AREA<1,X>,"!",4)
0139 TST.TYPE=FIELD(WKC.AREA<1,X>,"!",5)                                TST.TYPE=FIELD(WKC.AREA<1,X>,"!",5)
0140 *        PRINT 'WSS ':WKC.WSS<1,X>                              <  
0141 MATREAD WSS.REC FROM WORK.SHIFT,CONO:"!":WKC.WSS<1,X> ELSE         MATREAD WSS.REC FROM WORK.SHIFT,CONO:"!":WKC.WSS<1,X> ELSE
0142 ERRMSG = "CANNOT READ WORK.SHIFT.SCHEDULE FOR ":WKC.WSS<1,X>:"     ERRMSG = "CANNOT READ WORK.SHIFT.SCHEDULE FOR ":WKC.WSS<1,X>
0143 GO 90000                                                           GO 90000
0144 END                                                                END

0145 WORK.DAY = WKC.DAY                                                 WORK.DAY = WKC.DAY
0146 *        PRINT 'BEFORE RATE ':WKC.RATE<1,X>                     <  
0147 * IF EARNING OR WORK TYPE IS 100 OR GREATER THEN IT IS NOT WOR     * IF EARNING OR WORK TYPE IS 100 OR GREATER THEN IT IS NOT W
0148 IF TST.TYPE >= 100 THEN GO 1010                                    IF TST.TYPE >= 100 THEN GO 1010
0149 * IS THE TIME WORKED A CALL-BACK                                   * IS THE TIME WORKED A CALL-BACK
0150 IF TST.TYPE = EPSC.CBACK THEN                                      IF TST.TYPE = EPSC.CBACK THEN
0151 IF WKC.HRS<1,X> < WSS.CALLBACK<1,2> THEN WKC.HRS<1,X> = WSS.CA     IF WKC.HRS<1,X> < WSS.CALLBACK<1,2> THEN WKC.HRS<1,X> = WSS.
0152 IF WSS.CALLBACK<1,3> # 0 THEN WKC.HRS<1,X> = WKC.HRS<1,X> + WS     IF WSS.CALLBACK<1,3> # 0 THEN WKC.HRS<1,X> = WKC.HRS<1,X> + 

0160 MATREAD HOL.REC FROM HOLIDAY,CONO:TST.DATE ELSE GO 1010            MATREAD HOL.REC FROM HOLIDAY,CONO:TST.DATE ELSE GO 1010
0161 IF HOL.WSS = "ALL" THEN                                            IF HOL.WSS = "ALL" THEN
0162 GO 1005                                                            GO 1005
0163 END                                                                END
0164 LOCATE WKC.WSS<1,X> IN HOL.WSS<1> SETTING XX ELSE XX = ''          LOCATE WKC.WSS<1,X> IN HOL.WSS<1> SETTING XX ELSE XX = ''
0165 *        PRINT 'XX ':XX                                         <  
0166 IF XX = '' THEN HOL.FLG = ''; GO 1010                              IF XX = '' THEN HOL.FLG = ''; GO 1010
0167 1005*                                                              1005*
0168 HOL.FLG = 1                                                        HOL.FLG = 1
0169 POS = 4                                                            POS = 4

0175 IF WSS.USH.SHDIF.MET<1,POS> = "$" THEN                             IF WSS.USH.SHDIF.MET<1,POS> = "$" THEN
0176 WKC.RATE<1,X> = WKC.RATE<1,X> + WSS.USH.SHDIF.AMT<1,POS>           WKC.RATE<1,X> = WKC.RATE<1,X> + WSS.USH.SHDIF.AMT<1,POS>
0177 GOTO 1029                                                          GOTO 1029
0178 END                                                                END
0179 IF WSS.USH.SHDIF.MET<1,POS> = "%" THEN                             IF WSS.USH.SHDIF.MET<1,POS> = "%" THEN
0180 *             PRINT 'WKC.RATE ':WKC.RATE<1,X>                   <  
0181 DIF = (WKC.RATE<1,X> /1000)  * (WSS.USH.SHDIF.AMT<1,POS> / 100     DIF = (WKC.RATE<1,X> /1000)  * (WSS.USH.SHDIF.AMT<1,POS> / 1
0182 *             PRINT 'DIF ':DIF                                  <  
0183 AMT = WKC.RATE<1,X> + DIF                                          AMT = WKC.RATE<1,X> + DIF
0184 *             PRINT 'AMT ':AMT                                  <  

0185 WKC.RATE<1,X> = INT(AMT + .5)                                      WKC.RATE<1,X> = INT(AMT + .5)
0186 GO 1029                                                            GO 1029
0187 END                                                                END
0188 GO 1029                                                            GO 1029
0189 1010*                                                              1010*
0190 *        PRINT 'WORK.DAY ':WORK.DAY                             <  
0191 *        PRINT 'WSS.DAY ':WSS.DAY                               <  
0192 POS = ''                                                           POS = ''
0193 LOCATE WORK.DAY IN WSS.DAY<1> SETTING POS ELSE GO 1020             LOCATE WORK.DAY IN WSS.DAY<1> SETTING POS ELSE GO 1020
0194 *        PRINT 'WSS AMOUNT ':WSS.SHDIF.AMT<1,POS>               <  

0195 *        PRINT 'WSS METHOD ':WSS.SHDIF.MET<1,POS>               <  
0196 *        INPUT XX                                               <  
0197 IF WSS.SHDIF.AMT<1,POS> = 0 THEN GO 1029                           IF WSS.SHDIF.AMT<1,POS> = 0 THEN GO 1029
0198 IF WSS.SHDIF.MET<1,POS> = "$" THEN                                 IF WSS.SHDIF.MET<1,POS> = "$" THEN
0199 WKC.RATE<1,X> = WKC.RATE<1,X> + WSS.SHDIF.AMT<1,POS>               WKC.RATE<1,X> = WKC.RATE<1,X> + WSS.SHDIF.AMT<1,POS>
0200 GOTO 1029                                                          GOTO 1029
0201 END                                                                END

0202 IF WSS.SHDIF.MET<1,POS> = "%" THEN                                 IF WSS.SHDIF.MET<1,POS> = "%" THEN
0203 *             PRINT 'WKC.RATE ':WKC.RATE<1,X>                   <  
0204 DIF = (WKC.RATE<1,X> /1000)  * (WSS.SHDIF.AMT<1,POS> / 1000)       DIF = (WKC.RATE<1,X> /1000)  * (WSS.SHDIF.AMT<1,POS> / 1000)
0205 *             PRINT 'DIF ':DIF                                  <  
0206 AMT = WKC.RATE<1,X> + DIF                                          AMT = WKC.RATE<1,X> + DIF
0207 *             PRINT 'AMT ':AMT                                  <  
0208 WKC.RATE<1,X> = INT(AMT + .5)                                      WKC.RATE<1,X> = INT(AMT + .5)
0209 GO 1029                                                            GO 1029

0210 END                                                                END
0211 ERRMSG = "INVALID SHIFT DIFFERENTIAL METHOD IN RECORD ":ID:" F  |  ERRMSG = "INVALID SHIFT DIFFERENTIAL METHOD IN RECORD ":ID:"
0212 GO 90000                                                           GO 90000
0213 1020* ROUTINE IF WORK.DAY IN NOT IN NORMAL SCHEDULE BUT NOT HO  |  1020* ROUTINE IF WORK.DAY IS NOT IN NORMAL SCHEDULE BUT NOT 
0214 USCH.FLG = 1                                                       USCH.FLG = 1
0215 BEGIN CASE                                                         BEGIN CASE
0216 CASE WORK.DAY = "SAT"                                              CASE WORK.DAY = "SAT"
0217 POS = 2                                                            POS = 2

0228 IF WSS.USH.SHDIF.MET<1,POS> = "$" THEN                             IF WSS.USH.SHDIF.MET<1,POS> = "$" THEN
0229 WKC.RATE<1,X> = WKC.RATE<1,X> + WSS.USH.SHDIF.AMT<1,POS>           WKC.RATE<1,X> = WKC.RATE<1,X> + WSS.USH.SHDIF.AMT<1,POS>
0230 GOTO 1029                                                          GOTO 1029
0231 END                                                                END
0232 IF WSS.USH.SHDIF.MET<1,POS> = "%" THEN                             IF WSS.USH.SHDIF.MET<1,POS> = "%" THEN
0233 *             PRINT 'WKC.RATE ':WKC.RATE<1,X>                   <  
0234 DIF = (WKC.RATE<1,X> /1000)  * (WSS.USH.SHDIF.AMT<1,POS> / 100     DIF = (WKC.RATE<1,X> /1000)  * (WSS.USH.SHDIF.AMT<1,POS> / 1
0235 *             PRINT 'DIF ':DIF                                  <  
0236 AMT = WKC.RATE<1,X> + DIF                                          AMT = WKC.RATE<1,X> + DIF
0237 *             PRINT 'AMT ':AMT                                  <  

0237 *             PRINT 'AMT ':AMT                                  <  
0238 WKC.RATE<1,X> = INT(AMT + .5)                                      WKC.RATE<1,X> = INT(AMT + .5)
0239 GO 1029                                                            GO 1029
0240 END                                                                END
0241 1029*                                                              1029*
0242 *        PRINT 'AFTER RATE ':WKC.RATE<1,X>                      <  
0243 *        INPUT XX                                               <  
0244 NEXT X                                                             NEXT X
0245 1030* ROUTINE DETERMINES OVERTIME, DOUBLETIME, OR TRIPLETIME I     1030* ROUTINE DETERMINES OVERTIME, DOUBLETIME, OR TRIPLETIME
0246 OVT = ''                                                           OVT = ''

0274 END                                                                END
0275 OVT = WSS.OVT.BGN<1,POS>                                           OVT = WSS.OVT.BGN<1,POS>
0276 DBT = WSS.DT.BGN<1,POS>                                            DBT = WSS.DT.BGN<1,POS>
0277 TRP = WSS.TRP.BGN<1,POS>                                           TRP = WSS.TRP.BGN<1,POS>
0278 1035*                                                              1035*
0279 *T21555 v                                                       <  
0280 IF DBT > OVT THEN OVT.MAX = DBT - OVT ELSE OVT.MAX = DBT           IF DBT > OVT THEN OVT.MAX = DBT - OVT ELSE OVT.MAX = DBT
0281 IF TRP > DBT THEN DBT.MAX = TRP - DBT ELSE DBT.MAX = TRP           IF TRP > DBT THEN DBT.MAX = TRP - DBT ELSE DBT.MAX = TRP
0282 *   OVT.MAX = DBT - OVT                                         <  
0283 *   DBT.MAX = TRP - DBT                                         <  

0284 *T21555 ^                                                          *T21555 ^
0285 IF WKC.WRK.HRS <= OVT THEN GO 1999                              |  *T25700 v
0286 TST.HRS=0;TST.REG=0;TST.REG.OVT=0;TST.REG.DBT=0;TST.REG.TRP=0   |  *  IF WKC.WRK.HRS <= OVT THEN GO 1999
0287 TST.NC.REG=0;TST.NC.OVT=0;TST.NC.DBT=0;TST.NC.TRP=0             |  *T27765 v
0288 * 20749                                                         |  *  IF WKC.TOT.HRS <= OVT THEN GO 1999
0289 OVT.EXT = 0                                                     |  IF WKC.TOT.HRS < 0 THEN
0290 *                                                               |  CHK.TOT.HRS = WKC.TOT.HRS * -1
0291 FOR X = 1 TO X+1                                                |  IF CHK.TOT.HRS <= OVT THEN GO 1999

0292 IF WKC.AREA<1,X> = '' THEN GO 1040                              <  
0293 TYPE = FIELD(WKC.AREA<1,X>,"!",5)                               <  
0294 *        IF TYPE => 100 THEN GO 1039                            <  
0295 IF TYPE => 100 THEN GOSUB 5000; GO 1039                         <  
0296 IF TYPE = EPSC.CBACK THEN GO 1039                               <  
0297 BEGIN CASE                                                      <  
0298 CASE TYPE = EPSC.REG                                            <  

0299 TST.REG = TST.REG + WKC.HRS<1,X>                                <  
0300 CASE TYPE = EPSC.REG.OVT                                        <  
0301 TST.REG.OVT = TST.REG.OVT + WKC.HRS<1,X>                        <  
0302 CASE TYPE = EPSC.REG.DBT                                        <  
0303 TST.REG.DBT = TST.REG.DBT + WKC.HRS<1,X>                        <  
0304 CASE TYPE = EPSC.REG.TRP                                        <  
0305 TST.REG.TRP = TST.REG.TRP + WKC.HRS<1,X>                        <  

0306 CASE TYPE = EPSC.NC.REG                                         <  
0307 TST.NC.REG = TST.NC.REG + WKC.HRS<1,X>                          <  
0308 CASE TYPE = EPSC.NC.OVT                                         <  
0309 TST.NC.OVT = TST.NC.OVT + WKC.HRS<1,X>                          <  
0310 CASE TYPE = EPSC.NC.DBT                                         <  
0311 TST.NC.DBT = TST.NC.DBT + WKC.HRS<1,X>                          <  
0312 CASE TYPE = EPSC.NC.TRP                                         <  

0313 TST.NC.TRP = TST.NC.TRP + WKC.HRS<1,X>                          <  
0314 END CASE                                                        <  
0315 1039*                                                           <  
0316 NEXT X                                                          <  
0317 1040*                                                           <  
0318 TST.HRS = TST.REG + TST.REG.OVT + TST.REG.DBT + TST.REG.TRP     <  
0319 TST.HRS = TST.HRS + TST.NC.REG + TST.NC.OVT + TST.NC.DBT + TST  <  

0320 IF TST.HRS # WKC.WRK.HRS+0 THEN                                 <  
0321 ERRMSG = "TOTAL WORKED HOURS OUT OF BALANCE RECORD ":ID:" PROG  <  
0322 *        PRINT ERRMSG                                           <  
0323 *        INPUT XX                                               <  
0324 GO 90000                                                        <  
0325 END                                                             <  
0326 * 20749                                                         <  

0327 IF OVT > OVT.EXT THEN                                           <  
0328 OVT = OVT - OVT.EXT                                             <  
0329 END ELSE                                                           END ELSE
0330 OVT = 0                                                         |  IF WKC.TOT.HRS <= OVT THEN GO 1999
0331 END                                                                END
0332 IF TST.REG > OVT THEN                                           |  *T27765 ^
0333 DIF = TST.REG - OVT                                             |  *T25700 ^

0334 TST.REG.OVT = TST.REG.OVT + DIF                                 |  1040*
0335 TST.REG = OVT                                                   <  
0336 END                                                             <  
0337 IF TST.NC.REG > OVT THEN                                        <  
0338 DIF = TST.NC.REG - OVT                                          <  
0339 TST.NC.OVT = TST.NC.OVT + DIF                                   <  
0340 TST.NC.REG = OVT                                                <  

0341 END                                                             <  
0342 AMT = TST.REG + TST.NC.REG                                      <  
0343 IF AMT > OVT THEN                                               <  
0344 DIF = AMT - OVT                                                 <  
0345 TST.NC.OVT = TST.NC.OVT + DIF                                   <  
0346 TST.NC.REG = OVT - TST.REG                                      <  
0347 END                                                             <  

0348 IF TST.REG.OVT > OVT.MAX THEN                                   <  
0349 DIF = TST.REG.OVT - OVT.MAX                                     <  
0350 TST.REG.DBT = TST.REG.DBT + DIF                                 <  
0351 TST.REG.OVT = OVT.MAX                                           <  
0352 END                                                             <  
0353 IF TST.NC.OVT > OVT.MAX THEN                                    <  
0354 DIF = TST.NC.OVT - OVT.MAX                                      <  

0355 TST.NC.DBT = TST.NC.DBT + DIF                                   <  
0356 TST.NC.OVT = OVT.MAX                                            <  
0357 END                                                             <  
0358 AMT = TST.REG.OVT + TST.NC.OVT                                  <  
0359 IF AMT > OVT.MAX THEN                                           <  
0360 DIF = AMT - OVT.MAX                                             <  
0361 TST.NC.DBT = TST.NC.DBT + DIF                                   <  

0362 TST.NC.OVT = OVT.MAX - TST.REG.OVT                              <  
0363 END                                                             <  
0364 IF TST.REG.DBT > DBT.MAX THEN                                   <  
0365 DIF = TST.REG.DBT - DBT.MAX                                     <  
0366 TST.REG.TRP = TST.REG.TRP + DIF                                 <  
0367 TST.REG.DBT = DBT.MAX                                           <  
0368 END                                                             <  

0369 IF TST.NC.DBT > DBT.MAX THEN                                    <  
0370 DIF = TST.NC.DBT - DBT.MAX                                      <  
0371 TST.NC.TRP = TST.NC.TRP + DIF                                   <  
0372 TST.NC.DBT = DBT.MAX                                            <  
0373 END                                                             <  
0374 AMT = TST.REG.DBT + TST.NC.DBT                                  <  
0375 IF AMT > DBT.MAX THEN                                           <  

0376 DIF = AMT - DBT.MAX                                             <  
0377 TST.NC.TRP = TST.NC.TRP + DIF                                   <  
0378 TST.NC.DBT = DBT.MAX - TST.REG.DBT                              <  
0379 END                                                             <  
0380 *   PRINT 'TOTAL HOURS FROM WORK.CALC ':WKC.TOT.HRS             <  
0381 *   PRINT 'TOTAL HOURS WORKED FROM WORK.CALC ':WKC.WRK.HRS      <  
0382 *   PRINT 'REG HOURS ':TST.REG                                  <  

0383 *   PRINT 'REG OVT HOURS ':TST.REG.OVT                          <  
0384 *   PRINT 'REG DBT HOURS ':TST.REG.DBT                          <  
0385 *   PRINT 'REG TRP HOURS ':TST.REG.TRP                          <  
0386 *   PRINT 'NC REG HOURS ':TST.NC.REG                            <  
0387 *   PRINT 'NC OVT HOURS ':TST.NC.OVT                            <  
0388 *   PRINT 'NC DBT HOURS ':TST.NC.DBT                            <  
0389 *   PRINT 'NC TRP HOURS ':TST.NC.TRP                            <  

0390 *   INPUT XX                                                    <  
0391 1050*  AFTER DETERMINING THE TOTAL AMOUNT OF HOURS TO BE PAID   <  
0392 *      EARNINGS TYPE READJUST THE WORK.CALC RECORD TO REFLECT   <  
0393 *      DISTRIBUTION OF HOURS BASED ON AREA                      <  
0394 1100*                                                           <  
0395 *   DISTRIBUTE HOURS FOR CHARGEABLE REGULAR HOURS               <  
0396 *   TST.REG VARIABLE CONTAINS TOTAL HOURS OF THIS TYPE          <  

0397 USED=0;LEFT=TST.REG                                             <  
0398 *                                                                  *
0399 *** T21110 In all of the LOCATE statements in routines 1100 -   <  
0400 *** PTR is set to value of X and the insertion will be in X+1   <  
0401 *** the chronology of the time worked as it was originally.     <  
0402 *                                                                  *
0403 *   IF USED = LEFT THEN GO 1200                                 |  *T25700 v

0404 FOR X = 1 TO X+1                                                |  HOLD.DATA = ''
0405 IF WKC.AREA<1,X> = '' THEN GO 1150                              |  REG.LEFT = 0 ; OT.LEFT = 0 ; DT.LEFT = 0 ; TT.LEFT = 0
0406 DIV = FIELD(WKC.AREA<1,X>,"!",1)                                |  TOT.HRS = 0 ; OVT.EXT = 0 ; OTH.LEFT = 0
0407 DEPT = FIELD(WKC.AREA<1,X>,"!",2)                               |  *** DETERMINE HOW MANY HOURS ARE OT, 2X, 3X ***
0408 CCTR = FIELD(WKC.AREA<1,X>,"!",3)                               |  *** TIME CODES ABOVE 100 WILL ONLY BE CONCIDERED AS OVERTIME
0409 CLASS = FIELD(WKC.AREA<1,X>,"!",4)                              |  *** THE PROCESS WILL NOT GIVE 2X TIME OR 3X TIME FOR NON    
0410 TYPE = FIELD(WKC.AREA<1,X>,"!",5)                               |  *** WORKED HOURS SUCH AS SICK TIME, DR. APPT, ETC.          

0411 IF TYPE = EPSC.REG THEN                                         |  ACNT = DCOUNT(WKC.AREA,VM)
0412 *PRINT @(0,23):CL:"TYPE ":TYPE                                  |  FOR A = 1 TO ACNT
0413 *PRINT @(0,23):CL:"USED ":USED                                  |  TYPE = FIELD(WKC.AREA<1,A>,"!",5)
0414 *PRINT @(0,23):CL:"LEFT ":LEFT                                  |  IF TYPE GE 100 THEN
0415 *PRINT @(0,23):CL:"WKC.HRS ":WKC.HRS<1,X>:" X ":X               |  GOSUB 5000
0416 *INPUT SARA                                                     |  MATREAD ATT.REC FROM ATTEND.CODE, CONO:TYPE ELSE MAT ATT.REC
0417 IF WKC.HRS<1,X> > LEFT THEN                                     |  IF ATT.OVT.CALC = 'Y' THEN

0418 DIF = WKC.HRS<1,X> - LEFT                                       |  OVT.EXT = OVT.EXT + WKC.HRS<1,A>
0419 WKC.HRS<1,X> = LEFT                                             |  TOT.HRS = TOT.HRS + WKC.HRS<1,A>
0420 NEW.AREA = DIV:"!":DEPT:"!":CCTR:"!":CLASS:"!":EPSC.REG.OVT     <  
0421 * CSF 21866                                                     <  
0422 *              PTR = 1                                          <  
0423 PTR = X                                                         <  
0424 LOOP                                                            <  

0425 *                LOCATE NEW.AREA IN WKC.AREA<1> BY "AL" SETTIN  <  
0426 *T21110          LOCATE NEW.AREA IN WKC.AREA<1>,PTR BY "AL" SE  <  
0427 LOCATE NEW.AREA IN WKC.AREA<1>,PTR SETTING POS ELSE             <  
0428 POS = X+1                                                       <  
0429 INS NEW.AREA BEFORE WKC.AREA<1,POS>                             <  
0430 *                  INS DIF BEFORE WKC.HRS<1,POS>                <  
0431 INS 0 BEFORE WKC.HRS<1,POS>                                     <  

0432 INS WKC.RATE<1,X> BEFORE WKC.RATE<1,POS>                        <  
0433 INS WKC.WSS<1,X> BEFORE WKC.WSS<1,POS>                          <  
0434 IF EMP.STATUS = "S" THEN WKC.RATE<1,POS> = EMP.OT.RATE          <  
0435 *                  GO 1149                                      <  
0436 END                                                                END
0437 IF WKC.RATE<1,X> = WKC.RATE<1,POS> OR (EMP.STATUS = "S" AND WK  <  
0438 WKC.HRS<1,POS> = WKC.HRS<1,POS> + DIF                           <  

0439 PTR = 0                                                         <  
0440 END ELSE                                                           END ELSE
0441 PTR = POS + 1                                                   |  TOT.HRS = TOT.HRS + WKC.HRS<1,A>
0442 END                                                                END
0443 WHILE PTR DO REPEAT                                             |  NEXT A
0444 *                                                               |  *T27765 v
0445                                                                 >  NEG.FLAG = 0

0446                                                                 >  IF TOT.HRS LT 0 THEN
0447                                                                 >  TOT.HRS = TOT.HRS * -1
0448                                                                 >  NEG.FLAG = 1
0449 END                                                                END
0450 USED = USED + WKC.HRS<1,X>                                      |  *T27765 ^
0451 LEFT = LEFT - WKC.HRS<1,X>                                      |  BEGIN CASE
0452                                                                 >  CASE TOT.HRS GT TRP

0453                                                                 >  TT.LEFT = TOT.HRS - (TRP + OVT.EXT)
0454                                                                 >  DT.LEFT = TRP - DBT 
0455                                                                 >  OT.LEFT = DBT - OVT
0456                                                                 >  OT.LEFT = OT.LEFT + OVT.EXT
0457                                                                 >  REG.LEFT = OVT - OVT.EXT
0458                                                                 >  CASE TOT.HRS GT DBT
0459                                                                 >  DT.LEFT = TOT.HRS - (DBT + OVT.EXT)

0460                                                                 >  OT.LEFT = DBT - OVT
0461                                                                 >  OT.LEFT = OT.LEFT + OVT.EXT
0462                                                                 >  REG.LEFT = OVT - OVT.EXT
0463                                                                 >  CASE TOT.HRS GT OVT
0464                                                                 >  OT.LEFT = TOT.HRS - OVT
0465                                                                 >  OTH.LEFT = OVT.EXT
0466                                                                 >  REG.LEFT = OVT - OVT.EXT

0467                                                                 >  CASE 1
0468                                                                 >  REG.LEFT = TOT.HRS
0469                                                                 >  IF REG.LEFT LE OVT THEN GOTO 1999
0470                                                                 >  END CASE
0471                                                                 >  *T27765 v
0472                                                                 >  *  IF NEG.FLAG THEN
0473                                                                 >  *     TOT.HRS = TOT.HRS * -1

0474                                                                 >  *     IF TT.LEFT GT 0 THEN TT.LEFT = TT.LEFT * -1
0475                                                                 >  *     IF DT.LEFT GT 0 THEN DT.LEFT = DT.LEFT * -1
0476                                                                 >  *     IF OT.LEFT GT 0 THEN OT.LEFT = OT.LEFT * -1
0477                                                                 >  *     IF REG.LEFT GT 0 THEN REG.LEFT = REG.LEFT * -1
0478                                                                 >  *  END
0479                                                                 >  *T2765 ^
0480                                                                 >  *** END OF DETERMINE HOW MAY HOURS ARE OT, 2X, 3X ***

0481                                                                 >  FOR A = 1 TO ACNT
0482                                                                 >  IF WKC.AREA<1,A> = '' THEN GO 1150
0483                                                                 >  DV = FIELD(WKC.AREA<1,A>,"!",1)
0484                                                                 >  DP = FIELD(WKC.AREA<1,A>,"!",2)
0485                                                                 >  CC = FIELD(WKC.AREA<1,A>,"!",3)
0486                                                                 >  CLASS = FIELD(WKC.AREA<1,A>,"!",4)
0487                                                                 >  TYPE = FIELD(WKC.AREA<1,A>,"!",5)

0488                                                                 >  AREA = WKC.AREA<1,A>
0489                                                                 >  RATE = WKC.RATE<1,A>
0490                                                                 >  HRS = WKC.HRS<1,A>
0491                                                                 >  WSS = WKC.WSS<1,A>
0492                                                                 >  MATREAD ATT.REC FROM ATTEND.CODE, CONO:TYPE ELSE
0493                                                                 >  MAT ATT.REC = ""
0494                                                                 >  ATT.OVT.CALC = "N"

0495 END                                                                END
0496 1149*                                                           |  IF ATT.OVT.CALC = 'Y' THEN
0497 NEXT X                                                          |  *T27765 v
0498 1150*                                                           |  NEG.FLAG = 1
0499 *  ALL REGULAR EARNING HOURS HAVE BEEN USED AND ANY HOURS THAT  |  IF HRS LT 0 THEN
0500 *  ORIGINALLY REGULAR EARNINGS HAVE BEEN INSERTED AS OVERTIME   |  HRS = HRS * -1
0501 *  CHECK TO DELETE ANY ZERO HOURS AREAS                         |  NEG.FLAG = -1
0502 ENTRY = COUNT(WKC.HRS,VM) + (WKC.HRS # '')                      <  

0503 *   FOR X = 1  TO ENTRY                                         <  
0504 FOR X = ENTRY TO 1 STEP -1                                      <  
0505 *        IF WKC.HRS<1,X> = '' THEN GO 1200                      <  
0506 IF WKC.HRS<1,X> + 0 = 0 THEN                                    <  
0507 DEL WKC.AREA<1,X>                                               <  
0508 DEL WKC.HRS<1,X>                                                <  
0509 DEL WKC.RATE<1,X>                                               <  

0510 DEL WKC.WSS<1,X>                                                <  
0511 *             GO 1150                                           <  
0512 END                                                                END
0513 NEXT X                                                          |  *T27765 ^
0514 1200*                                                           |  1050 *
0515 *    DISTRIBUTE HOURS FOR CHARGEABLE OVERTIME                   |  OTH.FLAG = 1
0516 *    TST.REG.OVT VARIABLE CONTAINS TOTAL HOURS OF THIS TYPE     |  BEGIN CASE

0517 USED=0;LEFT=TST.REG.OVT                                         |  CASE TYPE GT 100 AND OTH.LEFT GT 0
0518 *   IF USED = LEFT THEN GO 1300                                 |  LEFT = OTH.LEFT
0519 FOR X = 1 TO X+1                                                |  OTH.FLAG = 1
0520 IF WKC.AREA<1,X> = '' THEN GO 1250                              |  CASE REG.LEFT GT 0
0521 DIV = FIELD(WKC.AREA<1,X>,"!",1)                                |  LEFT = REG.LEFT
0522 DEPT = FIELD(WKC.AREA<1,X>,"!",2)                               |  CASE OT.LEFT GT 0
0523 CCTR = FIELD(WKC.AREA<1,X>,"!",3)                               |  LEFT = OT.LEFT

0524 CLASS = FIELD(WKC.AREA<1,X>,"!",4)                              |  CASE DT.LEFT GT 0
0525 TYPE = FIELD(WKC.AREA<1,X>,"!",5)                               |  LEFT = DT.LEFT
0526 IF TYPE = EPSC.REG.OVT THEN                                     |  CASE TT.LEFT GT 0
0527 IF WKC.HRS<1,X> > LEFT THEN                                     |  LEFT = TT.LEFT
0528 DIF = WKC.HRS<1,X> - LEFT                                       |  END CASE
0529 WKC.HRS<1,X> = LEFT                                             |  IF HRS GT LEFT THEN
0530 NEW.AREA = DIV:"!":DEPT:"!":CCTR:"!":CLASS:"!":EPSC.REG.DBT     |  HRS = HRS - LEFT

0531 *CSF 21866                                                      |  BEGIN CASE
0532 PTR = X                                                         |  CASE TYPE = EPSC.REG AND REG.LEFT GT 0
0533 LOOP                                                            |  REG.LEFT = 0
0534 *                LOCATE NEW.AREA IN WKC.AREA<1> BY "AL" SETTIN  |  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.REG
0535 LOCATE NEW.AREA IN WKC.AREA<1>,PTR SETTING POS ELSE             |  CASE TYPE = EPSC.REG AND OT.LEFT GT 0
0536 POS = X+1                                                       |  OT.LEFT = 0
0537 INS NEW.AREA BEFORE WKC.AREA<1,POS>                             |  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.REG.OVT

0538 *                  INS DIF BEFORE WKC.HRS<1,POS>                |  CASE TYPE = EPSC.REG AND DT.LEFT GT 0
0539 INS 0 BEFORE WKC.HRS<1,POS>                                     |  DT.LEFT = 0
0540 INS WKC.RATE<1,X> BEFORE WKC.RATE<1,POS>                        |  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.REG.DBT
0541 INS WKC.WSS<1,X> BEFORE WKC.WSS<1,POS>                          |  CASE TYPE = EPSC.REG AND TT.LEFT GT 0
0542 IF EMP.STATUS = "S" THEN WKC.RATE<1,POS> = EMP.OT.RATE          |  TT.LEFT = 0
0543 *                  GO 1249                                      |  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.REG.TRP
0544 END                                                             |  CASE TYPE = EPSC.NC.REG AND REG.LEFT GT 0

0545 IF WKC.RATE<1,X> = WKC.RATE<1,POS> OR (EMP.STATUS = "S" AND WK  |  REG.LEFT = 0
0546 WKC.HRS<1,POS> = WKC.HRS<1,POS> + DIF                           |  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.NC.REG
0547 PTR = 0                                                         |  CASE TYPE = EPSC.NC.REG AND OT.LEFT GT 0
0548                                                                 >  OT.LEFT = 0
0549                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.NC.OVT
0550                                                                 >  CASE TYPE = EPSC.NC.REG AND DT.LEFT GT 0
0551                                                                 >  DT.LEFT = 0

0552                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.NC.DBT
0553                                                                 >  CASE TYPE = EPSC.NC.REG AND TT.LEFT GT 0
0554                                                                 >  TT.LEFT = 0
0555                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.NC.TRP
0556                                                                 >  CASE OTH.FLAG = 1
0557                                                                 >  OTH.LEFT = 0
0558                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':TYPE

0559                                                                 >  END CASE
0560                                                                 >  HOLD.DATA<1,-1> = NEW.AREA
0561                                                                 >  HOLD.DATA<2,-1> = LEFT * NEG.FLAG ; * T27765
0562                                                                 >  HOLD.DATA<3,-1> = RATE
0563                                                                 >  HOLD.DATA<4,-1> = WSS
0564                                                                 >  *      IF LEFT GE 0 THEN
0565                                                                 >  GOTO 1050

0566                                                                 >  *      END
0567 END ELSE                                                           END ELSE
0568 PTR = POS + 1                                                   |  LEFT = LEFT - HRS
0569                                                                 >  BEGIN CASE
0570                                                                 >  CASE TYPE = EPSC.REG AND REG.LEFT GT 0
0571                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.REG
0572                                                                 >  REG.LEFT = REG.LEFT - HRS

0573                                                                 >  CASE TYPE = EPSC.REG AND OT.LEFT GT 0
0574                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.REG.OVT
0575                                                                 >  OT.LEFT = OT.LEFT - HRS
0576                                                                 >  CASE TYPE = EPSC.REG AND DT.LEFT GT 0
0577                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.REG.DBT
0578                                                                 >  DT.LEFT = DT.LEFT - HRS
0579                                                                 >  CASE TYPE = EPSC.REG AND TT.LEFT GT 0

0580                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.REG.TRP
0581                                                                 >  TT.LEFT = TT.LEFT - HRS
0582                                                                 >  CASE TYPE = EPSC.NC.REG AND REG.LEFT GT 0
0583                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.NC.REG
0584                                                                 >  REG.LEFT = REG.LEFT - HRS
0585                                                                 >  CASE TYPE = EPSC.NC.REG AND OT.LEFT GT 0
0586                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.NC.OVT

0587                                                                 >  OT.LEFT = OT.LEFT - HRS
0588                                                                 >  CASE TYPE = EPSC.NC.REG AND DT.LEFT GT 0
0589                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.NC.DBT
0590                                                                 >  DT.LEFT = DT.LEFT - HRS
0591                                                                 >  CASE TYPE = EPSC.NC.REG AND TT.LEFT GT 0
0592                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':EPSC.NC.TRP
0593                                                                 >  TT.LEFT = TT.LEFT - HRS

0594                                                                 >  CASE OTH.FLAG = 1
0595                                                                 >  OTH.LEFT = OTH.LEFT - HRS
0596                                                                 >  NEW.AREA = DV:'!':DP:'!':CC:'!':CLASS:'!':TYPE
0597                                                                 >  END CASE
0598                                                                 >  HOLD.DATA<1,-1> = NEW.AREA
0599                                                                 >  HOLD.DATA<2,-1> = HRS * NEG.FLAG ; * T27765
0600                                                                 >  HOLD.DATA<3,-1> = RATE

0601                                                                 >  HOLD.DATA<4,-1> = WSS
0602 END                                                                END
0603 WHILE PTR DO REPEAT                                             <  
0604 *                                                               <  
0605 END                                                             <  
0606 USED = USED + WKC.HRS<1,X>                                      <  
0607 LEFT = LEFT - WKC.HRS<1,X>                                      <  

0608 END                                                             <  
0609 1249*                                                           <  
0610 NEXT X                                                          <  
0611 1250*                                                           <  
0612 *  ALL REG-OVT EARNING HOURS HAVE BEEN USED AND ANY HOURS THAT  <  
0613 *  ORIGINALLY REG-OVT EANINGS HAVE BEEN INSERTED AS DOUBLETIME  <  
0614 *  CHECK TO DELETE ANY ZERO HOURS AREAS                         <  

0615 ENTRY = COUNT(WKC.HRS,VM) + (WKC.HRS # '')                      <  
0616 *   FOR X = 1  TO ENTRY                                         <  
0617 FOR X = ENTRY TO 1 STEP -1                                      <  
0618 *        IF WKC.HRS<1,X> = '' THEN GO 1300                      <  
0619 IF WKC.HRS<1,X> + 0 = 0 THEN                                    <  
0620 DEL WKC.AREA<1,X>                                               <  
0621 DEL WKC.HRS<1,X>                                                <  

0622 DEL WKC.RATE<1,X>                                               <  
0623 DEL WKC.WSS<1,X>                                                <  
0624 *             GO 1250                                           <  
0625 END                                                             <  
0626 NEXT X                                                          <  
0627 1300*                                                           <  
0628 *    DISTRIBUTE HOURS FOR CHARGEABLE DOUBLETIME                 <  

0629 *    TST.REG.DBT VARIABLE CONTAINS TOTAL HOURS OF THIS TYPE     <  
0630 USED=0;LEFT=TST.REG.DBT                                         <  
0631 FOR X = 1 TO X+1                                                <  
0632 IF WKC.AREA<1,X> = '' THEN GO 1350                              <  
0633 DIV = FIELD(WKC.AREA<1,X>,"!",1)                                <  
0634 DEPT = FIELD(WKC.AREA<1,X>,"!",2)                               <  
0635 CCTR = FIELD(WKC.AREA<1,X>,"!",3)                               <  

0636 CLASS = FIELD(WKC.AREA<1,X>,"!",4)                              <  
0637 TYPE = FIELD(WKC.AREA<1,X>,"!",5)                               <  
0638 IF TYPE = EPSC.REG.DBT THEN                                     <  
0639 IF WKC.HRS<1,X> > LEFT THEN                                     <  
0640 DIF = WKC.HRS<1,X> - LEFT                                       <  
0641 WKC.HRS<1,X> = LEFT                                             <  
0642 NEW.AREA = DIV:"!":DEPT:"!":CCTR:"!":CLASS:"!":EPSC.REG.TRP     <  

0643 *CSF 21866                                                      <  
0644 PTR = X                                                         <  
0645 LOOP                                                            <  
0646 *                LOCATE NEW.AREA IN WKC.AREA<1> BY "AL" SETTIN  <  
0647 LOCATE NEW.AREA IN WKC.AREA<1>,PTR SETTING POS ELSE             <  
0648 POS = X+1                                                       <  
0649 INS NEW.AREA BEFORE WKC.AREA<1,POS>                             <  

0650 *                INS DIF BEFORE WKC.HRS<1,POS>                  <  
0651 INS 0 BEFORE WKC.HRS<1,POS>                                     <  
0652 INS WKC.RATE<1,X> BEFORE WKC.RATE<1,POS>                        <  
0653 INS WKC.WSS<1,X> BEFORE WKC.WSS<1,POS>                          <  
0654 IF EMP.STATUS = "S" THEN WKC.RATE<1,POS> = EMP.OT.RATE          <  
0655 *                GO 1349                                        <  
0656 END                                                             <  

0657 IF WKC.RATE<1,X> = WKC.RATE<1,POS> OR (EMP.STATUS = "S" AND WK  <  
0658 WKC.HRS<1,POS> = WKC.HRS<1,POS> + DIF                           <  
0659 PTR = 0                                                         <  
0660 END ELSE                                                           END ELSE
0661 PTR = POS + 1                                                   |  HOLD.DATA<1,-1> = AREA
0662                                                                 >  HOLD.DATA<2,-1> = HRS
0663                                                                 >  HOLD.DATA<3,-1> = RATE

0664                                                                 >  HOLD.DATA<4,-1> = WSS
0665 END                                                                END
0666 WHILE PTR DO REPEAT                                             |  1150 *
0667 *                                                               |  NEXT A
0668 END                                                             |  *** PUT THE WORK.CALC RECORD BACK TOGETHER ***
0669 USED = USED + WKC.HRS<1,X>                                      |  WKC.AREA = HOLD.DATA<1>
0670 LEFT = LEFT - WKC.HRS<1,X>                                      |  WKC.HRS = HOLD.DATA<2>

0671 END                                                             |  WKC.RATE = HOLD.DATA<3>
0672 1349*                                                           |  WKC.WSS = HOLD.DATA<4>
0673 NEXT X                                                          |  *T25700 ^
0674 1350*                                                           |  1999 *
0675 *  ALL REG-DBT EARNING HOURS HAVE BEEN USED AND ANY HOURS THAT  <  
0676 *  ORIGINALLY REG-DBT EANINGS HAVE BEEN INSERTED AS TRIPLETIME  <  
0677 *  CHECK TO DELETE ANY ZERO HOURS AREAS                         <  

0678 ENTRY = COUNT(WKC.HRS,VM) + (WKC.HRS # '')                      <  
0679 *   FOR X = 1  TO ENTRY                                         <  
0680 FOR X = ENTRY TO 1 STEP -1                                      <  
0681 *        IF WKC.HRS<1,X> = '' THEN GO 1500                      <  
0682 IF WKC.HRS<1,X> + 0 = 0 THEN                                    <  
0683 DEL WKC.AREA<1,X>                                               <  
0684 DEL WKC.HRS<1,X>                                                <  

0685 DEL WKC.RATE<1,X>                                               <  
0686 DEL WKC.WSS<1,X>                                                <  
0687 *             GO 1350                                           <  
0688 END                                                             <  
0689 NEXT X                                                          <  
0690 1400*                                                           <  
0691 *    THERE IS NO NEED TO REDISTRIBUTE TRIPLETIME HOURS BECAUSE  <  

0692 *    IS NO MAXIMUM FOR TRIPLETIME                               <  
0693 *    IF QUADRIPLETIME WERE EVER ADDED DO REDISTRIBUTION HERE    <  
0694 1500*                                                           <  
0695 *   DISTRIBUTE HOURS FOR NON-CHARGEABLE REGULAR HOURS           <  
0696 *   TST.NC.REG VARIABLE CONTAINS TOTAL HOURS OF THIS TYPE       <  
0697 USED=0;LEFT=TST.NC.REG                                          <  
0698 *   IF USED = LEFT THEN GO 1600                                 <  

0699 FOR X = 1 TO X+1                                                <  
0700 IF WKC.AREA<1,X> = '' THEN GO 1550                              <  
0701 DIV = FIELD(WKC.AREA<1,X>,"!",1)                                <  
0702 DEPT = FIELD(WKC.AREA<1,X>,"!",2)                               <  
0703 CCTR = FIELD(WKC.AREA<1,X>,"!",3)                               <  
0704 CLASS = FIELD(WKC.AREA<1,X>,"!",4)                              <  
0705 TYPE = FIELD(WKC.AREA<1,X>,"!",5)                               <  

0706 IF TYPE = EPSC.NC.REG THEN                                      <  
0707 IF WKC.HRS<1,X> > LEFT THEN                                     <  
0708 DIF = WKC.HRS<1,X> - LEFT                                       <  
0709 WKC.HRS<1,X> = LEFT                                             <  
0710 NEW.AREA = DIV:"!":DEPT:"!":CCTR:"!":CLASS:"!":EPSC.NC.OVT      <  
0711 *CSF 21866                                                      <  
0712 PTR = X                                                         <  

0713 LOOP                                                            <  
0714 *                LOCATE NEW.AREA IN WKC.AREA<1> BY "AL" SETTIN  <  
0715 *                LOCATE NEW.AREA IN WKC.AREA<1>,PTR BY "AL" SE  <  
0716 LOCATE NEW.AREA IN WKC.AREA<1>,PTR SETTING POS ELSE             <  
0717 POS = X+1                                                       <  
0718 INS NEW.AREA BEFORE WKC.AREA<1,POS>                             <  
0719 *                  INS DIF BEFORE WKC.HRS<1,POS>                <  

0720 INS 0 BEFORE WKC.HRS<1,POS>                                     <  
0721 INS WKC.RATE<1,X> BEFORE WKC.RATE<1,POS>                        <  
0722 INS WKC.WSS<1,X> BEFORE WKC.WSS<1,POS>                          <  
0723 IF EMP.STATUS = "S" THEN WKC.RATE<1,POS> = EMP.OT.RATE          <  
0724 *              GO 1549                                          <  
0725 END                                                             <  
0726 IF WKC.RATE<1,X> = WKC.RATE<1,POS> OR (EMP.STATUS = "S" AND WK  <  

0727 WKC.HRS<1,POS> = WKC.HRS<1,POS> + DIF                           <  
0728 PTR = 0                                                         <  
0729 END ELSE                                                        <  
0730 PTR = POS + 1                                                   <  
0731 END                                                             <  
0732 WHILE PTR DO REPEAT                                             <  
0733 *                                                               <  

0734 END                                                             <  
0735 USED = USED + WKC.HRS<1,X>                                      <  
0736 LEFT = LEFT - WKC.HRS<1,X>                                      <  
0737 END                                                             <  
0738 1549*                                                           <  
0739 NEXT X                                                          <  
0740 1550*                                                           <  

0741 *  ALL NC.REG. EARNING HOURS HAVE BEEN USED AND ANY HOURS THAT  <  
0742 *  ORIGINALLY NC.REG EANINGS HAVE BEEN INSERTED AS NC.OVERTIME  <  
0743 *  CHECK TO DELETE ANY ZERO HOURS AREAS                         <  
0744 ENTRY = COUNT(WKC.HRS,VM) + (WKC.HRS # '')                      <  
0745 *   FOR X = 1  TO ENTRY                                         <  
0746 FOR X = ENTRY TO 1 STEP -1                                      <  
0747 *        IF WKC.HRS<1,X> = '' THEN GO 1600                      <  

0748 IF WKC.HRS<1,X> + 0 = 0 THEN                                    <  
0749 DEL WKC.AREA<1,X>                                               <  
0750 DEL WKC.HRS<1,X>                                                <  
0751 DEL WKC.RATE<1,X>                                               <  
0752 DEL WKC.WSS<1,X>                                                <  
0753 *             GO 1550                                           <  
0754 END                                                             <  

0755 NEXT X                                                          <  
0756 1600*                                                           <  
0757 *    DISTRIBUTE HOURS FOR NC.OVERTIME                           <  
0758 *    TST.NC.OVT VARIABLE CONTAINS TOTAL HOURS OF THIS TYPE      <  
0759 USED=0;LEFT=TST.NC.OVT                                          <  
0760 *   IF USED = LEFT THEN GO 1700                                 <  
0761 FOR X = 1 TO X+1                                                <  

0762 IF WKC.AREA<1,X> = '' THEN GO 1650                              <  
0763 DIV = FIELD(WKC.AREA<1,X>,"!",1)                                <  
0764 DEPT = FIELD(WKC.AREA<1,X>,"!",2)                               <  
0765 CCTR = FIELD(WKC.AREA<1,X>,"!",3)                               <  
0766 CLASS = FIELD(WKC.AREA<1,X>,"!",4)                              <  
0767 TYPE = FIELD(WKC.AREA<1,X>,"!",5)                               <  
0768 IF TYPE = EPSC.NC.OVT THEN                                      <  

0769 IF WKC.HRS<1,X> > LEFT THEN                                     <  
0770 DIF = WKC.HRS<1,X> - LEFT                                       <  
0771 WKC.HRS<1,X> = LEFT                                             <  
0772 NEW.AREA = DIV:"!":DEPT:"!":CCTR:"!":CLASS:"!":EPSC.NC.DBT      <  
0773 *CSF 21866                                                      <  
0774 PTR = X                                                         <  
0775 LOOP                                                            <  

0776 *                LOCATE NEW.AREA IN WKC.AREA<1> BY "AL" SETTIN  <  
0777 *                LOCATE NEW.AREA IN WKC.AREA<1>,PTR BY "AL" SE  <  
0778 LOCATE NEW.AREA IN WKC.AREA<1>,PTR SETTING POS ELSE             <  
0779 POS = X+1                                                       <  
0780 INS NEW.AREA BEFORE WKC.AREA<1,POS>                             <  
0781 *                  INS DIF BEFORE WKC.HRS<1,POS>                <  
0782 INS 0 BEFORE WKC.HRS<1,POS>                                     <  

0783 INS WKC.RATE<1,X> BEFORE WKC.RATE<1,POS>                        <  
0784 INS WKC.WSS<1,X> BEFORE WKC.WSS<1,POS>                          <  
0785 IF EMP.STATUS = "S" THEN WKC.RATE<1,POS> = EMP.OT.RATE          <  
0786 *                  GO 1649                                      <  
0787 END                                                             <  
0788 IF WKC.RATE<1,X> = WKC.RATE<1,POS> OR (EMP.STATUS = "S" AND WK  <  
0789 WKC.HRS<1,POS> = WKC.HRS<1,POS> + DIF                           <  

0790 PTR = 0                                                         <  
0791 END ELSE                                                        <  
0792 PTR = POS + 1                                                   <  
0793 END                                                             <  
0794 WHILE PTR DO REPEAT                                             <  
0795 *                                                               <  
0796 END                                                             <  

0797 USED = USED + WKC.HRS<1,X>                                      <  
0798 LEFT = LEFT - WKC.HRS<1,X>                                      <  
0799 END                                                             <  
0800 1649*                                                           <  
0801 NEXT X                                                          <  
0802 1650*                                                           <  
0803 *  ALL NC-OVT EARNING HOURS HAVE BEEN USED AND ANY HOURS THAT   <  

0804 *  ORIGINALLY NC-OVT EANINGS HAVE BEEN INSERTED AS NC.TRIPLETI  <  
0805 *  CHECK TO DELETE ANY ZERO HOURS AREAS                         <  
0806 ENTRY = COUNT(WKC.HRS,VM) + (WKC.HRS # '')                      <  
0807 *   FOR X = 1  TO ENTRY                                         <  
0808 FOR X = ENTRY TO 1 STEP -1                                      <  
0809 *        IF WKC.HRS<1,X> = '' THEN GO 1700                      <  
0810 IF WKC.HRS<1,X> + 0 = 0 THEN                                    <  

0811 DEL WKC.AREA<1,X>                                               <  
0812 DEL WKC.HRS<1,X>                                                <  
0813 DEL WKC.RATE<1,X>                                               <  
0814 DEL WKC.WSS<1,X>                                                <  
0815 *             GO 1650                                           <  
0816 END                                                             <  
0817 NEXT X                                                          <  

0818 1700*                                                           <  
0819 *    DISTRIBUTE HOURS FOR NC.DOUBLETIME                         <  
0820 *    TST.NC.DBT VARIABLE CONTAINS TOTAL HOURS OF THIS TYPE      <  
0821 USED=0;LEFT=TST.NC.DBT                                          <  
0822 *   IF USED = LEFT THEN GO 1800                                 <  
0823 FOR X = 1 TO X+1                                                <  
0824 IF WKC.AREA<1,X> = '' THEN GO 1750                              <  

0825 DIV = FIELD(WKC.AREA<1,X>,"!",1)                                <  
0826 DEPT = FIELD(WKC.AREA<1,X>,"!",2)                               <  
0827 CCTR = FIELD(WKC.AREA<1,X>,"!",3)                               <  
0828 CLASS = FIELD(WKC.AREA<1,X>,"!",4)                              <  
0829 TYPE = FIELD(WKC.AREA<1,X>,"!",5)                               <  
0830 IF TYPE = EPSC.NC.DBT THEN                                      <  
0831 IF WKC.HRS<1,X> > LEFT THEN                                     <  

0832 DIF = WKC.HRS<1,X> - LEFT                                       <  
0833 WKC.HRS<1,X> = LEFT                                             <  
0834 NEW.AREA = DIV:"!":DEPT:"!":CCTR:"!":CLASS:"!":EPSC.NC.TRP      <  
0835 *CSF 21866                                                      <  
0836 PTR = X                                                         <  
0837 LOOP                                                            <  
0838 *                LOCATE NEW.AREA IN WKC.AREA<1> BY "AL" SETTIN  <  

0839 *                LOCATE NEW.AREA IN WKC.AREA<1>,PTR BY "AL" SE  <  
0840 LOCATE NEW.AREA IN WKC.AREA<1>,PTR SETTING POS ELSE             <  
0841 POS = X+1                                                       <  
0842 INS NEW.AREA BEFORE WKC.AREA<1,POS>                             <  
0843 *                  INS DIF BEFORE WKC.HRS<1,POS>                <  
0844 INS 0 BEFORE WKC.HRS<1,POS>                                     <  
0845 INS WKC.RATE<1,X> BEFORE WKC.RATE<1,POS>                        <  

0846 INS WKC.WSS<1,X> BEFORE WKC.WSS<1,POS>                          <  
0847 IF EMP.STATUS = "S" THEN WKC.RATE<1,POS> = EMP.OT.RATE          <  
0848 *                  GO 1749                                      <  
0849 END                                                             <  
0850 IF WKC.RATE<1,X> = WKC.RATE<1,POS> OR (EMP.STATUS = "S" AND WK  <  
0851 WKC.HRS<1,POS> = WKC.HRS<1,POS> + DIF                           <  
0852 PTR = 0                                                         <  

0853 END ELSE                                                        <  
0854 PTR = POS + 1                                                   <  
0855 END                                                             <  
0856 WHILE PTR DO REPEAT                                             <  
0857 *                                                               <  
0858 END                                                             <  
0859 USED = USED + WKC.HRS<1,X>                                      <  

0860 LEFT = LEFT - WKC.HRS<1,X>                                      <  
0861 END                                                             <  
0862 1749*                                                           <  
0863 NEXT X                                                          <  
0864 1750*                                                           <  
0865 *  ALL NC-DBT EARNING HOURS HAVE BEEN USED AND ANY HOURS THAT   <  
0866 *  ORIGINALLY NC-DBT EANINGS HAVE BEEN INSERTED AS NC.TRIPLETI  <  

0867 *  CHECK TO DELETE ANY ZERO HOURS AREAS                         <  
0868 ENTRY = COUNT(WKC.HRS,VM) + (WKC.HRS # '')                      <  
0869 *   FOR X = 1  TO ENTRY                                         <  
0870 FOR X = ENTRY TO 1 STEP -1                                      <  
0871 *        IF WKC.HRS<1,X> = '' THEN GO 1900                      <  
0872 IF WKC.HRS<1,X> + 0 = 0 THEN                                    <  
0873 DEL WKC.AREA<1,X>                                               <  

0874 DEL WKC.HRS<1,X>                                                <  
0875 DEL WKC.RATE<1,X>                                               <  
0876 DEL WKC.WSS<1,X>                                                <  
0877 *             GO 1750                                           <  
0878 END                                                             <  
0879 NEXT X                                                          <  
0880 1800*                                                           <  

0881 *    THERE IS NO NEED TO REDISTRIBUTE NC.TRIPLETIME HOURS BECA  <  
0882 *    IS NO MAXIMUM FOR NC.TRIPLETIME                            <  
0883 *    IF NC.QUADRIPLETIME WERE EVER ADDED DO REDISTRIBUTION HER  <  
0884 *                                                               <  
0885 1900*                                                           <  
0886 1999*                                                           <  
0887 WKC.STATUS = 2                                                     WKC.STATUS = 2

0888 *   MATWRITE WKC.REC ON TESTFILE,ID                             <  
0889 MATWRITE WKC.REC ON WORK.CALC,ID                                   MATWRITE WKC.REC ON WORK.CALC,ID
0890 RETURN                                                             RETURN
0891 *************************                                          *************************
0892 2000*                                                              2000*
0893 IF EMP.STATUS = "S" THEN                                           IF EMP.STATUS = "S" THEN
0894 IF EMP.OVT = "Y" AND EMP.OT.RATE # '' THEN GO 2003                 IF EMP.OVT = "Y" AND EMP.OT.RATE # '' THEN GO 2003

0909 2005*                                                              2005*
0910 MATREAD WSS.REC FROM WORK.SHIFT,CONO:"!":WSS ELSE                  MATREAD WSS.REC FROM WORK.SHIFT,CONO:"!":WSS ELSE
0911 ERRMSG = "CANNOT READ WORK.SHIFT.SCHEDULE ":WSS:" FROM PROG -      ERRMSG = "CANNOT READ WORK.SHIFT.SCHEDULE ":WSS:" FROM PROG 
0912 GO 90000                                                           GO 90000
0913 END                                                                END
0914 OVT = ''                                                        <  
0915 DBT = ''                                                        <  
0916 TRP = ''                                                        <  
0917 OVT = WSS.OVTHR                                                    OVT = WSS.OVTHR
0918 DBT = WSS.DBTHR                                                    DBT = WSS.DBTHR

0917 OVT = WSS.OVTHR                                                    OVT = WSS.OVTHR
0918 DBT = WSS.DBTHR                                                    DBT = WSS.DBTHR
0919 TRP = WSS.TPTHR                                                    TRP = WSS.TPTHR
0920 2035*                                                              2035*
0921 *T21555 v                                                          *T21555 v
0922 IF DBT > OVT THEN OVT.MAX = DBT - OVT ELSE OVT.MAX = DBT        <  
0923 IF TRP > DBT THEN DBT.MAX = TRP - DBT ELSE DBT.MAX = TRP        <  
0924 *   OVT.MAX = DBT - OVT                                            *  OVT.MAX = DBT - OVT
0925 *   DBT.MAX = TRP - DBT                                            *  DBT.MAX = TRP - DBT
0926                                                                 >  IF DBT > OVT THEN OVT.MAX = DBT - OVT ELSE OVT.MAX = DBT

0927                                                                 >  IF TRP > DBT THEN DBT.MAX = TRP - DBT ELSE DBT.MAX = TRP
0928 *T21555 ^                                                          *T21555 ^
0929 ACFND=0                                                            ACFND=0
0930 FOR I = 1 TO DCOUNT(WKC.AREA,VM) UNTIL ACFND                       FOR I = 1 TO DCOUNT(WKC.AREA,VM) UNTIL ACFND
0931 IF FIELD(WKC.AREA<1,I>,"!",5) >= 100 THEN ACFND = 1                IF FIELD(WKC.AREA<1,I>,"!",5) >= 100 THEN ACFND = 1
0932 NEXT I                                                             NEXT I
0933 IF WKC.WRK.HRS <= OVT AND NOT(ACFND) THEN GO 1999                  IF WKC.WRK.HRS <= OVT AND NOT(ACFND) THEN GO 1999

0934 TST.HRS=0;TST.REG=0;TST.REG.OVT=0;TST.REG.DBT=0;TST.REG.TRP=0   <  
0935 TST.NC.REG=0;TST.NC.OVT=0;TST.NC.DBT=0;TST.NC.TRP=0             <  
0936 * 20749                                                         <  
0937 OVT.EXT = 0                                                     <  
0938 *                                                               <  
0939 FOR X = 1 TO X+1                                                <  
0940 IF WKC.AREA<1,X> = '' THEN GO 2040                              <  

0941 TYPE = FIELD(WKC.AREA<1,X>,"!",5)                               <  
0942 *        IF TYPE > 100 THEN GO 2039                             <  
0943 *        IF TYPE > 100 THEN GOSUB 5000; GO 2039                 <  
0944 * 20749                                                         <  
0945 IF TYPE => 100 THEN                                             <  
0946 GOSUB 5000                                                      <  
0947 MATREAD ATT.REC FROM ATTEND.CODE, CONO:TYPE ELSE                <  

0948 MAT ATT.REC = ""                                                <  
0949 ATT.OVT.CALC = "N"                                              <  
0950 END                                                             <  
0951 IF ATT.OVT.CALC = "Y" THEN                                      <  
0952 OVT.EXT = OVT.EXT + WKC.HRS<1,X>                                <  
0953 GOTO 2039                                                       <  
0954 END                                                             <  

0955 END                                                             <  
0956 IF TYPE = EPSC.CBACK THEN GO 2039                               <  
0957 BEGIN CASE                                                      <  
0958 CASE TYPE = EPSC.REG                                            <  
0959 TST.REG = TST.REG + WKC.HRS<1,X>                                <  
0960 CASE TYPE = EPSC.REG.OVT                                        <  
0961 TST.REG.OVT = TST.REG.OVT + WKC.HRS<1,X>                        <  

0962 CASE TYPE = EPSC.REG.DBT                                        <  
0963 TST.REG.DBT = TST.REG.DBT + WKC.HRS<1,X>                        <  
0964 CASE TYPE = EPSC.REG.TRP                                        <  
0965 TST.REG.TRP = TST.REG.TRP + WKC.HRS<1,X>                        <  
0966 CASE TYPE = EPSC.NC.REG                                         <  
0967 TST.NC.REG = TST.NC.REG + WKC.HRS<1,X>                          <  
0968 CASE TYPE = EPSC.NC.OVT                                         <  

0969 TST.NC.OVT = TST.NC.OVT + WKC.HRS<1,X>                          <  
0970 CASE TYPE = EPSC.NC.DBT                                         <  
0971 TST.NC.DBT = TST.NC.DBT + WKC.HRS<1,X>                          <  
0972 CASE TYPE = EPSC.NC.TRP                                         <  
0973 TST.NC.TRP = TST.NC.TRP + WKC.HRS<1,X>                          <  
0974 END CASE                                                        <  
0975 2039*                                                           <  

0976 NEXT X                                                          <  
0977 2040*                                                           <  
0978 GO 1040                                                            GO 1040
0979 5000*                                                              5000*
0980 LOCATE TYPE IN WSS.ABS.CDE<1>,1 SETTING AFND THEN                  LOCATE TYPE IN WSS.ABS.CDE<1>,1 SETTING AFND THEN
0981 IF WSS.ABS.RATE<1,AFND>+0 # 100 THEN                               IF WSS.ABS.RATE<1,AFND>+0 # 100 THEN
0982 WKC.RATE<1,X> = INT(WKC.RATE<1,X> * (WSS.ABS.RATE<1,AFND>/100)     WKC.RATE<1,X> = INT(WKC.RATE<1,X> * (WSS.ABS.RATE<1,AFND>/10


EPSBP/EPS.TIME.RATE.3                                              /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/EPS.TIME.RATE.3
Printed for thompson at 06/28/2006 04:23:38PM

0010 *                                                                  *
0011 *   AUTHOR         - SARA CRISMON                                  *   AUTHOR         - SARA CRISMON
0012 *                                                                  *
0013 *   DATE           - DECEMBER 1989                                 *   DATE           - DECEMBER 1989
0014 *T21824 lanny 04/18/1997 * Set process status flag in header t     *T21824 lanny 04/18/1997 * Set process status flag in header
0015                                                                 >  *T25162 cm 08/15/2000 * Allow multiple other incomes.
0016                                                                 >  *C37154 cm 10/03/2000 * Other income is sometimes going to D
0017                                                                 >  *                       00/00/000.
0018                                                                 >  *T25570 cm 12/14/2000 * Capture the attendence code and brin
0019                                                                 >  *                       the PAYREG file.

0168 IF NEWREC = '' THEN                                                IF NEWREC = '' THEN
0169 SAVE.CONO = CONO                                                   SAVE.CONO = CONO
0170 SAVE.EMP = EMPNO                                                   SAVE.EMP = EMPNO
0171 SAVE.BATCH.NO = DHC.BATCH                                          SAVE.BATCH.NO = DHC.BATCH
0172 SAVE.END.DATE = DHC.END.DATE                                       SAVE.END.DATE = DHC.END.DATE
0173                                                                 >  *T25162 v
0174 IF DHC.OTH.INCAMT = 0 THEN DHC.OTH.INCAMT = '';DHC.OTH.INC = '     IF DHC.OTH.INCAMT = 0 THEN DHC.OTH.INCAMT = '';DHC.OTH.INC =
0175                                                                 >  IF SUM(DHC.OTH.INCAMT) = 0 THEN DHC.OTH.INCAMT = '';DHC.OTH.
0176                                                                 >  *T25162 ^
0177 SAVE.OTH.INC = DHC.OTH.INCAMT                                      SAVE.OTH.INC = DHC.OTH.INCAMT

0220 WKC.STATUS = 3                                                     WKC.STATUS = 3
0221 MATWRITE WKC.REC ON WORK.CALC,ID                                   MATWRITE WKC.REC ON WORK.CALC,ID
0222 1046*                                                              1046*
0223 *          ROUTINE TO CHECK FOR SUPPLEMENTAL PAY IF NECESSARY      *          ROUTINE TO CHECK FOR SUPPLEMENTAL PAY IF NECESSAR
0224 IF EMP.STATUS = "S" OR EMP.SSP = 0 OR EMP.SSP = "" THEN GO 100     IF EMP.STATUS = "S" OR EMP.SSP = 0 OR EMP.SSP = "" THEN GO 1
0225 IF WKC.WRK.HRS <= 0 THEN GO 1000                                |  *T27765 v
0226                                                                 >  *  IF WKC.WRK.HRS <= 0 THEN GO 1000
0227                                                                 >  IF WKC.WRK.HRS # 0 THEN GO 1000
0228                                                                 >  *T27765 ^
0229 SUP.PAY = 0                                                        SUP.PAY = 0

0291 CASE TYPE<1,X,Y> = EPSC.VAC                                        CASE TYPE<1,X,Y> = EPSC.VAC
0292 ET.REC<1,1,12> = ET.REC<1,1,12> + HOURS<1,X,Y>                     ET.REC<1,1,12> = ET.REC<1,1,12> + HOURS<1,X,Y>
0293 CASE 1                                                             CASE 1
0294 ET.REC<1,1,13> = ET.REC<1,1,13> + HOURS<1,X,Y>                     ET.REC<1,1,13> = ET.REC<1,1,13> + HOURS<1,X,Y>
0295 END CASE                                                           END CASE
0296                                                                 >  *T25570 v
0297                                                                 >  LOCATE TYPE<1,X,Y> IN ET.REC<2,1>,1 SETTING POS THEN
0298                                                                 >  ET.REC<3,1,POS> = ET.REC<3,1,POS> + HOURS<1,X,Y>;******
0299                                                                 >  END ELSE
0300                                                                 >  ET.REC<2,1,-1> = TYPE<1,X,Y>

0301                                                                 >  ET.REC<3,1,-1> = HOURS<1,X,Y> + 0;******
0302                                                                 >  END
0303                                                                 >  *T25570 ^
0304 NEXT Y                                                             NEXT Y
0305 8030*                                                              8030*
0306 PAY.HOURS<1,X> = ET.REC                                         |  *T25570 v
0307                                                                 >  *     PAY.HOURS<1,X> = ET.REC

0308                                                                 >  PAY.HOURS<1,X> = ET.REC<1>
0309                                                                 >  PAY.ATTEND.CODE<1,X> = ET.REC<2>
0310                                                                 >  PAY.ATTEND.HRS<1,X> = ET.REC<3>
0311                                                                 >  *T25570 ^
0312 PAY.TOT.HRS<1,X> = 0                                               PAY.TOT.HRS<1,X> = 0
0313 FOR Z = 1 TO 13                                                    FOR Z = 1 TO 13
0314 PAY.TOT.HRS<1,X> = PAY.TOT.HRS<1,X> + PAY.HOURS<1,X,Z>             PAY.TOT.HRS<1,X> = PAY.TOT.HRS<1,X> + PAY.HOURS<1,X,Z>

0325 INS EMP.COST.CNTR BEFORE PAY.COST.CNTR<1,CC>                       INS EMP.COST.CNTR BEFORE PAY.COST.CNTR<1,CC>
0326 INS EMP.NORM.SHFT BEFORE PAY.SHIFT<1,CC>                           INS EMP.NORM.SHFT BEFORE PAY.SHIFT<1,CC>
0327 INS EMP.JOB.CLASS BEFORE PAY.CLASS<1,CC>                           INS EMP.JOB.CLASS BEFORE PAY.CLASS<1,CC>
0328 END                                                                END
0329 PAY.RECORDS = COUNT(PAY.DEPT,VM) + (PAY.DEPT # '')                 PAY.RECORDS = COUNT(PAY.DEPT,VM) + (PAY.DEPT # '')
0330                                                                 >  *T25162 v
0331                                                                 >  OI.CNT = DCOUNT(PAY.OTH.INC,VM)
0332                                                                 >  *C37154 v
0333                                                                 >  *  IF OI.CNT GT PAY.RECORDS THEN PAY.RECORDS = OI.CNT
0334                                                                 >  IF OI.CNT GT PAY.RECORDS THEN

0335                                                                 >  PAY.RECORDS = OI.CNT
0336                                                                 >  FOR I = 1 TO PAY.RECORDS
0337                                                                 >  IF PAY.DIV<1,I>='' AND PAY.DEPT<1,I>='' AND PAY.COST.CNTR<1,
0338                                                                 >  PAY.DIV<1,I>=EMP.DIV
0339                                                                 >  PAY.DEPT<1,I>=EMP.DEPT
0340                                                                 >  PAY.COST.CNTR<1,I>=EMP.COST.CNTR
0341                                                                 >  END

0342                                                                 >  NEXT I
0343                                                                 >  END
0344                                                                 >  *C37154 ^
0345                                                                 >  *T25162 ^
0346 MATWRITE PAY.REC ON PAYREG,CONO:PRVEMP:CNT                         MATWRITE PAY.REC ON PAYREG,CONO:PRVEMP:CNT
0347 MAT SAVE.REC = ""                                                  MAT SAVE.REC = ""
0348 PRVEMP = EMPNO                                                     PRVEMP = EMPNO


EPSBP/JOB.CLASS.MAINT                                              /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/JOB.CLASS.MAINT
Printed for thompson at 06/28/2006 04:23:38PM

0004 * SOURCE         - EPSBP                                           * SOURCE         - EPSBP
0005 * PROGRAM        - JOB.CLASS.MAINT                                 * PROGRAM        - JOB.CLASS.MAINT
0006 * BY             - Scott Dickerson, PRISM Software Technologie     * BY             - Scott Dickerson, PRISM Software Technolog
0007 * DATE           - 11-03-89                                        * DATE           - 11-03-89
0008 * DESCRIPTION    - JOB CLASSIFICATION MAINTENANCE                  * DESCRIPTION    - JOB CLASSIFICATION MAINTENANCE
0009                                                                 >  *T25142 cm 07/13/2000 * Check for Rate change effective date
0010                                                                 >  *                       when appropriate.
0011                                                                 >  *ENDDOC
0012 *-------------------------------------------------------------     *-----------------------------------------------------------
0013 *COPY>CPYLIB>COM1                                                  *COPY>CPYLIB>COM1

0057 SCV.REC(1)=ECD.RET.VALUE;ECD.ACTION=3;CALL SCRN.EDIT               SCV.REC(1)=ECD.RET.VALUE;ECD.ACTION=3;CALL SCRN.EDIT
0058 END                                                                END
0059 ITEM.ID=CONO:SCV.REC(1);MAT JCC.REC=''                             ITEM.ID=CONO:SCV.REC(1);MAT JCC.REC=''
0060 *-------------------------------------------------------------     *-----------------------------------------------------------
0061 MATREAD JCC.REC FROM JOB.CLASS,ITEM.ID THEN                        MATREAD JCC.REC FROM JOB.CLASS,ITEM.ID THEN
0062                                                                 >  GOSUB 9000 ; * T25142
0063 FOR I=2 TO 3;SCV.REC(I)=JCC.REC(I-1);NEXT I                        FOR I=2 TO 3;SCV.REC(I)=JCC.REC(I-1);NEXT I
0064 ECD.ACTION=3;CALL SCRN.EDIT;GO 400                                 ECD.ACTION=3;CALL SCRN.EDIT;GO 400
0065 END                                                                END
0066 *-------------------------------------------------------------     *-----------------------------------------------------------

0120 REPEAT                                                             REPEAT
0121 *-------------------------------------------------------------     *-----------------------------------------------------------
0122 HEAD='CodeDescription.........................Rate'              HEAD='CodeDescription.........................Rate'
0123 CALL CHOICES.SUB(HEAD,CHOICES,REPAINT)                             CALL CHOICES.SUB(HEAD,CHOICES,REPAINT)
0124 RETURN                                                             RETURN
0125                                                                 >  *T25142 v
0126                                                                 >  *
0127                                                                 >  9000 *  CHECK FOR RATE CHANGE
0128                                                                 >  *
0129                                                                 >  JFLAG = ''

0130                                                                 >  9001 *
0131                                                                 >  JCNT = DCOUNT(JCC.EFF.DATE<1>,VM)
0132                                                                 >  FOR J = 1 TO JCNT
0133                                                                 >  IF JCC.EFF.DATE<1,J> GT DATE() THEN NULL ELSE
0134                                                                 >  JCC.RATE = JCC.EFF.RATE<1,J>
0135                                                                 >  JCC.EFF.DATE=DELETE(JCC.EFF.DATE,1,J,0)
0136                                                                 >  JCC.EFF.RATE=DELETE(JCC.EFF.RATE,1,J,0)

0137                                                                 >  JFLAG = 1
0138                                                                 >  GOTO 9001
0139                                                                 >  END
0140                                                                 >  NEXT J
0141                                                                 >  RETURN
0142                                                                 >  *T25142 ^
0143                                                                 >  *


EPSBP/JOB.GROUP.MAINT                                              /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/JOB.GROUP.MAINT
Printed for thompson at 06/28/2006 04:23:38PM

0004 * SOURCE         - EPSBP                                           * SOURCE         - EPSBP
0005 * PROGRAM        - JOB.GROUP.MAINT                                 * PROGRAM        - JOB.GROUP.MAINT
0006 * BY             - Scott Dickerson, PRISM Software Technologie     * BY             - Scott Dickerson, PRISM Software Technolog
0007 * DATE           - 11-03-89                                        * DATE           - 11-03-89
0008 * DESCRIIPTION   - JOB AUTHORIZATION GROUP MAINTENANCE             * DESCRIIPTION   - JOB AUTHORIZATION GROUP MAINTENANCE
0009 *T25978 adelgado 02/05/2002 * Add the use of prompts (S,SR,SB,  |  *T25142 cm 07/13/2000 * Check Effective date for rate change
0010                                                                 >  *                       when appropriate.
0011 *-------------------------------------------------------------     *-----------------------------------------------------------
0012 *COPY>CPYLIB>COM1                                                  *COPY>CPYLIB>COM1
0013 *COPY>CPYLIB>CHAR                                                  *COPY>CPYLIB>CHAR

0067 SCV.REC(2)=JGT.DESC;SCV.REC(11)=JGT.CLASS                          SCV.REC(2)=JGT.DESC;SCV.REC(11)=JGT.CLASS
0068 LMNT=DCOUNT(SCV.REC(11),VM)                                        LMNT=DCOUNT(SCV.REC(11),VM)
0069 FOR MNT=1 TO LMNT                                                  FOR MNT=1 TO LMNT
0070 SCV.REC(10)<1,MNT>=MNT                                             SCV.REC(10)<1,MNT>=MNT
0071 MATREAD JCC.REC FROM JOB.CLASS,CONO:SCV.REC(11)<1,MNT> THEN        MATREAD JCC.REC FROM JOB.CLASS,CONO:SCV.REC(11)<1,MNT> THEN
0072                                                                 >  JCC.ID=CONO:SCV.REC(11)<1,MNT>;GOSUB 9000;*T25142
0073 SCV.REC(12)<1,MNT>=JCC.DESC                                        SCV.REC(12)<1,MNT>=JCC.DESC
0074 SCV.REC(13)<1,MNT>=JCC.RATE                                        SCV.REC(13)<1,MNT>=JCC.RATE
0075 END                                                                END
0076 NEXT MNT                                                           NEXT MNT

0101 CASE OPTION='S'                                                    CASE OPTION='S'
0102 PG=INT((MNT-1)/LINE.COUNT)+1                                       PG=INT((MNT-1)/LINE.COUNT)+1
0103 MNT=(PG*LINE.COUNT)+1                                              MNT=(PG*LINE.COUNT)+1
0104 IF MNT>LMNT THEN MNT=1                                             IF MNT>LMNT THEN MNT=1
0105 ECD.NUM=10;ECD.SUB.NUM=MNT;CALL SCROLL.SUB                         ECD.NUM=10;ECD.SUB.NUM=MNT;CALL SCROLL.SUB
0106 * T25978 v                                                      <  
0107 CASE OPTION='SR'                                                <  
0108 PG=INT((MNT-1)/LINE.COUNT)-1                                    <  
0109 MNT=(PG*LINE.COUNT)+1                                           <  
0110 IF MNT<1 THEN MNT=1                                             <  

0111 ECD.NUM=10;ECD.SUB.NUM=MNT;CALL SCROLL.SUB                      <  
0112 CASE OPTION='SB'                                                <  
0113 MNT = 1 + INT((LMNT-1)/LINE.COUNT)*LINE.COUNT                   <  
0114 ECD.NUM=10;ECD.SUB.NUM=MNT;CALL SCROLL.SUB                      <  
0115 CASE OPTION='ST'                                                <  
0116 MNT = 1                                                         <  
0117 ECD.NUM=10;ECD.SUB.NUM=MNT;CALL SCROLL.SUB                      <  

0118 * T25978 ^                                                      <  
0119 CASE OPTION=1;ECD.NUM=2;GOSUB 1000                                 CASE OPTION=1;ECD.NUM=2;GOSUB 1000
0120 CASE OPTION='A'                                                    CASE OPTION='A'
0121 450   *                                                            450   *
0122 PPG=INT((MNT-1)/LINE.COUNT)+1;MNT=LMNT                             PPG=INT((MNT-1)/LINE.COUNT)+1;MNT=LMNT
0123 LOOP UNTIL ECD.RET.VALUE='END' DO                                  LOOP UNTIL ECD.RET.VALUE='END' DO
0124 MNT=MNT+1;PG=INT((MNT-1)/LINE.COUNT)+1                             MNT=MNT+1;PG=INT((MNT-1)/LINE.COUNT)+1

0181 MATREAD JCC.REC FROM JOB.CLASS,CONO:VAL ELSE                       MATREAD JCC.REC FROM JOB.CLASS,CONO:VAL ELSE
0182 SCV.REC(11)<1,ECD.SUB.NUM>=''                                      SCV.REC(11)<1,ECD.SUB.NUM>=''
0183 ERRMSG='* * INVALID JOB CLASS * *';GOSUB 9100                      ERRMSG='* * INVALID JOB CLASS * *';GOSUB 9100
0184 ECD.SUB.NUM=MNT;ECD.ACTION=5;CALL SCRN.EDIT;GO 1000                ECD.SUB.NUM=MNT;ECD.ACTION=5;CALL SCRN.EDIT;GO 1000
0185 END                                                                END
0186                                                                 >  JCC.ID=CONO:VAL;GOSUB 9000;*T25142
0187 SCV.REC(11)<1,ECD.SUB.NUM>=VAL                                     SCV.REC(11)<1,ECD.SUB.NUM>=VAL
0188 SCV.REC(12)<1,ECD.SUB.NUM>=JCC.DESC                                SCV.REC(12)<1,ECD.SUB.NUM>=JCC.DESC
0189 SCV.REC(13)<1,ECD.SUB.NUM>=JCC.RATE                                SCV.REC(13)<1,ECD.SUB.NUM>=JCC.RATE
0190 ECD.SUB.NUM=MNT;ECD.NUM=12;ECD.ACTION=5;CALL SCRN.EDIT             ECD.SUB.NUM=MNT;ECD.NUM=12;ECD.ACTION=5;CALL SCRN.EDIT

0228 *-------------------------------------------------------------     *-----------------------------------------------------------
0229 HEAD='CodeDescription.........................Rate'              HEAD='CodeDescription.........................Rate'
0230 CALL CHOICES.SUB(HEAD,CHOICES,REPAINT)                             CALL CHOICES.SUB(HEAD,CHOICES,REPAINT)
0231 RETURN                                                             RETURN
0232 *-------------------------------------------------------------     *-----------------------------------------------------------
0233                                                                 >  *T25142 v
0234                                                                 >  *
0235                                                                 >  9000 *  CHECK FOR RATE CHANGE
0236                                                                 >  *
0237                                                                 >  JFLAG = ''

0238                                                                 >  9001 *
0239                                                                 >  JCNT = DCOUNT(JCC.EFF.DATE<1>,VM)
0240                                                                 >  FOR J = 1 TO JCNT
0241                                                                 >  IF JCC.EFF.DATE<1,J> GT DATE() THEN NULL ELSE
0242                                                                 >  JCC.RATE = JCC.EFF.RATE<1,J>
0243                                                                 >  JCC.EFF.DATE=DELETE(JCC.EFF.DATE,1,J,0)
0244                                                                 >  JCC.EFF.RATE=DELETE(JCC.EFF.RATE,1,J,0)

0245                                                                 >  JFLAG = 1
0246                                                                 >  GOTO 9001
0247                                                                 >  END
0248                                                                 >  NEXT J
0249                                                                 >  IF JFLAG THEN MATWRITE JCC.REC ON JOB.CLASS, JCC.ID
0250                                                                 >  RETURN
0251                                                                 >  *T25142 ^

0252                                                                 >  *
0253 9100 PRINT @(0,23):CL:ERRMSG:;INPUT XX:;PRINT @(0,23):CL:;RETU     9100  PRINT @(0,23):CL:ERRMSG:;INPUT XX:;PRINT @(0,23):CL:;R
0254 9300 PRINT @(0,23):CL:ERRMSG:;INPUT XX:;PRINT @(0,23):CL:          9300  PRINT @(0,23):CL:ERRMSG:;INPUT XX:;PRINT @(0,23):CL:
0255 9999 END                                                           9999  END
0256 


EPSBP/JOB.RATE.MAINT                                               /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/JOB.RATE.MAINT
Printed for thompson at 06/28/2006 04:23:38PM

0004 * SOURCE         - EPSBP                                           * SOURCE         - EPSBP
0005 * PROGRAM        - JOB.RATE.MAINT                                  * PROGRAM        - JOB.RATE.MAINT
0006 * BY             - Scott Dickerson, PRISM Software Technologie     * BY             - Scott Dickerson, PRISM Software Technolog
0007 * DATE           - 11-08-89                                        * DATE           - 11-08-89
0008 * DESCRIPTION    - JOB CLASSIFICATION RATE MAINTENANCE             * DESCRIPTION    - JOB CLASSIFICATION RATE MAINTENANCE
0009 *T25978 adelgado 02/05/2002 * Add the use of prompts (S,SR,SB,  |  *T25142 cm 06/27/2000 * Add Effective date field.
0010 *-------------------------------------------------------------     *-----------------------------------------------------------
0011 *COPY>CPYLIB>COM1                                                  *COPY>CPYLIB>COM1
0012 *COPY>CPYLIB>CHAR                                                  *COPY>CPYLIB>CHAR
0013 *COPY>CPYLIB>EDIT.COM                                              *COPY>CPYLIB>EDIT.COM

0019 * OPEN FILES                                                       * OPEN FILES
0020 *-------------------------------------------------------------     *-----------------------------------------------------------
0021 OPEN 'CONTROL' TO CONTROL ELSE                                     OPEN 'CONTROL' TO CONTROL ELSE
0022 ERRMSG='CONTROL FILE MISSING';GO 9300                              ERRMSG='CONTROL FILE MISSING';GO 9300
0023 END                                                                END
0024 OPEN 'PRS.SCREENS' TO M.SCREENS ELSE                            |  *T25142 v
0025                                                                 >  *  OPEN 'PRS.SCREENS' TO M.SCREENS ELSE
0026                                                                 >  OPEN 'CBN.SCREENS' TO M.SCREENS ELSE
0027                                                                 >  *T25142 ^
0028 ERRMSG='PRS.SCREENS FILE MISSING';GO 9300                          ERRMSG='PRS.SCREENS FILE MISSING';GO 9300

0073 CASE OPTION='F'                                                    CASE OPTION='F'
0074 JCR.CLASS=SCV.REC(11)                                              JCR.CLASS=SCV.REC(11)
0075 JCR.TYPE=SCV.REC(14)                                               JCR.TYPE=SCV.REC(14)
0076 JCR.AMT=SCV.REC(15)                                                JCR.AMT=SCV.REC(15)
0077 JCR.PCT=SCV.REC(16)                                                JCR.PCT=SCV.REC(16)
0078                                                                 >  JCR.EFF.DATE=SCV.REC(17) ; *T25142
0079 *-------------------------------------------------------------     *-----------------------------------------------------------
0080 415*                                                               415*
0081 PMSG='Apply rate changes to employee file? ';X=0;Y=21;TYP=8     |  *T25142 v
0082 FILL='#';MAXL=1;ECHO.BACK=1;CALL EDIT.SUB                       |  *            PMSG='Apply rate changes to employee file? ';X=

0083 IF VALUE='END' THEN GO 9999                                     |  *            FILL='#';MAXL=1;ECHO.BACK=1;CALL EDIT.SUB
0084 IF VALUE='Y' THEN                                               |  *            IF VALUE='END' THEN GO 9999
0085 PMSG='Enter date to install changes or <cr> for now: '          |  *            IF VALUE='Y' THEN
0086 X=0;Y=21;TYP=6;FILL='#';MAXL=8;ECHO.BACK=1;O.R='O'              |  *               PMSG='Enter date to install changes or <cr> 
0087 CALL EDIT.SUB                                                   |  *               X=0;Y=21;TYP=6;FILL='#';MAXL=8;ECHO.BACK=1;O
0088 IF VALUE='END' THEN GO 9999                                     |  *               CALL EDIT.SUB
0089 IF VALUE#'' THEN                                                |  *               IF VALUE='END' THEN GO 9999

0090 DATE=VALUE;JCR.STATUS='P'                                       |  *               IF VALUE#'' THEN
0091 END ELSE                                                        |  *                  DATE=VALUE;JCR.STATUS='P'
0092 DATE=DATE();JCR.STATUS='U'                                      |  *               END ELSE
0093 END                                                             |  *                  DATE=DATE();JCR.STATUS='U'
0094 END ELSE                                                        |  *               END
0095 PMSG = 'THESE CHANGES APPLY TO JOB CLASS FILE ONLY - ENTER "N"  |  *            END ELSE
0096 FILL='#';MAXL=1;ECHO.BACK=1;CALL EDIT.SUB                       |  *               PMSG = 'THESE CHANGES APPLY TO JOB CLASS FIL

0097 IF VALUE = 'N' THEN GO 415                                      |  *               FILL='#';MAXL=1;ECHO.BACK=1;CALL EDIT.SUB
0098 DATE=DATE();JCR.STATUS='N'                                      |  *               IF VALUE = 'N' THEN GO 415
0099 END                                                             |  *               DATE=DATE();JCR.STATUS='N'
0100                                                                 >  *            END
0101                                                                 >  JCR.STATUS = 'U'
0102                                                                 >  DATE = DATE()
0103                                                                 >  *T25142 ^

0116 CASE OPTION='S'                                                    CASE OPTION='S'
0117 PG=INT((MN-1)/LINE.COUNT)+1                                        PG=INT((MN-1)/LINE.COUNT)+1
0118 MN=(PG*LINE.COUNT)+1                                               MN=(PG*LINE.COUNT)+1
0119 IF MN>LMN THEN MN=1                                                IF MN>LMN THEN MN=1
0120 AN=10;VN=MN;CALL SCROLL.SUB                                        AN=10;VN=MN;CALL SCROLL.SUB
0121 * T25978 v                                                      <  
0122 CASE OPTION='SR'                                                <  
0123 PG=INT((MN-1)/LINE.COUNT)-1                                     <  
0124 MN=(PG*LINE.COUNT)+1                                            <  
0125 IF MN<1 THEN MN=1                                               <  

0126 AN=10;VN=MN;CALL SCROLL.SUB                                     <  
0127 CASE OPTION='SB'                                                <  
0128 MN = 1 + INT((LMN-1)/LINE.COUNT)*LINE.COUNT                     <  
0129 AN=10;VN=MN;CALL SCROLL.SUB                                     <  
0130 CASE OPTION='ST'                                                <  
0131 MN = 1                                                          <  
0132 AN=10;VN=MN;CALL SCROLL.SUB                                     <  

0133 * T25978 ^                                                      <  
0134 CASE OPTION='A'                                                    CASE OPTION='A'
0135 PPG=INT((MN-1)/LINE.COUNT)+1;MN=LMN                                PPG=INT((MN-1)/LINE.COUNT)+1;MN=LMN
0136 LOOP UNTIL VAL='END' DO                                            LOOP UNTIL VAL='END' DO
0137 MN=MN+1;PG=INT((MN-1)/LINE.COUNT)+1                                MN=MN+1;PG=INT((MN-1)/LINE.COUNT)+1
0138 IF PG#PPG THEN                                                     IF PG#PPG THEN
0139 VN=((PG-1)*LINE.COUNT)+1                                           VN=((PG-1)*LINE.COUNT)+1

0143 AN=10;ACT=5;CALL SCRN.EDIT                                         AN=10;ACT=5;CALL SCRN.EDIT
0144 VN=MN                                                              VN=MN
0145 AN=11;GOSUB 1000                                                   AN=11;GOSUB 1000
0146 REPEAT                                                             REPEAT
0147 *-------------------------------------------------------------     *-----------------------------------------------------------
0148 FOR AN=10 TO 16                                                 |  *T25142 v
0149                                                                 >  *           FOR AN=10 TO 16
0150                                                                 >  FOR AN=10 TO 17
0151                                                                 >  *T25142 ^
0152 VN=MN                                                              VN=MN

0176 PMSG='Line';X=0;Y=21;TYP=3;MINV=1;MAXV=LMN                         PMSG='Line';X=0;Y=21;TYP=3;MINV=1;MAXV=LMN
0177 FILL='#';MAXL=3;ECHO.BACK=1;CALL EDIT.SUB                          FILL='#';MAXL=3;ECHO.BACK=1;CALL EDIT.SUB
0178 IF VALUE#'END' AND VALUE#'' THEN                                   IF VALUE#'END' AND VALUE#'' THEN
0179 PPG=INT((MN-1)/LINE.COUNT)+1;MN=VALUE                              PPG=INT((MN-1)/LINE.COUNT)+1;MN=VALUE
0180 DEL SCV.REC(10)<1,LMN>                                             DEL SCV.REC(10)<1,LMN>
0181 FOR X=11 TO 16;DEL SCV.REC(X)<1,MN>;NEXT X                      |  *T25142 v
0182                                                                 >  *              FOR X=11 TO 16;DEL SCV.REC(X)<1,MN>;NEXT X
0183                                                                 >  FOR X=11 TO 17;DEL SCV.REC(X)<1,MN>;NEXT X
0184                                                                 >  *T25142 ^
0185 IF MN=LMN THEN MN=MN-1;IF MN=0 THEN MN=1                           IF MN=LMN THEN MN=MN-1;IF MN=0 THEN MN=1

0207 LOCATE VAL IN SCV.REC(11)<1> SETTING Z THEN                        LOCATE VAL IN SCV.REC(11)<1> SETTING Z THEN
0208 ERRMSG='* * JOB CLASS (':VAL:') HAS BEEN ENTERED * *'              ERRMSG='* * JOB CLASS (':VAL:') HAS BEEN ENTERED * *'
0209 GOSUB 9100                                                         GOSUB 9100
0210 ACT=5;CALL SCRN.EDIT;GO 1000                                       ACT=5;CALL SCRN.EDIT;GO 1000
0211 END                                                                END
0212                                                                 >  JCC.ID = CONO:VAL;GOSUB 9000 ; *T25142
0213 VN=MN                                                              VN=MN
0214 SCV.REC(11)<1,VN>=VAL                                              SCV.REC(11)<1,VN>=VAL
0215 SCV.REC(12)<1,VN>=JCC.DESC                                         SCV.REC(12)<1,VN>=JCC.DESC
0216 SCV.REC(13)<1,VN>=JCC.RATE                                         SCV.REC(13)<1,VN>=JCC.RATE

0229 ACT=5;CALL SCRN.EDIT;AN=16                                         ACT=5;CALL SCRN.EDIT;AN=16
0230 END                                                                END
0231 GO 1000                                                            GO 1000
0232 END CASE                                                           END CASE
0233 END                                                                END
0234                                                                 >  *T25142 v
0235                                                                 >  IF VAL # 'END' THEN
0236                                                                 >  SCV.REC(17)<1,MN>='';AN=17
0237                                                                 >  VN=MN
0238                                                                 >  ACT=5;CALL SCRN.EDIT;AN=17

0239                                                                 >  VN=MN
0240                                                                 >  ACT=4;CALL SCRN.EDIT
0241                                                                 >  END
0242                                                                 >  *T25142 ^
0243 RETURN                                                             RETURN
0244 *-------------------------------------------------------------     *-----------------------------------------------------------
0245 7000  * UPDATE JOB.CLASS FILE WITH RATE CHANGE                     7000  * UPDATE JOB.CLASS FILE WITH RATE CHANGE

0247 LVN=DCOUNT(JCR.CLASS<1>,VM)                                        LVN=DCOUNT(JCR.CLASS<1>,VM)
0248 FOR VN=1 TO LVN                                                    FOR VN=1 TO LVN
0249 JCC=JCR.CLASS<1,VN>;TYP=JCR.TYPE<1,VN>                             JCC=JCR.CLASS<1,VN>;TYP=JCR.TYPE<1,VN>
0250 AMT=JCR.AMT<1,VN>;PCT=JCR.PCT<1,VN>                                AMT=JCR.AMT<1,VN>;PCT=JCR.PCT<1,VN>
0251 MATREAD JCC.REC FROM JOB.CLASS,CONO:JCC THEN                       MATREAD JCC.REC FROM JOB.CLASS,CONO:JCC THEN
0252                                                                 >  OLD.JCC.RATE = JCC.RATE; * T25142
0253 BEGIN CASE                                                         BEGIN CASE
0254 CASE TYP='AA';JCC.RATE=JCC.RATE+AMT                                CASE TYP='AA';JCC.RATE=JCC.RATE+AMT
0255 CASE TYP='SA';JCC.RATE=JCC.RATE-AMT                                CASE TYP='SA';JCC.RATE=JCC.RATE-AMT
0256 CASE TYP='RA';JCC.RATE=AMT                                         CASE TYP='RA';JCC.RATE=AMT

0259 JCC.RATE=INT(JCC.RATE*PCT)                                         JCC.RATE=INT(JCC.RATE*PCT)
0260 CASE TYP='SP'                                                      CASE TYP='SP'
0261 PCT=1-(PCT/10000)                                                  PCT=1-(PCT/10000)
0262 JCC.RATE=INT(JCC.RATE*PCT)                                         JCC.RATE=INT(JCC.RATE*PCT)
0263 END CASE                                                           END CASE
0264                                                                 >  *T25142 v
0265                                                                 >  IF JCR.EFF.DATE<1,VN> GT DATE() THEN
0266                                                                 >  LOCATE JCR.EFF.DATE<1,VN> IN JCC.EFF.DATE,1 SETTING JED ELSE
0267                                                                 >  JED = DCOUNT(JCC.EFF.DATE<1>,VM) + 1
0268                                                                 >  END

0269                                                                 >  JCC.EFF.DATE<1,JED> = JCR.EFF.DATE<1,VN>
0270                                                                 >  JCC.EFF.RATE<1,JED> = JCC.RATE
0271                                                                 >  JCC.RATE = OLD.JCC.RATE
0272                                                                 >  END
0273                                                                 >  *T25142 ^
0274 MATWRITE JCC.REC ON JOB.CLASS,CONO:JCC                             MATWRITE JCC.REC ON JOB.CLASS,CONO:JCC
0275 END                                                                END

0278 *-------------------------------------------------------------     *-----------------------------------------------------------
0279 8000  * UPDATE EMPLOYEE FILE WITH RATE CHANGES                     8000  * UPDATE EMPLOYEE FILE WITH RATE CHANGES
0280 *-------------------------------------------------------------     *-----------------------------------------------------------
0281 CALL JOB.RATE.MAINT.SUB(ID,HEAD)                                   CALL JOB.RATE.MAINT.SUB(ID,HEAD)
0282 RETURN                                                             RETURN
0283                                                                 >  *T25142 v
0284                                                                 >  *-----------------------------------------------------------
0285                                                                 >  9000  * CHECK FOR RATE CHANGES
0286                                                                 >  *-----------------------------------------------------------
0287                                                                 >  JFLAG = ''

0288                                                                 >  9001 *
0289                                                                 >  JCNT = DCOUNT(JCC.EFF.DATE<1>,VM)
0290                                                                 >  FOR J = 1 TO JCNT
0291                                                                 >  IF JCC.EFF.DATE<1,J> GT DATE() THEN NULL ELSE
0292                                                                 >  JCC.RATE = JCC.EFF.RATE<1,J>
0293                                                                 >  JCC.EFF.DATE=DELETE(JCC.EFF.DATE,1,J,0)
0294                                                                 >  JCC.EFF.RATE=DELETE(JCC.EFF.RATE,1,J,0)

0295                                                                 >  JFLAG = 1
0296                                                                 >  GOTO 9001
0297                                                                 >  END
0298                                                                 >  NEXT J
0299                                                                 >  IF JFLAG THEN MATWRITE JCC.REC ON JOB.CLASS, JCC.ID
0300                                                                 >  RETURN
0301                                                                 >  *T25142 ^


EPSBP/JOB.RATE.MAINT.INQ                                           /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/JOB.RATE.MAINT.INQ
Printed for thompson at 06/28/2006 04:23:38PM

0004 * SOURCE         - EPSBP                                           * SOURCE         - EPSBP
0005 * PROGRAM        - JOB.RATE.MAINT.INQ                              * PROGRAM        - JOB.RATE.MAINT.INQ
0006 * BY             - Scott Dickerson, PRISM Software Technologie     * BY             - Scott Dickerson, PRISM Software Technolog
0007 * DATE           - 11-29-89                                        * DATE           - 11-29-89
0008 * DESCRIPTION    - JOB CLASSIFICATION RATE MAINTENANCE INQUIRY     * DESCRIPTION    - JOB CLASSIFICATION RATE MAINTENANCE INQUI
0009 *T25978 adelgado 02/05/2002 * Add the use of prompts (S,SR,SB,  |  *T25142 cm 06/28/2000 * Add Effective Date field to screen.
0010 *-------------------------------------------------------------     *-----------------------------------------------------------
0011 *COPY>CPYLIB>COM1                                                  *COPY>CPYLIB>COM1
0012 *COPY>CPYLIB>CHAR                                                  *COPY>CPYLIB>CHAR
0013 *COPY>CPYLIB>EDIT.COM                                              *COPY>CPYLIB>EDIT.COM

0019 * OPEN FILES                                                       * OPEN FILES
0020 *-------------------------------------------------------------     *-----------------------------------------------------------
0021 OPEN 'CONTROL' TO CONTROL ELSE                                     OPEN 'CONTROL' TO CONTROL ELSE
0022 ERRMSG='CONTROL FILE MISSING';GO 9300                              ERRMSG='CONTROL FILE MISSING';GO 9300
0023 END                                                                END
0024 OPEN 'PRS.SCREENS' TO M.SCREENS ELSE                            |  *T25142 v
0025                                                                 >  *     OPEN 'PRS.SCREENS' TO M.SCREENS ELSE
0026                                                                 >  OPEN 'CBN.SCREENS' TO M.SCREENS ELSE
0027                                                                 >  *T25142 ^
0028 ERRMSG='PRS.SCREENS FILE MISSING';GO 9300                          ERRMSG='PRS.SCREENS FILE MISSING';GO 9300

0103 SCV.REC(14)=JCR.PCT                                                SCV.REC(14)=JCR.PCT
0104 SCV.REC(15)=JCR.STATUS                                             SCV.REC(15)=JCR.STATUS
0105 SCV.REC(15)=CHANGE(SCV.REC(15),'N','NONE')                         SCV.REC(15)=CHANGE(SCV.REC(15),'N','NONE')
0106 SCV.REC(15)=CHANGE(SCV.REC(15),'P','PENDING')                      SCV.REC(15)=CHANGE(SCV.REC(15),'P','PENDING')
0107 SCV.REC(15)=CHANGE(SCV.REC(15),'U','UPDATED')                      SCV.REC(15)=CHANGE(SCV.REC(15),'U','UPDATED')
0108                                                                 >  SCV.REC(16)=JCR.EFF.DATE ; * T25142
0109 AN=10;VN=1;CALL SCROLL.SUB                                         AN=10;VN=1;CALL SCROLL.SUB
0110 END ELSE                                                           END ELSE
0111 ERRMSG='* * ITEM IS NOT ON FILE * *';GOSUB 9100                    ERRMSG='* * ITEM IS NOT ON FILE * *';GOSUB 9100
0112 SCV.REC(2)='';AN=2;ACT=5;CALL SCRN.EDIT                            SCV.REC(2)='';AN=2;ACT=5;CALL SCRN.EDIT

0131 VN=(PG*LINE.COUNT)+1                                               VN=(PG*LINE.COUNT)+1
0132 CTR=(PG*LINE.COUNT)+1                                              CTR=(PG*LINE.COUNT)+1
0133 IF VN>DCOUNT(SCV.REC(10),VM) THEN VN=1                             IF VN>DCOUNT(SCV.REC(10),VM) THEN VN=1
0134 IF CTR>DCOUNT(SCV.REC(10),VM) THEN CTR=1                           IF CTR>DCOUNT(SCV.REC(10),VM) THEN CTR=1
0135 AN=10;CALL SCROLL.SUB                                              AN=10;CALL SCROLL.SUB
0136 * T25978 v                                                      <  
0137 CASE OPT='SR'                                                   <  
0138 PG=INT((CTR-1)/LINE.COUNT)-1                                    <  
0139 VN=(PG*LINE.COUNT)+1                                            <  
0140 CTR=(PG*LINE.COUNT)+1                                           <  

0141 IF VN<1 THEN VN = 1                                             <  
0142 IF CTR<1 THEN CTR = 1                                           <  
0143 AN=10;CALL SCROLL.SUB                                           <  
0144 CASE OPT='SB'                                                   <  
0145 TMP.CNT = DCOUNT(SCV.REC(10),VM)                                <  
0146 VN = 1 + INT((TMP.CNT-1)/LINE.COUNT)*LINE.COUNT                 <  
0147 CTR = 1 + INT((TMP.CNT-1)/LINE.COUNT)*LINE.COUNT                <  

0148 AN=10;CALL SCROLL.SUB                                           <  
0149 CASE OPT='ST'                                                   <  
0150 VN = 1                                                          <  
0151 CTR = 1                                                         <  
0152 AN=10;CALL SCROLL.SUB                                           <  
0153 * T25978 ^                                                      <  
0154 END CASE                                                           END CASE


EPSBP/JOB.RATE.MAINT.SUB                                           /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/JOB.RATE.MAINT.SUB
Printed for thompson at 06/28/2006 04:23:38PM

0004 * REVISION       - [08.1]                                          * REVISION       - [08.1]
0005 * SOURCE         - EPSBP                                           * SOURCE         - EPSBP
0006 * PROGRAM        - EMPUPD.SUB                                      * PROGRAM        - EMPUPD.SUB
0007 * BY             - Scott Dickerson, PRISM Software Technologie     * BY             - Scott Dickerson, PRISM Software Technolog
0008 * DATE           - 12-07-89                                        * DATE           - 12-07-89
0009 * DESCRIPTION    - UPDATE EMPLOYEE EMPLOYEES WITH JOB RATE CHA  |  * DESCRIPTION    - UPDATE EMPLOYEES WITH JOB RATE CHANGES
0010                                                                 >  *
0011                                                                 >  *T25142 cm 06/28/2000 * Add 3 fields so rate changes can be 
0012                                                                 >  *                       then go into effect on the specified
0013                                                                 >  *                       date.

0014                                                                 >  *ENDDOC
0015 *-------------------------------------------------------------     *-----------------------------------------------------------
0016 *COPY>CPYLIB>COM1                                                  *COPY>CPYLIB>COM1
0017 *COPY>CPYLIB>CHAR                                                  *COPY>CPYLIB>CHAR
0018 *COPY>CPYLIB>EDIT.COM                                              *COPY>CPYLIB>EDIT.COM
0019 *COPY>CPYLIB>EDIT.COM.DRIVER                                       *COPY>CPYLIB>EDIT.COM.DRIVER
0020 *COPY>CPYLIB>FILE.VARS                                             *COPY>CPYLIB>FILE.VARS

0032 *-------------------------------------------------------------     *-----------------------------------------------------------
0033 * INITIALIZATION                                                   * INITIALIZATION
0034 *-------------------------------------------------------------     *-----------------------------------------------------------
0035 IF ID.LIST='' THEN RETURN                                          IF ID.LIST='' THEN RETURN
0036 CONO=ID.LIST[1,3]                                                  CONO=ID.LIST[1,3]
0037 DIM JCR(4);MAT JCR='';DIM RPT(5);MAT RPT=''                     |  *T25142 v
0038                                                                 >  *  DIM JCR(4);MAT JCR='';DIM RPT(5);MAT RPT=''
0039                                                                 >  DIM JCR(5);MAT JCR='';DIM RPT(6);MAT RPT=''
0040                                                                 >  TODAY=DATE()
0041                                                                 >  *T25142 ^

0049 NVN=DCOUNT(JCR(1),VM)                                              NVN=DCOUNT(JCR(1),VM)
0050 JCR(1)<1,NVN>=JCR.CLASS                                            JCR(1)<1,NVN>=JCR.CLASS
0051 JCR(2)<1,NVN>=JCR.TYPE                                             JCR(2)<1,NVN>=JCR.TYPE
0052 JCR(3)<1,NVN>=JCR.AMT                                              JCR(3)<1,NVN>=JCR.AMT
0053 JCR(4)<1,NVN>=JCR.PCT                                              JCR(4)<1,NVN>=JCR.PCT
0054                                                                 >  JCR(5)<1,NVN>=JCR.EFF.DATE ; * T25142
0055 JCR.STATUS='U'                                                     JCR.STATUS='U'
0056 MATWRITE JCR.REC ON JOB.RATE,ID                                    MATWRITE JCR.REC ON JOB.RATE,ID
0057 END                                                                END
0058 NEXT VN                                                            NEXT VN

0063 MORE = 1                                                           MORE = 1
0064 LOOP                                                               LOOP
0065 READNEXT EMP.NUM ELSE MORE = 0                                     READNEXT EMP.NUM ELSE MORE = 0
0066 WHILE MORE DO                                                      WHILE MORE DO
0067 IF EMP.NUM[1,3]=CONO THEN                                          IF EMP.NUM[1,3]=CONO THEN
0068 MATREAD EMP.REC FROM EMPLOYEE,EMP.NUM THEN                      |  *C45193 v
0069                                                                 >  *        MATREAD EMP.REC FROM EMPLOYEE,EMP.NUM THEN
0070                                                                 >  MATREADU EMP.REC FROM EMPLOYEE,EMP.NUM THEN
0071 RAN=0;GOSUB 1000                                                   RAN=0;GOSUB 1000
0072 IF RAN#0 THEN MATWRITE EMP.REC ON EMPLOYEE,EMP.NUM              |  *           IF RAN#0 THEN MATWRITE EMP.REC ON EMPLOYEE,EMP.N

0073                                                                 >  IF RAN#0 THEN MATWRITE EMP.REC ON EMPLOYEE,EMP.NUM ELSE RELE
0074 END                                                                END
0075 END                                                                END
0076 REPEAT                                                             REPEAT
0077 GO 3000                                                            GO 3000
0078 *-------------------------------------------------------------     *-----------------------------------------------------------
0079 1000  * CHECK FOR CLASS TO BE CHANGED                              1000  * CHECK FOR CLASS TO BE CHANGED

0079 1000  * CHECK FOR CLASS TO BE CHANGED                              1000  * CHECK FOR CLASS TO BE CHANGED
0080 *-------------------------------------------------------------     *-----------------------------------------------------------
0081 LOCATE EMP.JOB.CLASS IN JCR(1)<1> SETTING JVN THEN                 LOCATE EMP.JOB.CLASS IN JCR(1)<1> SETTING JVN THEN
0082 CLS=EMP.JOB.CLASS;RATE=EMP.JOB.CL.RATE;NEW.RATE=RATE               CLS=EMP.JOB.CLASS;RATE=EMP.JOB.CL.RATE;NEW.RATE=RATE
0083 TYP=JCR(2)<1,JVN>;AMT=JCR(3)<1,JVN>;PCT=JCR(4)<1,JVN>              TYP=JCR(2)<1,JVN>;AMT=JCR(3)<1,JVN>;PCT=JCR(4)<1,JVN>
0084                                                                 >  CCLS=JCR(1)<1,JVN>;DTE=JCR(5)<1,JVN> ; *T25142
0085 GOSUB 1500                                                         GOSUB 1500
0086 IF RATE#NEW.RATE THEN GOSUB 2000;EMP.JOB.CL.RATE=NEW.RATE;EMP.  |  *T25142 v
0087                                                                 >  *     IF RATE#NEW.RATE THEN GOSUB 2000;EMP.JOB.CL.RATE=NEW.R
0088                                                                 >  IF RATE # NEW.RATE AND DTE LE TODAY THEN

0089                                                                 >  GOSUB 2000
0090                                                                 >  EMP.JOB.CL.RATE=NEW.RATE
0091                                                                 >  EMP.RATE=NEW.RATE
0092                                                                 >  END ELSE
0093                                                                 >  GOSUB 2000
0094                                                                 >  LOCATE CCLS IN EMP.EFF.CLASS<1>,1 SETTING EEC ELSE
0095                                                                 >  EEC = DCOUNT(EMP.EFF.CLASS<1>,VM) + 1

0096 END                                                                END
0097                                                                 >  EMP.EFF.CLASS<1,EEC> = CCLS
0098                                                                 >  EMP.EFF.DATE<1,EEC> = DTE
0099                                                                 >  EMP.EFF.RATE<1,EEC> = NEW.RATE
0100                                                                 >  EMP.EFF.TYPE<1,EEC> = TYP
0101                                                                 >  END
0102                                                                 >  *T25142 ^
0103                                                                 >  END

0104 *-------------------------------------------------------------     *-----------------------------------------------------------
0105                                                                 >  IF EMP.STATUS = 'S' THEN RETURN
0106 LVN=DCOUNT(EMP.VALID.CLASS<1>,VM)                                  LVN=DCOUNT(EMP.VALID.CLASS<1>,VM)
0107 FOR VN=1 TO LVN                                                    FOR VN=1 TO LVN
0108                                                                 >  IF EMP.VALID.CLASS<1,VN> = EMP.JOB.CLASS THEN GO 1001
0109 LOCATE EMP.VALID.CLASS<1,VN> IN JCR(1)<1> SETTING JVN THEN         LOCATE EMP.VALID.CLASS<1,VN> IN JCR(1)<1> SETTING JVN THEN
0110 CLS=EMP.VALID.CLASS<1,VN>;RATE=EMP.VAL.CL.RATE<1,VN>               CLS=EMP.VALID.CLASS<1,VN>;RATE=EMP.VAL.CL.RATE<1,VN>
0111 NEW.RATE=RATE                                                      NEW.RATE=RATE

0112 TYP=JCR(2)<1,JVN>;AMT=JCR(3)<1,JVN>;PCT=JCR(4)<1,JVN>              TYP=JCR(2)<1,JVN>;AMT=JCR(3)<1,JVN>;PCT=JCR(4)<1,JVN>
0113                                                                 >  CCLS=JCR(1)<1,JVN>;DTE=JCR(5)<1,JVN> ; *T25142
0114 GOSUB 1500                                                         GOSUB 1500
0115 IF RATE#NEW.RATE THEN GOSUB 2000;EMP.VAL.CL.RATE<1,VN>=NEW.RAT  |  *T25142 v
0116                                                                 >  *        IF RATE#NEW.RATE THEN GOSUB 2000;EMP.VAL.CL.RATE<1,
0117                                                                 >  IF RATE # NEW.RATE AND DTE LE TODAY THEN
0118                                                                 >  GOSUB 2000
0119                                                                 >  EMP.VAL.CL.RATE<1,VN> = NEW.RATE

0120                                                                 >  END ELSE
0121                                                                 >  GOSUB 2000
0122                                                                 >  LOCATE CCLS IN EMP.EFF.CLASS<1>,1 SETTING EEC ELSE
0123                                                                 >  EEC = DCOUNT(EMP.EFF.CLASS<1>,VM) + 1
0124 END                                                                END
0125                                                                 >  EMP.EFF.CLASS<1,EEC> = CCLS
0126                                                                 >  EMP.EFF.DATE<1,EEC> = DTE

0127                                                                 >  EMP.EFF.RATE<1,EEC> = NEW.RATE
0128                                                                 >  EMP.EFF.TYPE<1,EEC> = TYP
0129                                                                 >  END
0130                                                                 >  *T25142 ^
0131                                                                 >  END
0132                                                                 >  1001 *
0133 NEXT VN                                                            NEXT VN

0153 IF RAN=0 THEN                                                      IF RAN=0 THEN
0154 NAME=EMP.LAST.NAME:', ':EMP.FRST.NAME                              NAME=EMP.LAST.NAME:', ':EMP.FRST.NAME
0155 LOCATE NAME IN RPT(2) BY 'AL' SETTING RAN ELSE NULL                LOCATE NAME IN RPT(2) BY 'AL' SETTING RAN ELSE NULL
0156 RPT(1)=INSERT(RPT(1),RAN,0,0,EMP.NUM[4,99])                        RPT(1)=INSERT(RPT(1),RAN,0,0,EMP.NUM[4,99])
0157 RPT(2)=INSERT(RPT(2),RAN,0,0,NAME)                                 RPT(2)=INSERT(RPT(2),RAN,0,0,NAME)
0158 FOR I=3 TO 5;RPT(I)=INSERT(RPT(I),RAN,0,0,'');NEXT I            |  *T25142 v
0159                                                                 >  *     FOR I=3 TO 5;RPT(I)=INSERT(RPT(I),RAN,0,0,'');NEXT I
0160                                                                 >  FOR I=3 TO 6;RPT(I)=INSERT(RPT(I),RAN,0,0,'');NEXT I
0161                                                                 >  *T25142 ^
0162 END                                                                END

0162 END                                                                END
0163 *-------------------------------------------------------------     *-----------------------------------------------------------
0164 RPT(3)<RAN,-1>=CLS                                                 RPT(3)<RAN,-1>=CLS
0165 RPT(4)<RAN,-1>=RATE                                                RPT(4)<RAN,-1>=RATE
0166 RPT(5)<RAN,-1>=NEW.RATE                                            RPT(5)<RAN,-1>=NEW.RATE
0167                                                                 >  RPT(6)<RAN,-1>=DTE ; *T25142
0168 RETURN                                                             RETURN
0169 *-------------------------------------------------------------     *-----------------------------------------------------------
0170 3000  * PRINT REPORT                                               3000  * PRINT REPORT
0171 *-------------------------------------------------------------     *-----------------------------------------------------------

0172 HEAD=STR(' ',36-(LEN(HEAD)/2)):HEAD:"'L'"                          HEAD=STR(' ',36-(LEN(HEAD)/2)):HEAD:"'L'"
0173 HEAD=HEAD:OCONV(DATE(),'D2/')'L#20'                                HEAD=HEAD:OCONV(DATE(),'D2/')'L#20'
0174 HEAD=HEAD:'EMPLOYEE JOB CLASS RATE CHANGES':STR(' ',9)             HEAD=HEAD:'EMPLOYEE JOB CLASS RATE CHANGES':STR(' ',9)
0175 HEAD=HEAD:"PAGE#'PPLL'"                                            HEAD=HEAD:"PAGE#'PPLL'"
0176 HEAD=HEAD:'Emp#.. Name.......................... Job.Class'        HEAD=HEAD:'Emp#.. Name.......................... Job.Class'
0177 HEAD=HEAD:' ..Old.Rate ..New.Rate':"'L'"                        |  *T25142 v
0178                                                                 >  *  HEAD=HEAD:' ..Old.Rate ..New.Rate':"'L'"
0179                                                                 >  HEAD=HEAD:' ..Old.Rate ..New.Rate Eff.Date':"'L'"
0180                                                                 >  *T25142 ^
0181 3010  *                                                            3010  *

0189 PRINT RPT(1)<AN>'R#6':' ':RPT(2)<AN>'L#30':' ':                    PRINT RPT(1)<AN>'R#6':' ':RPT(2)<AN>'L#30':' ':
0190 END ELSE                                                           END ELSE
0191 PRINT STR(' ',38):                                                 PRINT STR(' ',38):
0192 END                                                                END
0193 PRINT RPT(3)<AN,VN>'L#9':' ':OCONV(RPT(4)<AN,VN>,'MD4')'R#10':     PRINT RPT(3)<AN,VN>'L#9':' ':OCONV(RPT(4)<AN,VN>,'MD4')'R#10
0194 PRINT ' ':OCONV(RPT(5)<AN,VN>,'MD4')'R#10'                      |  PRINT ' ':OCONV(RPT(5)<AN,VN>,'MD4')'R#10':
0195                                                                 >  *T25142 v
0196                                                                 >  PRINT ' ':OCONV(RPT(6)<AN,VN>,'D2/')'L#8'
0197                                                                 >  *T25142 ^
0198 NEXT VN                                                            NEXT VN


EPSBP/PAY.BATCH.2                                                  /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/PAY.BATCH.2
Printed for thompson at 06/28/2006 04:23:39PM

0014 *T21805 lanny 04/15/1997 * Paying terminated employees holiday     *T21805 lanny 04/15/1997 * Paying terminated employees holid
0015 *                          not eligible.                           *                          not eligible.
0016 *T23966 cm 06/03/1999 * When a batch is re-opened any other in     *T23966 cm 06/03/1999 * When a batch is re-opened any other 
0017 *                       was entered in the Employee Payroll In     *                       was entered in the Employee Payroll 
0018 *                       is deleted                                 *                       is deleted
0019                                                                 >  *T25142 cm 06/29/2000 * Check employee rate and update when 
0020 *******************************************************            *******************************************************
0021 *                                                                  *
0022 *                                                                  *
0023 *COPY>CPYLIB>COM1                                                  *COPY>CPYLIB>COM1

0073 MATREAD BDT.REC FROM BATCH.DETAIL,CONO:BATCH ELSE                  MATREAD BDT.REC FROM BATCH.DETAIL,CONO:BATCH ELSE
0074 NO.DETAIL = 'Y'                                                    NO.DETAIL = 'Y'
0075 END                                                                END
0076 100*                                                               100*
0077 READNEXT KEY ELSE GO 900                                           READNEXT KEY ELSE GO 900
0078 MATREAD EMP.REC FROM EMPLOYEE,KEY ELSE                          |  *C45193 MATREAD EMP.REC FROM EMPLOYEE,KEY ELSE
0079                                                                 >  MATREADU EMP.REC FROM EMPLOYEE,KEY ELSE
0080 ERRMSG = "CANNOT READ EMPLOYEE MASTER RECORD FOR EMP.NO ":KEY[     ERRMSG = "CANNOT READ EMPLOYEE MASTER RECORD FOR EMP.NO ":KE
0081 MATREADU BHD.REC FROM BATCH.HEADER,CONO:BATCH ELSE GO 90000        MATREADU BHD.REC FROM BATCH.HEADER,CONO:BATCH ELSE GO 90000
0082 BHD.STATUS = ''                                                    BHD.STATUS = ''

0105 *********IF HOLIDAY PAY BESURE EMPLOYEE IS ELIGIBLE                *********IF HOLIDAY PAY BESURE EMPLOYEE IS ELIGIBLE
0106 IF BDT.TYPE<1,X> = EPSC.HOL THEN                                   IF BDT.TYPE<1,X> = EPSC.HOL THEN
0107 IF BDT.DATE<1,X> < EMP.HOL.DATE THEN GO 190                        IF BDT.DATE<1,X> < EMP.HOL.DATE THEN GO 190
0108 END                                                                END
0109 *********IS THIS EMPLOYEE ELIGIBLE FOR PAY ON THIS DATE            *********IS THIS EMPLOYEE ELIGIBLE FOR PAY ON THIS DATE
0110                                                                 >  *T25142 v
0111                                                                 >  CALL CHECK.RATE.CHANGE.SUB(MAT EMP.REC,KEY,BDT.DATE<1,X>,EMP
0112                                                                 >  *T25142 ^
0113 BEGIN CASE                                                         BEGIN CASE
0114 CASE EMP.TERM.DATE # '' AND EMP.REHR.DATE # ''                     CASE EMP.TERM.DATE # '' AND EMP.REHR.DATE # ''

0210 CASE EMP.TERM.DATE # '' AND EMP.REHR.DATE > BHD.END.DATE           CASE EMP.TERM.DATE # '' AND EMP.REHR.DATE > BHD.END.DATE
0211 GO 100                                                             GO 100
0212 END CASE                                                           END CASE
0213 END                                                                END
0214 MATWRITE DHC.REC ON DLY.HRS.CONTROL,KEY                            MATWRITE DHC.REC ON DLY.HRS.CONTROL,KEY
0215                                                                 >  RELEASE EMPLOYEE,KEY ;*C45193
0216 GO 100                                                             GO 100
0217 *                                                                  *
0218 900*                                                               900*
0219 MATREAD BHD.REC FROM BATCH.HEADER,CONO:BATCH ELSE                  MATREAD BHD.REC FROM BATCH.HEADER,CONO:BATCH ELSE


EPSBP/PAY.CONTROL.MAINT                                            /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/PAY.CONTROL.MAINT
Printed for thompson at 06/28/2006 04:23:39PM

0007 * PROGRAM       - PAY.CONTROL.MAINT                                * PROGRAM       - PAY.CONTROL.MAINT
0008 * BY            - Greg Gardner                                     * BY            - Greg Gardner
0009 * DATE          - 12/22/89                                         * DATE          - 12/22/89
0010 * DESCRIPTION   - To allow input into the PAY.CONTROL file to      * DESCRIPTION   - To allow input into the PAY.CONTROL file t
0011 *                 define specific earnings type codes.             *                 define specific earnings type codes.
0012                                                                 >  *T28078 cmykleb 09/13/2004 * Allow more than 12 attendance c
0013                                                                 >  *                            entered on this screen.  To do 
0014                                                                 >  *                            and program had to be totally r
0015 **************************************************************     ************************************************************
0016 *                                                                  *

0020 *COPY>CPYLIB>EDIT.COM                                              *COPY>CPYLIB>EDIT.COM
0021 *COPY>CPYLIB>EDIT.COM.DRIVER                                       *COPY>CPYLIB>EDIT.COM.DRIVER
0022 *COPY>PRS.CPYLIB>PAY.CONTROL                                       *COPY>PRS.CPYLIB>PAY.CONTROL
0023 *COPY>PRS.CPYLIB>ATTEND.CODE                                       *COPY>PRS.CPYLIB>ATTEND.CODE
0024 *                                                                  *
0025 DIM CNT(12)                                                     <  
0026 *                                                                  *
0027 *----- OPEN FILES                                                  *----- OPEN FILES
0028 *                                                                  *
0029 OPEN "","CONTROL" TO CONTROL ELSE ERRMSG = "CONTROL FILE MISSI     OPEN "","CONTROL" TO CONTROL ELSE ERRMSG = "CONTROL FILE MIS

0030 OPEN "","ATTEND.CODE" TO ATTEND.CODE ELSE ERRMSG = "ATTEND.COD     OPEN "","ATTEND.CODE" TO ATTEND.CODE ELSE ERRMSG = "ATTEND.C
0031 OPEN "","PRS.SCREENS" TO SECOND.SCREENS ELSE ERRMSG = "PRS.SCR  |  OPEN "","CBN.SCREENS" TO CBN.SCREENS ELSE ERRMSG = "CBN.SCRE
0032 *                                                                  *
0033 *----- INITIALIZATION                                              *----- INITIALIZATION
0034 *                                                                  *
0035 PROCREAD BUF ELSE ERRMSG = "Cannot read PROC from program PAY.     PROCREAD BUF ELSE ERRMSG = "Cannot read PROC from program PA
0036 CONO = BUF<1>                                                      CONO = BUF<1>
0037 *                                                                  *

0038 MAT EDIT.COM.DRIVER = ""                                           MAT EDIT.COM.DRIVER = ""
0039 MAT CNT = ""                                                    |  PAGE.SIZE = 16
0040 TCNT = 0                                                        |  BEGIN.PAGE = 4
0041                                                                 >  LINE.SPACE = 1
0042                                                                 >  OLD.START.LINE = 0
0043 *                                                                  *
0044 *----- PRINT SCREEN                                                *----- PRINT SCREEN
0045 *                                                                  *

0046 ECD.SCRN.CNT = 1                                                   ECD.SCRN.CNT = 1
0047 ECD.SCRN.NAME<1> = "PAY.CONTROL.MAINT"                             ECD.SCRN.NAME<1> = "PAY.CONTROL.MAINT"
0048 ECD.SCRN.FLAG<1> = 2                                            <  
0049 ECD.ACTION = 1; CALL SCRN.EDIT                                     ECD.ACTION = 1; CALL SCRN.EDIT
0050 ECD.SCRN.NO = 1                                                    ECD.SCRN.NO = 1
0051 MAT SCV.REC = ""                                                   MAT SCV.REC = ""
0052 ECD.ACTION = 2; CALL SCRN.EDIT                                     ECD.ACTION = 2; CALL SCRN.EDIT
0053 *                                                                  *
0054 *----- MAIN PROCESSING                                             *----- MAIN PROCESSING

0055 *                                                                  *
0056 100*                                                               100*
0057 MAT CNT = ""                                                    |  *  MAT CNT = ""
0058 NEW.EPSC.REC = 0                                                |  *  NEW.EPSC.REC = 0
0059 MATREAD EPSC.REC FROM CONTROL, CONO: "PAY.CONTROL" ELSE         |  *  MATREAD EPSC.REC FROM CONTROL, CONO: "PAY.CONTROL" ELSE
0060 MAT EPSC.REC = ""                                               |  *     MAT EPSC.REC = ""
0061 NEW.EPSC.REC = 1                                                |  *     NEW.EPSC.REC = 1
0062 END                                                             |  *  END
0063                                                                 >  READ CBN.DATA FROM CONTROL, CONO:'CBN.PAY.CONTROL' ELSE CBN.

0064                                                                 >  LINES = DCOUNT(CBN.DATA<1>,VM)
0065                                                                 >  LN = 1
0066                                                                 >  GOSUB 80000
0067 *                                                                  *
0068 IF NEW.EPSC.REC THEN                                            |  *--- ENTER OPTIONS
0069 FOR OPTION = 1 TO 12 WHILE ECD.RET.VALUE # "END"                <  
0070 ON OPTION GOSUB 1100,1200,1300,1400,1500,1600,1700,1800,1900,1  <  

0071 NEXT OPTION                                                     <  
0072 IF ECD.RET.VALUE = "END" THEN                                   <  
0073 GO 99999                                                        <  
0074 END                                                             <  
0075 FOR I = 1 TO 12                                                 <  
0076 TCNT = TCNT + CNT(I)                                            <  
0077 NEXT I                                                          <  

0078 IF TCNT < 12 THEN                                               <  
0079 ERRMSG = "WARNING! Not all types have been defined."            <  
0080 GOSUB 91000                                                     <  
0081 END                                                             <  
0082 END ELSE                                                        <  
0083 GOSUB 3000                                                      <  
0084 END                                                             <  

0085 *                                                                  *
0086                                                                 >  500 *
0087 MORE = 1                                                           MORE = 1
0088 LOOP                                                               LOOP
0089 ECD.NUM = 15                                                    |  ECD.NUM = 6
0090 ECD.ACTION = 4; CALL SCRN.EDIT                                  |  SCV.REC(ECD.NUM)<1> = ''
0091                                                                 >  ECD.ACTION=4;CALL SCRN.EDIT
0092 OPTION = ECD.RET.VALUE                                             OPTION = ECD.RET.VALUE

0093 BEGIN CASE                                                         BEGIN CASE
0094 CASE OPTION = "E" OR OPTION = "END"                             |  CASE OPTION = 'E' OR OPTION = 'END'
0095 GOTO 99999                                                         GOTO 99999
0096 CASE OPTION = "F"                                               |  CASE OPTION = "C"
0097 MATWRITE EPSC.REC ON CONTROL, CONO: "PAY.CONTROL"               |  GOSUB 70000
0098 GOTO 99999                                                      |  IF LN.NO THEN
0099 CASE NOT(NUM(OPTION))                                           |  SLN = BEGIN.PAGE + LINE.SPACE * MOD(LN-1,PAGE.SIZE)
0100 CASE OPTION < 1 OR OPTION > 12                                  |  GOSUB 10000

0101 CASE 1                                                          |  END
0102 ON OPTION GOSUB 1100,1200,1300,1400,1500,1600,1700,1800,1900,1  |  CASE OPTION = "S"
0103                                                                 >  LN = 1 + INT((LN-1)/PAGE.SIZE) * PAGE.SIZE + PAGE.SIZE
0104                                                                 >  IF LN > LINES THEN LN = 1
0105                                                                 >  GOSUB 80000
0106                                                                 >  CASE OPTION = 'F'
0107                                                                 >  *           MATWRITE EPSC.REC ON CONTROL, CONO: "PAY.CONTROL

0106                                                                 >  CASE OPTION = 'F'
0107                                                                 >  *           MATWRITE EPSC.REC ON CONTROL, CONO: "PAY.CONTROL
0108 END CASE                                                           END CASE
0109 WHILE MORE DO REPEAT                                               WHILE MORE DO REPEAT
0110 *                                                                  *
0111 ECD.ACTION = 6; CALL SCRN.EDIT                                  <  
0112 MAT EPSC.REC = ""                                               <  
0113 GOTO 100                                                        <  
0114 *                                                               <  
0115 1100*                                                           <  

0116 ECD.NUM = 1                                                     <  
0117 IF EPSC.REG # '' THEN SCV.REC(ECD.NUM) = EPSC.REG               <  
0118 GOSUB 74000                                                     <  
0119 TRY.AGAIN = 0                                                   <  
0120 IF ECD.RET.VALUE # "END" THEN                                   <  
0121 CNT(1) = 1                                                      <  
0122 GOSUB 10000                                                     <  

0123 IF TRY.AGAIN THEN GO 1100                                       <  
0124 GOSUB 20000                                                     <  
0125 IF TRY.AGAIN THEN GO 1100                                       <  
0126 ECD.NUM = 31                                                    <  
0127 GOSUB 75000                                                     <  
0128 EPSC.REG = ETYPE                                                <  
0129 END                                                             <  

0130 RETURN                                                          <  
0131 *                                                               <  
0132 1200*                                                           <  
0133 ECD.NUM = 2                                                     <  
0134 IF EPSC.REG.OVT # '' THEN SCV.REC(ECD.NUM) = EPSC.REG.OVT       <  
0135 GOSUB 74000                                                     <  
0136 TRY.AGAIN = 0                                                   <  

0137 IF ECD.RET.VALUE # "END" THEN                                   <  
0138 CNT(2) = 1                                                      <  
0139 GOSUB 10000                                                     <  
0140 IF TRY.AGAIN THEN GO 1200                                       <  
0141 GOSUB 20000                                                     <  
0142 IF TRY.AGAIN THEN GO 1200                                       <  
0143 ECD.NUM = 32                                                    <  

0144 GOSUB 75000                                                     <  
0145 EPSC.REG.OVT = ETYPE                                            <  
0146 END                                                             <  
0147 RETURN                                                          <  
0148 *                                                               <  
0149 1300*                                                           <  
0150 ECD.NUM = 3                                                     <  

0151 IF EPSC.REG.DBT # '' THEN SCV.REC(ECD.NUM) = EPSC.REG.DBT       <  
0152 GOSUB 74000                                                     <  
0153 TRY.AGAIN = 0                                                   <  
0154 IF ECD.RET.VALUE # "END" THEN                                   <  
0155 CNT(3) = 1                                                      <  
0156 GOSUB 10000                                                     <  
0157 IF TRY.AGAIN THEN GO 1300                                       <  

0158 GOSUB 20000                                                     <  
0159 IF TRY.AGAIN THEN GO 1300                                       <  
0160 ECD.NUM = 33                                                    <  
0161 GOSUB 75000                                                     <  
0162 EPSC.REG.DBT = ETYPE                                            <  
0163 END                                                             <  
0164 RETURN                                                          <  

0165 *                                                               <  
0166 1400*                                                           <  
0167 ECD.NUM = 4                                                     <  
0168 IF EPSC.REG.TRP # '' THEN SCV.REC(ECD.NUM) = EPSC.REG.TRP       <  
0169 GOSUB 74000                                                     <  
0170 TRY.AGAIN = 0                                                   <  
0171 IF ECD.RET.VALUE # "END" THEN                                   <  

0172 CNT(4) = 1                                                      <  
0173 GOSUB 10000                                                     <  
0174 IF TRY.AGAIN THEN GO 1400                                       <  
0175 GOSUB 20000                                                     <  
0176 IF TRY.AGAIN THEN GO 1400                                       <  
0177 ECD.NUM = 34                                                    <  
0178 GOSUB 75000                                                     <  

0179 EPSC.REG.TRP = ETYPE                                            <  
0180 END                                                             <  
0181 RETURN                                                          <  
0182 *                                                               <  
0183 1500*                                                           <  
0184 ECD.NUM = 5                                                     <  
0185 IF EPSC.NC.REG # '' THEN SCV.REC(ECD.NUM) = EPSC.NC.REG         <  

0186 GOSUB 74000                                                     <  
0187 TRY.AGAIN = 0                                                   <  
0188 IF ECD.RET.VALUE # "END" THEN                                   <  
0189 CNT(5) = 1                                                      <  
0190 GOSUB 10000                                                     <  
0191 IF TRY.AGAIN THEN GO 1500                                       <  
0192 GOSUB 20000                                                     <  

0193 IF TRY.AGAIN THEN GO 1500                                       <  
0194 ECD.NUM = 35                                                    <  
0195 GOSUB 75000                                                     <  
0196 EPSC.NC.REG = ETYPE                                             <  
0197 END                                                             <  
0198 RETURN                                                          <  
0199 *                                                               <  

0200 1600*                                                           <  
0201 ECD.NUM = 6                                                     <  
0202 IF EPSC.NC.OVT # '' THEN SCV.REC(ECD.NUM) = EPSC.NC.OVT         <  
0203 GOSUB 74000                                                     <  
0204 TRY.AGAIN = 0                                                   <  
0205 IF ECD.RET.VALUE # "END" THEN                                   <  
0206 CNT(6) = 1                                                      <  

0207 GOSUB 10000                                                     <  
0208 IF TRY.AGAIN THEN GO 1600                                       <  
0209 GOSUB 20000                                                     <  
0210 IF TRY.AGAIN THEN GO 1600                                       <  
0211 ECD.NUM = 36                                                    <  
0212 GOSUB 75000                                                     <  
0213 EPSC.NC.OVT = ETYPE                                             <  

0214 END                                                             <  
0215 RETURN                                                          <  
0216 *                                                               <  
0217 1700*                                                           <  
0218 ECD.NUM = 7                                                     <  
0219 IF EPSC.NC.DBT # '' THEN SCV.REC(ECD.NUM) = EPSC.NC.DBT         <  
0220 GOSUB 74000                                                     <  

0221 TRY.AGAIN = 0                                                   <  
0222 IF ECD.RET.VALUE # "END" THEN                                   <  
0223 CNT(7) = 1                                                      <  
0224 GOSUB 10000                                                     <  
0225 IF TRY.AGAIN THEN GO 1700                                       <  
0226 GOSUB 20000                                                     <  
0227 IF TRY.AGAIN THEN GO 1700                                       <  

0228 ECD.NUM = 37                                                    <  
0229 GOSUB 75000                                                     <  
0230 EPSC.NC.DBT = ETYPE                                             <  
0231 END                                                             <  
0232 RETURN                                                          <  
0233 *                                                               <  
0234 1800*                                                           <  

0235 ECD.NUM = 8                                                     <  
0236 IF EPSC.NC.TRP # '' THEN SCV.REC(ECD.NUM) = EPSC.NC.TRP         <  
0237 GOSUB 74000                                                     <  
0238 TRY.AGAIN = 0                                                   <  
0239 IF ECD.RET.VALUE # "END" THEN                                   <  
0240 CNT(8) = 1                                                      <  
0241 GOSUB 10000                                                     <  

0242 IF TRY.AGAIN THEN GO 1800                                       <  
0243 GOSUB 20000                                                     <  
0244 IF TRY.AGAIN THEN GO 1800                                       <  
0245 ECD.NUM = 38                                                    <  
0246 GOSUB 75000                                                     <  
0247 EPSC.NC.TRP = ETYPE                                             <  
0248 END                                                             <  

0249 RETURN                                                          <  
0250 *                                                               <  
0251 1900*                                                           <  
0252 ECD.NUM = 9                                                     <  
0253 IF EPSC.CBACK # '' THEN SCV.REC(ECD.NUM) = EPSC.CBACK           <  
0254 GOSUB 74000                                                     <  
0255 TRY.AGAIN = 0                                                   <  

0256 IF ECD.RET.VALUE # "END" THEN                                   <  
0257 CNT(9) = 1                                                      <  
0258 GOSUB 10000                                                     <  
0259 IF TRY.AGAIN THEN GO 1900                                       <  
0260 GOSUB 20000                                                     <  
0261 IF TRY.AGAIN THEN GO 1900                                       <  
0262 ECD.NUM = 39                                                    <  

0263 GOSUB 75000                                                     <  
0264 EPSC.CBACK = ETYPE                                              <  
0265 END                                                             <  
0266 RETURN                                                          <  
0267 *                                                               <  
0268 11000*                                                          <  
0269 ECD.NUM = 10                                                    <  

0270 IF EPSC.SICK # '' THEN SCV.REC(ECD.NUM) = EPSC.SICK             <  
0271 GOSUB 74000                                                     <  
0272 TRY.AGAIN = 0                                                   <  
0273 IF ECD.RET.VALUE # "END" THEN                                   <  
0274 CNT(10) = 1                                                     <  
0275 GOSUB 10000                                                     <  
0276 IF TRY.AGAIN THEN GO 11000                                      <  

0277 GOSUB 20000                                                     <  
0278 IF TRY.AGAIN THEN GO 11000                                      <  
0279 ECD.NUM = 40                                                    <  
0280 GOSUB 75000                                                     <  
0281 EPSC.SICK = ETYPE                                               <  
0282 END                                                             <  
0283 RETURN                                                          <  

0284 *                                                               <  
0285 11100*                                                          <  
0286 ECD.NUM = 11                                                    <  
0287 IF EPSC.HOL # '' THEN SCV.REC(ECD.NUM) = EPSC.HOL               <  
0288 GOSUB 74000                                                     <  
0289 TRY.AGAIN = 0                                                   <  
0290 IF ECD.RET.VALUE # "END" THEN                                   <  

0291 CNT(11) = 1                                                     <  
0292 GOSUB 10000                                                     <  
0293 IF TRY.AGAIN THEN GO 11100                                      <  
0294 GOSUB 20000                                                     <  
0295 IF TRY.AGAIN THEN GO 11100                                      <  
0296 ECD.NUM = 41                                                    <  
0297 GOSUB 75000                                                     <  

0298 EPSC.HOL = ETYPE                                                <  
0299 END                                                             <  
0300 RETURN                                                          <  
0301 *                                                               <  
0302 11200*                                                          <  
0303 ECD.NUM = 12                                                    <  
0304 IF EPSC.VAC # '' THEN SCV.REC(ECD.NUM) = EPSC.VAC               <  

0305 GOSUB 74000                                                     <  
0306 TRY.AGAIN = 0                                                   <  
0307 IF ECD.RET.VALUE # "END" THEN                                   <  
0308 CNT(12) = 1                                                     <  
0309 GOSUB 10000                                                     <  
0310 IF TRY.AGAIN THEN GO 11200                                      <  
0311 GOSUB 20000                                                     <  

0312 IF TRY.AGAIN THEN GO 11200                                      <  
0313 ECD.NUM = 42                                                    <  
0314 GOSUB 75000                                                     <  
0315 EPSC.VAC = ETYPE                                                <  
0316 END                                                             <  
0317 RETURN                                                          <  
0318 *                                                               <  

0319 3000*                                                           <  
0320 SCV.REC(1) = EPSC.REG                                           <  
0321 SCV.REC(2) = EPSC.REG.OVT                                       <  
0322 SCV.REC(3) = EPSC.REG.DBT                                       <  
0323 SCV.REC(4) = EPSC.REG.TRP                                       <  
0324 SCV.REC(5) = EPSC.NC.REG                                        <  
0325 SCV.REC(6) = EPSC.NC.OVT                                        <  

0326 SCV.REC(7) = EPSC.NC.DBT                                        <  
0327 SCV.REC(8) = EPSC.NC.TRP                                        <  
0328 SCV.REC(9) = EPSC.CBACK                                         <  
0329 SCV.REC(10) = EPSC.SICK                                         <  
0330 SCV.REC(11) = EPSC.HOL                                          <  
0331 SCV.REC(12) = EPSC.VAC                                          <  
0332 FOR I = 1 TO 12                                                 <  

0333 MATREAD ATT.REC FROM ATTEND.CODE, CONO: SCV.REC(I) ELSE         <  
0334 ERRMSG = "Cannot load type ":SCV.REC(I):" description for disp  <  
0335 GOSUB 91000                                                     <  
0336 GOTO 100                                                        <  
0337 END                                                             <  
0338 SCV.REC(I+30) = ATT.DESC                                        <  
0339 NEXT I                                                          <  

0340 *                                                               <  
0341 ECD.ACTION = 3; CALL SCRN.EDIT                                     ECD.ACTION = 3; CALL SCRN.EDIT
0342 RETURN                                                             RETURN
0343 *                                                                  *
0344 10000*                                                             10000*
0345 MATREAD ATT.REC FROM ATTEND.CODE, CONO: ETYPE ELSE              |  X = 5; Y = SLN; TYP = 3; MAXL = 3; O.R = "O"
0346                                                                 >  CALL EDIT.SUB

0347                                                                 >  BEGIN CASE
0348                                                                 >  CASE 1
0349                                                                 >  MATREAD ATT.REC FROM ATTEND.CODE, CONO: VALUE ELSE
0350 ERRMSG = "Invalid type.  Please try again."                        ERRMSG = "Invalid type.  Please try again."
0351 GOSUB 91000                                                        GOSUB 91000
0352 TRY.AGAIN = 1                                                   |  GOTO 10000
0353 END                                                                END

0354                                                                 >  P_X = 11 ; P_Y = SSLN ; P_VALUE = ATT.DESC"L#30" ; P_OPT = "
0355                                                                 >  CALL VSI_PLINE(P_X,P_Y,P_VALUE,P_OPT)
0356                                                                 >  P_X = 43 ; P_Y = SSLN ; P_VALUE = ATT.EARN.TYPE"L#30" ; P_OP
0357                                                                 >  CALL VSI_PLINE(P_X,P_Y,P_VALUE,P_OPT)
0358                                                                 >  END CASE
0359 RETURN                                                             RETURN
0360 *                                                               |  70000 *

0361 20000*                                                          |  GOSUB 80000
0362 FOR X = 1 TO 12                                                 |  ECD.NUM = 7 ; SCV.REC(ECD.NUM)<1> = ''
0363 IF X # ECD.NUM THEN                                             |  ECD.MINV = OLD.START.LINE; ECD.MAXV = LAST.LINE
0364 IF ETYPE = SCV.REC(X) THEN                                      |  ECD.ACTION=4;CALL SCRN.EDIT
0365 ERRMSG = "Duplicate attendance code used.  Please try again."   |  LN.NO = ECD.RET.VALUE
0366 GOSUB 91000                                                     |  BEGIN CASE
0367 SCV.REC(ECD.NUM) = ''                                           |  CASE LN.NO = '' OR LN.NO = 'END'

0368 TRY.AGAIN = 1                                                   |  LN.NO = 0
0369                                                                 >  CASE 1
0370                                                                 >  END CASE
0371                                                                 >  RETURN
0372                                                                 >  80000 *
0373                                                                 >  START.LINE = 1 + INT((LN-1)/PAGE.SIZE) * PAGE.SIZE
0374                                                                 >  LAST.LINE = START.LINE + PAGE.SIZE - 1

0375                                                                 >  IF LAST.LINE > LINES THEN LAST.LINE = LINES
0376                                                                 >  IF START.LINE = OLD.START.LINE THEN RETURN
0377                                                                 >  OLD.START.LINE = START.LINE
0378                                                                 >  CNT = 1
0379                                                                 >  FOR N = START.LINE TO LAST.LINE
0380                                                                 >  ATT.CODE = CBN.DATA<1,N>
0381                                                                 >  MATREAD ATT.REC FROM ATTEND.CODE, CONO:ATT.CODE ELSE

0382                                                                 >  MAT ATT.REC = ''
0383 END                                                                END
0384 END                                                             |  SSLN = BEGIN.PAGE + LINE.SPACE * MOD(N-1,PAGE.SIZE)
0385 NEXT X                                                          |  P_X  = 0 ; P_Y = SSLN ; P_VALUE = N "R#2" ; P_OPT = "CL"
0386 IF TRY.AGAIN = 1 THEN RETURN                                    |  P_X := AM:6 ; P_Y := AM:SSLN ; P_VALUE := AM:ATT.CODE"L#3"
0387 IF ECD.NUM < 10 AND ETYPE > 99 THEN                             |  P_X := AM:11 ; P_Y := AM:SSLN ; P_VALUE := AM:ATT.DESC"L#30"
0388 ERRMSG = "The code is not in the acceptable range for a workin  |  P_X := AM:43 ; P_Y := AM:SSLN ; P_VALUE := AM:ATT.EARN.TYPE"

0389 GOSUB 91000                                                     |  CALL VSI_PLINE(P_X,P_Y,P_VALUE,P_OPT)
0390 TRY.AGAIN = 1                                                   |  CNT += 1
0391 SCV.REC(ECD.NUM) = ''                                           |  NEXT N
0392 END                                                             |  FOR N = CNT TO PAGE.SIZE
0393 IF ECD.NUM > 9 AND ETYPE < 100 THEN                             |  SSLN = BEGIN.PAGE + LINE.SPACE * MOD(N-1,PAGE.SIZE)
0394 ERRMSG = "The code is not in the acceptable range for a non-wo  |  P_X  = 0 ; P_Y = SSLN ; P_VALUE = "" ; P_OPT = "CL"
0395 GOSUB 91000                                                     |  NEXT N

0396 TRY.AGAIN = 1                                                   <  
0397 SCV.REC(ECD.NUM) = ''                                           <  
0398 END                                                             <  
0399 RETURN                                                             RETURN
0400 *                                                               <  
0401 74000*                                                          <  
0402 ECD.ACTION = 4; CALL SCRN.EDIT                                  <  

0403 IF ECD.RET.VALUE # "END" THEN ETYPE = ECD.RET.VALUE             <  
0404 RETURN                                                          <  
0405 *                                                               <  
0406 75000*                                                          <  
0407 SCV.REC(ECD.NUM) = ATT.DESC                                     <  
0408 ECD.ACTION = 5; CALL SCRN.EDIT                                  <  
0409 RETURN                                                          <  

0410 *                                                               <  
0411 91000*                                                             91000*
0412 PRINT @(0,23) : ERRMSG : CL :                                      PRINT @(0,23) : ERRMSG : CL :
0413 INPUT XX :                                                         INPUT XX :
0414 PRINT @(0,23) : CL :                                               PRINT @(0,23) : CL :
0415 RETURN                                                             RETURN
0416 93000*                                                             93000*

0417 PRINT @(0,23) : ERRMSG : CL :                                      PRINT @(0,23) : ERRMSG : CL :
0418 INPUT XX :                                                         INPUT XX :
0419 PRINT @(0,23) : CL :                                               PRINT @(0,23) : CL :
0420 99999*                                                             99999*
0421 END                                                                END
0422                                                                 <  
0423 


EPSBP/POST.ATTEND                                                  /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/POST.ATTEND
Printed for thompson at 06/28/2006 04:23:39PM

0009 *               RECORDS WITH STATUS = 3.  AFTER THE RECORDS AR     *               RECORDS WITH STATUS = 3.  AFTER THE RECORDS 
0010 *               THE RECORD STATUS IS UPDATED TO 4 AND THE RECO     *               THE RECORD STATUS IS UPDATED TO 4 AND THE RE
0011 *               THEN CLEARED WITH THE NEXT PAYROLL CYCLE PROCE     *               THEN CLEARED WITH THE NEXT PAYROLL CYCLE PRO
0012 *               TIME AND RATE CALCULATION.                         *               TIME AND RATE CALCULATION.
0013 *                                                                  *
0014                                                                 >  *T24551 cm 01/25/2000 Delete WORK.CALC record once it posts 
0015                                                                 >  *                     History.
0016                                                                 >  *ENDDOC
0017 **************************************************************     ************************************************************
0018 *                                                                  *

0182 AWH.Y.SHFT = AWH.Y.SHFT + 1                                        AWH.Y.SHFT = AWH.Y.SHFT + 1
0183 AWH.T.SHFT = AWH.T.SHFT + 1                                        AWH.T.SHFT = AWH.T.SHFT + 1
0184 END                                                                END
0185 END                                                                END
0186 WKC.STATUS = 4                                                     WKC.STATUS = 4
0187 MATWRITE WKC.REC ON WORK.CALC,ID                                |  *T24551 v
0188                                                                 >  *  MATWRITE WKC.REC ON WORK.CALC,ID
0189                                                                 >  DELETE WORK.CALC,ID
0190                                                                 >  *T24551 ^
0191 GO 100                                                             GO 100


EPSBP/SPEC.PAY.INPUT                                               /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/SPEC.PAY.INPUT
Printed for thompson at 06/28/2006 04:23:39PM

0006 * PROGRAM     - SPEC.PAY.INPUT                                     * PROGRAM     - SPEC.PAY.INPUT
0007 * BY          - SARA CRISMON                                       * BY          - SARA CRISMON
0008 * DATE        - JANUARY 1990                                       * DATE        - JANUARY 1990
0009 * DESCRIPTION -                                                    * DESCRIPTION -
0010 *C32340 gat 12/30/1998* FIX PROBLEM ON LARGE BONUS CHEC            *C32340 gat 12/30/1998* FIX PROBLEM ON LARGE BONUS CHEC
0011                                                                 >  *T24102 markt 10/11/1999 * Expand the shift code to 2 digits
0012                                                                 >  *T25142 cm 06/29/2000 * Check for employee rate change and w
0013                                                                 >  *                       appropriate make change and update f
0014                                                                 >  *T25576 cm 01/05/2001 * Change vacation and sick hours to al
0015                                                                 >  *                       past the decimal.

0031 *COPY>CPYLIB>EDIT.COM.DRIVER                                       *COPY>CPYLIB>EDIT.COM.DRIVER
0032 *COPY>CPYLIB>FILE.VARS                                             *COPY>CPYLIB>FILE.VARS
0033 *COPY>CPYLIB>GEN.XREF                                              *COPY>CPYLIB>GEN.XREF
0034 *COPY>PRS.CPYLIB>PAYROLL.HOURS                                     *COPY>PRS.CPYLIB>PAYROLL.HOURS
0035 *COPY>CPYLIB>CHAR                                                  *COPY>CPYLIB>CHAR
0036                                                                 >  *COPY>CBN.CPYLIB>VACATION.TRANS               ; *T25576
0037 DIM OTH.INC.REC(5)                                                 DIM OTH.INC.REC(5)
0038 EQU OTH.INC.DESC TO OTH.INC.REC(1)                                 EQU OTH.INC.DESC TO OTH.INC.REC(1)
0039 DIM SAVE.PAYREG(55)                                                DIM SAVE.PAYREG(55)
0040 ERRMSG = ""                                                        ERRMSG = ""

0064 OPEN '','DEPARTMENT' TO DEPARTMENT ELSE ERRMSG = 'DEPARTMENT F     OPEN '','DEPARTMENT' TO DEPARTMENT ELSE ERRMSG = 'DEPARTMENT
0065 OPEN '','DIVISION' TO DIVISION ELSE ERRMSG = 'DIVISION FILE IS     OPEN '','DIVISION' TO DIVISION ELSE ERRMSG = 'DIVISION FILE 
0066 OPEN '','COST.CNTR' TO COST.CNTR ELSE ERRMSG = 'COST.CNTR FILE     OPEN '','COST.CNTR' TO COST.CNTR ELSE ERRMSG = 'COST.CNTR FI
0067 OPEN '','OTHER-INC' TO OTHER.INC ELSE ERRMSG = 'OTHER.INC FILE     OPEN '','OTHER-INC' TO OTHER.INC ELSE ERRMSG = 'OTHER.INC FI
0068 OPEN '','QTD-YTD' TO QTD.YTD ELSE ERRMSG = 'QTD-YTD FILE IS MI     OPEN '','QTD-YTD' TO QTD.YTD ELSE ERRMSG = 'QTD-YTD FILE IS 
0069 OPEN '','PRS.SCREENS' TO M.SCREENS ELSE ERRMSG = 'PRS.SCREENS   |  OPEN '','CBN.SCREENS' TO M.SCREENS ELSE ERRMSG = 'CBN.SCREEN
0070 OPEN '','PAYREG' TO PAYREG ELSE ERRMSG = 'PAYREG FILE IS MISSI     OPEN '','PAYREG' TO PAYREG ELSE ERRMSG = 'PAYREG FILE IS MIS
0071 OPEN '','DEDREG' TO DEDREG ELSE ERRMSG = 'DEDREG FILE IS MISSI     OPEN '','DEDREG' TO DEDREG ELSE ERRMSG = 'DEDREG FILE IS MIS
0072 OPEN '','PREFIX' TO PREFIX ELSE ERRMSG = 'PREFIX FILE IS MISSI     OPEN '','PREFIX' TO PREFIX ELSE ERRMSG = 'PREFIX FILE IS MIS
0073 OPEN '','BATCH.HEADER' TO BATCH.HEADER ELSE ERRMSG = 'BATCH.HE     OPEN '','BATCH.HEADER' TO BATCH.HEADER ELSE ERRMSG = 'BATCH.

0074                                                                 >  *T25576 v
0075                                                                 >  OPEN '','VACATION.TRANS' TO VACATION.TRANS ELSE ERRMSG = 'VA
0076                                                                 >  *T25576 ^
0077 IF CO.EMP.XREF = "Y" THEN                                          IF CO.EMP.XREF = "Y" THEN
0078 OPEN '','EMPLOYEE.XREF' TO EMPLOYEE.XREF ELSE ERRMSG = 'EMPLOY     OPEN '','EMPLOYEE.XREF' TO EMPLOYEE.XREF ELSE ERRMSG = 'EMPL
0079 END                                                                END
0080 UNKNOWN = "????????"                                               UNKNOWN = "????????"

0171 IF BHD.BEG.DIV > EMP.DIV THEN ERRMSG = "The employee's divisio     IF BHD.BEG.DIV > EMP.DIV THEN ERRMSG = "The employee's divis
0172 IF BHD.END.DIV < EMP.DIV THEN ERRMSG = "The employee's divisio     IF BHD.END.DIV < EMP.DIV THEN ERRMSG = "The employee's divis
0173 IF BHD.BEG.DEPT > EMP.DEPT THEN ERRMSG = "The employee's depar     IF BHD.BEG.DEPT > EMP.DEPT THEN ERRMSG = "The employee's dep
0174 IF BHD.END.DEPT < EMP.DEPT THEN ERRMSG = "The employee's depar     IF BHD.END.DEPT < EMP.DEPT THEN ERRMSG = "The employee's dep
0175 *                                                                  *
0176 35*                                                             |  *T25142 v
0177                                                                 >  CALL CHECK.RATE.CHANGE.SUB(MAT EMP.REC,CONO:EMP.NO,BHD.END.D
0178                                                                 >  *T25142 ^
0179 MATREAD QTD.REC FROM QTD.YTD, CONO:EMP.NO ELSE MAT QTD.REC = "     MATREAD QTD.REC FROM QTD.YTD, CONO:EMP.NO ELSE MAT QTD.REC =
0180 MATREAD DEPT.REC FROM DEPARTMENT, CONO:EMP.DEPT ELSE MAT DEPT.     MATREAD DEPT.REC FROM DEPARTMENT, CONO:EMP.DEPT ELSE MAT DEP

0181                                                                 >  *T25576 v
0182                                                                 >  *
0183                                                                 >  *--- GET CURRET VACATION BALANCE AND SICK BALANCE
0184                                                                 >  *
0185                                                                 >  TODAY = DATE()
0186                                                                 >  YEAR = OCONV(TODAY,'D2/')[7,2]
0187                                                                 >  VAC.BAL = '' ; SICK.BAL = EMP.MAX.SIC

0188                                                                 >  SETINDEX 'EMP.NO',CONO:EMP.NO ON VACATION.TRANS
0189                                                                 >  35 *
0190                                                                 >  READFWD TMP FROM VACATION.TRANS THEN
0191                                                                 >  EMP.ID = FIELD(@ID,'!',1)
0192                                                                 >  IF EMP.ID # CONO:EMP.NO THEN GOTO 36
0193                                                                 >  TRAN.DATE = FIELD(@ID,'!',2)
0194                                                                 >  TRAN.YR = OCONV(TRAN.DATE,'D2/')[7,2]

0195                                                                 >  IF TRAN.DATE GT TODAY THEN GOTO 36
0196                                                                 >  MATREAD VAC.TRANS.REC FROM VACATION.TRANS, @ID ELSE MAT VAC.
0197                                                                 >  VAC.BAL = VAC.BAL + (VT.VAC.EARN - VT.PAID.VAC)
0198                                                                 >  IF TRAN.YR = YEAR THEN
0199                                                                 >  SICK.BAL = SICK.BAL - VT.PAID.SICK
0200                                                                 >  END
0201                                                                 >  GOTO 35

0202                                                                 >  END
0203                                                                 >  36 *
0204                                                                 >  *T25576 ^
0205 ECD.NUM = 1; ECD.ACTION = 5; CALL SCRN.EDIT                        ECD.NUM = 1; ECD.ACTION = 5; CALL SCRN.EDIT
0206 SCV.REC(2)<1> = EMP.FRST.NAME :" ": EMP.LAST.NAME                  SCV.REC(2)<1> = EMP.FRST.NAME :" ": EMP.LAST.NAME
0207 ECD.NUM = 2; ECD.ACTION = 5; CALL SCRN.EDIT                        ECD.NUM = 2; ECD.ACTION = 5; CALL SCRN.EDIT
0208 SCV.REC(3)<1> = EMP.DEPT                                           SCV.REC(3)<1> = EMP.DEPT

0453 PAY.DIV<1,RECORD> = ECD.RET.VALUE                                  PAY.DIV<1,RECORD> = ECD.RET.VALUE
0454 ECD.NUM = 19; SCV.REC(19)<1> = DIV.DESC; ECD.ACTION = 5; CALL      ECD.NUM = 19; SCV.REC(19)<1> = DIV.DESC; ECD.ACTION = 5; CAL
0455 CASE ECD.RET.VALUE = ""                                            CASE ECD.RET.VALUE = ""
0456 MAT GEN.XREF.REC = ''                                              MAT GEN.XREF.REC = ''
0457 GXR.CO = CONO                                                      GXR.CO = CONO
0458 GXR.HEADING<1,2> = "DISCRIPTION"                                |  GXR.HEADING<1,2> = "DESCRIPTION"
0459 GXR.ATT<1,1> = 0                                                   GXR.ATT<1,1> = 0
0460 GXR.ATT<1,2> = 1                                                   GXR.ATT<1,2> = 1
0461 GXR.LEN<1,1> = 2                                                   GXR.LEN<1,1> = 2
0462 GXR.LEN<1,2> = 30                                                  GXR.LEN<1,2> = 30

0695 RETURN                                                             RETURN
0696 20000*                                                             20000*
0697 BEGIN CASE                                                         BEGIN CASE
0698 CASE HRS.QTD<1,SUB.NUM> = "VAC" AND PAY.EMP # ""                   CASE HRS.QTD<1,SUB.NUM> = "VAC" AND PAY.EMP # ""
0699 IF EMP.MAX.VAC = "" THEN EMP.MAX.VAC = 0                           IF EMP.MAX.VAC = "" THEN EMP.MAX.VAC = 0
0700 IF (ECD.RET.VALUE + SUM(QTD.VAC.HRS)) > (EMP.MAX.VAC * 100) AN  |  *T25576 v
0701                                                                 >  *        IF (ECD.RET.VALUE + SUM(QTD.VAC.HRS)) > (EMP.MAX.VA
0702                                                                 >  IF VAC.BAL - ECD.RET.VALUE LT 0 AND ECD.RET.VALUE GT 0 THEN
0703                                                                 >  *T25576 ^
0704 SAVE.HRS = ECD.RET.VALUE                                           SAVE.HRS = ECD.RET.VALUE

0705 EXC.HRS = OCONV((ECD.RET.VALUE + SUM(QTD.VAC.HRS) - (EMP.MAX.V  |  *T25576 v
0706                                                                 >  *           EXC.HRS = OCONV((ECD.RET.VALUE + SUM(QTD.VAC.HRS
0707                                                                 >  EXC.HRS = OCONV(ECD.RET.VALUE - VAC.BAL,'MD2')
0708                                                                 >  *T25576 ^
0709 ECD.PMSG = "VAC EXCEEDS MAX BY ":EXC.HRS:" ACCEPT (Y/N) :"         ECD.PMSG = "VAC EXCEEDS MAX BY ":EXC.HRS:" ACCEPT (Y/N) :"
0710 ECD.NUM = 31; ECD.ACTION = 4; CALL SCRN.EDIT                       ECD.NUM = 31; ECD.ACTION = 4; CALL SCRN.EDIT
0711 IF ECD.RET.VALUE # "Y" THEN                                        IF ECD.RET.VALUE # "Y" THEN

0713 END                                                                END
0714 ECD.RET.VALUE = SAVE.HRS                                           ECD.RET.VALUE = SAVE.HRS
0715 END                                                                END
0716 CASE HRS.QTD<1,SUB.NUM> = "SICK" AND PAY.EMP # ""                  CASE HRS.QTD<1,SUB.NUM> = "SICK" AND PAY.EMP # ""
0717 IF EMP.MAX.SIC = "" THEN EMP.MAX.SIC = 0                           IF EMP.MAX.SIC = "" THEN EMP.MAX.SIC = 0
0718 IF (ECD.RET.VALUE + SUM(QTD.SCK.HRS)) > (EMP.MAX.SIC * 100) AN  |  *T25576 v
0719                                                                 >  *        IF (ECD.RET.VALUE + SUM(QTD.SCK.HRS)) > (EMP.MAX.SI
0720                                                                 >  IF ECD.RET.VALUE + SICK.BAL GT EMP.MAX.SIC AND ECD.RET.VALUE
0721                                                                 >  *T25576 ^
0722 SAVE.HRS = ECD.RET.VALUE                                           SAVE.HRS = ECD.RET.VALUE

0723 EXC.HRS = OCONV((ECD.RET.VALUE + SUM(QTD.SCK.HRS) - (EMP.MAX.S  |  *T25576 v
0724                                                                 >  *           EXC.HRS = OCONV((ECD.RET.VALUE + SUM(QTD.SCK.HRS
0725                                                                 >  EXC.HRS = OCONV(ECD.RET.VALUE - SICK.BAL,'MD2')
0726                                                                 >  *T25576 ^
0727 ECD.PMSG = "SICK EXCEEDS MAX BY ":EXC.HRS:" ACCEPT (Y/N) :"        ECD.PMSG = "SICK EXCEEDS MAX BY ":EXC.HRS:" ACCEPT (Y/N) :"
0728 ECD.NUM = 31; ECD.ACTION = 4; CALL SCRN.EDIT                       ECD.NUM = 31; ECD.ACTION = 4; CALL SCRN.EDIT
0729 IF ECD.RET.VALUE # "Y" THEN                                        IF ECD.RET.VALUE # "Y" THEN


EPSBP/WORK.SHFT.LIST                                               /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/WORK.SHFT.LIST
Printed for thompson at 06/28/2006 04:23:40PM

0007 * BY          - Stefanie A. Newton                                 * BY          - Stefanie A. Newton
0008 * DESCRIPTION - This program produces a Work Shift Schedule Li     * DESCRIPTION - This program produces a Work Shift Schedule 
0009 * T22581 stefanie 02/20/1998 * Create Work Shift Schedule List     * T22581 stefanie 02/20/1998 * Create Work Shift Schedule Li
0010 *T22886 rik 05/11/1998 * WORK SHIFT DIFFERENTIAL AMOUNT PRINTI     *T22886 rik 05/11/1998 * WORK SHIFT DIFFERENTIAL AMOUNT PRIN
0011 *                        DECIMALS TO THE RIGHT TOO MANY.           *                        DECIMALS TO THE RIGHT TOO MANY.
0012                                                                 >  *T24102 markt 10/13/1999 * Expand the shift code to 2 digits
0013 *ENDDOC                                                            *ENDDOC
0014 **************************************************************     ************************************************************
0015 *                                                                  *
0016 *COPY>PMC.CPYLIB>COMPANY                                           *COPY>PMC.CPYLIB>COMPANY

0076 MATREAD UNN.REC FROM UNION, CONO:WSS.UNION.CDE ELSE UNN.DESC =     MATREAD UNN.REC FROM UNION, CONO:WSS.UNION.CDE ELSE UNN.DESC
0077 PRINT CLINE                                                        PRINT CLINE
0078 PRINT CDLINE                                                       PRINT CDLINE
0079 WSS.ID = FIELD(KEY,'!',2)                                          WSS.ID = FIELD(KEY,'!',2)
0080 PLINE = WSS.ID "L#8":SP:WSS.DESC "L#30":SP:WSS.UNION.CDE "L#3"     PLINE = WSS.ID "L#8":SP:WSS.DESC "L#30":SP:WSS.UNION.CDE "L#
0081 PLINE = PLINE:SPACE(3):WSS.SHIFT:SPACE(7):WSS.PAY.CYCLE:SPACE(  |  * T24102 v
0082                                                                 >  *      PLINE = PLINE:SPACE(3):WSS.SHIFT:SPACE(7):WSS.PAY.CYC
0083                                                                 >  PLINE = PLINE:SPACE(2):WSS.SHIFT"R#2":SPACE(7):WSS.PAY.CYCLE
0084                                                                 >  * T24102 ^
0085 PLINE = PLINE:SPACE(8):WSS.OVT.METH:SPACE(4):OCONV(WSS.OVTHR,'     PLINE = PLINE:SPACE(8):WSS.OVT.METH:SPACE(4):OCONV(WSS.OVTHR


EPSBP/WORK.SHFT.MAINT                                              /vsi/cust/rev11/cbn/CBA-CBN/CBNBP/WORK.SHFT.MAINT
Printed for thompson at 06/28/2006 04:23:40PM

0005 * PROGRAM        - WORK.SHFT.MAINT                                 * PROGRAM        - WORK.SHFT.MAINT
0006 * BY             - Scott Dickerson, PRISM Software Technologie     * BY             - Scott Dickerson, PRISM Software Technolog
0007 * DATE           - 11-13-89                                        * DATE           - 11-13-89
0008 * DESCRIIPTION   - WORK SHIFT SCHEDULE MAINTENANCE                 * DESCRIIPTION   - WORK SHIFT SCHEDULE MAINTENANCE
0009 * C25944 GAT 06/11/96 * FIX XREF ON WORK SHIFT                     * C25944 GAT 06/11/96 * FIX XREF ON WORK SHIFT
0010 *T25613 lanny 02/01/2001 * UNSCHED WORK DAYS ON 2ND SCREEN ONL  |  *T24102 markt 10/11/1999 * Expand the shift code to 2 digits
0011 *                          FOR SHFT TYPE 'S'                    <  
0012 *T25978 adelgado 02/05/2002 * Add the use of prompts (S,SR,SB,  <  
0013 *-------------------------------------------------------------     *-----------------------------------------------------------
0014 *COPY>CPYLIB>COM1                                                  *COPY>CPYLIB>COM1

0026 ERRMSG='CONTROL FILE MISSING';GO 9300                              ERRMSG='CONTROL FILE MISSING';GO 9300
0027 END                                                                END
0028 OPEN 'PRS.SCREENS' TO M.SCREENS ELSE                               OPEN 'PRS.SCREENS' TO M.SCREENS ELSE
0029 ERRMSG='PRS.SCREENS FILE MISSING';GO 9300                          ERRMSG='PRS.SCREENS FILE MISSING';GO 9300
0030 END                                                                END
0031                                                                 >  * T24102 v
0032                                                                 >  OPEN 'CBN.SCREENS' TO SECOND.SCREENS ELSE
0033                                                                 >  ERRMSG='CBN.SCREENS FILE MISSING';GO 9300
0034                                                                 >  END
0035                                                                 >  * T24102 ^

0060 *-------------------------------------------------------------     *-----------------------------------------------------------
0061 * PRINT SCREEN                                                     * PRINT SCREEN
0062 *-------------------------------------------------------------     *-----------------------------------------------------------
0063 ECD.SCRN.CNT=2                                                     ECD.SCRN.CNT=2
0064 ECD.SCRN.NAME<1>='WORK.SHFT.MAINT'                                 ECD.SCRN.NAME<1>='WORK.SHFT.MAINT'
0065                                                                 >  ECD.SCRN.FLAG<1> = 2 ;* T24102
0066 ECD.SCRN.NAME<2>='WORK.SHFT.MAINT2'                                ECD.SCRN.NAME<2>='WORK.SHFT.MAINT2'
0067 ACT=1;CALL SCRN.EDIT                                               ACT=1;CALL SCRN.EDIT
0068 SN=1;MAT SCV.REC=''                                                SN=1;MAT SCV.REC=''
0069 ACT=2;CALL SCRN.EDIT                                               ACT=2;CALL SCRN.EDIT

0129 FAN=50;LAN=54;VN=1                                                 FAN=50;LAN=54;VN=1
0130 FOR AN = 1 TO 2                                                    FOR AN = 1 TO 2
0131 SCV.REC(AN)<2> = SCV.REC(AN)<1>                                    SCV.REC(AN)<2> = SCV.REC(AN)<1>
0132 ACT=5;CALL SCRN.EDIT                                               ACT=5;CALL SCRN.EDIT
0133 NEXT AN                                                            NEXT AN
0134 *T25613 v                                                       <  
0135 IF SCV.REC(8) = 'S' THEN                                        <  
0136 FOR VN=1 TO 4 WHILE VAL#'END'                                      FOR VN=1 TO 4 WHILE VAL#'END'
0137 FOR AN=40 TO 48 WHILE VAL#'END'                                    FOR AN=40 TO 48 WHILE VAL#'END'
0138 VN2=VN                                                             VN2=VN

0138 VN2=VN                                                             VN2=VN
0139 GOSUB 1000                                                         GOSUB 1000
0140 VN=VN2                                                             VN=VN2
0141 NEXT AN                                                            NEXT AN
0142 NEXT VN                                                            NEXT VN
0143 END                                                             <  
0144 *T25613 ^                                                       <  
0145 IF VAL='END' THEN GO 490                                           IF VAL='END' THEN GO 490
0146 *-------------------------------------------------------------     *-----------------------------------------------------------
0147 FAN=50;LAN=54                                                      FAN=50;LAN=54

0167 CASE SN=1 AND OPT=11;AN=31;GOSUB 1000                              CASE SN=1 AND OPT=11;AN=31;GOSUB 1000
0168 CASE SN=1 AND OPT=12;AN=32;GOSUB 1000                              CASE SN=1 AND OPT=12;AN=32;GOSUB 1000
0169 CASE SN=1 AND OPT=13;AN=33;GOSUB 1000                              CASE SN=1 AND OPT=13;AN=33;GOSUB 1000
0170 CASE SN=1 AND OPT=14;AN=35;GOSUB 1000                              CASE SN=1 AND OPT=14;AN=35;GOSUB 1000
0171 CASE SN=2 AND (OPT>=1 AND OPT<=4)                                  CASE SN=2 AND (OPT>=1 AND OPT<=4)
0172 *T25613 v                                                       <  
0173 IF SCV.REC(8) = 'S' THEN                                        <  
0174 VN=OPT                                                             VN=OPT
0175 FOR AN=40 TO 48 WHILE VAL#'END'                                    FOR AN=40 TO 48 WHILE VAL#'END'
0176 GOSUB 1000                                                         GOSUB 1000

0177 VN=OPT                                                             VN=OPT
0178 NEXT AN                                                            NEXT AN
0179 END                                                             <  
0180 *T25613 ^                                                       <  
0181 CASE OPT='END' OR OPT='E';MORE=0                                   CASE OPT='END' OR OPT='E';MORE=0
0182 CASE OPT='F'                                                       CASE OPT='F'
0183 ERRMSG='';GOSUB 7500                                               ERRMSG='';GOSUB 7500
0184 IF ERRMSG='' THEN MATWRITE WSS.REC ON WORK.SHIFT,ITEM.ID;MORE=     IF ERRMSG='' THEN MATWRITE WSS.REC ON WORK.SHIFT,ITEM.ID;MOR
0185 CASE OPT='S'                                                       CASE OPT='S'

0184 IF ERRMSG='' THEN MATWRITE WSS.REC ON WORK.SHIFT,ITEM.ID;MORE=     IF ERRMSG='' THEN MATWRITE WSS.REC ON WORK.SHIFT,ITEM.ID;MOR
0185 CASE OPT='S'                                                       CASE OPT='S'
0186 VN=(PN*LCNT)+1                                                     VN=(PN*LCNT)+1
0187 IF SCV.REC(FAN)<SN,VN>='' THEN VN=1 ELSE VN=(PN*LCNT)+1            IF SCV.REC(FAN)<SN,VN>='' THEN VN=1 ELSE VN=(PN*LCNT)+1
0188 AN=FAN;CALL SCROLL.SUB;PN=INT((VN-1)/LCNT)+1                       AN=FAN;CALL SCROLL.SUB;PN=INT((VN-1)/LCNT)+1
0189 * T25978 v                                                      <  
0190 CASE OPT='SR'                                                   <  
0191 VN=((PN-1)*LCNT)+1                                              <  
0192 VN -= LCNT                                                      <  
0193 IF VN < 1 THEN VN = 1                                           <  

0194 AN=FAN;CALL SCROLL.SUB;PN=INT((VN-1)/LCNT)+1                    <  
0195 CASE OPT='SB'                                                   <  
0196 VN = DCOUNT(SCV.REC(FAN)<SN>,VM)                                <  
0197 AN=FAN;CALL SCROLL.SUB;PN=INT((VN-1)/LCNT)+1                    <  
0198 CASE OPT='ST'                                                   <  
0199 VN = 1                                                          <  
0200 AN=FAN;CALL SCROLL.SUB;PN=INT((VN-1)/LCNT)+1                    <  

0201 * T25978 ^                                                      <  
0202 CASE OPT='A'                                                       CASE OPT='A'
0203 IF SN=1 AND SCV.REC(8)<1>#'S' THEN GO 400                          IF SN=1 AND SCV.REC(8)<1>#'S' THEN GO 400
0204 GOSUB 6000                                                         GOSUB 6000
0205 CASE OPT='C'                                                       CASE OPT='C'
0206 LVN=DCOUNT(SCV.REC(FAN)<SN>,VM)                                    LVN=DCOUNT(SCV.REC(FAN)<SN>,VM)
0207 PMSG='Line';X=0;Y=21;TYP=3;MINV=1;MAXV=LVN                         PMSG='Line';X=0;Y=21;TYP=3;MINV=1;MAXV=LVN

0240 FAN=50;LAN=54;VN=1                                                 FAN=50;LAN=54;VN=1
0241 FOR AN = 1 TO 2                                                    FOR AN = 1 TO 2
0242 SCV.REC(AN)<2> = SCV.REC(AN)<1>                                    SCV.REC(AN)<2> = SCV.REC(AN)<1>
0243 ACT=5;CALL SCRN.EDIT                                               ACT=5;CALL SCRN.EDIT
0244 NEXT AN                                                            NEXT AN
0245 *T25613 v                                                       <  
0246 IF SCV.REC(8) = 'S' THEN                                        <  
0247 FOR VNT = 1 TO 4                                                   FOR VNT = 1 TO 4
0248 FOR AN = 40 TO 48                                                  FOR AN = 40 TO 48
0249 VN = VNT                                                           VN = VNT

0248 FOR AN = 40 TO 48                                                  FOR AN = 40 TO 48
0249 VN = VNT                                                           VN = VNT
0250 ACT = 5; CALL SCRN.EDIT                                            ACT = 5; CALL SCRN.EDIT
0251 NEXT AN                                                            NEXT AN
0252 NEXT VNT                                                           NEXT VNT
0253 END                                                             <  
0254 *T25613 ^                                                       <  
0255 AN=FAN;VN=1;CALL SCROLL.SUB;PN=1                                   AN=FAN;VN=1;CALL SCROLL.SUB;PN=1
0256 CASE OPT='P'                                                       CASE OPT='P'
0257 SN=1;ACT=2;CALL SCRN.EDIT                                          SN=1;ACT=2;CALL SCRN.EDIT


