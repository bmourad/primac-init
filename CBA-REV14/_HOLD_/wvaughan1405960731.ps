%!PS-Adobe-3.0%%Creator: PRIMAC
/Courier findfont [ 9 0 0 
9 0 0 ] makefont setfont
/showline { gsave show grestore 0 -9  rmoveto } def
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(REV12ABP/JE.MAINT                                                  GLSBP/JE.MAINT) showline
(Printed for wvaughan at 06/28/2006 04:52:11PM) showline
() showline
(0001 *COPY>CPYLIB>COM1                                                  *COPY>CPYLIB>COM1) showline
(0002 *COPY>PMC.CPYLIB>COM.COA                                           *COPY>PMC.CPYLIB>COM.COA) showline
(0003 **************************************************************     ************************************************************) showline
(0004 * REVISION    - [08.0]                                             * REVISION    - [08.0]) showline
(0005 * Copyright 1982 by Computer Business Associates \(Vercom Softw     * Copyright 1982 by Computer Business Associates \(Vercom Sof) showline
(0006 * SYSTEM     - PRIMAC                                              * SYSTEM     - PRIMAC) showline
(0007 * SOURCE     - GLSBP                                               * SOURCE     - GLSBP) showline
(0008 * PROGRAM    - JE.MAINT                                            * PROGRAM    - JE.MAINT) showline
(0009 * BY         - WALID YAMOUT , C.B.A                                * BY         - WALID YAMOUT , C.B.A) showline
(0010 * DATE       - 09/09/85                                            * DATE       - 09/09/85) showline
(0011 * DESCRIPTION-                                                     * DESCRIPTION-) showline
(0012 * LAST COMPILE  - 1113                                             * LAST COMPILE  - 1113) showline
(0013 *                                                                  *) showline
(0014 * TASK                                                             * TASK) showline
(0015 *     18573 - 5/95 LLH - 1-52 ACCOUNTING PERIODS                   *     18573 - 5/95 LLH - 1-52 ACCOUNTING PERIODS) showline
(0016 * TASK 20731 CLS 8/96  ADD DIVISION TO HEADER AND VALIDAT DIST     * TASK 20731 CLS 8/96  ADD DIVISION TO HEADER AND VALIDAT DI) showline
(0017 *T21177 diane 11/06/1996 * REV11 UPG                               *T21177 diane 11/06/1996 * REV11 UPG) showline
(0018 *                                                                  *) showline
(0019 *T21876 diane 05/06/1997 *  Use Gen.xref                           *T21876 diane 05/06/1997 *  Use Gen.xref) showline
(0020 *T22708 renee 03/30/1998 * Display journal number as part of t     *T22708 renee 03/30/1998 * Display journal number as part of) showline
(0021 *                          when a new journal entry is filed.      *                          when a new journal entry is filed) showline
(0022 *T23278 markt 12/10/1998 * Add check for divisional security.      *T23278 markt 12/10/1998 * Add check for divisional security) showline
(0023 *T25978 adelgado 02/07/2002 * Add the use of prompts \(S,SR,SB,     *T25978 adelgado 02/07/2002 * Add the use of prompts \(S,SR,S) showline
(0024 *T26126 adelgado 02/28/2002 * Implement the LOCKED clause for      *T26126 adelgado 02/28/2002 * Implement the LOCKED clause fo) showline
(0025 *T26685 lhelms 07/08/2002 * REV12 DIVISION SECURITY                *T26685 lhelms 07/08/2002 * REV12 DIVISION SECURITY) showline
(0026 *T27624 lross 08/11/2003 * Use GEN.XREF.SUB for dept lookup.       *T27624 lross 08/11/2003 * Use GEN.XREF.SUB for dept lookup.) showline
(0027 *T27935 cmykleb 03/18/2004 * Add a process to reverse an alrea  |  *T28098 cmykleb 05/05/2004 * Use GEN.XREF.SUB for account # ) showline
(0028 *                            journal.                           <  ) showline
(0029 *ENDDOC                                                            *ENDDOC) showline
(0030 **************************************************************     ************************************************************) showline
(0031 *                                                                  *) showline
(0032 *--- INSERT FILES EQUETES                                          *--- INSERT FILES EQUETES) showline
(0033 *                                                                  *) showline
(0034 *COPY>GLS.CPYLIB>JE                                                *COPY>GLS.CPYLIB>JE) showline
(0035 *COPY>GLS.CPYLIB>POSTED.JE ; * T27935                           <  ) showline
(0036 *COPY>GLS.CPYLIB>STATUS.JE                                         *COPY>GLS.CPYLIB>STATUS.JE) showline
(0037 *COPY>GLS.CPYLIB>ACCT.TYPE                                         *COPY>GLS.CPYLIB>ACCT.TYPE) showline
(0038 *COPY>PMC.CPYLIB>DEPARTMENT                                        *COPY>PMC.CPYLIB>DEPARTMENT) showline
(0039 *COPY>PMC.CPYLIB>DIVISION                                          *COPY>PMC.CPYLIB>DIVISION) showline
(0040 *COPY>PMC.CPYLIB>COMPANY                                           *COPY>PMC.CPYLIB>COMPANY) showline
(0041 *COPY>PMC.CPYLIB>COA                                               *COPY>PMC.CPYLIB>COA) showline
(0042 *COPY>PMC.CPYLIB>COA.FILE.VARS                                     *COPY>PMC.CPYLIB>COA.FILE.VARS) showline
(0043 *COPY>PMC.CPYLIB>COST.CNTR                                         *COPY>PMC.CPYLIB>COST.CNTR) showline
(0044                                                                 >  **COPY>CPYLIB>GEN.XREF ;*T27624) showline
(0045 *COPY>CPYLIB>GEN.XREF.SUB ;*T27624                                 *COPY>CPYLIB>GEN.XREF.SUB ;*T27624) showline
(0046 *COPY>CPYLIB>XREF.DATA ;*T27624                                    *COPY>CPYLIB>XREF.DATA ;*T27624) showline
(0047 *COPY>CPYLIB>EDIT.COM                                              *COPY>CPYLIB>EDIT.COM) showline
(0048 *COPY>CPYLIB>EDIT.COM.DRIVER                                       *COPY>CPYLIB>EDIT.COM.DRIVER) showline
(0049 *COPY>CPYLIB>FILE.VARS                                             *COPY>CPYLIB>FILE.VARS) showline
(0050 *COPY>CPYLIB>CHAR                                                  *COPY>CPYLIB>CHAR) showline
(0051 *COPY>CPYLIB>SYSCOM                                                *COPY>CPYLIB>SYSCOM) showline
(0052 MAT SYSCOM.REC =  ""; SYS.TYPE = 2                                 MAT SYSCOM.REC =  ""; SYS.TYPE = 2) showline
(0053 *                                                                  *) showline
(0054 *                                                                  *) showline
(0055 *--- INITALIZE EDIT.SUB                                            *--- INITALIZE EDIT.SUB) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0056 *                                                                  *) showline
(0057 FILL = "#"                                                         FILL = "#") showline
(0058 ERRMSG = ""                                                        ERRMSG = "") showline
(0059 *                                                                  *) showline
(0060 *--- GET COMPANY                                                   *--- GET COMPANY) showline
(0061 *                                                                  *) showline
(0062 MAT FILE.VARS = ""                                                 MAT FILE.VARS = "") showline
(0063 OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = 'COMPANY FILE IS MI     OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = 'COMPANY FILE IS ) showline
(0064 OPEN '','CONTROL' TO CONTROL ELSE ERRMSG = 'CONTROL FILE IS MI     OPEN '','CONTROL' TO CONTROL ELSE ERRMSG = 'CONTROL FILE IS ) showline
(0065 CONO = ""                                                          CONO = "") showline
(0066 MAT COMP.REC = ""                                                  MAT COMP.REC = "") showline
(0067 CALL GET.CONO\(CONO,MAT COMP.REC\)                                   CALL GET.CONO\(CONO,MAT COMP.REC\)) showline
(0068 IF CONO = "END" THEN GOTO 999999                                   IF CONO = "END" THEN GOTO 999999) showline
(0069 *                                                                  *) showline
(0070 *--- OPEN FILES                                                    *--- OPEN FILES) showline
(0071 *                                                                  *) showline
(0072 OPEN '','JE' TO JE ELSE ERRMSG = 'JE FILE IS MISSING'; GOSUB 9     OPEN '','JE' TO JE ELSE ERRMSG = 'JE FILE IS MISSING'; GOSUB) showline
(0073 OPEN '','DIVISION' TO DIVISION ELSE ERRMSG = 'DIVISION FILE IS     OPEN '','DIVISION' TO DIVISION ELSE ERRMSG = 'DIVISION FILE ) showline
(0074 OPEN '','DEPARTMENT' TO DEPARTMENT ELSE ERRMSG = 'DEPARTMENT F     OPEN '','DEPARTMENT' TO DEPARTMENT ELSE ERRMSG = 'DEPARTMENT) showline
(0075 OPEN '','COST.CNTR' TO COST.CNTR ELSE ERRMSG = 'COST.CNTR FILE     OPEN '','COST.CNTR' TO COST.CNTR ELSE ERRMSG = 'COST.CNTR FI) showline
(0076 OPEN '','REV12A.SCREENS' TO M.SCREENS ELSE ERRMSG = 'M.SCREENS  |  OPEN '','GLS.SCREENS' TO M.SCREENS ELSE ERRMSG = 'M.SCREENS ) showline
(0077 OPEN '','PREFIX' TO PREFIX ELSE ERRMSG = 'PREFIX FILE IS MISSI     OPEN '','PREFIX' TO PREFIX ELSE ERRMSG = 'PREFIX FILE IS MIS) showline
(0078 OPEN '','COA' TO COA ELSE ERRMSG = 'COA FILE IS MISSING'; GOSU     OPEN '','COA' TO COA ELSE ERRMSG = 'COA FILE IS MISSING'; GO) showline
(0079 OPEN '','COA.XREF' TO COA.XREF ELSE ERRMSG = 'COA.XREF FILE IS     OPEN '','COA.XREF' TO COA.XREF ELSE ERRMSG = 'COA.XREF FILE ) showline
(0080 OPEN '','ACCT.TYPE' TO ACCT.TYPE ELSE ERRMSG = 'ACCT.TYPE FILE     OPEN '','ACCT.TYPE' TO ACCT.TYPE ELSE ERRMSG = 'ACCT.TYPE FI) showline
(0081 OPEN '','ACCT.CATG' TO ACCT.CATG ELSE ERRMSG = 'ACCT.CATG FILE     OPEN '','ACCT.CATG' TO ACCT.CATG ELSE ERRMSG = 'ACCT.CATG FI) showline
(0082 OPEN '','ACCT.SUB.CATG' TO ACCT.SUB.CATG ELSE ERRMSG = 'ACCT.S     OPEN '','ACCT.SUB.CATG' TO ACCT.SUB.CATG ELSE ERRMSG = 'ACCT) showline
(0083 OPEN '','CATG.AND.SUB' TO CATG.AND.SUB ELSE ERRMSG = 'CATG.AND     OPEN '','CATG.AND.SUB' TO CATG.AND.SUB ELSE ERRMSG = 'CATG.A) showline
(0084 OPEN '','SECURITY' TO SECURITY ELSE ERRMSG = 'SECURITY FILE IS     OPEN '','SECURITY' TO SECURITY ELSE ERRMSG = 'SECURITY FILE ) showline
(0085 EQV.FLG = 1                                                        EQV.FLG = 1) showline
(0086 OPEN '','COA.EQUIV' TO COA.EQUIV ELSE EQV.FLG = 0                  OPEN '','COA.EQUIV' TO COA.EQUIV ELSE EQV.FLG = 0) showline
(0087 OPEN 'XREF.DATA' TO XREF.DATA ELSE ERRMSG='XREF.DATA FILE IS M     OPEN 'XREF.DATA' TO XREF.DATA ELSE ERRMSG='XREF.DATA FILE IS) showline
(0088 *T27935 v                                                       <  ) showline
(0089 OPEN '','POSTED.JE' TO POSTED.JE ELSE ERRMSG = 'POSTED.JE FILE  <  ) showline
(0090 *T27935 ^                                                       <  ) showline
(0091 *                                                                  *) showline
(0092 *--- INITIALIZATION                                                *--- INITIALIZATION) showline
(0093 *                                                                  *) showline
(0094 TODAY = DATE\(\)                                                     TODAY = DATE\(\)) showline
(0095 LINE.SPACE = 2                                                     LINE.SPACE = 2) showline
(0096 BEGIN.PAGE = 8                                                     BEGIN.PAGE = 8) showline
(0097 PAGE.SIZE = 5                                                      PAGE.SIZE = 5) showline
(0098 LINE.SP = 1                                                        LINE.SP = 1) showline
(0099 PAGE.S = 10                                                        PAGE.S = 10) showline
(0100 GEN.DIV = '00'                                                     GEN.DIV = '00') showline
(0101 GEN.DEPT = '00'                                                    GEN.DEPT = '00') showline
(0102 GEN.CCTR = '000'                                                   GEN.CCTR = '000') showline
(0103 BASE.LEN = FIELD\(CO.ACCT.STRUC,"-",1\)                              BASE.LEN = FIELD\(CO.ACCT.STRUC,"-",1\)) showline
(0104 ACCT.LEN = LEN\(CO.ACCT.PIC\)                                        ACCT.LEN = LEN\(CO.ACCT.PIC\)) showline
(0105 SP16 = SPACE\(16\)                                                   SP16 = SPACE\(16\)) showline
(0106 PP.NO = 12                                                         PP.NO = 12) showline
(0107 DS.X = 52                                                          DS.X = 52) showline
(0108 DV.X = 38                                                          DV.X = 38) showline
(0109 DP.X = 43                                                          DP.X = 43) showline
(0110 CC.X = 47                                                          CC.X = 47) showline
(0111 MAT GEN.XREF.REC = ""; GXR.CO = CONO; GXR.LOC = 1                  MAT GEN.XREF.REC = ""; GXR.CO = CONO; GXR.LOC = 1) showline
(0112 UNKNOWN = 'NOT ON FILE'                                            UNKNOWN = 'NOT ON FILE') showline
(0113 *                                                                  *) showline
(0114 *--- GET FISCAL YEAR                                               *--- GET FISCAL YEAR) showline
(0115 *                                                                  *) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0116 READ REC FROM CONTROL, CONO:"FISCAL" ELSE                          READ REC FROM CONTROL, CONO:"FISCAL" ELSE) showline
(0117 ERRMSG = "CONTROL FISCAL IS MISSING"; GOSUB 91000; GOTO 999999     ERRMSG = "CONTROL FISCAL IS MISSING"; GOSUB 91000; GOTO 9999) showline
(0118 END                                                                END) showline
(0119 READ PERIOD.REC FROM CONTROL, CONO:"ACCT.PERIODS" ELSE             READ PERIOD.REC FROM CONTROL, CONO:"ACCT.PERIODS" ELSE) showline
(0120 PERIOD.REC = ""                                                    PERIOD.REC = "") showline
(0121 PERIOD.REC<1> = 12                                                 PERIOD.REC<1> = 12) showline
(0122 END                                                                END) showline
(0123 NUM.PERIODS = PERIOD.REC<1>                                        NUM.PERIODS = PERIOD.REC<1>) showline
(0124 YEAR = REC<1>[1,4]                                                 YEAR = REC<1>[1,4]) showline
(0125 CURR = REC<1>[5,2]                                                 CURR = REC<1>[5,2]) showline
(0126 IF CURR < 1 OR CURR > NUM.PERIODS THEN                             IF CURR < 1 OR CURR > NUM.PERIODS THEN) showline
(0127 ERRMSG = "INVALID CURRENT PERIOD IN CONTROL FISCAL"; GOSUB 910     ERRMSG = "INVALID CURRENT PERIOD IN CONTROL FISCAL"; GOSUB 9) showline
(0128 END                                                                END) showline
(0129 READ OPENDATES FROM CONTROL, CONO : "OPENDATES" ELSE               READ OPENDATES FROM CONTROL, CONO : "OPENDATES" ELSE) showline
(0130 ERRMSG = 'NEED TO SETUP GLS OPEN DATES'                            ERRMSG = 'NEED TO SETUP GLS OPEN DATES') showline
(0131 GOSUB 91000; GOTO 999999                                           GOSUB 91000; GOTO 999999) showline
(0132 END                                                                END) showline
(0133 ***** T23278 v                                                     ***** T23278 v) showline
(0134 READ DIVISIONS.REC FROM  CONTROL, CONO:"DIVISIONS" ELSE            READ DIVISIONS.REC FROM  CONTROL, CONO:"DIVISIONS" ELSE) showline
(0135 ERRMSG = "CONTROL DIVISIONS RECORD IS MISSING"; GOSUB 91000; G     ERRMSG = "CONTROL DIVISIONS RECORD IS MISSING"; GOSUB 91000;) showline
(0136 END                                                                END) showline
(0137 READ SECURITY.REC FROM CONTROL, CONO:"DIV.SECURITY" ELSE           READ SECURITY.REC FROM CONTROL, CONO:"DIV.SECURITY" ELSE) showline
(0138 ERRMSG = "CONTROL DIV.SECURITY RECORD IS MISSING"; GOSUB 91000     ERRMSG = "CONTROL DIV.SECURITY RECORD IS MISSING"; GOSUB 910) showline
(0139 END                                                                END) showline
(0140 ***** T23278 ^                                                     ***** T23278 ^) showline
(0141 *                                                                  *) showline
(0142 *--- GET OPER.ID                                                   *--- GET OPER.ID) showline
(0143 *                                                                  *) showline
(0144                                                                 >  *      PORT.NO=@TTY) showline
(0145 PORT.NO = 'TTY'                                                    PORT.NO = 'TTY') showline
(0146 CALL SYSVARS.SUB\(PORT.NO\)                                          CALL SYSVARS.SUB\(PORT.NO\)) showline
(0147 READV OPER.ID FROM SECURITY, "R.":PORT.NO,2 ELSE OPER.ID = ""      READV OPER.ID FROM SECURITY, "R.":PORT.NO,2 ELSE OPER.ID = ") showline
(0148 IF OPER.ID = "" THEN OPER.ID = PORT.NO :"-": TODAY                 IF OPER.ID = "" THEN OPER.ID = PORT.NO :"-": TODAY) showline
(0149 *                                                                  *) showline
(0150 *--- SCREEN                                                        *--- SCREEN) showline
(0151 *                                                                  *) showline
(0152 MAT EDIT.COM.DRIVER = ''                                           MAT EDIT.COM.DRIVER = '') showline
(0153 ECD.SCRN.CNT = 1                                                   ECD.SCRN.CNT = 1) showline
(0154 ECD.SCRN.NAME<1> = 'JE.MAINT'                                      ECD.SCRN.NAME<1> = 'JE.MAINT') showline
(0155 ECD.ACTION=1;CALL SCRN.EDIT                                        ECD.ACTION=1;CALL SCRN.EDIT) showline
(0156 *                                                                  *) showline
(0157 *--- MAIN PROCESS                                                  *--- MAIN PROCESS) showline
(0158 *                                                                  *) showline
(0159 ECD.SCRN.NO = 1                                                    ECD.SCRN.NO = 1) showline
(0160 LOOP                                                               LOOP) showline
(0161 MAT SCV.REC = ''                                                   MAT SCV.REC = '') showline
(0162 ECD.ACTION = 2; CALL SCRN.EDIT                                     ECD.ACTION = 2; CALL SCRN.EDIT) showline
(0163 *                                                                  *) showline
(0164 *--- ENTER REFERENCE NUMBER                                        *--- ENTER REFERENCE NUMBER) showline
(0165 *                                                                  *) showline
(0166 LOOP                                                               LOOP) showline
(0167 MORE = 1                                                           MORE = 1) showline
(0168 REV.FLAG = "" ; * T27935                                        <  ) showline
(0169 JE.NO = ""                                                         JE.NO = "") showline
(0170 LN = 1                                                             LN = 1) showline
(0171 LINES = 0                                                          LINES = 0) showline
(0172 OLD.START = 0                                                      OLD.START = 0) showline
(0173 LINE.DESC = ""                                                     LINE.DESC = "") showline
(0174 LINE.TYPE = ""                                                     LINE.TYPE = "") showline
(0175 LINE.NORM = ""                                                     LINE.NORM = "") showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0176 LINE.CAT = ""                                                      LINE.CAT = "") showline
(0177 LINE.SUB = ""                                                      LINE.SUB = "") showline
(0178 TOT.DEBIT = 0                                                      TOT.DEBIT = 0) showline
(0179 TOT.CREDIT = 0                                                     TOT.CREDIT = 0) showline
(0180 ECD.NUM = 1                                                        ECD.NUM = 1) showline
(0181 ECD.ACTION=4;CALL SCRN.EDIT                                        ECD.ACTION=4;CALL SCRN.EDIT) showline
(0182 BEGIN CASE                                                         BEGIN CASE) showline
(0183 CASE ECD.RET.VALUE = "END"                                         CASE ECD.RET.VALUE = "END") showline
(0184 MORE = 0                                                           MORE = 0) showline
(0185 CASE ECD.RET.VALUE = "N"                                           CASE ECD.RET.VALUE = "N") showline
(0186 JE.NO = ECD.RET.VALUE                                              JE.NO = ECD.RET.VALUE) showline
(0187 MAT JE.REC = ''                                                    MAT JE.REC = '') showline
(0188 NEW = 1                                                            NEW = 1) showline
(0189 FOR OPTION = 1 TO 4 WHILE ECD.RET.VALUE # 'END'                    FOR OPTION = 1 TO 4 WHILE ECD.RET.VALUE # 'END') showline
(0190 ON OPTION GOSUB 500,1000,2000,3000                                 ON OPTION GOSUB 500,1000,2000,3000) showline
(0191 NEXT OPTION                                                        NEXT OPTION) showline
(0192 IF ECD.RET.VALUE = 'END' THEN MORE = 2                             IF ECD.RET.VALUE = 'END' THEN MORE = 2) showline
(0193 *T27935 v                                                       <  ) showline
(0194 CASE ECD.RET.VALUE = "R"                                        <  ) showline
(0195 ECD.NUM = 27                                                    <  ) showline
(0196 ECD.ACTION = 4 ; CALL SCRN.EDIT                                 <  ) showline
(0197 IF ECD.RET.VALUE = 'END' THEN MORE = 2; GOTO 400                <  ) showline
(0198 RJE.NO = ECD.RET.VALUE'R%8'                                     <  ) showline
(0199 ECD.NUM = 28                                                    <  ) showline
(0200 ECD.ACTION = 4 ; CALL SCRN.EDIT                                 <  ) showline
(0201 IF ECD.RET.VALUE = 'END' THEN MORE = 2; GOTO 400                <  ) showline
(0202 RJE.PERIOD = ECD.RET.VALUE                                      <  ) showline
(0203 PJE.ID = CONO:RJE.NO:'!':RJE.PERIOD                             <  ) showline
(0204 MATREAD PJE.REC FROM POSTED.JE, PJE.ID ELSE                     <  ) showline
(0205 ERRMSG = 'Posted JE record is not on file.'                     <  ) showline
(0206 GOSUB 91000                                                     <  ) showline
(0207 MORE = 2                                                        <  ) showline
(0208 P_X  = 0 ; P_Y = 21 ; P_VALUE = "" ; P_OPT = "CL"               <  ) showline
(0209 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                           <  ) showline
(0210 SCV.REC\(1\)<1> = ""                                              <  ) showline
(0211 CONTINUE                                                        <  ) showline
(0212 END                                                             <  ) showline
(0213 IF PJE.REV.DATE # "" THEN                                       <  ) showline
(0214 ERRMSG = 'This journal has already been reversed on ':OCONV\(PJ  <  ) showline
(0215 GOSUB 91000                                                     <  ) showline
(0216 MORE = 2                                                        <  ) showline
(0217 P_X  = 0 ; P_Y = 21 ; P_VALUE = "" ; P_OPT = "CL"               <  ) showline
(0218 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                           <  ) showline
(0219 SCV.REC\(1\)<1> = ""                                              <  ) showline
(0220 CONTINUE                                                        <  ) showline
(0221 END                                                             <  ) showline
(0222 MAT JE.REC = MAT PJE.REC                                        <  ) showline
(0223 JE.DB.AMT = ""                                                  <  ) showline
(0224 JE.CR.AMT = ""                                                  <  ) showline
(0225 JE.PDATE = ""                                                   <  ) showline
(0226 JE.PERIOD = ""                                                  <  ) showline
(0227 JE.DATE = TODAY                                                 <  ) showline
(0228 JE.REV.NO = RJE.NO:'!':RJE.PERIOD                               <  ) showline
(0229 LCNT = DCOUNT\(JE.ACCT,VM\)                                       <  ) showline
(0230 FOR L = 1 TO LCNT                                               <  ) showline
(0231 JE.DB.AMT<1,L> = PJE.CR.AMT<1,L>                                <  ) showline
(0232 JE.CR.AMT<1,L> = PJE.DB.AMT<1,L>                                <  ) showline
(0233 NEXT L                                                          <  ) showline
(0234 JE.NO = 'N'                                                     <  ) showline
(0235 SCV.REC\(1\)<1> = JE.NO                                           <  ) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0236 ECD.NUM = 1; ECD.ACTION = 5; CALL SCRN.EDIT                     <  ) showline
(0237 SCV.REC\(2\)<1> = JE.PERIOD                                       <  ) showline
(0238 ECD.NUM = 2; ECD.ACTION = 5; CALL SCRN.EDIT                     <  ) showline
(0239 SCV.REC\(3\)<1> = JE.DATE                                         <  ) showline
(0240 ECD.NUM = 3; ECD.ACTION = 5; CALL SCRN.EDIT                     <  ) showline
(0241 NEW = 0                                                         <  ) showline
(0242 REV.FLAG = 1                                                    <  ) showline
(0243 OLD.PERIOD = ""                                                 <  ) showline
(0244 GOSUB 1000                                                      <  ) showline
(0245 GOSUB 2000                                                      <  ) showline
(0246 *T27935 ^                                                       <  ) showline
(0247 CASE NUM\(ECD.RET.VALUE\)                                            CASE NUM\(ECD.RET.VALUE\)) showline
(0248 JE.NO = STR\("0",8-LEN\(ECD.RET.VALUE\)\):ECD.RET.VALUE                JE.NO = STR\("0",8-LEN\(ECD.RET.VALUE\)\):ECD.RET.VALUE) showline
(0249 ECD.NUM = 1; SCV.REC\(1\)<1> = JE.NO; ECD.ACTION = 5; CALL SCRN.     ECD.NUM = 1; SCV.REC\(1\)<1> = JE.NO; ECD.ACTION = 5; CALL SCR) showline
(0250 NEW = 0                                                            NEW = 0) showline
(0251 * T26126 v                                                         * T26126 v) showline
(0252 MATREADU JE.REC FROM JE, CONO : JE.NO LOCKED                       MATREADU JE.REC FROM JE, CONO : JE.NO LOCKED) showline
(0253 ERRMSG = 'JOURNAL record is locked by user - ':GETUSERNAME\(STA     ERRMSG = 'JOURNAL record is locked by user - ':GETUSERNAME\(S) showline
(0254 GOSUB 91000;MORE = 2 ; CONTINUE                                    GOSUB 91000;MORE = 2 ; CONTINUE) showline
(0255 END ELSE                                                           END ELSE) showline
(0256 * T26126 ^                                                         * T26126 ^) showline
(0257 MAT JE.REC = ''                                                    MAT JE.REC = '') showline
(0258 NEW = 1                                                            NEW = 1) showline
(0259 FOR OPTION = 1 TO 4 WHILE ECD.RET.VALUE # 'END'                    FOR OPTION = 1 TO 4 WHILE ECD.RET.VALUE # 'END') showline
(0260 ON OPTION GOSUB 500,1000,2000,3000                                 ON OPTION GOSUB 500,1000,2000,3000) showline
(0261 NEXT OPTION                                                        NEXT OPTION) showline
(0262 IF ECD.RET.VALUE = 'END' THEN                                      IF ECD.RET.VALUE = 'END' THEN) showline
(0263 RELEASE JE, JE.NO                                                  RELEASE JE, JE.NO) showline
(0264 MORE = 2                                                           MORE = 2) showline
(0265 END                                                                END) showline
(0266 END                                                                END) showline
(0267 DIV.CODE=JE.HEAD.DIV;USER.ID=UPCASE\(@LOGNAME\);ERRMSG=''         |  *T23278 v) showline
(0268                                                                 >  DIV.CODE = JE.HEAD.DIV; USER.ID = UPCASE\(@LOGNAME\); ERRMSG =) showline
(0269 CALL CK.DIV.SEC.SUB\(CONO,DIV.CODE,USER.ID,ERRMSG\)                  CALL CK.DIV.SEC.SUB\(CONO,DIV.CODE,USER.ID,ERRMSG\)) showline
(0270 IF ERRMSG # '' THEN                                                IF ERRMSG # '' THEN) showline
(0271 GOSUB 91000; MORE = 2                                              GOSUB 91000; MORE = 2) showline
(0272 END                                                                END) showline
(0273                                                                 >  *T23278 ^) showline
(0274 CASE 1                                                             CASE 1) showline
(0275 ERRMSG = 'INVALID INPUT'; GOSUB 91000                              ERRMSG = 'INVALID INPUT'; GOSUB 91000) showline
(0276 MORE = 2                                                           MORE = 2) showline
(0277 400 *                                                           <  ) showline
(0278 END CASE                                                           END CASE) showline
(0279 WHILE MORE = 2 DO                                                  WHILE MORE = 2 DO) showline
(0280 MAT SCV.REC = ''                                                   MAT SCV.REC = '') showline
(0281 ECD.ACTION = 6; CALL SCRN.EDIT                                     ECD.ACTION = 6; CALL SCRN.EDIT) showline
(0282 REPEAT                                                             REPEAT) showline
(0283 WHILE MORE DO                                                      WHILE MORE DO) showline
(0284 IF NEW THEN                                                        IF NEW THEN) showline
(0285 OLD.PERIOD = ''                                                    OLD.PERIOD = '') showline
(0286 OPTION = "A"                                                       OPTION = "A") showline
(0287 LOOP                                                               LOOP) showline
(0288 LN = LINES + 1                                                     LN = LINES + 1 ) showline
(0289 OLD.LINES = LINES                                                  OLD.LINES = LINES) showline
(0290 GOSUB 10000                                                        GOSUB 10000) showline
(0291 WHILE LINES > OLD.LINES DO REPEAT                                  WHILE LINES > OLD.LINES DO REPEAT) showline
(0292 LN = LINES                                                         LN = LINES) showline
(0293 GOSUB 80000                                                        GOSUB 80000) showline
(0294 END ELSE                                                           END ELSE) showline
(0295 OLD.PERIOD = JE.PERIOD                                             OLD.PERIOD = JE.PERIOD) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0296 SCV.REC\(2\)<1> = JE.PERIOD[5,2]                                     SCV.REC\(2\)<1> = JE.PERIOD[5,2]) showline
(0297 SCV.REC\(3\)<1> = JE.DATE                                            SCV.REC\(3\)<1> = JE.DATE) showline
(0298 SCV.REC\(4\)<1> = JE.DESC                                            SCV.REC\(4\)<1> = JE.DESC) showline
(0299 SCV.REC\(13\)<1> = JE.HEAD.DIV                                       SCV.REC\(13\)<1> = JE.HEAD.DIV) showline
(0300 LINES = COUNT\(JE.ACCT,VM\) + \(JE.ACCT # ""\)                         LINES = COUNT\(JE.ACCT,VM\) + \(JE.ACCT # ""\)) showline
(0301 FOR I = 1 TO LINES                                                 FOR I = 1 TO LINES) showline
(0302 MATREAD COA.REC FROM COA, CONO : JE.ACCT<1,I> ELSE                 MATREAD COA.REC FROM COA, CONO : JE.ACCT<1,I> ELSE) showline
(0303 MAT COA.REC = ''                                                   MAT COA.REC = '') showline
(0304 COA.L.DESC = UNKNOWN                                               COA.L.DESC = UNKNOWN) showline
(0305 END                                                                END) showline
(0306 LINE.DESC<I> = COA.L.DESC                                          LINE.DESC<I> = COA.L.DESC) showline
(0307 LINE.TYPE<I> = COA.TYPE                                            LINE.TYPE<I> = COA.TYPE) showline
(0308 *T27935 v                                                       |  LINE.NORM<I> = COA.NORM) showline
(0309 *           LINE.NORM<I> = COA.NORM                             <  ) showline
(0310 IF REV.FLAG = "" THEN LINE.NORM<I> = COA.NORM                   <  ) showline
(0311 *T27935 ^                                                       <  ) showline
(0312 LINE.CAT<I> = COA.CATG                                             LINE.CAT<I> = COA.CATG) showline
(0313 LINE.SUB<I> = COA.SUB.CATG                                         LINE.SUB<I> = COA.SUB.CATG) showline
(0314 TOT.DEBIT = TOT.DEBIT + JE.DB.AMT<1,I>                             TOT.DEBIT = TOT.DEBIT + JE.DB.AMT<1,I>) showline
(0315 TOT.CREDIT = TOT.CREDIT + JE.CR.AMT<1,I>                           TOT.CREDIT = TOT.CREDIT + JE.CR.AMT<1,I>) showline
(0316 NEXT N                                                             NEXT N) showline
(0317 SCV.REC\(5\)<1> = "IN"                                               SCV.REC\(5\)<1> = "IN") showline
(0318 SCV.REC\(6\)<1> = 0                                                  SCV.REC\(6\)<1> = 0) showline
(0319 SCV.REC\(8\)<1> = TOT.DEBIT                                          SCV.REC\(8\)<1> = TOT.DEBIT) showline
(0320 SCV.REC\(9\)<1> = TOT.CREDIT                                         SCV.REC\(9\)<1> = TOT.CREDIT) showline
(0321 ECD.ACTION = 3; CALL SCRN.EDIT                                     ECD.ACTION = 3; CALL SCRN.EDIT) showline
(0322 GOSUB 80000                                                        GOSUB 80000) showline
(0323 END                                                                END) showline
(0324 *                                                                  *) showline
(0325 *--- ENTER OPTIONS                                                 *--- ENTER OPTIONS) showline
(0326 *                                                                  *) showline
(0327 LOOP                                                               LOOP) showline
(0328 ECD.NUM = 10                                                       ECD.NUM = 10) showline
(0329 SCV.REC\(ECD.NUM\)<1> = ''                                           SCV.REC\(ECD.NUM\)<1> = '') showline
(0330 ECD.ACTION=4;CALL SCRN.EDIT                                        ECD.ACTION=4;CALL SCRN.EDIT) showline
(0331 OPTION = ECD.RET.VALUE                                             OPTION = ECD.RET.VALUE) showline
(0332 BEGIN CASE                                                         BEGIN CASE) showline
(0333 CASE OPTION = "END" OR OPTION = "E"                                CASE OPTION = "END" OR OPTION = "E") showline
(0334 RELEASE                                                            RELEASE) showline
(0335 OPTION = 'END'                                                     OPTION = 'END') showline
(0336 CASE NUM\(OPTION\) AND OPTION > 0 AND JE.UDATE = ""                  CASE NUM\(OPTION\) AND OPTION > 0 AND JE.UDATE = "") showline
(0337 ON OPTION GOSUB 500,1000,2000,3000                                 ON OPTION GOSUB 500,1000,2000,3000) showline
(0338 CASE OPTION = "A" AND JE.UDATE = ""                                CASE OPTION = "A" AND JE.UDATE = "") showline
(0339 LOOP                                                               LOOP) showline
(0340 LN = LINES + 1                                                     LN = LINES + 1) showline
(0341 OLD.LINES = LINES                                                  OLD.LINES = LINES) showline
(0342 GOSUB 10000                                                        GOSUB 10000) showline
(0343 WHILE LINES > OLD.LINES DO REPEAT                                  WHILE LINES > OLD.LINES DO REPEAT) showline
(0344 LN = LINES                                                         LN = LINES) showline
(0345 GOSUB 80000                                                        GOSUB 80000) showline
(0346 CASE OPTION = "C" AND JE.UDATE = ""                                CASE OPTION = "C" AND JE.UDATE = "") showline
(0347 IF LINES = 1 THEN LNO = 1 ELSE GOSUB 30000                         IF LINES = 1 THEN LNO = 1 ELSE GOSUB 30000) showline
(0348 IF LNO THEN                                                        IF LNO THEN) showline
(0349 LN = LNO                                                           LN = LNO) showline
(0350 SLN = BEGIN.PAGE + LINE.SPACE * MOD\(LN-1,PAGE.SIZE\)                SLN = BEGIN.PAGE + LINE.SPACE * MOD\(LN-1,PAGE.SIZE\)) showline
(0351 GOSUB 10100                                                        GOSUB 10100) showline
(0352 END                                                                END) showline
(0353 GOSUB 80000                                                        GOSUB 80000) showline
(0354 CASE OPTION = "D" AND JE.UDATE = ""                                CASE OPTION = "D" AND JE.UDATE = "") showline
(0355 GOSUB 30000                                                        GOSUB 30000) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0356 IF LNO THEN                                                        IF LNO THEN) showline
(0357 LN = LNO                                                           LN = LNO) showline
(0358 TOT.DEBIT = TOT.DEBIT - JE.DB.AMT<1,LN>                            TOT.DEBIT = TOT.DEBIT - JE.DB.AMT<1,LN>) showline
(0359 TOT.CREDIT = TOT.CREDIT - JE.CR.AMT<1,LN>                          TOT.CREDIT = TOT.CREDIT - JE.CR.AMT<1,LN>) showline
(0360 JE.ACCT = DELETE\(JE.ACCT,1,LN,0\)                                   JE.ACCT = DELETE\(JE.ACCT,1,LN,0\)) showline
(0361 LINE.DESC = DELETE\(LINE.DESC,LN,0,0\)                               LINE.DESC = DELETE\(LINE.DESC,LN,0,0\)) showline
(0362 LINE.TYPE = DELETE\(LINE.TYPE,LN,0,0\)                               LINE.TYPE = DELETE\(LINE.TYPE,LN,0,0\)) showline
(0363 LINE.NORM = DELETE\(LINE.NORM,LN,0,0\)                               LINE.NORM = DELETE\(LINE.NORM,LN,0,0\)) showline
(0364 LINE.CAT = DELETE\(LINE.CAT,LN,0,0\)                                 LINE.CAT = DELETE\(LINE.CAT,LN,0,0\)) showline
(0365 LINE.SUB = DELETE\(LINE.SUB,LN,0,0\)                                 LINE.SUB = DELETE\(LINE.SUB,LN,0,0\)) showline
(0366 JE.DIV = DELETE\(JE.DIV,1,LN,0\)                                     JE.DIV = DELETE\(JE.DIV,1,LN,0\)) showline
(0367 JE.DEPT = DELETE\(JE.DEPT,1,LN,0\)                                   JE.DEPT = DELETE\(JE.DEPT,1,LN,0\)) showline
(0368 JE.CCTR = DELETE\(JE.CCTR,1,LN,0\)                                   JE.CCTR = DELETE\(JE.CCTR,1,LN,0\)) showline
(0369 JE.DB.AMT = DELETE\(JE.DB.AMT,1,LN,0\)                               JE.DB.AMT = DELETE\(JE.DB.AMT,1,LN,0\)) showline
(0370 JE.CR.AMT = DELETE\(JE.CR.AMT,1,LN,0\)                               JE.CR.AMT = DELETE\(JE.CR.AMT,1,LN,0\)) showline
(0371 JE.CMT = DELETE\(JE.CMT,1,LN,0\) ; *CAF1 15973                       JE.CMT = DELETE\(JE.CMT,1,LN,0\) ; *CAF1 15973) showline
(0372 LINES = COUNT\(JE.ACCT,VM\) + \(JE.ACCT # ""\)                         LINES = COUNT\(JE.ACCT,VM\) + \(JE.ACCT # ""\)) showline
(0373 IF LN > LINES THEN LN = LINES                                      IF LN > LINES THEN LN = LINES) showline
(0374 IF LN < 1 THEN LN = 1                                              IF LN < 1 THEN LN = 1) showline
(0375 OLD.START = 0                                                      OLD.START = 0) showline
(0376 GOSUB 80000                                                        GOSUB 80000) showline
(0377 GOSUB 20000                                                        GOSUB 20000) showline
(0378 END                                                                END) showline
(0379 * T25978 v                                                         * T25978 v) showline
(0380 CASE OPTION[1,1] = "S"                                             CASE OPTION[1,1] = "S") showline
(0381 BEGIN CASE                                                         BEGIN CASE) showline
(0382 CASE OPTION = "S"                                                  CASE OPTION = "S" ) showline
(0383 LN = 1 + INT\(\(LN-1\)/PAGE.SIZE\) * PAGE.SIZE + PAGE.SIZE             LN = 1 + INT\(\(LN-1\)/PAGE.SIZE\) * PAGE.SIZE + PAGE.SIZE) showline
(0384 IF LN > LINES THEN LN = 1                                          IF LN > LINES THEN LN = 1) showline
(0385 GOSUB 80000                                                        GOSUB 80000) showline
(0386 CASE OPTION[2,1] = "R"                                             CASE OPTION[2,1] = "R") showline
(0387 LN = 1 + INT\(\(LN-1\)/PAGE.SIZE\) * PAGE.SIZE - PAGE.SIZE             LN = 1 + INT\(\(LN-1\)/PAGE.SIZE\) * PAGE.SIZE - PAGE.SIZE) showline
(0388 IF LN < 1 THEN LN = 1                                              IF LN < 1 THEN LN = 1) showline
(0389 GOSUB 80000                                                        GOSUB 80000) showline
(0390 CASE OPTION[2,1] = "T"                                             CASE OPTION[2,1] = "T") showline
(0391 LN = 1                                                             LN = 1) showline
(0392 GOSUB 80000                                                        GOSUB 80000) showline
(0393 CASE OPTION[2,1] = "B"                                             CASE OPTION[2,1] = "B") showline
(0394 LN = LINES                                                         LN = LINES) showline
(0395 GOSUB 80000                                                        GOSUB 80000) showline
(0396 CASE NUM\(OPTION[2,10]\) AND \(OPTION[2,10] GT 0 AND OPTION[2,10]     CASE NUM\(OPTION[2,10]\) AND \(OPTION[2,10] GT 0 AND OPTION[2,1) showline
(0397 LN = OPTION[2,10]                                                  LN = OPTION[2,10]) showline
(0398 GOSUB 80000                                                        GOSUB 80000) showline
(0399 END CASE                                                           END CASE) showline
(0400 * T25978 ^                                                         * T25978 ^) showline
(0401 CASE OPTION = "F" AND JE.UDATE = ""                                CASE OPTION = "F" AND JE.UDATE = "") showline
(0402                                                                 >  ***** T23278 v) showline
(0403                                                                 >  *   T26685 v) showline
(0404                                                                 >  *       IF SECURITY.REC<1> = "Y" AND SECURITY.REC<2> = "Y" T) showline
(0405 IF SECURITY.REC<1> = "Y" AND SECURITY.REC<2> = "Y" AND JE.HEAD     IF SECURITY.REC<1> = "Y" AND SECURITY.REC<2> = "Y" AND JE.HE) showline
(0406 LOCATE JE.HEAD.DIV IN DIVISIONS.REC<1>,1 SETTING POS ELSE          LOCATE JE.HEAD.DIV IN DIVISIONS.REC<1>,1 SETTING POS ELSE) showline
(0407 ERRMSG = "DIVISION ":JE.HEAD.DIV:" NOT FOUND ON CONTROL RECORD     ERRMSG = "DIVISION ":JE.HEAD.DIV:" NOT FOUND ON CONTROL RECO) showline
(0408 GOSUB 91000; GOTO 999999                                           GOSUB 91000; GOTO 999999) showline
(0409 END                                                                END) showline
(0410 END ELSE                                                           END ELSE) showline
(0411 POS = 1                                                            POS = 1) showline
(0412 END                                                                END) showline
(0413 IF REV.FLAG THEN OLD.PERIOD = "" ; * T27935                     |  ***** T23278 ^) showline
(0414 IF JE.ACCT = "" THEN                                               IF JE.ACCT = "" THEN) showline
(0415 IF OLD.PERIOD # '' THEN                                            IF OLD.PERIOD # '' THEN) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0416 DELETE JE, CONO:JE.NO                                              DELETE JE, CONO:JE.NO) showline
(0417 CTL.KEY = CONO : "JE" : OLD.PERIOD                                 CTL.KEY = CONO : "JE" : OLD.PERIOD) showline
(0418 MATREADU SJE.REC FROM CONTROL, CTL.KEY ELSE MAT SJE.REC = ''       MATREADU SJE.REC FROM CONTROL, CTL.KEY ELSE MAT SJE.REC = '') showline
(0419                                                                 >  ***** T23278 v) showline
(0420                                                                 >  *                          IF JE.PDATE = '' THEN SJE.PRT.NO ) showline
(0421                                                                 >  *                          SJE.POST.NO = SJE.POST.NO - 1) showline
(0422 IF JE.PDATE = '' THEN SJE.PRT.NO<1,POS> = SJE.PRT.NO<1,POS> -      IF JE.PDATE = '' THEN SJE.PRT.NO<1,POS> = SJE.PRT.NO<1,POS> ) showline
(0423 SJE.POST.NO<1,POS> = SJE.POST.NO<1,POS> - 1                        SJE.POST.NO<1,POS> = SJE.POST.NO<1,POS> - 1) showline
(0424                                                                 >  ***** T23278 ^) showline
(0425 GOSUB 89000                                                        GOSUB 89000) showline
(0426 END                                                                END) showline
(0427 RELEASE JE, CONO:JE.NO                                             RELEASE JE, CONO:JE.NO) showline
(0428 OPTION = 'END'                                                     OPTION = 'END') showline
(0429 END ELSE                                                           END ELSE) showline
(0430 IF TOT.DEBIT = TOT.CREDIT THEN                                     IF TOT.DEBIT = TOT.CREDIT THEN) showline
(0431 IF JE.NO = "N" THEN                                                IF JE.NO = "N" THEN) showline
(0432 READU NEXT.NO FROM CONTROL, CONO:"JE" ELSE NEXT.NO = 1             READU NEXT.NO FROM CONTROL, CONO:"JE" ELSE NEXT.NO = 1) showline
(0433 LOOP                                                               LOOP) showline
(0434 JE.NO = NEXT.NO                                                    JE.NO = NEXT.NO) showline
(0435 NEXT.NO = JE.NO + 1                                                NEXT.NO = JE.NO + 1) showline
(0436 IF NEXT.NO > 99999999 THEN NEXT.NO = 1                             IF NEXT.NO > 99999999 THEN NEXT.NO = 1) showline
(0437 JE.NO = STR\("0",8-LEN\(JE.NO\)\):JE.NO                                JE.NO = STR\("0",8-LEN\(JE.NO\)\):JE.NO) showline
(0438 FND = 1                                                            FND = 1) showline
(0439 READU REC FROM JE, CONO:JE.NO ELSE FND = 0                         READU REC FROM JE, CONO:JE.NO ELSE FND = 0) showline
(0440 WHILE FND DO                                                       WHILE FND DO) showline
(0441 RELEASE JE, CONO:JE.NO                                             RELEASE JE, CONO:JE.NO) showline
(0442 REPEAT                                                             REPEAT) showline
(0443 WRITE NEXT.NO ON CONTROL, CONO:"JE"                                WRITE NEXT.NO ON CONTROL, CONO:"JE") showline
(0444 ECD.NUM = 1; SCV.REC\(1\)<1> = JE.NO; ECD.ACTION = 5; CALL SCRN.     ECD.NUM = 1; SCV.REC\(1\)<1> = JE.NO; ECD.ACTION = 5; CALL SCR) showline
(0445 * T22708 v Add new journal number as part of the message displ     * T22708 v Add new journal number as part of the message dis) showline
(0446 *                       ERRMSG = "Note the Reference Number";      *                          ERRMSG = "Note the Reference Numb) showline
(0447 ERRMSG = "Note the new Reference Number - "                        ERRMSG = "Note the new Reference Number - ") showline
(0448 ERRMSG = ERRMSG:JE.NO                                              ERRMSG = ERRMSG:JE.NO) showline
(0449 GOSUB 91000                                                        GOSUB 91000) showline
(0450 * T22708 ^                                                         * T22708 ^) showline
(0451 END                                                                END) showline
(0452 JE.OPER = OPER.ID                                                  JE.OPER = OPER.ID) showline
(0453 IF OLD.PERIOD # JE.PERIOD THEN                                     IF OLD.PERIOD # JE.PERIOD THEN) showline
(0454 IF OLD.PERIOD # '' THEN                                            IF OLD.PERIOD # '' THEN) showline
(0455 CTL.KEY = CONO : 'JE' : OLD.PERIOD                                 CTL.KEY = CONO : 'JE' : OLD.PERIOD) showline
(0456 MATREADU SJE.REC FROM CONTROL, CTL.KEY ELSE MAT SJE.REC = ''       MATREADU SJE.REC FROM CONTROL, CTL.KEY ELSE MAT SJE.REC = '') showline
(0457                                                                 >  ***** T23278 v) showline
(0458                                                                 >  *                                  IF JE.PDATE = '' THEN SJE) showline
(0459                                                                 >  *                                  SJE.POST.NO = SJE.POST.NO) showline
(0460 IF JE.PDATE = '' THEN SJE.PRT.NO<1,POS> = SJE.PRT.NO<1,POS> -      IF JE.PDATE = '' THEN SJE.PRT.NO<1,POS> = SJE.PRT.NO<1,POS> ) showline
(0461 SJE.POST.NO<1,POS> = SJE.POST.NO<1,POS> - 1                        SJE.POST.NO<1,POS> = SJE.POST.NO<1,POS> - 1) showline
(0462                                                                 >  ***** T23278 ^) showline
(0463 GOSUB 89000                                                        GOSUB 89000) showline
(0464 END                                                                END) showline
(0465 CTL.KEY = CONO : 'JE' : JE.PERIOD                                  CTL.KEY = CONO : 'JE' : JE.PERIOD) showline
(0466 MATREADU SJE.REC FROM CONTROL, CTL.KEY ELSE MAT SJE.REC = ''       MATREADU SJE.REC FROM CONTROL, CTL.KEY ELSE MAT SJE.REC = '') showline
(0467                                                                 >  ***** T23278 v) showline
(0468                                                                 >  *                              IF JE.PDATE = '' THEN SJE.PRT) showline
(0469                                                                 >  *                              SJE.POST.NO = SJE.POST.NO + 1) showline
(0470 IF JE.PDATE = '' THEN SJE.PRT.NO<1,POS> = SJE.PRT.NO<1,POS> +      IF JE.PDATE = '' THEN SJE.PRT.NO<1,POS> = SJE.PRT.NO<1,POS> ) showline
(0471 SJE.POST.NO<1,POS> = SJE.POST.NO<1,POS> + 1                        SJE.POST.NO<1,POS> = SJE.POST.NO<1,POS> + 1) showline
(0472                                                                 >  ***** T23278 ^) showline
(0473 GOSUB 89000                                                        GOSUB 89000) showline
(0474 END                                                                END) showline
(0475 MATWRITE JE.REC ON JE, CONO:JE.NO                                  MATWRITE JE.REC ON JE, CONO:JE.NO) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0476 OPTION = 'END'                                                     OPTION = 'END') showline
(0477 END ELSE                                                           END ELSE) showline
(0478 ERRMSG = "Cannot File When Record is OUT OF BALANCE";GOSUB 910     ERRMSG = "Cannot File When Record is OUT OF BALANCE";GOSUB 9) showline
(0479 END                                                                END) showline
(0480 END                                                                END) showline
(0481 END CASE                                                           END CASE) showline
(0482 WHILE OPTION # 'END' DO REPEAT                                     WHILE OPTION # 'END' DO REPEAT) showline
(0483 REPEAT                                                             REPEAT) showline
(0484 GOTO 999999                                                        GOTO 999999) showline
(0485 *---------------*                                                  *---------------*) showline
(0486 *  SUBROUTINES  *                                                  *  SUBROUTINES  *) showline
(0487 *---------------*                                                  *---------------*) showline
(0488 *                                                                  *) showline
(0489 *--- DIVISION                                                      *--- DIVISION) showline
(0490 *                                                                  *) showline
(0491 500 *                                                              500 *) showline
(0492                                                                 >  *  IF SCV.REC\(13\)<1> # "" THEN ECD.DEFAULT = JE.HEAD.DIV;* T) showline
(0493 ECD.DEFAULT = JE.HEAD.DIV; SCV.REC\(13\)<1> = JE.HEAD.DIV;* T232     ECD.DEFAULT = JE.HEAD.DIV; SCV.REC\(13\)<1> = JE.HEAD.DIV;* T2) showline
(0494 ECD.NUM = 13; ECD.ACTION = 4; CALL SCRN.EDIT                       ECD.NUM = 13; ECD.ACTION = 4; CALL SCRN.EDIT) showline
(0495 BEGIN CASE                                                         BEGIN CASE) showline
(0496 CASE ECD.RET.VALUE = "END"                                         CASE ECD.RET.VALUE = "END" ) showline
(0497 GOTO 1999                                                          GOTO 1999) showline
(0498 CASE ECD.RET.VALUE = "00"                                          CASE ECD.RET.VALUE = "00") showline
(0499 CASE ECD.RET.VALUE # ""                                            CASE ECD.RET.VALUE # "") showline
(0500 MATREAD DIV.REC FROM DIVISION,CONO:ECD.RET.VALUE ELSE              MATREAD DIV.REC FROM DIVISION,CONO:ECD.RET.VALUE ELSE) showline
(0501 ERRMSG = "NOT A VALID DIVISION"                                    ERRMSG = "NOT A VALID DIVISION") showline
(0502 GOSUB 91000                                                        GOSUB 91000) showline
(0503 GOTO 500                                                           GOTO 500) showline
(0504 END                                                                END) showline
(0505 IF JE.DIV # "" THEN                                                IF JE.DIV # "" THEN) showline
(0506 FOR X = 1 TO DCOUNT\(JE.DIV<1>,VM\)                                  FOR X = 1 TO DCOUNT\(JE.DIV<1>,VM\)) showline
(0507 IF JE.DIV<1,X> # ECD.RET.VALUE THEN                                IF JE.DIV<1,X> # ECD.RET.VALUE THEN) showline
(0508 ERRMSG = ECD.RET.VALUE:" DOES NOT MATCH JE.DIVISION\(S\) "           ERRMSG = ECD.RET.VALUE:" DOES NOT MATCH JE.DIVISION\(S\) ") showline
(0509 GOSUB 91000                                                        GOSUB 91000) showline
(0510 GOTO 500                                                           GOTO 500) showline
(0511 END                                                                END) showline
(0512 NEXT X                                                             NEXT X) showline
(0513 END                                                                END) showline
(0514 END CASE                                                           END CASE) showline
(0515 *T23278 v                                                          *T23278 v) showline
(0516 DIV.CODE = ECD.RET.VALUE; USER.ID = UPCASE\(@LOGNAME\); ERRMSG =     DIV.CODE = ECD.RET.VALUE; USER.ID = UPCASE\(@LOGNAME\); ERRMSG) showline
(0517 CALL CK.DIV.SEC.SUB\(CONO,DIV.CODE,USER.ID,ERRMSG\)                  CALL CK.DIV.SEC.SUB\(CONO,DIV.CODE,USER.ID,ERRMSG\)) showline
(0518 IF ERRMSG # '' THEN                                                IF ERRMSG # '' THEN) showline
(0519 GOSUB 91000; GOTO 500                                              GOSUB 91000; GOTO 500) showline
(0520 END                                                                END) showline
(0521 *T23278 ^                                                          *T23278 ^) showline
(0522 JE.HEAD.DIV = ECD.RET.VALUE                                        JE.HEAD.DIV = ECD.RET.VALUE) showline
(0523 RETURN                                                             RETURN) showline
(0524 *                                                                  *) showline
(0525 *--- PERIOD                                                        *--- PERIOD) showline
(0526 *                                                                  *) showline
(0527 1000 IF SCV.REC\(2\)<1> = "" THEN ECD.DEFAULT = CURR                 1000 IF SCV.REC\(2\)<1> = "" THEN ECD.DEFAULT = CURR) showline
(0528 IF CURR < \(NUM.PERIODS - 1\) THEN                                   IF CURR < \(NUM.PERIODS - 1\) THEN) showline
(0529 ECD.VALDAT = STR\("0",\(2-LEN\(CURR\)\)\):CURR:","                       ECD.VALDAT = STR\("0",\(2-LEN\(CURR\)\)\):CURR:",") showline
(0530 ECD.VALDAT = ECD.VALDAT:STR\("0",\(2-LEN\(CURR+1\)\)\):\(CURR+1\):","      ECD.VALDAT = ECD.VALDAT:STR\("0",\(2-LEN\(CURR+1\)\)\):\(CURR+1\):",) showline
(0531 ECD.VALDAT = ECD.VALDAT:STR\("0",\(2-LEN\(CURR+2\)\)\):\(CURR+2\)          ECD.VALDAT = ECD.VALDAT:STR\("0",\(2-LEN\(CURR+2\)\)\):\(CURR+2\)) showline
(0532 END ELSE                                                           END ELSE) showline
(0533 IF CURR = \(NUM.PERIODS - 1\) THEN ECD.VALDAT = \(NUM.PERIODS-1\):     IF CURR = \(NUM.PERIODS - 1\) THEN ECD.VALDAT = \(NUM.PERIODS-1) showline
(0534 IF CURR = NUM.PERIODS THEN ECD.VALDAT = NUM.PERIODS:",01,02"       IF CURR = NUM.PERIODS THEN ECD.VALDAT = NUM.PERIODS:",01,02") showline
(0535 END                                                                END) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0536 ECD.HMSG = "ENTER PERIOD ":ECD.VALDAT                              ECD.HMSG = "ENTER PERIOD ":ECD.VALDAT) showline
(0537 ECD.NUM = 2; ECD.ACTION = 4; CALL SCRN.EDIT                        ECD.NUM = 2; ECD.ACTION = 4; CALL SCRN.EDIT) showline
(0538 IF ECD.RET.VALUE = "END" THEN GOTO 1999                            IF ECD.RET.VALUE = "END" THEN GOTO 1999) showline
(0539 IF ECD.RET.VALUE < 1 OR ECD.RET.VALUE > NUM.PERIODS OR NOT\(NUM     IF ECD.RET.VALUE < 1 OR ECD.RET.VALUE > NUM.PERIODS OR NOT\(N) showline
(0540 IF CURR > \(NUM.PERIODS-2\) AND ECD.RET.VALUE < 3 THEN JE.PERIOD     IF CURR > \(NUM.PERIODS-2\) AND ECD.RET.VALUE < 3 THEN JE.PERI) showline
(0541 JE.PERIOD = JE.PERIOD:ECD.RET.VALUE                                JE.PERIOD = JE.PERIOD:ECD.RET.VALUE) showline
(0542 1999 RETURN                                                        1999 RETURN) showline
(0543 *                                                                  *) showline
(0544 *--- DATE                                                          *--- DATE) showline
(0545 *                                                                  *) showline
(0546 2000 ECD.NUM = 3                                                   2000 ECD.NUM = 3) showline
(0547 IF SCV.REC\(ECD.NUM\)<1> = "" THEN                                   IF SCV.REC\(ECD.NUM\)<1> = "" THEN) showline
(0548 XYR = JE.PERIOD[1,4]; XPR = JE.PERIOD[5,2]                         XYR = JE.PERIOD[1,4]; XPR = JE.PERIOD[5,2]) showline
(0549 BEGIN CASE                                                         BEGIN CASE) showline
(0550 CASE XYR = YEAR AND XPR < NUM.PERIODS                              CASE XYR = YEAR AND XPR < NUM.PERIODS) showline
(0551 ECD.DEFAULT = OPENDATES<XPR+1> - 1                                 ECD.DEFAULT = OPENDATES<XPR+1> - 1) showline
(0552 CASE XYR = YEAR                                                    CASE XYR = YEAR) showline
(0553 ECD.DEFAULT = OCONV\(OPENDATES<1>,"D/"\)                             ECD.DEFAULT = OCONV\(OPENDATES<1>,"D/"\)) showline
(0554 ECD.DEFAULT = ECD.DEFAULT[1,6] : ECD.DEFAULT[7,4] + 1              ECD.DEFAULT = ECD.DEFAULT[1,6] : ECD.DEFAULT[7,4] + 1) showline
(0555 ECD.DEFAULT = ICONV\(ECD.DEFAULT,"D/"\) - 1                          ECD.DEFAULT = ICONV\(ECD.DEFAULT,"D/"\) - 1) showline
(0556 CASE XPR < NUM.PERIODS                                             CASE XPR < NUM.PERIODS) showline
(0557 ECD.DEFAULT = OCONV\(OPENDATES<XPR+1>,"D/"\)                         ECD.DEFAULT = OCONV\(OPENDATES<XPR+1>,"D/"\)) showline
(0558 ECD.DEFAULT = ECD.DEFAULT[1,6] : ECD.DEFAULT[7,4] + 1              ECD.DEFAULT = ECD.DEFAULT[1,6] : ECD.DEFAULT[7,4] + 1) showline
(0559 ECD.DEFAULT = ICONV\(ECD.DEFAULT,"D/"\) - 1                          ECD.DEFAULT = ICONV\(ECD.DEFAULT,"D/"\) - 1) showline
(0560 END CASE                                                           END CASE) showline
(0561 END                                                                END) showline
(0562 ECD.ACTION = 4; CALL SCRN.EDIT                                     ECD.ACTION = 4; CALL SCRN.EDIT) showline
(0563 IF ECD.RET.VALUE # 'END' THEN                                      IF ECD.RET.VALUE # 'END' THEN) showline
(0564 JE.DATE = ECD.RET.VALUE                                            JE.DATE = ECD.RET.VALUE) showline
(0565 END                                                                END) showline
(0566 RETURN                                                             RETURN) showline
(0567 *                                                                  *) showline
(0568 *--- DESC                                                          *--- DESC) showline
(0569 *                                                                  *) showline
(0570 3000 ECD.NUM = 4; ECD.ACTION = 4; CALL SCRN.EDIT                   3000 ECD.NUM = 4; ECD.ACTION = 4; CALL SCRN.EDIT) showline
(0571 IF ECD.RET.VALUE # 'END' THEN                                      IF ECD.RET.VALUE # 'END' THEN) showline
(0572 JE.DESC = ECD.RET.VALUE                                            JE.DESC = ECD.RET.VALUE) showline
(0573 END                                                                END) showline
(0574 RETURN                                                             RETURN) showline
(0575 *--- LINE ENTRY                                                    *--- LINE ENTRY) showline
(0576 *                                                                  *) showline
(0577 10000 *                                                            10000 *) showline
(0578 GOSUB 80000                                                        GOSUB 80000) showline
(0579 SLN = BEGIN.PAGE + LINE.SPACE * MOD\(LN-1,PAGE.SIZE\)                SLN = BEGIN.PAGE + LINE.SPACE * MOD\(LN-1,PAGE.SIZE\)) showline
(0580 P_X  = 0 ; P_Y = SLN ; P_VALUE = LN "R#3" ; P_OPT = "CL"           P_X  = 0 ; P_Y = SLN ; P_VALUE = LN "R#3" ; P_OPT = "CL") showline
(0581 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0582 LINES = LINES + 1                                                  LINES = LINES + 1) showline
(0583 10100 *                                                            10100 *) showline
(0584 P_X  = 4 ; P_Y = SLN ; P_VALUE = SP16 ; P_OPT = ""                 P_X  = 4 ; P_Y = SLN ; P_VALUE = SP16 ; P_OPT = "") showline
(0585 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0586 IF JE.CR.AMT<1,LN> > 0 THEN AC.X = 6 ELSE AC.X = 4                 IF JE.CR.AMT<1,LN> > 0 THEN AC.X = 6 ELSE AC.X = 4) showline
(0587 IF JE.CR.AMT<1,LN> > 0 THEN ECD.COLOR = 4                          IF JE.CR.AMT<1,LN> > 0 THEN ECD.COLOR = 4) showline
(0588                                                                 >  *      X = AC.X; Y = SLN; TYP = 1; O.R = 'R') showline
(0589 X = 4; Y = SLN; TYP = 1; O.R = 'R'                                 X = 4; Y = SLN; TYP = 1; O.R = 'R') showline
(0590 MAXL = ACCT.LEN; JUSTIFY = 'L'                                     MAXL = ACCT.LEN; JUSTIFY = 'L') showline
(0591 IF JE.ACCT<1,LN> # '' THEN                                         IF JE.ACCT<1,LN> # '' THEN) showline
(0592 O.R = 'O'; DEFAULT = JE.ACCT<1,LN>                                 O.R = 'O'; DEFAULT = JE.ACCT<1,LN>) showline
(0593 END                                                                END) showline
(0594 CALL EDIT.SUB                                                      CALL EDIT.SUB) showline
(0595 IF VALUE = 'END' THEN                                              IF VALUE = 'END' THEN) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0596 IF OPTION = 'A' THEN                                               IF OPTION = 'A' THEN) showline
(0597 P_X  = 0 ; P_Y = SLN ; P_VALUE = "" ; P_OPT = "CL"                 P_X  = 0 ; P_Y = SLN ; P_VALUE = "" ; P_OPT = "CL") showline
(0598 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0599 P_X  = 0 ; P_Y = SLN+1 ; P_VALUE = "" ; P_OPT = "CL"               P_X  = 0 ; P_Y = SLN+1 ; P_VALUE = "" ; P_OPT = "CL") showline
(0600 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0601 JE.ACCT = DELETE\(JE.ACCT,1,LN,0\)                                   JE.ACCT = DELETE\(JE.ACCT,1,LN,0\)) showline
(0602 JE.DIV = DELETE\(JE.DIV,1,LN,0\)                                     JE.DIV = DELETE\(JE.DIV,1,LN,0\)) showline
(0603 JE.DEPT = DELETE\(JE.DEPT,1,LN,0\)                                   JE.DEPT = DELETE\(JE.DEPT,1,LN,0\)) showline
(0604 JE.CCTR = DELETE\(JE.CCTR,1,LN,0\)                                   JE.CCTR = DELETE\(JE.CCTR,1,LN,0\)) showline
(0605 JE.DB.AMT = DELETE\(JE.DB.AMT,1,LN,0\)                               JE.DB.AMT = DELETE\(JE.DB.AMT,1,LN,0\)) showline
(0606 JE.CR.AMT = DELETE\(JE.CR.AMT,1,LN,0\)                               JE.CR.AMT = DELETE\(JE.CR.AMT,1,LN,0\)) showline
(0607 JE.CMT = DELETE\(JE.CMT,1,LN,0\) ;* CAF1 15973                       JE.CMT = DELETE\(JE.CMT,1,LN,0\) ;* CAF1 15973) showline
(0608 LINE.TYPE = DELETE\(LINE.TYPE,LN,0,0\)                               LINE.TYPE = DELETE\(LINE.TYPE,LN,0,0\)) showline
(0609 LINE.NORM = DELETE\(LINE.NORM,LN,0,0\)                               LINE.NORM = DELETE\(LINE.NORM,LN,0,0\)) showline
(0610 LINE.CAT = DELETE\(LINE.CAT,LN,0,0\)                                 LINE.CAT = DELETE\(LINE.CAT,LN,0,0\)) showline
(0611 LINE.SUB = DELETE\(LINE.SUB,LN,0,0\)                                 LINE.SUB = DELETE\(LINE.SUB,LN,0,0\)) showline
(0612 LINE.DESC = DELETE\(LINE.DESC,LN,0,0\)                               LINE.DESC = DELETE\(LINE.DESC,LN,0,0\)) showline
(0613 END ELSE                                                           END ELSE) showline
(0614 P_X  = 4 ; P_Y = SLN ; P_VALUE = JE.ACCT<1,LN> CO.ACCT.MASK ;      P_X  = 4 ; P_Y = SLN ; P_VALUE = JE.ACCT<1,LN> CO.ACCT.MASK ) showline
(0615 P_X  := AM:22 ; P_Y := AM:SLN ; P_VALUE := AM:LINE.TYPE<LN> "L     P_X  := AM:22 ; P_Y := AM:SLN ; P_VALUE := AM:LINE.TYPE<LN> ) showline
(0616 P_X  := AM:26 ; P_Y := AM:SLN ; P_VALUE := AM:LINE.NORM<LN> "L     P_X  := AM:26 ; P_Y := AM:SLN ; P_VALUE := AM:LINE.NORM<LN> ) showline
(0617 P_X  := AM:30 ; P_Y := AM:SLN ; P_VALUE := AM:LINE.CAT<LN> "L#     P_X  := AM:30 ; P_Y := AM:SLN ; P_VALUE := AM:LINE.CAT<LN> ") showline
(0618 P_X  := AM:34 ; P_Y := AM:SLN ; P_VALUE := AM:LINE.SUB<LN> "L#     P_X  := AM:34 ; P_Y := AM:SLN ; P_VALUE := AM:LINE.SUB<LN> ") showline
(0619 P_X  := AM:DV.X ; P_Y := AM:SLN ; P_VALUE := AM:JE.DIV<1,LN> "     P_X  := AM:DV.X ; P_Y := AM:SLN ; P_VALUE := AM:JE.DIV<1,LN>) showline
(0620 P_X  := AM:DP.X ; P_Y := AM:SLN ; P_VALUE := AM:JE.DEPT<1,LN>      P_X  := AM:DP.X ; P_Y := AM:SLN ; P_VALUE := AM:JE.DEPT<1,LN) showline
(0621 P_X  := AM:CC.X ; P_Y := AM:SLN ; P_VALUE := AM:JE.CCTR<1,LN>      P_X  := AM:CC.X ; P_Y := AM:SLN ; P_VALUE := AM:JE.CCTR<1,LN) showline
(0622 P_X  := AM:52 ; P_Y := AM:SLN ; P_VALUE := AM:OCONV\(JE.DB.AMT<     P_X  := AM:52 ; P_Y := AM:SLN ; P_VALUE := AM:OCONV\(JE.DB.AM) showline
(0623 P_X  := AM:66 ; P_Y := AM:SLN ; P_VALUE := AM:OCONV\(JE.CR.AMT<     P_X  := AM:66 ; P_Y := AM:SLN ; P_VALUE := AM:OCONV\(JE.CR.AM) showline
(0624 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0625 P_X = 0 ; P_Y = SLN+1 ; P_VALUE = "" ; P_OPT = "CL"                P_X = 0 ; P_Y = SLN+1 ; P_VALUE = "" ; P_OPT = "CL") showline
(0626                                                                 >  *            P_X  := AM:AC.X ; P_Y := AM:SLN+1 ; P_VALUE := ) showline
(0627 P_X  := AM:4 ; P_Y := AM:SLN+1 ; P_VALUE := AM:LINE.DESC<LN> "     P_X  := AM:4 ; P_Y := AM:SLN+1 ; P_VALUE := AM:LINE.DESC<LN>) showline
(0628 P_X  := AM:4+34 ; P_Y := AM:SLN+1 ; P_VALUE := AM:JE.CMT<1,LN>     P_X  := AM:4+34 ; P_Y := AM:SLN+1 ; P_VALUE := AM:JE.CMT<1,L) showline
(0629 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0630 END                                                                END) showline
(0631 GOTO 19999                                                         GOTO 19999) showline
(0632 END                                                                END) showline
(0633 GXR.ACTION = ""                                                    GXR.ACTION = "") showline
(0634 BEGIN CASE                                                         BEGIN CASE) showline
(0635 CASE VALUE = "D"                                                   CASE VALUE = "D") showline
(0636 P_X  = 0 ; P_Y = Y ; P_VALUE = "" ; P_OPT = "CL"                   P_X  = 0 ; P_Y = Y ; P_VALUE = "" ; P_OPT = "CL") showline
(0637 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0638                                                                 >  *            X = AC.X; Y = SLN + 1; TYP = 1; MAXL = 30; O.R ) showline
(0639 X = 4; Y = SLN + 1; TYP = 1; MAXL = 30; O.R = 'O'; DEFAULT = L     X = 4; Y = SLN + 1; TYP = 1; MAXL = 30; O.R = 'O'; DEFAULT =) showline
(0640 CALL EDIT.SUB                                                      CALL EDIT.SUB) showline
(0641 IF VALUE = '' OR VALUE = 'END' THEN GOTO 10100                     IF VALUE = '' OR VALUE = 'END' THEN GOTO 10100) showline
(0642 GXR.ACTION = "D"                                                   GXR.ACTION = "D") showline
(0643 CASE VALUE = "T"                                                   CASE VALUE = "T") showline
(0644 P_X  = 0 ; P_Y = Y ; P_VALUE = "" ; P_OPT = "CL"                   P_X  = 0 ; P_Y = Y ; P_VALUE = "" ; P_OPT = "CL") showline
(0645 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0646 X = 4; Y = SLN + 1; TYP = 1; MAXL = 1; O.R = 'O'; DEFAULT = LI     X = 4; Y = SLN + 1; TYP = 1; MAXL = 1; O.R = 'O'; DEFAULT = ) showline
(0647 CALL EDIT.SUB                                                      CALL EDIT.SUB) showline
(0648 IF VALUE = '' OR VALUE = 'END' THEN GOTO 10100                     IF VALUE = '' OR VALUE = 'END' THEN GOTO 10100) showline
(0649 MATREAD AT.REC FROM ACCT.TYPE, VALUE ELSE                          MATREAD AT.REC FROM ACCT.TYPE, VALUE ELSE) showline
(0650 ERRMSG = 'INVALID ACCOUNT TYPE'                                    ERRMSG = 'INVALID ACCOUNT TYPE') showline
(0651 GOSUB 91000; GOTO 10100                                            GOSUB 91000; GOTO 10100) showline
(0652 END                                                                END) showline
(0653 GXR.ACTION = "C"                                                   GXR.ACTION = "C") showline
(0654 CASE LEN\(VALUE\) < BASE.LEN                                         CASE LEN\(VALUE\) < BASE.LEN) showline
(0655 ERRMSG = "** MINIMUM LENGTH  = " : BASE.LEN : " **"                ERRMSG = "** MINIMUM LENGTH  = " : BASE.LEN : " **") showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0656 GOSUB 91000; GOTO 10100                                            GOSUB 91000; GOTO 10100) showline
(0657 CASE NOT\(NUM\(VALUE\)\)                                               CASE NOT\(NUM\(VALUE\)\)) showline
(0658 ERRMSG = "** NUMERIC INPUT REQUIRED **"                            ERRMSG = "** NUMERIC INPUT REQUIRED **") showline
(0659 GOSUB 91000; GOTO 10100                                            GOSUB 91000; GOTO 10100) showline
(0660 END CASE                                                           END CASE) showline
(0661 IF GXR.ACTION # "" THEN                                            IF GXR.ACTION # "" THEN) showline
(0662 GXR.SRCH.ID = VALUE; GXR.ID = ''; GXR.FILE = COA                   GXR.SRCH.ID = VALUE; GXR.ID = ''; GXR.FILE = COA) showline
(0663 CALL COA.GEN.XREF\(MAT GEN.XREF.REC,PREFIX\)                      |  *T28098 v) showline
(0664                                                                 >  *     CALL COA.GEN.XREF\(MAT GEN.XREF.REC,PREFIX\)) showline
(0665                                                                 >  CALL COA.GEN.XREF.SUB\(MAT GEN.XREF.REC,PREFIX\)) showline
(0666                                                                 >  *T28098 ^) showline
(0667 ECD.ACTION = 2; CALL SCRN.EDIT                                     ECD.ACTION = 2; CALL SCRN.EDIT) showline
(0668 ECD.ACTION = 3; CALL SCRN.EDIT                                     ECD.ACTION = 3; CALL SCRN.EDIT) showline
(0669 OLD.START = 0; GOSUB 80000                                         OLD.START = 0; GOSUB 80000) showline
(0670 IF GXR.ID = '' THEN                                                IF GXR.ID = '' THEN) showline
(0671 GOTO 10100                                                         GOTO 10100) showline
(0672 END                                                                END) showline
(0673 VALUE = GXR.ID                                                     VALUE = GXR.ID) showline
(0674 END ELSE                                                           END ELSE) showline
(0675 VALUE = VALUE : STR\("0",ACCT.LEN-LEN\(VALUE\)\)                       VALUE = VALUE : STR\("0",ACCT.LEN-LEN\(VALUE\)\)) showline
(0676 END                                                                END) showline
(0677 MATREAD COA.REC FROM COA, CONO:VALUE ELSE                          MATREAD COA.REC FROM COA, CONO:VALUE ELSE) showline
(0678 ERRMSG = 'CANNOT LOCATE ACCOUNT : ' : VALUE CO.ACCT.MASK           ERRMSG = 'CANNOT LOCATE ACCOUNT : ' : VALUE CO.ACCT.MASK) showline
(0679 GOSUB 91000; GOTO 10100                                            GOSUB 91000; GOTO 10100) showline
(0680 END                                                                END) showline
(0681 JE.ACCT<1,LN> = VALUE                                              JE.ACCT<1,LN> = VALUE) showline
(0682 GOSUB 40000                                                        GOSUB 40000) showline
(0683 DV.NO = JE.DIV<1,LN>                                               DV.NO = JE.DIV<1,LN>) showline
(0684 DP.NO = JE.DEPT<1,LN>                                              DP.NO = JE.DEPT<1,LN>) showline
(0685 CC.NO = JE.CCTR<1,LN>                                              CC.NO = JE.CCTR<1,LN>) showline
(0686 *COPY>PMCBP>DV.DP.CC.MAINT                                         *COPY>PMCBP>DV.DP.CC.MAINT) showline
(0687 *                                                                  *) showline
(0688 10500 *                                                            10500 *) showline
(0689 IF EQV.FLG = 1 THEN                                                IF EQV.FLG = 1 THEN) showline
(0690 READ N.KEY FROM COA.EQUIV , CONO:DV.NO:DP.NO:CC.NO:JE.ACCT<1,L     READ N.KEY FROM COA.EQUIV , CONO:DV.NO:DP.NO:CC.NO:JE.ACCT<1) showline
(0691 IF N.KEY # "" THEN                                                 IF N.KEY # "" THEN) showline
(0692 UPD.FLG = 1                                                        UPD.FLG = 1) showline
(0693 MATREAD COA.REC FROM COA, CONO:N.KEY[11,ACCT.LEN] ELSE             MATREAD COA.REC FROM COA, CONO:N.KEY[11,ACCT.LEN] ELSE) showline
(0694 ERRMSG = "CANNOT LOCATE EQUIVALENT ACCOUNT : ": N.KEY[11,ACCT.     ERRMSG = "CANNOT LOCATE EQUIVALENT ACCOUNT : ": N.KEY[11,ACC) showline
(0695 GOSUB 91000                                                        GOSUB 91000) showline
(0696 UPD.FLG = 0                                                        UPD.FLG = 0) showline
(0697 END                                                                END) showline
(0698 IF UPD.FLG = 1 THEN                                                IF UPD.FLG = 1 THEN) showline
(0699 JE.ACCT<1,LN> = N.KEY[11,ACCT.LEN]                                 JE.ACCT<1,LN> = N.KEY[11,ACCT.LEN]) showline
(0700 GOSUB 40000                                                        GOSUB 40000) showline
(0701 DV.NO = N.KEY[4,2]                                                 DV.NO = N.KEY[4,2]) showline
(0702 DP.NO = N.KEY[6,2]                                                 DP.NO = N.KEY[6,2]) showline
(0703 CC.NO = N.KEY[8,3]                                                 CC.NO = N.KEY[8,3]) showline
(0704 P_X  = DV.X ; P_Y = SLN ; P_VALUE = DV.NO "L#2" ; P_OPT = ""       P_X  = DV.X ; P_Y = SLN ; P_VALUE = DV.NO "L#2" ; P_OPT = "") showline
(0705 P_X  := AM:DP.X ; P_Y := AM:SLN ; P_VALUE := AM:DP.NO "L#2"        P_X  := AM:DP.X ; P_Y := AM:SLN ; P_VALUE := AM:DP.NO "L#2") showline
(0706 P_X  := AM:CC.X ; P_Y := AM:SLN ; P_VALUE := AM:CC.NO "L#3"        P_X  := AM:CC.X ; P_Y := AM:SLN ; P_VALUE := AM:CC.NO "L#3") showline
(0707 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0708 END                                                                END) showline
(0709 END                                                                END) showline
(0710 END                                                                END) showline
(0711 JE.DIV<1,LN> = DV.NO                                               JE.DIV<1,LN> = DV.NO) showline
(0712 JE.DEPT<1,LN> = DP.NO                                              JE.DEPT<1,LN> = DP.NO) showline
(0713 JE.CCTR<1,LN> = CC.NO                                              JE.CCTR<1,LN> = CC.NO) showline
(0714 * TASK 20731 v                                                     * TASK 20731 v) showline
(0715 IF JE.HEAD.DIV # "00" THEN                                         IF JE.HEAD.DIV # "00" THEN) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0716 IF DV.NO # JE.HEAD.DIV THEN                                        IF DV.NO # JE.HEAD.DIV THEN) showline
(0717 ERRMSG = "DIVISION MUST MATCH THE DIVISION IN THE HEADER"          ERRMSG = "DIVISION MUST MATCH THE DIVISION IN THE HEADER") showline
(0718 GOSUB 91000                                                        GOSUB 91000) showline
(0719 JE.DIV<1,LN> = ''                                                  JE.DIV<1,LN> = '') showline
(0720 JE.DEPT<1,LN> = ''                                                 JE.DEPT<1,LN> = '') showline
(0721 JE.CCTR<1,LN> = ''                                                 JE.CCTR<1,LN> = '') showline
(0722 GOTO 10000                                                         GOTO 10000) showline
(0723 END                                                                END) showline
(0724 END                                                                END) showline
(0725 * TASK 20731 ^                                                     * TASK 20731 ^) showline
(0726                                                                 >  *<<<<<       CAF1 15973) showline
(0727 10501 *                                                            10501 *) showline
(0728                                                                 >  *      X = AC.X+34; Y = SLN + 1; TYP = 1; MAXL = 40; O.R = ') showline
(0729 X = 4+34; Y = SLN + 1; TYP = 1; MAXL = 40; O.R = 'O'               X = 4+34; Y = SLN + 1; TYP = 1; MAXL = 40; O.R = 'O') showline
(0730 IF JE.CMT<1,LN> # "" THEN                                          IF JE.CMT<1,LN> # "" THEN) showline
(0731 DEFAULT = JE.CMT<1,LN>                                             DEFAULT = JE.CMT<1,LN>) showline
(0732 END ELSE                                                           END ELSE) showline
(0733 DEFAULT = JE.DESC "L#40"                                           DEFAULT = JE.DESC "L#40") showline
(0734 END                                                                END) showline
(0735 CALL EDIT.SUB                                                      CALL EDIT.SUB) showline
(0736 IF VALUE = 'END' THEN GOTO 10100                                   IF VALUE = 'END' THEN GOTO 10100) showline
(0737 JE.CMT<1,LN> = VALUE                                               JE.CMT<1,LN> = VALUE) showline
(0738                                                                 >  *>>>>>) showline
(0739 IF JE.CR.AMT<1,LN> > 0 THEN GOTO 10550                             IF JE.CR.AMT<1,LN> > 0 THEN GOTO 10550) showline
(0740 IF JE.DB.AMT<1,LN> < 1 AND LINE.NORM<LN> = 'CR' THEN GOTO 1055     IF JE.DB.AMT<1,LN> < 1 AND LINE.NORM<LN> = 'CR' THEN GOTO 10) showline
(0741 10510 *                                                            10510 *) showline
(0742 IF AC.X = 6 THEN                                                   IF AC.X = 6 THEN) showline
(0743 AC.X = 4                                                           AC.X = 4) showline
(0744                                                                 >  *         P_X  = AC.X ; P_Y = SLN ; P_VALUE = JE.ACCT<1,LN> ) showline
(0745 P_X  = 4 ; P_Y = SLN ; P_VALUE = JE.ACCT<1,LN> CO.ACCT.MASK:SP     P_X  = 4 ; P_Y = SLN ; P_VALUE = JE.ACCT<1,LN> CO.ACCT.MASK:) showline
(0746 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0747                                                                 >  *<<<<<        CAF1 15973) showline
(0748                                                                 >  *         P_X  = AC.X ; P_Y = SLN+1 ; P_VALUE = LINE.DESC<LN) showline
(0749 P_X  = 4 ; P_Y = SLN+1 ; P_VALUE = LINE.DESC<LN> "L#32":SPACE\(     P_X  = 4 ; P_Y = SLN+1 ; P_VALUE = LINE.DESC<LN> "L#32":SPAC) showline
(0750 P_X  := AM:4+34 ; P_Y := AM:SLN+1 ; P_VALUE := AM:JE.CMT<1,LN>     P_X  := AM:4+34 ; P_Y := AM:SLN+1 ; P_VALUE := AM:JE.CMT<1,L) showline
(0751 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0752                                                                 >  *>>>>>>>) showline
(0753 END                                                                END) showline
(0754 X = 52; Y = SLN; TYP = 4; SCALER = 2                               X = 52; Y = SLN; TYP = 4; SCALER = 2) showline
(0755 MAXL = 11; MINV = 0; MAXV = 9999999999                             MAXL = 11; MINV = 0; MAXV = 9999999999) showline
(0756 DEFAULT = OCONV\(JE.DB.AMT<1,LN>,'MD2'\)                             DEFAULT = OCONV\(JE.DB.AMT<1,LN>,'MD2'\)) showline
(0757 O.R = "O"                                                          O.R = "O") showline
(0758 CALL EDIT.SUB                                                      CALL EDIT.SUB) showline
(0759 IF VALUE = "END" THEN                                              IF VALUE = "END" THEN) showline
(0760 IF OPTION = "A" THEN GOTO 10100 ELSE VALUE = ""                    IF OPTION = "A" THEN GOTO 10100 ELSE VALUE = "") showline
(0761 END                                                                END) showline
(0762 TOT.DEBIT = TOT.DEBIT - JE.DB.AMT<1,LN> + VALUE                    TOT.DEBIT = TOT.DEBIT - JE.DB.AMT<1,LN> + VALUE) showline
(0763 JE.DB.AMT<1,LN> = VALUE                                            JE.DB.AMT<1,LN> = VALUE) showline
(0764 P_X  = 52 ; P_Y = SLN ; P_VALUE = OCONV\(VALUE,"MD2Z"\) "R#13" ;     P_X  = 52 ; P_Y = SLN ; P_VALUE = OCONV\(VALUE,"MD2Z"\) "R#13") showline
(0765 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0766 IF VALUE > 0 THEN                                                  IF VALUE > 0 THEN) showline
(0767 TOT.CREDIT = TOT.CREDIT - JE.CR.AMT<1,LN>                          TOT.CREDIT = TOT.CREDIT - JE.CR.AMT<1,LN>) showline
(0768 JE.CR.AMT<1,LN> = ""                                               JE.CR.AMT<1,LN> = "") showline
(0769 P_X  = 66 ; P_Y = SLN ; P_VALUE = OCONV\(JE.CR.AMT<1,LN>,"MD2Z"     P_X  = 66 ; P_Y = SLN ; P_VALUE = OCONV\(JE.CR.AMT<1,LN>,"MD2) showline
(0770 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0771 GOTO 19999                                                         GOTO 19999) showline
(0772 END                                                                END) showline
(0773 10550 *                                                            10550 *) showline
(0774 IF AC.X = 4 THEN                                                   IF AC.X = 4 THEN) showline
(0775 AC.X = 6                                                           AC.X = 6) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0776 ECD.COLOR = 6                                                      ECD.COLOR = 6) showline
(0777 P_X  = 4 ; P_Y = SLN ; P_VALUE = SPACE\(2\):JE.ACCT<1,LN> CO.ACC     P_X  = 4 ; P_Y = SLN ; P_VALUE = SPACE\(2\):JE.ACCT<1,LN> CO.A) showline
(0778 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0779                                                                 >  *<<<<        CAF1 15973) showline
(0780 P_X  = 4 ; P_Y = SLN+1 ; P_VALUE = SPACE\(2\):LINE.DESC<LN> "L#3     P_X  = 4 ; P_Y = SLN+1 ; P_VALUE = SPACE\(2\):LINE.DESC<LN> "L) showline
(0781 P_X  := AM:38 ; P_Y := AM:SLN+1 ; P_VALUE := AM:SPACE\(2\):JE.CM     P_X  := AM:38 ; P_Y := AM:SLN+1 ; P_VALUE := AM:SPACE\(2\):JE.) showline
(0782 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0783                                                                 >  *>>>>) showline
(0784 END                                                                END) showline
(0785 X = 66; Y = SLN; TYP = 4; SCALER = 2                               X = 66; Y = SLN; TYP = 4; SCALER = 2) showline
(0786 MAXL = 11; MINV = 0; MAXV = 9999999999                             MAXL = 11; MINV = 0; MAXV = 9999999999) showline
(0787 DEFAULT = OCONV\(JE.CR.AMT<1,LN>,'MD2'\)                             DEFAULT = OCONV\(JE.CR.AMT<1,LN>,'MD2'\)) showline
(0788 O.R = "O"                                                          O.R = "O") showline
(0789 CALL EDIT.SUB                                                      CALL EDIT.SUB) showline
(0790 IF VALUE = "END" THEN                                              IF VALUE = "END" THEN) showline
(0791 IF OPTION = "A" THEN GOTO 10100 ELSE VALUE = ""                    IF OPTION = "A" THEN GOTO 10100 ELSE VALUE = "") showline
(0792 END                                                                END) showline
(0793 TOT.CREDIT = TOT.CREDIT - JE.CR.AMT<1,LN> + VALUE                  TOT.CREDIT = TOT.CREDIT - JE.CR.AMT<1,LN> + VALUE) showline
(0794 JE.CR.AMT<1,LN> = VALUE                                            JE.CR.AMT<1,LN> = VALUE) showline
(0795 P_X  = 66 ; P_Y = SLN ; P_VALUE = OCONV\(VALUE,"MD2Z"\) "R#13" ;     P_X  = 66 ; P_Y = SLN ; P_VALUE = OCONV\(VALUE,"MD2Z"\) "R#13") showline
(0796 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0797 IF VALUE > 0 THEN                                                  IF VALUE > 0 THEN) showline
(0798 TOT.DEBIT = TOT.DEBIT - JE.DB.AMT<1,LN>                            TOT.DEBIT = TOT.DEBIT - JE.DB.AMT<1,LN>) showline
(0799 JE.DB.AMT<1,LN> = ""                                               JE.DB.AMT<1,LN> = "") showline
(0800 P_X  = 52 ; P_Y = SLN ; P_VALUE = OCONV\(JE.DB.AMT<1,LN>,"MD2Z"     P_X  = 52 ; P_Y = SLN ; P_VALUE = OCONV\(JE.DB.AMT<1,LN>,"MD2) showline
(0801 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0802 END ELSE                                                           END ELSE) showline
(0803 GOTO 10510                                                         GOTO 10510) showline
(0804 END                                                                END) showline
(0805 19999 *                                                            19999 *) showline
(0806 GOSUB 20000                                                        GOSUB 20000) showline
(0807 LINES = COUNT\(JE.ACCT,VM\) + \(JE.ACCT # ""\)                         LINES = COUNT\(JE.ACCT,VM\) + \(JE.ACCT # ""\)) showline
(0808 RETURN                                                             RETURN) showline
(0809 *                                                                  *) showline
(0810 *--- FIND BALANCE                                                  *--- FIND BALANCE) showline
(0811 *                                                                  *) showline
(0812 20000 *                                                            20000 *) showline
(0813 BEGIN CASE                                                         BEGIN CASE) showline
(0814 CASE TOT.DEBIT > TOT.CREDIT                                        CASE TOT.DEBIT > TOT.CREDIT) showline
(0815 SCV.REC\(5\)<1> = "OUT OF"                                           SCV.REC\(5\)<1> = "OUT OF") showline
(0816 SCV.REC\(6\)<1> = TOT.DEBIT - TOT.CREDIT                             SCV.REC\(6\)<1> = TOT.DEBIT - TOT.CREDIT) showline
(0817 SCV.REC\(7\)<1> = "DB"                                               SCV.REC\(7\)<1> = "DB") showline
(0818 CASE TOT.CREDIT > TOT.DEBIT                                        CASE TOT.CREDIT > TOT.DEBIT) showline
(0819 SCV.REC\(5\)<1> = "OUT OF"                                           SCV.REC\(5\)<1> = "OUT OF") showline
(0820 SCV.REC\(6\)<1> = TOT.CREDIT - TOT.DEBIT                             SCV.REC\(6\)<1> = TOT.CREDIT - TOT.DEBIT) showline
(0821 SCV.REC\(7\)<1> = "CR"                                               SCV.REC\(7\)<1> = "CR") showline
(0822 CASE 1                                                             CASE 1) showline
(0823 SCV.REC\(5\)<1> = "IN"                                               SCV.REC\(5\)<1> = "IN") showline
(0824 SCV.REC\(6\)<1> = ''                                                 SCV.REC\(6\)<1> = '') showline
(0825 SCV.REC\(7\)<1> = ""                                                 SCV.REC\(7\)<1> = "") showline
(0826 END CASE                                                           END CASE) showline
(0827 ECD.NUM = 5                                                        ECD.NUM = 5) showline
(0828 ECD.ACTION = 5; CALL SCRN.EDIT                                     ECD.ACTION = 5; CALL SCRN.EDIT) showline
(0829 ECD.NUM = 6                                                        ECD.NUM = 6) showline
(0830 ECD.ACTION = 5; CALL SCRN.EDIT                                     ECD.ACTION = 5; CALL SCRN.EDIT) showline
(0831 ECD.NUM = 7                                                        ECD.NUM = 7) showline
(0832 ECD.ACTION = 5; CALL SCRN.EDIT                                     ECD.ACTION = 5; CALL SCRN.EDIT) showline
(0833 ECD.NUM = 8; SCV.REC\(ECD.NUM\)<1> = TOT.DEBIT                       ECD.NUM = 8; SCV.REC\(ECD.NUM\)<1> = TOT.DEBIT) showline
(0834 ECD.ACTION = 5; CALL SCRN.EDIT                                     ECD.ACTION = 5; CALL SCRN.EDIT) showline
(0835 ECD.NUM = 9; SCV.REC\(ECD.NUM\)<1> = TOT.CREDIT                      ECD.NUM = 9; SCV.REC\(ECD.NUM\)<1> = TOT.CREDIT) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0836 ECD.ACTION = 5; CALL SCRN.EDIT                                     ECD.ACTION = 5; CALL SCRN.EDIT) showline
(0837 RETURN                                                             RETURN) showline
(0838 *                                                                  *) showline
(0839 *--- GET LINE NUMBER                                               *--- GET LINE NUMBER) showline
(0840 *                                                                  *) showline
(0841 30000 *                                                            30000 *) showline
(0842 GOSUB 80000                                                        GOSUB 80000) showline
(0843 ECD.MINV = ST.LINE                                                 ECD.MINV = ST.LINE) showline
(0844 ECD.MAXV = LST.LINE                                                ECD.MAXV = LST.LINE) showline
(0845 ECD.NUM = 11                                                       ECD.NUM = 11) showline
(0846 ECD.ACTION = 4; CALL SCRN.EDIT                                     ECD.ACTION = 4; CALL SCRN.EDIT) showline
(0847 IF ECD.RET.VALUE = "END" THEN LNO = 0 ELSE LNO = ECD.RET.VALUE     IF ECD.RET.VALUE = "END" THEN LNO = 0 ELSE LNO = ECD.RET.VAL) showline
(0848 RETURN                                                             RETURN) showline
(0849 *                                                                  *) showline
(0850 *---- MOVE AND PRINT ACCOUNT VALUES                                *---- MOVE AND PRINT ACCOUNT VALUES) showline
(0851 *                                                                  *) showline
(0852 40000 *                                                            40000 *) showline
(0853 LINE.DESC<LN> = COA.L.DESC                                         LINE.DESC<LN> = COA.L.DESC) showline
(0854 LINE.TYPE<LN> = COA.TYPE                                           LINE.TYPE<LN> = COA.TYPE) showline
(0855 LINE.NORM<LN> = COA.NORM                                           LINE.NORM<LN> = COA.NORM) showline
(0856 LINE.CAT<LN> = COA.CATG                                            LINE.CAT<LN> = COA.CATG) showline
(0857 LINE.SUB<LN> = COA.SUB.CATG                                        LINE.SUB<LN> = COA.SUB.CATG) showline
(0858 BEGIN CASE                                                         BEGIN CASE) showline
(0859 CASE JE.DB.AMT<1,LN> > 0                                           CASE JE.DB.AMT<1,LN> > 0) showline
(0860 AC.X = 4                                                           AC.X = 4) showline
(0861 CASE JE.CR.AMT<1,LN> > 0                                           CASE JE.CR.AMT<1,LN> > 0) showline
(0862 AC.X = 6                                                           AC.X = 6) showline
(0863 CASE LINE.NORM<LN> = 'CR'                                          CASE LINE.NORM<LN> = 'CR') showline
(0864 AC.X = 6                                                           AC.X = 6) showline
(0865 CASE 1                                                             CASE 1) showline
(0866 AC.X = 4                                                           AC.X = 4) showline
(0867 END CASE                                                           END CASE) showline
(0868 P_X  = 4 ; P_Y = SLN ; P_VALUE = SP16 ; P_OPT = ""                 P_X  = 4 ; P_Y = SLN ; P_VALUE = SP16 ; P_OPT = "") showline
(0869                                                                 >  *      P_X  := AM:AC.X ; P_Y := AM:SLN ; P_VALUE := AM:JE.AC) showline
(0870 P_X  := AM:4 ; P_Y := AM:SLN ; P_VALUE := AM:JE.ACCT<1,LN> CO.     P_X  := AM:4 ; P_Y := AM:SLN ; P_VALUE := AM:JE.ACCT<1,LN> C) showline
(0871 P_X  := AM:22 ; P_Y := AM:SLN ; P_VALUE := AM:COA.TYPE "L#1"       P_X  := AM:22 ; P_Y := AM:SLN ; P_VALUE := AM:COA.TYPE "L#1") showline
(0872 P_X  := AM:26 ; P_Y := AM:SLN ; P_VALUE := AM:COA.NORM "L#2"       P_X  := AM:26 ; P_Y := AM:SLN ; P_VALUE := AM:COA.NORM "L#2") showline
(0873 P_X  := AM:30 ; P_Y := AM:SLN ; P_VALUE := AM:COA.CATG "L#3"       P_X  := AM:30 ; P_Y := AM:SLN ; P_VALUE := AM:COA.CATG "L#3") showline
(0874 P_X  := AM:34 ; P_Y := AM:SLN ; P_VALUE := AM:COA.SUB.CATG "L#     P_X  := AM:34 ; P_Y := AM:SLN ; P_VALUE := AM:COA.SUB.CATG ") showline
(0875 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0876 P_X  = 0 ; P_Y = SLN+1 ; P_VALUE = "" ; P_OPT = ""                 P_X  = 0 ; P_Y = SLN+1 ; P_VALUE = "" ; P_OPT = "") showline
(0877 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0878                                                                 >  *<<<<        CAF1 15973) showline
(0879                                                                 >  *      P_X  = AC.X ; P_Y = SLN+1 ; P_VALUE = COA.L.DESC "L#3) showline
(0880 P_X  = 4 ; P_Y = SLN+1 ; P_VALUE = COA.L.DESC "L#32" ; P_OPT =     P_X  = 4 ; P_Y = SLN+1 ; P_VALUE = COA.L.DESC "L#32" ; P_OPT) showline
(0881 P_X  := AM:4+34 ; P_Y := AM:SLN+1 ; P_VALUE := AM:JE.CMT<1,LN>     P_X  := AM:4+34 ; P_Y := AM:SLN+1 ; P_VALUE := AM:JE.CMT<1,L) showline
(0882 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0883                                                                 >  *>>>>) showline
(0884 RETURN                                                             RETURN) showline
(0885 *                                                                  *) showline
(0886 *--- SCROLL                                                        *--- SCROLL) showline
(0887 *                                                                  *) showline
(0888 80000 *                                                            80000 *) showline
(0889 ST.LINE = 1 + INT\(\(LN-1\)/PAGE.SIZE\) * PAGE.SIZE                    ST.LINE = 1 + INT\(\(LN-1\)/PAGE.SIZE\) * PAGE.SIZE) showline
(0890 LST.LINE = ST.LINE + PAGE.SIZE - 1                                 LST.LINE = ST.LINE + PAGE.SIZE - 1) showline
(0891 IF LST.LINE > LINES THEN LST.LINE = LINES                          IF LST.LINE > LINES THEN LST.LINE = LINES) showline
(0892 IF ST.LINE = OLD.START THEN RETURN                                 IF ST.LINE = OLD.START THEN RETURN) showline
(0893 OLD.START = ST.LINE                                                OLD.START = ST.LINE) showline
(0894 CNT = 1                                                            CNT = 1) showline
(0895 FOR N = ST.LINE TO LST.LINE                                        FOR N = ST.LINE TO LST.LINE) showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0896 SSLN = BEGIN.PAGE + LINE.SPACE * MOD\(N-1,PAGE.SIZE\)                SSLN = BEGIN.PAGE + LINE.SPACE * MOD\(N-1,PAGE.SIZE\)) showline
(0897 P_X  = 0 ; P_Y = SSLN ; P_VALUE = N "R#3" ; P_OPT = "CL"           P_X  = 0 ; P_Y = SSLN ; P_VALUE = N "R#3" ; P_OPT = "CL") showline
(0898 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0899 BEGIN CASE                                                         BEGIN CASE) showline
(0900 CASE JE.DB.AMT<1,N> > 0                                            CASE JE.DB.AMT<1,N> > 0) showline
(0901 X = 4                                                              X = 4) showline
(0902 CASE JE.CR.AMT<1,N> > 0                                            CASE JE.CR.AMT<1,N> > 0) showline
(0903 X = 6                                                              X = 6) showline
(0904 CASE LINE.NORM<N> = 'CR'                                           CASE LINE.NORM<N> = 'CR') showline
(0905 X = 6                                                              X = 6) showline
(0906 CASE 1                                                             CASE 1) showline
(0907 X = 4                                                              X = 4) showline
(0908 END CASE                                                           END CASE) showline
(0909 *         P_X  = X ; P_Y = SSLN ; P_VALUE = JE.ACCT<1,N> CO.AC     *         P_X  = X ; P_Y = SSLN ; P_VALUE = JE.ACCT<1,N> CO.) showline
(0910 P_X  = 4 ; P_Y = SSLN ; P_VALUE = JE.ACCT<1,N> CO.ACCT.MASK ;      P_X  = 4 ; P_Y = SSLN ; P_VALUE = JE.ACCT<1,N> CO.ACCT.MASK ) showline
(0911 P_X  := AM:22 ; P_Y := AM:SSLN ; P_VALUE := AM:LINE.TYPE<N> "L     P_X  := AM:22 ; P_Y := AM:SSLN ; P_VALUE := AM:LINE.TYPE<N> ) showline
(0912 P_X  := AM:26 ; P_Y := AM:SSLN ; P_VALUE := AM:LINE.NORM<N> "L     P_X  := AM:26 ; P_Y := AM:SSLN ; P_VALUE := AM:LINE.NORM<N> ) showline
(0913 P_X  := AM:30 ; P_Y := AM:SSLN ; P_VALUE := AM:LINE.CAT<N> "L#     P_X  := AM:30 ; P_Y := AM:SSLN ; P_VALUE := AM:LINE.CAT<N> ") showline
(0914 P_X  := AM:34 ; P_Y := AM:SSLN ; P_VALUE := AM:LINE.SUB<N> "L#     P_X  := AM:34 ; P_Y := AM:SSLN ; P_VALUE := AM:LINE.SUB<N> ") showline
(0915 P_X  := AM:38 ; P_Y := AM:SSLN ; P_VALUE := AM:JE.DIV<1,N> "L#     P_X  := AM:38 ; P_Y := AM:SSLN ; P_VALUE := AM:JE.DIV<1,N> ") showline
(0916 P_X  := AM:43 ; P_Y := AM:SSLN ; P_VALUE := AM:JE.DEPT<1,N> "L     P_X  := AM:43 ; P_Y := AM:SSLN ; P_VALUE := AM:JE.DEPT<1,N> ) showline
(0917 P_X  := AM:47 ; P_Y := AM:SSLN ; P_VALUE := AM:JE.CCTR<1,N> "L     P_X  := AM:47 ; P_Y := AM:SSLN ; P_VALUE := AM:JE.CCTR<1,N> ) showline
(0918 P_X  := AM:52 ; P_Y := AM:SSLN ; P_VALUE := AM:OCONV\(JE.DB.AMT     P_X  := AM:52 ; P_Y := AM:SSLN ; P_VALUE := AM:OCONV\(JE.DB.A) showline
(0919 P_X  := AM:66 ; P_Y := AM:SSLN ; P_VALUE := AM:OCONV\(JE.CR.AMT     P_X  := AM:66 ; P_Y := AM:SSLN ; P_VALUE := AM:OCONV\(JE.CR.A) showline
(0920 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0921 P_X  = 0 ; P_Y = SSLN+1 ; P_VALUE = "" ; P_OPT = ""                P_X  = 0 ; P_Y = SSLN+1 ; P_VALUE = "" ; P_OPT = "") showline
(0922 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0923                                                                 >  *<<<<        CAF1 15973) showline
(0924                                                                 >  *         P_X  = X ; P_Y = SSLN+1 ; P_VALUE = LINE.DESC<N> ") showline
(0925 P_X  = 4 ; P_Y = SSLN+1 ; P_VALUE = LINE.DESC<N> "L#32" ; P_OP     P_X  = 4 ; P_Y = SSLN+1 ; P_VALUE = LINE.DESC<N> "L#32" ; P_) showline
(0926                                                                 >  *         P_X  := AM:X+34 ; P_Y := AM:SSLN+1 ; P_VALUE := AM) showline
(0927 P_X  := AM:4+34 ; P_Y := AM:SSLN+1 ; P_VALUE := AM:JE.CMT<1,N>     P_X  := AM:4+34 ; P_Y := AM:SSLN+1 ; P_VALUE := AM:JE.CMT<1,) showline
(0928 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0929                                                                 >  *>>>>) showline
(0930 CNT = CNT + 1                                                      CNT = CNT + 1) showline
(0931 NEXT N                                                             NEXT N) showline
(0932 FOR N = CNT TO PAGE.SIZE                                           FOR N = CNT TO PAGE.SIZE) showline
(0933 SSLN = BEGIN.PAGE + LINE.SPACE * MOD\(N-1,PAGE.SIZE\)                SSLN = BEGIN.PAGE + LINE.SPACE * MOD\(N-1,PAGE.SIZE\)) showline
(0934 P_X  = 0 ; P_Y = SSLN ; P_VALUE = "" ; P_OPT = "CL"                P_X  = 0 ; P_Y = SSLN ; P_VALUE = "" ; P_OPT = "CL") showline
(0935 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0936 P_X  = 0 ; P_Y = SSLN+1 ; P_VALUE = "" ; P_OPT = "CL"              P_X  = 0 ; P_Y = SSLN+1 ; P_VALUE = "" ; P_OPT = "CL") showline
(0937 CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)                              CALL VSI_PLINE\(P_X,P_Y,P_VALUE,P_OPT\)) showline
(0938 NEXT N                                                             NEXT N) showline
(0939 RETURN                                                             RETURN) showline
(0940 *                                                                  *) showline
(0941                                                                 >  *--- SCROLL XREF) showline
(0942                                                                 >  *) showline
(0943                                                                 >  * *COPY>PMCBP>DV.DP.CC.SCROLL    ;* T21876) showline
(0944                                                                 >  *) showline
(0945 *--- UPDATE CONTROL FILE                                           *--- UPDATE CONTROL FILE) showline
(0946 *                                                                  *) showline
(0947 89000 *                                                            89000 *) showline
(0948                                                                 >  *  SJE.DATE = TODAY;* T23278) showline
(0949 SJE.DATE<1,POS> = TODAY;* T23278                                   SJE.DATE<1,POS> = TODAY;* T23278) showline
(0950 BEGIN CASE                                                         BEGIN CASE) showline
(0951 ***** T23278 v                                                     ***** T23278 v) showline
(0952 *      CASE SJE.POST.NO < 1                                        *      CASE SJE.POST.NO < 1) showline
(0953 *          SJE.PRT.NO = 0                                          *          SJE.PRT.NO = 0) showline
(0954 *          SJE.POST.NO = 0                                         *          SJE.POST.NO = 0) showline
(0955 *          SJE.STATUS = 'CLOSED'                                   *          SJE.STATUS = 'CLOSED') showline
showpage
<< /PageSize  [792 612] /Duplex true >> setpagedevice

36 576 moveto
(0956 *      CASE SJE.PRT.NO < 1                                         *      CASE SJE.PRT.NO < 1) showline
(0957 *          SJE.PRT.NO = 0                                          *          SJE.PRT.NO = 0) showline
(0958 *          SJE.STATUS = 'PRINTED'                                  *          SJE.STATUS = 'PRINTED') showline
(0959 *      CASE 1                                                      *      CASE 1) showline
(0960 *          SJE.STATUS = 'ENTERED'                                  *          SJE.STATUS = 'ENTERED') showline
(0961 CASE SJE.POST.NO<1,POS> < 1                                        CASE SJE.POST.NO<1,POS> < 1) showline
(0962 SJE.PRT.NO<1,POS> = 0                                              SJE.PRT.NO<1,POS> = 0) showline
(0963 SJE.POST.NO<1,POS> = 0                                             SJE.POST.NO<1,POS> = 0) showline
(0964 SJE.STATUS<1,POS> = 'CLOSED'                                       SJE.STATUS<1,POS> = 'CLOSED') showline
(0965 CASE SJE.PRT.NO<1,POS> < 1                                         CASE SJE.PRT.NO<1,POS> < 1) showline
(0966 SJE.PRT.NO<1,POS> = 0                                              SJE.PRT.NO<1,POS> = 0) showline
(0967 SJE.STATUS<1,POS> = 'PRINTED'                                      SJE.STATUS<1,POS> = 'PRINTED') showline
(0968 CASE 1                                                             CASE 1) showline
(0969 SJE.STATUS<1,POS> = 'ENTERED'                                      SJE.STATUS<1,POS> = 'ENTERED') showline
(0970 ***** T23278 ^                                                     ***** T23278 ^) showline
(0971 END CASE                                                           END CASE) showline
(0972 MATWRITE SJE.REC ON CONTROL, CTL.KEY                               MATWRITE SJE.REC ON CONTROL, CTL.KEY) showline
(0973 RETURN                                                             RETURN) showline
(0974 *                                                                  *   ) showline
(0975 *--- ERROR ROUTINE                                                 *--- ERROR ROUTINE) showline
(0976 *                                                                  *   ) showline
(0977 91000 ERR.TYPE=1;CALL SYSCOM\(MAT SYSCOM.REC\);RETURN                91000 ERR.TYPE=1;CALL SYSCOM\(MAT SYSCOM.REC\);RETURN) showline
(0978 999999 *                                                        |  * 91000 *) showline
(0979                                                                 >  *       PRINT @\(0,23\):ERRMSG:CL:) showline
(0980                                                                 >  *       INPUT REPLY,1 :) showline
(0981                                                                 >  *       PRINT @\(0,23\):CL:) showline
(0982                                                                 >  *       RETURN   ) showline
(0983                                                                 >  999999 * PRINT * @\(-1\) *  *  * ) showline
(0984 END                                                                END) showline
(0985 ) showline
showpage