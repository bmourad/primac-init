SUBROUTINE JKT_COUR_BIND_STYLE(CONO,ERRMSG,I_FNAME,I_FPTR,I_VNAME,I_VREC,I_SNAME,I_SREC,STYLE_DESC)
*COPY>CPYLIB>COM1

******************************************************************************
*                 written for Courier Corporation
*  
*  Revision Date -  10/12/98
*
*  Library       -  JISBP/JKT_COUR_BIND_STYLE
*
*  Author        -  Dave Markell
*
******************************************************************************
*
*  For use by JIS for Courier Job Tickets to pick up the text descrption 
*  for the Case Bind or Paper Back bind style as per the Projection file
*  attributes 14 (CB) and 12 (PB) or the Case Bind Covert Type - Projection file attribute 6.
*
*  This subroutine should be invoked for COURIER_FLD 403 for Paper B ind Style
*  or COURIER_FLD 520 for Case Bind Style or COURIER_FLD_521 for Case Cover Type.
*
*  One of the following fields must be on the JIS form that invokes this
*  and must be placed in the Passing Field Names section of the
*  Screen Subroutine Definition form :
*
*     PROJ_CB_BND -  the Case Bind Style
*                     (PROJECTION record attribute 14)
*     PROJ_PB_BND -  the Paper Bind Style
*                     (PROJECTION record attribute 12)
*
*     PROJ_CVR_TYPE - the Case Cover Type
*                       (PROJECTION record attribute 6)
*   Since JIS does require a file name in the Passing File Names section
*   TITLE.ID should be placed there.
*
*
******************************************************************************
*
*
*---  Data Structure Libraries  ---
*
*COPY>COURIER.CPYLIB>TITLE.ID
*COPY>COURIER.CPYLIB>TITLE.ID.DET
*
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR

*
*  no need to set up FNAME/FPTR since no file names are being passed
*
*->     FNAME    = "TITLE.ID"
*->      FNAME<2> = "TITLE.ID.DET"
*->      FCNT = 2
*->      DIM FPTR(FCNT)
*->      EQU  TITLEID_FPTR    TO FPTR(1)
*->      EQU  TITLEIDDET_FPTR TO FPTR(2)
*
*

*
* set up blank error message and default return value (in case of no match)
*
      ERRMSG = ""
      STYLE_DESC = "*-???-*"
*
* no need to scan array of file names from Screen Subroutine Definition
*
*->      ICNT = 9
*->      FOR I = 1 TO FCNT
*->        LOCATE FNAME<I> IN I_FNAME,1 SETTING FND THEN
*->          FPTR(I) = I_FPTR<FND>
*->        END ELSE
*->          ERRMSG = "File (":FNAME<I>:") is required for this Subroutine"
*->          ICNT = 0
*->        END
*->      NEXT I
*->      IF ICNT = 0 THEN GOTO 99999
*
* check 1st element of  array of field names passed on Screen Subroutine
*  Find the field name of either PROJN_CB_BND or PROJ_PB_BND in the I_VNAME arry
*  and pick up the value of it from the corresponding slot in I_VREC
*
      CT_PASSED = 0
      STYLE_CODE = "???"
      LOCATE "PROJ_CB_BND" IN I_VNAME,1 SETTING FND THEN
        STYLE_CODE = I_VREC<FND>
        CT_PASSED = CT_PASSED + 1
      END 
      LOCATE "PROJ_PB_BND" IN I_VNAME,1 SETTING FND THEN
        STYLE_CODE = I_VREC<FND>
        CT_PASSED = CT_PASSED + 1
      END
      DOING_COVER = "N"
      LOCATE "PROJ_CVR_TYPE" IN I_VNAME,1 SETTING FND THEN
        STYLE_CODE = I_VREC<FND>
        CT_PASSED = CT_PASSED + 1
        DOING_COVER = "Y"
      END
      IF DOING_COVER THEN
      IF CT_PASSED = 0 THEN
        ERRMSG = "The field PROJ_CB_BND or PROJ_PB_BND or PROJ_CVT_TYPE required "
        GOTO 99999
      END
*
      IF DOING_COVER THEN
        BEGIN CASE
          CASE STYLE_CODE = ""
            STYLE_DESC = " (none entered) "
          CASE STYLE_CODE = "PP"
            STYLE_DESC = "Preprinted Case"
          CASE STYLE_CODE = "1PC"
            STYLE_DESC = "1 Piece Case"
          CASE STYLE_CODE = "3PC"
            STYLE_DESC = "3 Piece Case"
        END CASE
      END ELSE
       BEGIN CASE
        CASE STYLE_CODE = ""
          STYLE_DESC = " (none entered)"
        CASE STYLE_CODE = "PP"
          STYLE_DESC = "Perfect Paper"
        CASE STYLE_CODE = "BP" OR STYLE_CODE = "NP"
          STYLE_DESC = "Notch Paper"
        CASE STYLE_CODE = "SP"
          STYLE_DESC = "Sewn Paper"
        CASE STYLE_CODE = "SW"
          STYLE_DESC = "Saddlewire"
        CASE STYLE_CODE = "WO"
          STYLE_DESC = "Wire-O"
        CASE STYLE_CODE = "T4S"
          STYLE_DESC = "Trim 4 Sides"
        CASE STYLE_CODE = "NCR"
          STYLE_DESC = "Notch Case Reinforced"
        CASE STYLE_CODE = "PCR"
          STYLE_DESC = "Perfect Case Reinforced"
        CASE STYLE_CODE = "SCR"
          STYLE_DESC = "Sewn Case Reinforced"
        CASE STYLE_CODE = "NC"
          STYLE_DESC = "Notch Case"
        CASE STYLE_CODE = "PC"
          STYLE_DESC = "Perfect Case"
        CASE STYLE_CODE = "SC"
          STYLE_DESC = "Sewn Case"
       END CASE
      END
*
99999*
      RETURN
      END
