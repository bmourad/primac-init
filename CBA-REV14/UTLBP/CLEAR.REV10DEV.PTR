* CLEAR.REV10DEV.PTR
* MODIFICATION OF CLEAR.LOCAL.PTR
* USED BY MOVIE TO REMOVE REV10 DEV ACCOUNT LOCAL POINTERS
*
PROMPT ""
OPEN '','VOC' TO VOC ELSE
  PRINT "Cannot open VOC file"
  STOP
END
OPEN '','DEV.CONTROL' TO CONTROL ELSE
  PRINT "Cannot open CONTROL file"
  STOP
END
READ MREC FROM CONTROL, "MENUS.CONTROL" ELSE
  PRINT "Cannot find MENUS.CONTROL record"
  STOP
END
10 *
PRINT @(-1):
INPUT LISTID
IF LISTID = "END" THEN STOP
READ PRGM FROM VOC, LISTID ELSE
  STOP 
END
PCNT = DCOUNT(PRGM,CHAR(254))
ACNT = DCOUNT(MREC<6>,CHAR(253)) + 2
FOR APTR = 1 TO ACNT
  BEGIN CASE
  CASE APTR = ACNT
    ACCT = "CBA-":MREC<1>
  CASE APTR = (ACNT - 1)
    ACCT = MREC<1>
  CASE 1
    ACCT = MREC<1>:"-":MREC<6,APTR>
  END CASE
* PRINT ACCT
  QPTR = "F"
  QPTR<2> = "/rev10/dev/":ACCT:"/VOC"
  QPTR<3> = "/rev10/dev/":ACCT:"/D_VOC"
  WRITE QPTR ON VOC, "VFILE"
  OPEN '','VFILE' TO VFILE ELSE
    PRINT "Cannot open VOC file in ":ACCT:" account"
    GOTO 200
  END
  FOR PPTR = 1 TO PCNT
    READ REC FROM VFILE, PRGM<PPTR> THEN
      IF REC<1> = "C" THEN
        DELETE VFILE, PRGM<PPTR>
        PRINT ACCT:' ':PRGM<PPTR>:' DELETED'
      END
    END
  NEXT PPTR
200 *
NEXT APTR
* DELETE VOC, "VFILE"
END
