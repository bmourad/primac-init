	SUBROUTINE ALL.DICT.CR(FILE.NAME, HEAD, WIDTH, CONV, CORR, NEW.DICT.ID)
*COPY>CPYLIB>COM1
*COPY>CPYLIB>COM.DICT.VAL
**********************************************************************
* REVISION   - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* FILE       - UTLBP
* PROGRAM    - ALL.DICT.CR
* DATE       - 10/90
* DESCRIPTION
*		CALLED BY 'ALL.DICT.BLD'
*
*		CREATES DICTIONARY ITEMS IN UNIDATA FORMAT
*
**********************************************************************
*COPY>PMC.CPYLIB>COMPANY
*COPY>PMC.CPYLIB>CORP.CONO
*COPY>CPYLIB>DICT.VALUES
*COPY>CPYLIB>UNI.DICT
*COPY>CPYLIB>DICT.HLD.FILE
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*
*---- INITIAL
*
MAT DICT.REC = ''
ERRMSG = ''
*
*** DETERMINE IF DICT.ID CONFORMS TO UNIDATA FORMAT (i.e. CANNOT BEGIN
*** WITH NUMERIC OR CONTAIN '#', IF SO, THE COMMON PARAMETER PASSED OF
*** 'NEW.DICT.ID' WILL BE CHANGED TO CONFORM
*
	IF NUM(NEW.DICT.ID[1,1]) THEN
		NEW.DICT.ID = 'F':NEW.DICT.ID
	END
	X = LEN(NEW.DICT.ID)
	WORK.ID = ''
	FOR Y = 1 TO X
		IF NEW.DICT.ID[Y,1] = '#' THEN
			WORK.ID = WORK.ID:'_'
		END ELSE
			WORK.ID = WORK.ID:NEW.DICT.ID[Y,1]
		END
	NEXT X
	NEW.DICT.ID = WORK.ID
*
***** NOTE, TAKE THE FOLLOWING 'NEXT X' LOGIC OUT IF RUNNING MASF
*
FOR X = 1 TO CCO.MAX; CCO.REC(X) = ''; NEXT X
*
*--- CORPORATE FILES (NOTE: MUST BE IN SAME ORDER AS CCO.REC)
*
	CCO.FILES = 'COA'
	CCO.FILES<2> = 'VEND'
	CCO.FILES<3> = 'CUSTOMER'
	CCO.FILES<4> = 'OPERATION'
	CCO.FILES<5> = 'INVENTORY'
	FOR X = 1 TO CCO.MAX
		IF CCO.REC(X) = '' THEN CCO.REC(X) = '@ID[1,3]'
	NEXT X
*
	LOCATE HOLD.TFILE IN CCO.FILES,1 SETTING PTR ELSE
		PTR = 0
	END
	IF PTR # 0 THEN
		TFILE.CONO = CCO.REC(PTR)
	END ELSE
		TFILE.CONO = '@ID[1,3]'
	END
	LOCATE HOLD.TFILE2 IN CCO.FILES,1 SETTING PTR ELSE
		PTR = 0
	END
	IF PTR # 0 THEN
		TFILE2.CONO = CCO.REC(PTR)
	END ELSE
		TFILE2.CONO = '@ID[1,3]'
	END
*
199 *
UD.TYPE = 'I'
ATT = HOLD.A.AMC
IF ATT = 0 THEN
SUF.X = '@ID'
END ELSE
SUF.X = 'F' : ATT
END
IF HOLD.MS.FLAG = 'Y' THEN
UD.MS.FLAG = 'M'
END ELSE
UD.MS.FLAG = 'S'
END
UD.HEAD = HOLD.S.NAME
UD.WIDTH = HOLD.MAX.LEN
FMT1 = 'OCONV(': SUF.X :'[1,': CONO.LEN + GL.LEN : '],"TCOA;X;1;1")'
FMT2 = SUF.X: '[' : POS(1) + CCTR.LEN : ',' : GL.LEN : ']'
FMT3 = 'OCONV(' : SUF.X : '[1,': CONO.LEN : ']:@ID[' : ST.CCTR : ',' : GL.LEN : '], "TCOA;X;1;1")'
FMT5 = SUF.X : '[' : ST.CCTR : ',' : GL.LEN : ']' : ':" ":' : FMT3
FMT6 = SUF.X : '[' : POS(1) + CONO.LEN : ',' : GL.LEN : ']'
FOR I = 1 TO SF.CNT
SF1(I) = SUF.X : '[' : POS(I) + CCTR.LEN : ',' : SFR(I) : ']'
SF2(I) = SUF.X : '[' : POS(I) : ',' : SFR(I) : ']'
SF3(I) = SUF.X : '[' : POS(I) + CONO.LEN : ',' : SFR(I) : ']'
NEXT I
IF HOLD.TFILE.ATTR = 0 THEN
SUF.X2 = '@ID'
END ELSE
SUF.X2 = 'F' : HOLD.TFILE.ATTR
END
FMT35 = 'OCONV(' : SUF.X : '[1,' : CONO.LEN : ']:' : SUF.X2 : ',"TCOA;X;1;1)'
FMT36 = 'TRANS(COA,SUBR("-CATS",REUSE(@ID[1,' : CONO.LEN : ']),' : SUF.X2 : '),1,"X")'
BEGIN CASE
CASE HOLD.TYPE = '01'
UD.TYPE = 'D'
UD.FUN = ATT
UD.WIDTH = GL.LEN
GOSUB 1000
CASE HOLD.TYPE = '02'
UD.FUN = SUF.X : '[' : HOLD.START.PT : ',' : GL.LEN : ']'
UD.WIDTH = GL.LEN
GOSUB 1000
CASE HOLD.TYPE = '03'
UD.FUN = SUF.X : '[' : CCTR.LEN : ',' : HOLD.NO.LEN : ']'
GOSUB 1000
CASE HOLD.TYPE = '04'
UD.FUN = FMT1
GOSUB 1000
CASE HOLD.TYPE = '05'
UD.FUN = FMT2
UD.WIDTH = STRUC.LEN
GOSUB 1000
CASE HOLD.TYPE = '06'
UD.FUN = FMT3
GOSUB 1000
CASE HOLD.TYPE > 6 AND HOLD.TYPE < 12
UD.FUN = SF1(HOLD.TYPE-6)
UD.WIDTH = SFR(HOLD.TYPE-6)
GOSUB 1000
CASE HOLD.TYPE = '12'
UD.TYPE = 'D'
UD.FUN = ATT
UD.WIDTH = STRUC.LEN
GOSUB 1000
CASE HOLD.TYPE > 12 AND HOLD.TYPE < 18
UD.FUN = SF2(HOLD.TYPE-12)
UD.WIDTH = SFR(HOLD.TYPE-12)
GOSUB 1000
CASE HOLD.TYPE = '18'
UD.FUN = SUF.X : '[' : EN.GL.LEN2 : ',' : HOLD.NO.LEN : ']'
GOSUB 1000
CASE HOLD.TYPE = '19'
UD.FUN = SUF.X : '[' : SUFFIX.POS : ',' : SUFFIX.LEN : ']'
IF SUFFIX.LEN > 0 THEN UD.WIDTH = SUFFIX.LEN ELSE WIDTH = 1
GOSUB 1000
CASE HOLD.TYPE = '20'
UD.FUN = SUF.X : '[' : (SUFFIX.POS + CCTR.LEN) : ',' : SUFFIX.LEN : ']'
IF SUFFIX.LEN > 0 THEN UD.WIDTH = SUFFIX.LEN ELSE WIDTH = 1
GOSUB 1000
CASE HOLD.TYPE = '21'
UD.FUN = FMT5
GOSUB 1000
CASE HOLD.TYPE = '22'
UD.FUN = FMT6
UD.WIDTH = STRUC.LEN
GOSUB 1000
CASE HOLD.TYPE > 22 AND HOLD.TYPE < 28
UD.FUN = SF3(HOLD.TYPE-22)
UD.WIDTH = SFR(HOLD.TYPE-22)
GOSUB 1000
CASE HOLD.TYPE = '28'
UD.FUN = 'OCONV(' : SUF.X : ',"G!1");@1[' : EN.GL.LEN2 : ',' : HOLD.NO.LEN : ']'
GOSUB 1000
CASE HOLD.TYPE = '32'
UD.FUN = SUF.X2 : ':" ":' : FMT36
GOSUB 1000
CASE HOLD.TYPE = '33'
TEMP = ''
FMT33 = 'EXTRACT(' : SUF.X : ',1,' : HOLD.TFILE.MV.NO : ',0);OCONV(@ID[1,' : CONO.LEN : ']:@1,"TCOA;X;1;1")'
TEMP = ';'
FOR I = 1 TO SF.CNT
FMT33 = FMT33 : TEMP : '@1[' : POS(I) : ',' : SFR(I) : ']'
TEMP = ':"-":'
NEXT I
FMT33 = FMT33 : ':" ":@2'
UD.FUN = FMT33
CASE HOLD.TYPE = '34'
TEMP = ''
FMT34 = ''
FOR I = 1 TO SF.CNT
FMT34 = FMT34 : TEMP : SUF.X2 : '[' : POS(I) : ',' : SFR(I) : ']'
TEMP = ':"-":'
NEXT I
UD.FUN = FMT34 : ':" ":OCONV(@ID[1,' : CONO.LEN : ']:' : SUF.X2 : ',"TCOA;X;1;1")'
CASE HOLD.TYPE = '35'
IF HOLD.MS.FLAG = 'Y' THEN
UD.FUN = FMT36
END ELSE
UD.FUN = FMT35
END
CASE HOLD.TYPE = '36'
UD.FUN = SUF.X : '[' : HOLD.START.PT : ',' : HOLD.NO.LEN : ']'
UD.WIDTH = HOLD.NO.LEN
GOSUB 1000
	CASE HOLD.TYPE = '50'OR HOLD.TYPE = '53'
		IF TFILE.CONO[1,1] # '@' THEN
			UD.FUN = 'OCONV(@ID,"G!1");@ID[4,99];':TFILE.CONO:';(OCONV(@3:@2,"T':HOLD.TFILE:';X':HOLD.TFILE.MV.NO:';':HOLD.TFILE.ATTR:';':HOLD.TFILE.ATTR:'")'
		END ELSE
			UD.FUN = 'OCONV(@ID,"G!1");OCONV(@1,"T':HOLD.TFILE:';X':HOLD.TFILE.MV.NO:';':HOLD.TFILE.ATTR:';':HOLD.TFILE.ATTR:'")'
		END
		IF HOLD.TYPE = '53' THEN
			UD.FUN = UD.FUN:';OCONV(':TFILE2.CONO:':@2,"T':HOLD.TFILE2:';X;':HOLD.TFILE2.ATTR:';':HOLD.TFILE2.ATTR:'")'
		END
		UD.CONV = HOLD.CONV
	CASE HOLD.TYPE = '51' OR HOLD.TYPE = '56'
		IF HOLD.MS.FLAG = 'Y' THEN
			UD.FUN = 'TRANS(':HOLD.TFILE:',SUBR("-CATS",REUSE(':TFILE.CONO:'),F':HOLD.KEY.FIELD:'),':HOLD.TFILE.ATTR:',"X':HOLD.TFILE.MV.NO:'")'
		END ELSE
			UD.FUN = 'OCONV(':TFILE.CONO:':F':HOLD.KEY.FIELD:',"T':HOLD.TFILE:';X':HOLD.TFILE.MV.NO:';':HOLD.TFILE.ATTR:';':HOLD.TFILE.ATTR:'")'
		END
		IF HOLD.TYPE = '56' THEN
			UD.FUN = UD.FUN:';F':HOLD.KEY.FIELD:':" ":@1'
		END
		UD.CONV = HOLD.CONV
	CASE HOLD.TYPE = '52'
		UD.FUN = 'OCONV(@ID,"G':HOLD.KEY.FIELD:'!1");OCONV(':TFILE.CONO:':@1,"T':HOLD.TFILE:';X':HOLD.TFILE.MV.NO:';':HOLD.TFILE.ATTR:';':HOLD.TFILE.ATTR:'")'
		UD.CONV = HOLD.CONV
	CASE HOLD.TYPE = '54'
		UD.FUN = 'OCONV(':TFILE.CONO:':F':HOLD.KEY.FIELD:',"T':HOLD.TFILE:';X':HOLD.TFILE.MV.NO:';':HOLD.TFILE.ATTR:';':HOLD.TFILE.ATTR:'");OCONV(':TFILE2.CONO:':@1,"T': HOLD.TFILE2:';X;':HOLD.TFILE2.ATTR:';':HOLD.TFILE2.ATTR:'")'
		UD.CONV = HOLD.CONV
	CASE HOLD.TYPE = '60'
		UD.FUN = '(F':HOLD.INV.QTY:'+"5")/"10";F':HOLD.INV.COST:'/"100";OCONV(FIELD(@ID,"!",1),"T':HOLD.TFILE:';X':HOLD.TFILE.MV.NO:';':HOLD.TFILE.ATTR:';':HOLD.TFILE.ATTR:'");(@1*@2)/@3'
		UD.CONV = HOLD.CONV
	CASE HOLD.TYPE = '57'
		UD.FUN = 'OCONV(@ID,"T':FILE.NAME:';X':HOLD.KEY.FLD.MV:';':HOLD.KEY.FIELD:';':HOLD.KEY.FIELD:'")'
		UD.CONV = HOLD.CONV
	END CASE
IF HOLD.TYPE = 5 OR HOLD.TYPE = 12 OR HOLD.TYPE = 22 THEN
UD.MASK = STRUC.LEN:HOLD.JUSTIFY:HOLD.ACCT.MASK[1,STRUC.LEN]
END ELSE
UD.MASK = UD.WIDTH:HOLD.JUSTIFY
END
9999 *
GOTO 999999
1000 *
IF UD.WIDTH < 1 THEN
UD.HEAD = "."
GOTO 1999
END
IF UD.HEAD = '' THEN GOTO 1999
IF NUM(UD.HEAD) THEN GOTO 1999
IF INDEX(UD.HEAD,":",1) > 0 THEN GOTO 1999
IF UD.HEAD = STR(".",LEN(UD.HEAD)) THEN GOTO 1999
IF UD.HEAD = STR(" ",LEN(UD.HEAD)) THEN GOTO 1999
IF HOLD.TYPE = '05' OR HOLD.TYPE = '12' OR HOLD.TYPE = '22' THEN
MAXWIDTH = 14
END ELSE
MAXWIDTH = UD.WIDTH
END
HCNT = DCOUNT(UD.HEAD,VM)
FOR N = 1 TO HCNT
UD.HEAD<1,N> = TRIM(UD.HEAD<1,N>)
NEXT N
IF UD.HEAD<1,N>[1,1] = "-" THEN
FOR N = 1 TO HCNT-1
IF LEN(UD.HEAD<1,N>) > MAXWIDTH THEN MAXWIDTH = LEN(UD.HEAD<1,N>)
NEXT N
UD.HEAD<1,HCNT> = STR("-",MAXWIDTH)
FOR N = 1 TO HCNT - 1
LEN.HEAD = LEN(UD.HEAD<1,N>)
SPC = INT((MAXWIDTH - LEN.HEAD)/2)
UD.HEAD<1,N> = SPACE(SPC) : UD.HEAD<1,N> : SPACE(MAXWIDTH - SPC - LEN.HEAD)
NEXT N
END
1999 *
RETURN
999999 *
	HEAD = UD.HEAD
	WIDTH = UD.WIDTH
	CONV = UD.CONV
	CORR = UD.FUN
RETURN
PRINT @(-1):
END
