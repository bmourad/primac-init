**********************************************
* REVISION    - [XX.X]
* Copyright 1995 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - CBABP
* PROGRAM     - CONVERT.MENU.TO.FORM
* BY          - diane; CBA
* DATE        - 11/20/1996
* DESCRIPTION -
*
*
*   This program will produce a hard copy of a specific menu or "ALL"
*   menus from the specified file. A complete table of contents listing is
*   also created. The menu documentation may optionally be printed along
*   with the associated menu.
*
*T21177 diane 11/20/1996 * ALLOW ENTRY OF MENU TO CONVERT OR ALL
*ENDDOC
**********************************************
*
*COPY>PMC.CPYLIB>MENUS.CONTROL
*COPY>CPYLIB>CHAR
*
*---- OPEN ALL FILES
*
   OPEN "","CONTROL" TO CONTROL ELSE
      STOP "CANNOT OPEN CONTROL FILE"
   END
*   OPEN "","MENUFORM" TO MENUFORM ELSE
*      STOP "CANNOT OPEN MENUFORM FILE"
*   END
*   OPEN "","PRIMAC.MENUS" TO MENUS ELSE
*      STOP "CANNOT OPEN PRIMAC.MENUS FILE"
*   END
*
*---- INITIALIZATION
*
   PROMPT ""
   MATREAD MENU.REC FROM CONTROL, "MENUS.CONTROL" ELSE
      MAT MENU.REC = ""
   END
*
*---- MAIN PROCESSING
*
100*
   BYPASS = 1
   CRT CS
   CRT @(10,2):"C O N V E R T   M E N U   T O   G U I   F O R M"
   CRT @(10,4):"MENU FILE        : "
   CRT @(10,6):'MENU ID OR "ALL" : '
   CRT @(10,8):'MASTER MENU      : '
   INPUT @(29,4):MENU.FILE:
   IF MENU.FILE = "" OR MENU.FILE = "END" THEN GOTO 99999
   FORM.FILE = FIELD(MENU.FILE,".",1):".MENUFORMS"
   INPUT @(29,6):MENU.ID:
   OPEN "",FORM.FILE TO MENUFORM ELSE
      STOP "CANNOT OPEN ":FORM.FILE:" FILE"
   END
   OPEN "",MENU.FILE TO MENUS ELSE
      STOP "CANNOT OPEN ":MENU.FILE:" FILE"
   END
   BEGIN CASE
      CASE MENU.ID = '' OR MENU.ID = "END"
         GOTO 99999
      CASE MENU.ID = "ALL"
         MASTER = ""
         INPUT @(29,8):MASTER:
         MENU.NAME = "ALL"
         DOC.FLAG = "N"
         BEGIN CASE
            CASE MENU.FILE = "PRIMAC.MENUS"
               IF MASTER = "" THEN
                  MASTER = "M.MASTER"
               END
            CASE MENU.FILE = "EASY.MENUS"
               IF MASTER = "" THEN
                  MASTER = "M.CBA"
               END
            CASE 1
               GOTO 99999
         END CASE
         MENU.NAMES = ""
         CALL GET.MENU.NAMES (MASTER, MENUS, MENU.NAMES)
         MENU.CNT = DCOUNT(MENU.NAMES,AM)
         FOR MENU.PTR = 1 TO MENU.CNT
            MENU.ID = MENU.NAMES<MENU.PTR>
            IF MENU.ID[1,2] # "M." THEN GOTO 129
            IF MENU.ID = "M.MASTER" THEN GOTO 129
            CALL MENU.MAINT.TUF(MENU.ID,FORM.FILE,MENU.FILE,BYPASS)
129      NEXT MENU.PTR
      CASE MENU.ID # '' AND MENU.ID # "ALL" 
         BYPASS = 1
         CALL MENU.MAINT.TUF(MENU.ID,FORM.FILE,MENU.FILE,BYPASS)
   END CASE
**
99999*
   STOP
   END

