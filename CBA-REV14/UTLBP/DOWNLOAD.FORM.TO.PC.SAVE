*********************************************************************
*
* REVISION    - [11.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
*
* PROGRAM - DOWNLOAD.FORM.TO.PC
*
* AUTHOR  - DIANE TOVAR, COMPUTER BUSINESS ASSOCIATES
*
* DATE    - 7/31/96
*
* DESCRIPTION
* READ ALL PMCFORMS AND LOAD FORM
*
*********************************************************************
*
   INCLUDE TUBP SPECIAL.H
   INCLUDE TUBP ROC.H
   INCLUDE TUBP OBJECT.H
*
*---- DEFINE VARIABLES
*
   PRINT @(-1)
   PRINT
   PRINT 'DOWNLOAD PMCFORMS TO PC, Y/N'
   INPUT ANSWER
   IF ANSWER # 'Y' THEN  GOTO 99999
*
*---- OPEN ALL FILES
*
*
*---- MAIN PROCESSING
*
110*
   PRINT 'INPUT AN ITEM OR "ALL"':
   INPUT FORMID
   IF FORMID # "ALL"  AND FORMID # "" THEN
CALL TU.INIT(ERROR)
      GOSUB 1000
      GOTO 99999
   END
   PRINT @(0,23):'PROCESSING PMCFORMS'
CALL TU.INIT(ERROR)
   RESPONSE = ''
   LISTVAR = ''
   FORMID = ''
   STMT = 'SELECT PMCFORMS'
   UDTEXECUTE STMT CAPTURING RESPONSE RETURNING LISTVAR
   EOF = 0
   LOOP
      READNEXT FORMID ELSE EOF = 1
      PRINT FORMID
   UNTIL EOF DO
      GOSUB 1000
   REPEAT
   GOTO 99999
*
1000 *
   CALL TU.FORM.LOAD("PMCFORMS",FORMID,"","",FRMHNDL,ERROR)
   BEGIN CASE
      CASE ERROR = 0
         CALL TU.FORM.KILL(FRMHNDL,ERROR)
      CASE 1
         PRINT 'CANNOT LOAD FORM ':FORMID
   END CASE
   RETURN
*
*---- ERROR PROCESS
*
91000*
   PRINT @(0,23):CL:ERRMSG:
   INPUT REPLY,1:
   PRINT @(0,23):CL:
   RETURN
*
93000*
   PRINT @(0,23):CL:ERRMSG:
   INPUT REPLY,1:
   PRINT @(0,23):CL:
99999*
   STOP
END
