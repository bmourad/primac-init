* REVISION    - [10.0A]
*  this pgm will use a select list and report the location of the items
*  restrictions the list must be a list in the SAVEDLISTS file and
*  the items in the list should be all of one type.  pgm names, proc names...
*
*COPY>CPYLIB>COM1
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>SYSCOM
*COPY>CPYLIB>CHAR
DIM TYPES(500)
DIM ITEMS(500)
SYS.TYPE=1
CALL SYSCOM(MAT SYSCOM.REC)
OPEN '','MD' TO MD ELSE ERRMSG='MD FILE IS MISSING' ; GOTO 93000
OPEN "SAVEDLISTS" TO SAVEDLISTS ELSE PRINT "SAVEDLISTS FILE IS MISSING" ; GOTO 93000
*      PORT.ACCT=OCONV(0,"U50BB")
*      PORT.NO=FIELD(PORT.ACCT," ",1)
*      ACCT.RUN = FIELD(PORT.ACCT," ",2)
*     PORT.NO = SYSTEM(18)
PORT.NO = 'TTY'
CALL SYSVARS.SUB(PORT.NO)
ACCT.RUN =SYSTEM(19)
PORT.ACCT = PORT.NO:" ":ACCT.RUN
DONE=0
LOOP
UNTIL DONE DO
  PRINT "Enter Type of File to process 'B','P','S','C' or 'X' to Exit :":
  INPUT FTYPE
  IF FTYPE='B' OR FTYPE='C' OR FTYPE='S' OR FTYPE='P' THEN
    DONE =1
  END ELSE
    IF FTYPE='X' THEN
      DONE=1
    END ELSE
      PRINT "Must use B,P,S,C or X to exit"
    END
  END
REPEAT
IF FTYPE = 'X' THEN STOP
PRINT
PRINT
DONE = 0
LOOP
UNTIL DONE DO
  PRINT "Enter List name or 'X' to Exit :":
  INPUT LISTNAME
  IF LISTNAME # "X" THEN
    READ TT FROM SAVEDLISTS,LISTNAME:"000" THEN
      DONE=1
    END ELSE
      PRINT "List ":LISTNAME:" is not a Valid Listname"
    END
  END ELSE
    DONE=1
  END
REPEAT
IF LISTNAME = 'X' THEN STOP
PRINT
PRINT
DONE=0
LOOP
UNTIL DONE DO
  PRINT "Do you want the output to P-Printer or S-Screen (P/S/X) :":
  INPUT PWHERE
  IF PWHERE = 'P' OR PWHERE='S' THEN
    DONE=1
  END ELSE
    IF PWHERE='X' THEN
      DONE=1
    END ELSE
      PRINT "Response must be P,S or X"
    END
  END
REPEAT
IF PWHERE='X' THEN STOP
IF PWHERE='P' THEN
  NO.CRT=1
END ELSE
  NO.CRT=0
END
VERB = "GET-LIST ":LISTNAME
UDTEXECUTE VERB
GOSUB 20000
STOP
*
*
20000*
DONE = 0
CTR=1
LOOP
  READNEXT ID ELSE DONE=1
UNTIL DONE DO
  TYPES(CTR)=FTYPE
  ITEMS(CTR)=ID
  CTR=CTR+1
REPEAT
FLINES = CTR-1
IF NO.CRT THEN
  PRINTER ON
END
SCREEN.ITEMS = ""
BASIC.ITEMS = ""
PROC.ITEMS = ""
CPYLIB.ITEMS = ""
FOR I = 1 TO FLINES
  BEGIN CASE
    CASE TYPES(I) = "S"
      SCREEN.ITEMS<-1> = ITEMS(I)
    CASE TYPES(I) = "P"
      PROC.ITEMS<-1> = ITEMS(I)
    CASE TYPES(I) = "B"
      BASIC.ITEMS<-1> = ITEMS(I)
    CASE 1
      CPYLIB.ITEMS<-1> = ITEMS(I)
  END CASE
NEXT I
IF SCREEN.ITEMS = "" THEN SCREEN.FLG = "N" ELSE SCREEN.FLG = "Y"
IF PROC.ITEMS = "" THEN PROC.FLG = "N" ELSE PROC.FLG = "Y"
IF BASIC.ITEMS = "" THEN BASIC.FLG = "N" ELSE BASIC.FLG = "Y"
IF CPYLIB.ITEMS = "" THEN CPYLIB.FLG = "N" ELSE CPYLIB.FLG = "Y"
MAT TYPES = ""
MAT ITEMS = ""
SCREEN.FILES = ""
PROC.FILES = ""
BASIC.FILES = ""
CPYLIB.FILES = ""
SELECT MD
20001*
READNEXT ID ELSE GOTO 20009
READ REC FROM MD, ID ELSE GOTO 20001
*     IF REC<1> # "D" AND REC<1> # "Q" THEN GOTO 20001
IF REC<1> # "DIR" AND REC<1> # "F" THEN GOTO 20001
ID.LEN = LEN(ID)
BEGIN CASE
  CASE SCREEN.FLG = "Y" AND ID[ID.LEN-6,7] = "SCREENS"
    SCREEN.FILES<-1> = ID
  CASE PROC.FLG = "Y" AND ID[ID.LEN-4,5] = "PROCS"
    PROC.FILES<-1> = ID
  CASE BASIC.FLG = "Y" AND ID[ID.LEN-1,2] = "BP"
    BASIC.FILES<-1> = ID
  CASE CPYLIB.FLG = "Y" AND ID[ID.LEN-5,6] = "CPYLIB"
    CPYLIB.FILES<-1> = ID
END CASE
GOTO 20001
20009*
IF BASIC.FLG = "Y" THEN
  IF BASIC.FILES = "" THEN
    BASIC.ITEMS = ""
    BASIC.FLG = "N"
  END
END
IF SCREEN.FLG = "Y" THEN
  IF SCREEN.FILES = "" THEN
    SCREEN.ITEMS = ""
    SCREEN.FLG = "N"
  END
END
IF PROC.FLG = "Y" THEN
  IF PROC.FILES = "" THEN
    PROC.ITEMS = ""
    PROC.FLG = "N"
  END
END
IF CPYLIB.FLG = "Y" THEN
  IF CPYLIB.FILES = "" THEN
    CPYLIB.ITEMS = ""
    CPYLIB.FLG = "N"
  END
END
IF NO.CRT THEN HEAD.LEN = 128 ELSE HEAD.LEN = 75
PRINT.FLG = 0
IF BASIC.FLG = "Y" THEN
  PRINT.FLG = 1
  HEAD = " 'T' SCANNING BP FILES                  PAGE - 'PL'"
  HEADING HEAD
  BP.CNT = COUNT(BASIC.ITEMS,AM) + (BASIC.ITEMS # "")
  HEAD = "ITEMS - " : BASIC.ITEMS<1>
  FOR BP = 2 TO BP.CNT
    IF LEN(HEAD) + LEN(BASIC.ITEMS<BP>) > HEAD.LEN THEN
      PRINT HEAD
      HEAD = "        "
    END ELSE
      HEAD = HEAD : ', '
    END
    HEAD = HEAD : BASIC.ITEMS<BP>
  NEXT BP
  PRINT HEAD
  PRINT
  BP.FCNT = COUNT(BASIC.FILES,AM) + (BASIC.FILES # "")
  FOR BPF = 1 TO BP.FCNT
    OPEN '',BASIC.FILES<BPF> TO TEMP.FILE ELSE GOTO 20019
    FOR BP = 1 TO BP.CNT
      READ REC FROM TEMP.FILE, BASIC.ITEMS<BP> ELSE REC = ""
      IF REC # "" THEN
        PRINT "ITEM - ":BASIC.ITEMS<BP>: " FOUND IN - ":BASIC.FILES<BPF>
      END
    NEXT BP
20019*
  NEXT BPF
END
IF SCREEN.FLG = "Y" THEN
  IF PRINT.FLG THEN GOSUB 94000 ELSE PRINT.FLG = 1
  HEAD = " 'T' SCANNING SCREENS FILES                  PAGE - 'PL'"
  HEADING HEAD
  BP.CNT = COUNT(SCREEN.ITEMS,AM) + (SCREEN.ITEMS # "")
  HEAD = "ITEMS - " : SCREEN.ITEMS<1>
  FOR BP = 2 TO BP.CNT
    IF LEN(HEAD) + LEN(SCREEN.ITEMS<BP>) > HEAD.LEN THEN
      PRINT HEAD
      HEAD = "        "
    END ELSE
      HEAD = HEAD : ', '
    END
    HEAD = HEAD : SCREEN.ITEMS<BP>
  NEXT BP
  PRINT HEAD
  PRINT
  BP.FCNT = COUNT(SCREEN.FILES,AM) + (SCREEN.FILES # "")
  FOR BPF = 1 TO BP.FCNT
    OPEN '',SCREEN.FILES<BPF> TO TEMP.FILE ELSE GOTO 20029
    FOR BP = 1 TO BP.CNT
      READ REC FROM TEMP.FILE, SCREEN.ITEMS<BP>:"*FRM" ELSE REC = ""
      IF REC # "" THEN
        PRINT "ITEM - ":SCREEN.ITEMS<BP>: " FOUND IN - ":SCREEN.FILES<BPF>
      END
    NEXT BP
20029*
  NEXT BPF
END
IF PROC.FLG = "Y" THEN
  IF PRINT.FLG THEN GOSUB 94000 ELSE PRINT.FLG = 1
  HEAD = " 'T' SCANNING PROC FILES                  PAGE - 'PL'"
  HEADING HEAD
  BP.CNT = COUNT(PROC.ITEMS,AM) + (PROC.ITEMS # "")
  HEAD = "ITEMS - " : PROC.ITEMS<1>
  FOR BP = 2 TO BP.CNT
    IF LEN(HEAD) + LEN(PROC.ITEMS<BP>) > HEAD.LEN THEN
      PRINT HEAD
      HEAD = "        "
    END ELSE
      HEAD = HEAD : ', '
    END
    HEAD = HEAD : PROC.ITEMS<BP>
  NEXT BP
  PRINT HEAD
  PRINT
  BP.FCNT = COUNT(PROC.FILES,AM) + (PROC.FILES # "")
  FOR BPF = 1 TO BP.FCNT
    OPEN '',PROC.FILES<BPF> TO TEMP.FILE ELSE GOTO 20039
    FOR BP = 1 TO BP.CNT
      READ REC FROM TEMP.FILE, PROC.ITEMS<BP> ELSE REC = ""
      IF REC # "" THEN
        PRINT "ITEM - ":PROC.ITEMS<BP>: " FOUND IN - ":PROC.FILES<BPF>
      END
    NEXT BP
20039*
  NEXT BPF
END
IF CPYLIB.FLG = "Y" THEN
  IF PRINT.FLG THEN GOSUB 94000 ELSE PRINT.FLG = 1
  HEAD = " 'T' SCANNING CPYLIB FILES                  PAGE - 'PL'"
  HEADING HEAD
  BP.CNT = COUNT(CPYLIB.ITEMS,AM) + (CPYLIB.ITEMS # "")
  HEAD = "ITEMS - " : CPYLIB.ITEMS<1>
  FOR BP = 2 TO BP.CNT
    IF LEN(HEAD) + LEN(CPYLIB.ITEMS<BP>) > HEAD.LEN THEN
      PRINT HEAD
      HEAD = "        "
    END ELSE
      HEAD = HEAD : ', '
    END
    HEAD = HEAD : CPYLIB.ITEMS<BP>
  NEXT BP
  PRINT HEAD
  PRINT
  BP.FCNT = COUNT(CPYLIB.FILES,AM) + (CPYLIB.FILES # "")
  FOR BPF = 1 TO BP.FCNT
    OPEN '',CPYLIB.FILES<BPF> TO TEMP.FILE ELSE GOTO 20049
    FOR BP = 1 TO BP.CNT
      READ REC FROM TEMP.FILE, CPYLIB.ITEMS<BP> ELSE REC = ""
      IF REC # "" THEN
        PRINT "ITEM - ":CPYLIB.ITEMS<BP>: " FOUND IN - ":CPYLIB.FILES<BPF>
      END
    NEXT BP
20049*
  NEXT BPF
END
IF NO.CRT THEN
  PRINTER OFF
  PRINTER CLOSE
END
RETURN
91000 ERR.TYPE=1 ; CALL SYSCOM(MAT SYSCOM.REC) ; RETURN
92000 ERR.TYPE=2 ; CALL SYSCOM(MAT SYSCOM.REC) ; RETURN
93000 ERR.TYPE=3 ; CALL SYSCOM(MAT SYSCOM.REC)
94000 IF NO.CRT = 0 THEN
  PRINT "PRESS <RETURN> TO CONTINUE":
  INPUT REPLY
  PRINT @(-1) :
END
RETURN
99999*
END
