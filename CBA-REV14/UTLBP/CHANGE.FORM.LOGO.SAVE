*********************************************************************
*
* REVISION    - [11.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
*
* PROGRAM - CHANGE.FORM.LOGO
*
* AUTHOR  - DIANE TOVAR, COMPUTER BUSINESS ASSOCIATES
*
* DATE    - 7/31/96
*
* DESCRIPTION
* READ ALL PMCFORMS AND UPDATE WITH LOGO PATH
*
*********************************************************************
*
*COPY>CPYLIB>CHAR
*
*---- DEFINE VARIABLES
*
   PRINT @(-1)
   PRINT
   PRINT 'ENTER THE OLD PATH : ':
   INPUT OLD.PATH
   PRINT 'ENTER THE NEW PATH : ':
   INPUT NEW.PATH
   PRINT
   PRINT 'OLD PATH = ':OLD.PATH
   PRINT 'NEW PATH = ':NEW.PATH
   PRINT 'IS THIS CORRECT ? : ':
   INPUT ANSWER
   IF ANSWER # 'Y' THEN  GOTO 99999
*
*---- OPEN ALL FILES
*
   OPEN "","PMCFORMS" TO PMCFORMS ELSE
      ERRMSG = "CANNOT OPEN PMCFORMS FILE"
      GOTO 93000
   END
*      OPEN "","DEVBP" TO PMCFORMS ELSE
*         ERRMSG = "CANNOT OPEN DEVBP FILE"
*         GOTO 93000
*      END
*
*---- MAIN PROCESSING
*
110*
   PRINT 'INPUT AN ITEM OR "ALL"':
   INPUT FORMID
   IF FORMID # "ALL"  AND FORMID # "" THEN
      GOSUB 1000
      GOTO 99999
   END
   PRINT @(0,23):'PROCESSING PMCFORMS'
   RESPONSE = ''
   LISTVAR = ''
   STMT = 'SELECT PMCFORMS'
   UDTEXECUTE STMT CAPTURING RESPONSE RETURNING LISTVAR
   EOF = 0
   LOOP
      READNEXT FORMID ELSE EOF = 1
   UNTIL EOF DO
      GOSUB 1000
   REPEAT
   GOTO 99999
*
1000 *
   READU FORM.REC FROM PMCFORMS, FORMID ELSE
      ERRMSG = 'CANNOT READ ':FORMID ; GOSUB 91000
      RETURN
   END
*
   LCNT = DCOUNT(FORM.REC,AM)
   FOR LPTR = 1 TO LCNT
      LINE = FORM.REC<LPTR>
      FND = INDEX(LINE,OLD.PATH,1)
      IF FND THEN
*      LOCATE OLD.PATH IN LINE<0> SETTING FND THEN
         PRINT LINE
         PRINT FND
         PRINT OLD.PATH
         LINE = CHANGE(LINE,OLD.PATH,NEW.PATH)
         FORM.REC<LPTR> = LINE
         FORM.REC<1> =  'formclass ':OCONV(TIME(),'MTS'):'  ':OCONV(DATE(),'D')
         WRITE FORM.REC ON PMCFORMS, FORMID
         LPTR = LCNT
      END
   NEXT LPTR
   RETURN
*
*---- ERROR PROCESS
*
91000*
   PRINT @(0,23):CL:ERRMSG:
   INPUT REPLY,1:
   PRINT @(0,23):CL:
   RETURN
*
93000*
   PRINT @(0,23):CL:ERRMSG:
   INPUT REPLY,1:
   PRINT @(0,23):CL:
99999*
   STOP
END
