* REVISION    - [08.0]
      PROMPT ""
*
      PRINT "SELECT ALL PROGRAMS COMPILED ON OR AFTER - ":
      INPUT CUTOFF.DATE
      IF CUTOFF.DATE = "" THEN STOP
      CUTOFF.DATE = ICONV(CUTOFF.DATE,"D")
*
      PRINT "CUTOFF DATE = ":OCONV(CUTOFF.DATE,"D2-")
      PRINT "CONTINUE (Y/N) ":
      INPUT REPLY
      IF REPLY # "Y" THEN STOP
*
      OPEN "","MD" TO MD ELSE STOP
      FILE = ""
      CNT = 0
      SELECT MD
10*
      READNEXT ID ELSE GOTO 100
      IF ID[LEN(ID)-1,2] # "BP" THEN GOTO 10
      READ REC FROM MD, ID ELSE GOTO 10
      IF REC<1> # "D" THEN GOTO 10
      LOCATE ID IN FILE,1 BY "AL" SETTING P ELSE NULL
      FILE = INSERT(FILE,P,0,0,ID)
      CNT = CNT + 1
      GOTO 10
100*
      FOR F = 1 TO CNT
         FILENAME = FILE<F>
         OPEN "",FILENAME TO FNAME ELSE
            PRINT "INVALID FILE NAME"
            GOTO 90
         END
         GOSUB 1000
90    NEXT F
      STOP
1000*
      PRINTER ON
      PRINT FILENAME
      SELECT FNAME
      LIST = ""
1010*
      READNEXT ID ELSE GOTO 2000
      IF ID[1,1] # "$" THEN GOTO 1010
*     READV LINE5 FROM MD, ID[2,99],5 ELSE GOTO 1010
*     IF LINE5 = "CBA-DEV" THEN GOTO 1010
*     IF FIELD(LINE5," ",1) # "CBA-DEV" THEN GOTO 1010
      READV LINE1 FROM FNAME, ID,1 ELSE GOTO 1010
      COMPILE.DATE = LINE1<1,3>
      CDATE = ICONV(COMPILE.DATE,"D")
      IF CDATE < CUTOFF.DATE THEN GOTO 1010
      PRINT SPACE(10):ID[2,99]
      LIST<-1> = ID[2,99]
      GOTO 1010
2000*
      PRINTER OFF
      IF LIST = "" THEN RETURN
      IF LEN(FILENAME) # 5 THEN RETURN
      WRITELIST LIST ON FILENAME
      RETURN
   END
