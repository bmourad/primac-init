INCLUDE INCS GLOBAL.EQUATES
PROMPT ''
*
OPEN "INSTALL.LISTS" TO INSTALL.LISTS ELSE STOP
OPEN "INSTALL.LISTS,HISTORY" TO INSTALL.HISTORY ELSE STOP
START.ROW = 4
NUM.PER.COL = 15
*-----
START.LBL:
*-----
PRINT CLS:@(20,00):"-- Install Updates to Production Accounts --"
*-----
GET.LIST:
*-----
PRINT @(00,22):"Enter Install List Name or 'END':":
INPUT LIST.NAME
IF LIST.NAME = 'END' THEN STOP
READ LIST.REC FROM INSTALL.LISTS, LIST.NAME ELSE
  PRINT @(00,23):BELL:"'":LIST.NAME:"' is not a valid Install List"
  GOTO GET.LIST
END
ITEM.NDX = 1
GOSUB DISP.LIST
*-----
GET.CONT.FLAG:
*-----
PRINT @(00,22):CLR.EOL:"Enter 'INSTALL' to Proceed with Installation:":
INPUT CONT.FLAG
BEGIN CASE
  CASE CONT.FLAG = 'INSTALL'   ; GOSUB DO.INSTALL
  CASE CONT.FLAG = 'D'
     IF NEXT.ITEM.NDX # 0 THEN
       ITEM.NDX = NEXT.ITEM.NDX
       GOSUB DISP.LIST
     END ELSE
       PRINT @(00,23):BELL:"At end of list":
     END
     GOTO GET.CONT.FLAG
  CASE CONT.FLAG = 'U'
     IF START.ITEM.NDX # 1 THEN
       ITEM.NDX = START.ITEM.NDX - 45
       GOSUB DISP.LIST
     END ELSE
       PRINT @(00,23):BELL:"At start of list":
     END
     GOTO GET.CONT.FLAG
  CASE TRUE
END CASE
*
GOTO START.LBL
*-----
DISP.LIST:
*-----
PRINT @(00,02):CLR.EOS:"Installation List: ":LIST.NAME
NUM.ITEMS = DCOUNT(LIST.REC, AM)
NUM.COLS = NUM.ITEMS/NUM.PER.COL
IF NUM.COLS # INT(NUM.COLS) THEN NUM.COLS = NUM.COLS + 1
IF NUM.COLS > 3 THEN NUM.COLS = 3
PRINT @(00,START.ROW):
FOR C.NUM = 1 TO NUM.COLS
  PRINT "Install Item...........  ":
NEXT C.NUM
R.NUM = 1
C.NUM = 1
START.ITEM.NDX = ITEM.NDX
LOOP
  PRINT @((C.NUM-1)*25,R.NUM+START.ROW):ITEM.NDX"R#2":'. ':LIST.REC<ITEM.NDX>"L#19":
  R.NUM = R.NUM + 1
  IF R.NUM > NUM.PER.COL THEN C.NUM = C.NUM + 1;R.NUM = 1
UNTIL ITEM.NDX = NUM.ITEMS  OR C.NUM > 3 DO
  ITEM.NDX = ITEM.NDX + 1
REPEAT
IF ITEM.NDX < NUM.ITEMS THEN 
  PRINT @(50, 20):"       --- More ---"
  NEXT.ITEM.NDX = ITEM.NDX + 1
END
RETURN
*-----
DO.INSTALL:
*-----
 
RETURN
