      SUBROUTINE ORD.LINE.RPT(CONO,ORDNO,PAGE.NO,DIV.NO,REPORT.NUMBER)
*COPY>CPYLIB>COM1
*COPY>JCS.CPYLIB>COM.JCS.LINK  
*COPY>ICS.CPYLIB>COM.INV.MAIN  
*COPY>ICS.CPYLIB>COM.INV.SERIAL
*COPY>JCS.CPYLIB>COM.INV.STATS 
*COPY>PMC.CPYLIB>COM.CUST
*COPY>OPS.CPYLIB>COM.ORDER
*COPY>ICS.CPYLIB>COM.INV.CNV
********************************************************************
* REVISION    - [08.1]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SOURCE        - OPSBP
* PROGRAM       - ORD.LINE.RPT
* BY            - JULIANNE RIVERA, VERCOM SOFTWARE INC.
* DATE          - 03/24/92
* DESCRIPTION   -
*
*  TASK        19394 7/95 LLH DIVISIONALIZTION
*T21177 diane 02/14/1997 * REV11 UPG
*T26493 cmykleb 03/22/2002 * Change report to use rpt # from proc.
********************************************************************
*COPY>PMC.CPYLIB>CUSTOMER
*COPY>PMC.CPYLIB>COMPANY
*COPY>PMC.CPYLIB>SHIP.TO
*COPY>OPS.CPYLIB>ORDER
*COPY>OPS.CPYLIB>ORDER.DETAIL
*COPY>OPS.CPYLIB>ORDER.DETAIL.INQ
*COPY>ICS.CPYLIB>INVENTORY
*COPY>ICS.CPYLIB>INV.WHSE
*COPY>ICS.CPYLIB>INV.CNV
*COPY>ICS.CPYLIB>FNGD.STATS
*COPY>ICS.CPYLIB>FNGD.ORDER.STATS
*COPY>ICS.CPYLIB>FNGD.JOB.STATS
*COPY>CPYLIB>GEN.XREF.SUB
*COPY>CPYLIB>EDIT.COM
*COPY>CPYLIB>EDIT.COM.DRIVER
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*COPY>CPYLIB>SYSCOM
      MAT SYSCOM.REC =  ""; SYS.TYPE = 2
*
*---- GET COMPANY
*
      MAT COMP.REC = ''
      CONO = ''
      CALL GET.CONO(CONO,MAT COMP.REC)
      IF CONO = 'END' THEN GOTO 99999
*
*---- Display screen
*
      SP1 = SPACE(1)
      GEN.SHPNO = "000"
*
*T26493 v
*     REPORT.NAME = "ORDER LINE DETAIL REPORT"
*     REPORT.NUMBER = "XXXX"
      REPORT.NAME = ""
      CONO.NAME = ""
*T26493 ^
      REPORT.DATE = DATE()
      HD1 = "" ; HD2 = ""
      CALL GET.PROG.HEAD(CONO,CONO.NAME,REPORT.NAME,REPORT.NUMBER,REPORT.DATE,HD1,HD2)
      HD3 = "FOR DIVISION ":DIV.NO
      S.HD1 = SPACE(12):"PRODUCT / DESCRIPTION":SPACE(13):"WHSE UM    ORDERED   RESERVED   ALLOCATED    PRICE      JOB"
      S.UN1 = STR("-",45):" ---- --- ---------- ---------- ---------- ---------- --------"
*
*---- Ship to
100 *
      SHPCNT = DCOUNT(ORD.SHIP.TO,VM)
      FOR T = 1 TO SHPCNT
         IF ORD.SHIP.TO<1,T> = GEN.SHPNO THEN
            MAT SPT.REC = ""
            SPT.NAME = CUST.NAME
            SPT.ADDR1 = CUST.ADDR1
            SPT.ADDR2 = CUST.ADDR2
            SPT.STATE = TRIM(FIELD(CUST.ADDR4,",",2))
            SPT.CITY = TRIM(FIELD(CUST.ADDR4,",",1))
            SPT.ZIP = CUST.ZIP
            SPT.TAX.JUR = CUST.TAX.JUR
            SPT.TAXABLE = CUST.TAXABLE
            SPT.EXEMPT = CUST.EXEMPT
            SPT.EXMT.DATE = CUST.EXMT.DATE
            SPT.SLSMN = CUST.SALESMAN
            SPT.FOB = CUST.ADDL.OPS<1,3>
            SPT.SHP.TERMS = CUST.ADDL.OPS<1,4>
         END ELSE
               MATREAD SPT.REC FROM SHIP.TO, CONO:ORD.CUST:"!":ORD.SHIP.TO<1,T> ELSE
                  GOTO 99
               END
         END
         NEW.SHIP.TO = 1
         LINE.CNT = 99
         GOSUB 1000
99 *
      NEXT T
      GOTO 99999
*
*---- Display a single line
*
1000 *
      MATREAD ORD.DET.REC FROM ORDER.DETAIL, CONO:ORDNO:"!":ORD.SHIP.TO<1,T> ELSE
         MAT ORD.DET.REC = ""
      END
      IF SUM(OSD.G.QTY<1>) = 0 THEN
         GOTO 1999
      END
      CNT = DCOUNT(OSD.PROD,VM)
      FOR N = 1 TO CNT
         IF LINE.CNT > 55 THEN
            GOSUB 3000
         END
         MATREAD INV.REC FROM INVENTORY, CONO:OSD.PROD<1,N> ELSE
            MAT INV.REC = ""; INV.FULL.DESC = "Unknown"
         END
         GOSUB 9000
         P.LINE = OSD.PROD<1,N> "L#15" : SPACE(30)
         P.LINE = P.LINE : SP1 :  OSD.WHSE<1,N> "L#4" 
         P.LINE = P.LINE : SP1 :  INV.UNIT<1,3> "L#3" 
         P.LINE = P.LINE : SP1 :  OCONV(INT(((OSD.G.QTY<1,N> / ICR.DV1) * ICR.MT1) / ICR.DV2 + .5),ICR.CNV1) "R#10" 
         P.LINE = P.LINE : SP1 :  OCONV(INT(((OSD.R.QTY<1,N> / ICR.DV1) * ICR.MT1) / ICR.DV2 + .5),ICR.CNV1) "R#10" 
         P.LINE = P.LINE : SP1 :  OCONV(INT(((OSD.A.QTY<1,N> / ICR.DV1) * ICR.MT1) / ICR.DV2 + .5),ICR.CNV1) "R#10" 
         IF OSD.PRICE<1,N> > 0 THEN
            P.LINE = P.LINE : SP1 :  OCONV(OSD.PRICE<1,N>,"MD4,") "R#10"
         END ELSE
            P.LINE = P.LINE : SP1 :  SPACE(10)
         END
         IF OSD.JOB<1,N,2> # "" THEN
            P.LINE = P.LINE : SP1 :  "MULTI" "L#8"
         END ELSE
            P.LINE = P.LINE : SP1 :  OSD.JOB<1,N> "L#8"
         END
         PRINT P.LINE
         P.LINE = ""
         P.LINE = INV.FULL.DESC "L#45"
         PRINT P.LINE
         LINE.CNT = LINE.CNT + 2
      NEXT N
1999 *
      RETURN
*
*---- PRINT HEADINGS
3000 *
      PRINT CHAR(12)
      PAGE.NO = PAGE.NO + 1
      PRINT HD1:PAGE.NO
      PRINT HD2
      PRINT HD3
      PRINT "ORDER    : ":ORDNO
      PRINT
      IF NEW.SHIP.TO THEN
         PRINT "CUSTOMER : ":ORD.CUST
         PRINT "SHIP TO  : ":ORD.SHIP.TO<1,T>"R#3":SP1: SPT.NAME
         PRINT SPACE(15) : SPT.ADDR1
         PRINT SPACE(15) : SPT.CITY:", ":SPT.STATE:SP1:SPT.ZIP
         LINE.CNT = 12
         NEW.SHIP.TO = 0
      END ELSE
         LINE.CNT = 7
      END
      PRINT
      PRINT S.HD1
      PRINT S.UN1
      RETURN
9000 *
*COPY>ICSBP>INV.UM.CNV
      RETURN
91000 ERR.TYPE=1;CALL SYSCOM(MAT SYSCOM.REC);RETURN
* 91000 *
*       PRINT @(0,23) : ERRMSG : CL :
*       INPUT XX :
*       PRINT @(0,23) : CL :
*       RETURN
93000 ERR.TYPE=3;CALL SYSCOM(MAT SYSCOM.REC)
* 93000 *
*       PRINT @(0,23) : ERRMSG : CL :
*       INPUT XX :
*       PRINT @(0,23) : CL :
99999 *
      RETURN
   END
