      SUBROUTINE ORD.SUM.RPT(CONO,ORDNO,PAGE.NO,DIV.NO,REPORT.NUMBER)
*COPY>CPYLIB>COM1
*COPY>JCS.CPYLIB>COM.JCS.LINK  
*COPY>ICS.CPYLIB>COM.INV.MAIN  
*COPY>ICS.CPYLIB>COM.INV.SERIAL
*COPY>JCS.CPYLIB>COM.INV.STATS 
*COPY>PMC.CPYLIB>COM.CUST
*COPY>OPS.CPYLIB>COM.ORDER
*COPY>ICS.CPYLIB>COM.INV.CNV
********************************************************************
* REVISION    - [08.1]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SOURCE        - OPSBP
* PROGRAM       - ORD.SUM.RPT
* BY            - JULIANNE RIVERA, VERCOM SOFTWARE, INC
* DATE          - 03/24/92
* DESCRIPTION   -
*
* TASK          19394 7/95 LLH DIVISIONALIZATION
*
*T26493 cmykleb 03/22/2002 * Change report to use rpt # from proc.
********************************************************************
*COPY>PMC.CPYLIB>CUSTOMER
*COPY>PMC.CPYLIB>COMPANY
*COPY>OPS.CPYLIB>ORDER
*COPY>OPS.CPYLIB>ORDER.DETAIL.INQ
*COPY>ICS.CPYLIB>INVENTORY
*COPY>ICS.CPYLIB>INV.CNV
*COPY>CPYLIB>EDIT.COM.DRIVER
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*COPY>CPYLIB>SYSCOM
*
*--- SETUP SYSTEM ERROR MESSAGES
*
      SYS.TYPE = 1
      CALL SYSCOM(MAT SYSCOM.REC)
*
*
*---- GET COMPANY
*
      MAT COMP.REC = ''
      CONO = ''
      CALL GET.CONO(CONO,MAT COMP.REC)
      IF CONO = 'END' THEN GOTO 99999
*
*---- GET HEADINGS
*
*T26493 v
*     REPORT.NAME = "ORDER SUMMARY REPORT"
*     REPORT.NUMBER = "XXXX"
      CONO.NAME = ""
      REPORT.NAME = ""
*T26493 ^
      REPORT.DATE = DATE()
      HD1 = "" ; HD2 = ""
      CALL GET.PROG.HEAD(CONO,CONO.NAME,REPORT.NAME,REPORT.NUMBER,REPORT.DATE,HD1,HD2)
      HD3 = SPACE(68):"FOR DIVISION ":DIV.NO
      S.HD1 = SPACE(12):"PRODUCT / DESCRIPTION":SPACE(13):"WHSE   ORDERED   RESERVED   FINISHED    SHIPPED     JOB   S"

      S.UN1 = STR("-",45):" ---- ---------- ---------- ---------- ---------- -------- -"
*
*---- MAIN PROCESSING
*
      SP1 = SPACE(1)
      LINE.CNT = 99
      CNT = DCOUNT(ODQ.PROD,VM)
      FOR N = 1 TO CNT
         IF LINE.CNT > 55 THEN GOSUB 4000
         MATREAD INV.REC FROM INVENTORY, CONO:ODQ.PROD<1,N> ELSE
            MAT INV.REC = ""; INV.FULL.DESC = "Unknown"
         END
*COPY>ICSBP>INV.UM.CNV
         LINE = ODQ.PROD<1,N> "L#15" : SPACE(30)
         LINE = LINE : SP1 : ODQ.WHSE<1,N> "L#4" 
         LINE = LINE : SP1 : OCONV(INT(((ODQ.G.QTY<1,N> / ICR.DV1) * ICR.MT1) / ICR.DV2 + .5),ICR.CNV1) "R#10" 
         LINE = LINE : SP1 : OCONV(INT(((ODQ.R.QTY<1,N> / ICR.DV1) * ICR.MT1) / ICR.DV2 + .5),ICR.CNV1) "R#10" 
         LINE = LINE : SP1 : OCONV(INT(((ODQ.F.QTY<1,N> / ICR.DV1) * ICR.MT1) / ICR.DV2 + .5),ICR.CNV1) "R#10" 
         LINE = LINE : SP1 : OCONV(INT(((ODQ.S.QTY<1,N> / ICR.DV1) * ICR.MT1) / ICR.DV2 + .5),ICR.CNV1) "R#10" 
         IF ODQ.JOB<1,N,2> = "" THEN
            LINE = LINE : SP1 : ODQ.JOB<1,N> "L#8" 
         END ELSE
            LINE = LINE : SP1 : "MULTI" "L#8" 
         END
         BEGIN CASE
            CASE ODQ.I.QTY<1,N> >= ODQ.G.QTY<1,N>
               STATUS = "I"
            CASE ODQ.S.QTY<1,N> >= ODQ.G.QTY<1,N>
               STATUS = "S"
            CASE ODQ.A.QTY<1,N> < 1
               STATUS = "O"
            CASE ODQ.F.QTY<1,N> >= ODQ.A.QTY<1,N>
               STATUS = "F"
            CASE 1
               STATUS = "M"
         END CASE
         LINE = LINE : SP1 : STATUS "L#1"
         PRINT LINE
         LINE = ""
         LINE = INV.FULL.DESC "L#45" 
         PRINT LINE
         LINE.CNT = LINE.CNT + 2
      NEXT N
      GOTO 99999 
*
*---- PRINT HEADINGS
4000 *
      PRINT CHAR(12)
      PAGE.NO = PAGE.NO + 1
      PRINT HD1:PAGE.NO
      PRINT HD2
      PRINT HD3
      PRINT "ORDER : ":ORDNO
      PRINT
      PRINT "CUSTOMER : ":ORD.CUST"L#10":SP1:CUST.NAME"L#30"
      PRINT "ADDRESS  : ":CUST.ADDR1"L#30"
      PRINT SPACE(11):CUST.ADDR2"L#30"
      PRINT SPACE(11):CUST.ADDR4"L#30":"  ":CUST.ZIP"L#10"
      PRINT
      PRINT S.HD1
      PRINT S.UN1
      LINE.CNT = 12
      RETURN
* 91000 PRINT@(0,23) : ERRMSG : CL :
*       INPUT XX :
*       PRINT@(0,23) : CL :
*       RETURN
* 93000 PRINT@(0,23) : ERRMSG : CL :
*       INPUT XX :
*       PRINT@(0,23) : CL :
91000 *
      ERR.TYPE = 1;CALL SYSCOM(MAT SYSCOM.REC); RETURN
92000 *
      ERR.TYPE = 2;CALL SYSCOM(MAT SYSCOM.REC); RETURN
93000 *
      ERR.TYPE = 3;CALL SYSCOM(MAT SYSCOM.REC)
99999 RETURN
   END
