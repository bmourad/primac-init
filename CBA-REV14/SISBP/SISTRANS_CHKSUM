*COPY>SIS.CPYLIB>SIS_TRANS
*COPY>SIS.CPYLIB>SISMSG
*COPY>CPYLIB>CHAR
   OPEN '','SIS_TRANS' TO SIS_TRANS ELSE STOP
   OPEN '','SIS_OUTPUT' TO SIS_OUTPUT ELSE STOP
   OPEN '','SIS_CONTROL' TO SIS_CONTROL ELSE STOP
*
   MODE = "PRINT"
*
   PRINTER ON
   SELECT SIS_OUTPUT
100*
   READNEXT ID ELSE
      PRINTER OFF
      STOP
   END
   MATREAD SISMSG_REC FROM SIS_OUTPUT, ID THEN
      SKIP_TRN = 0
      BEGIN CASE
         CASE SISMSG_ERROR # "CHECKSUM"
            SKIP_TRN = 1
         CASE SISMSG_FILE # "SIS_Trans"
            SKIP_TRN = 1
         CASE SISMSG_ITEM = ""
            SKIP_TRN = 1
         CASE 1
      END CASE
      IF SKIP_TRN THEN
         RELEASE SIS_OUTPUT, ID
         GOTO 100
      END
   END ELSE
      CRT ID :", SIS_OUTPUT is missing"
      GOTO 100
   END
*
   MATREAD SISTRN_REC FROM SIS_TRANS, SISMSG_ORGID THEN
      SKIP_TRN = 0
      BEGIN CASE
         CASE SISMSG_CONO # SISTRN_CONO
            SKIP_TRN = 1
         CASE SISMSG_SERVER # SISTRN_SERVER
            SKIP_TRN = 1
         CASE SISMSG_CLIENT # SISTRN_CLIENT
            SKIP_TRN = 1
         CASE SISMSG_ITEM # SISTRN_TRANSID
            SKIP_TRN = 1
         CASE 1
      END CASE
      IF SKIP_TRN THEN
         CRT SISMSG_ORGID :", SIS_OUTPUT/SIS_TRANS mismatch"
         GOTO 100
      END
      TOT_CHKSUM = 0
      CALL SISTRANS_CHECKSUM_SUB (MODE, SISMSG_ORGID, MAT SISMSG_REC, MAT SISTRN_REC, TOT_CHKSUM)
   END ELSE
      CRT ID :", SIS_TRANS is missing"
   END
   GOTO 100
END
