************************************************************
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM        - PRIMAC
* SOURCE        - ARSBP
* PROGRAM       - ROLPRT1
* BY            - RHONDA PERRIN,COMPUTER BUSINESS ASSOCIATES
* DATE          - 05/10/85
* DESCRIPTION   -
* This program prints Rolodex records by:
*  1) All Customers
*  2) New Customers
*
* REV11 UPG diane 2/20/97 Remove CHAIN
*ENDDOC
************************************************************
*
    CS = CHAR(12)
    VM = CHAR(253)
    PROMPT ""
*    PROCREAD X ELSE PRINT "MUST BE RUN FROM PROC PROLPRT";INPUT X;CHAIN "M"
    PROCREAD X ELSE PRINT "MUST BE RUN FROM PROC PROLPRT";INPUT X;STOP
    CONO=EXTRACT(X,1,0,0)
    CHOICE = X<3>
    DIM CUST(100)
    OPEN "","CUSTOMER" TO F.CUST ELSE ERROR="CUST";GOTO 9980
    OPEN "","CONTROL" TO CTRLFILE ELSE ERROR="CONTROL";GOTO 9980
100 PRINT @(-1):@(10,10):"ROLODEX CARD PRINT":@(10,11):"HOW MANY CARDS PER CUSTOMER? #":CHAR(8):CHAR(7):;INPUT CDNUM
    IF CDNUM="END" THEN STOP
    IF CDNUM="" THEN GOTO 100
    IF NOT(NUM(CDNUM)) THEN GOTO 100
    IF CDNUM>9 THEN GOTO 100
    PRINTER ON
    IF CHOICE = 1 THEN
       GOTO 150
    END ELSE
       GOTO 175
    END
150 READNEXT ID ELSE GO 160
    MATREAD CUST FROM F.CUST,ID ELSE GOTO 150
    FOR XX=1 TO CDNUM
       PRINT"*";PRINT;PRINT ID[1,3]:" ":ID[4,8]
       PRINT CUST(1)"L#40"
       PRINT CUST(2)"L#40"
       IF CUST(3)#"" THEN PRINT CUST(3)"L#30"
       IF CUST(4)#"" THEN PRINT CUST(4):"  ":CUST(5) ELSE PRINT CUST(5)
       IF CUST(3)="" THEN PRINT
       PRINT CUST(6);PRINT
       PRINT CUST(8):SPACE(3):CUST(7)<1,1>
       FOR TT=1 TO 3;PRINT;NEXT TT
    NEXT XX
    GOTO 150
160 GOTO 99999
175 READVU KEY FROM CTRLFILE,CONO:"ROLODEX",1 ELSE RELEASE CTRLFILE,CONO:"ROLODEX";PRINT "ROLODEX MISSING":;INPUT KEY:;CHAIN "M"
    CNT = COUNT(KEY,VM) + (KEY # "")
    FOR YY=1 TO CNT
       ID=EXTRACT(KEY,1,YY,0)
       ID=CONO:ID
       MATREAD CUST FROM F.CUST,ID ELSE GOTO 200
       FOR XX=1 TO CDNUM
          PRINT"*";PRINT;PRINT ID[1,3]:" ":ID[4,8]
          PRINT CUST(1)"L#40"
          PRINT CUST(2)"L#40"
          IF CUST(3)#"" THEN PRINT CUST(3)"L#30"
          IF CUST(4)#"" THEN PRINT CUST(4):"  ":CUST(5) ELSE PRINT CUST(5)
          IF CUST(3)="" THEN PRINT
          PRINT CUST(6);PRINT
          PRINT CUST(8):SPACE(3):CUST(7)<1,1>
          FOR TT=1 TO 3;PRINT;NEXT TT
       NEXT XX
200 NEXT YY
    PRINTER CLOSE
    PRINTER OFF
300 PRINT STR(CS,4)
    PRINT@(5,5):"WARNING, IF ANSWERED 'Y' THE POINTERS WILL BE DESTROYED!":
    PRINT@(5,10):"DID THE ROLODEX CARDS PRINT PROPERLY AND":@(5,11):"DO YOU HAVE ALL THE COPIES YOU WILL NEED  (Y/N)  ":;INPUT YY
    IF YY='N' THEN RELEASE CTRLFILE,CONO:"ROLODEX";STOP
    IF YY#'Y' THEN GO 300
    KEY=''
    WRITEV KEY ON CTRLFILE,CONO:"ROLODEX",1
    GOTO 99999
9980PRINT @(-1):@(10,10):"FILE ":ERROR:" MISSING!! - ENTER <RTN> TO END:":CHAR(7):;INPUT ANS
99999*
    PRINTER OFF
    PRINT @(0,0):@(-1)
    STOP
 END
