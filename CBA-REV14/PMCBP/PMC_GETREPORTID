   SUBROUTINE PMC_GETREPORTID(ERRMSG,IN_PARAM,OUT_PARAM,HOLD_FILE,CONTROL)
   ERRMSG = ""
   OUT_PARAM = ""
   CONO = IN_PARAM<1> ;* 001
   SEQ_ID = IN_PARAM<2> ;* CONTROL RECORD ID
   IF FILEINFO(HOLD_FILE,0) # 1 THEN
      OPEN '',"_HOLD_" TO HOLD_FILE ELSE
         ERRMSG = "_HOLD_ FILE IS MISSING"
         GOTO 999999
      END
   END
   IF FILEINFO(CONTROL,0) # 1 THEN
      OPEN '',"CONTROL" TO CONTROL ELSE
         ERRMSG = "CONTROL FILE IS MISSING"
         GOTO 999999
      END
   END
   P_DATE = DATE()
   READU SEQ_REC FROM CONTROL, CONO:SEQ_ID ELSE SEQ_REC = ""
   PPSR_ID = ""
   LOOP
   UNTIL PPSR_ID # "" DO
      IF SEQ_REC<1> = "" OR P_DATE > SEQ_REC<1> THEN
         SEQ_REC<1> = P_DATE
         SEQ_REC<2> = 0
      END
      SEQ_REC<2> += 1
      PPSR_ID = CONO : P_DATE : "_" : SEQ_REC<2>
      READU DUMMY FROM HOLD_FILE, PPSR_ID THEN
         PPSR_ID = ""
      END LOCKED
         PPSR_ID = ""
      END
   REPEAT
   DUMMY = ""
   WRITE SEQ_REC ON CONTROL, CONO:SEQ_ID
   OUT_PARAM = PPSR_ID
999999*
   RETURN
END
