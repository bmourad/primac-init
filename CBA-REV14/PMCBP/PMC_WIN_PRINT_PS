SUBROUTINE PMC_WIN_PRINT_PS(DEST,PS.PATH,COPY)
STM = "WHERE"
UDTEXECUTE STM CAPTURING WLOC
DEST = TRIM(DEST)
DEST = FIELD(DEST,"\",4)
WLOC = FIELD(WLOC,@AM,1)
STM = "LISTPTR"
UDTEXECUTE STM CAPTURING PRLST
PRLST = TRIM(PRLST)
PRCNT = DCOUNT(PRLST,@AM)
FOR PRX = 1 TO PRCNT
  PRTCHK = FIELD(PRLST<PRX,1>," ",1)
  IF DEST = PRTCHK THEN
    SYSLOC = FIELD(PRLST<PRX,1>," ",2)[4,99]
  END
NEXT PRX
IF COPY # "" THEN
  FOR P = 1 TO COPY
    PRTSMT = "!lpr -S ":SYSLOC:" -P ":DEST:" ":WLOC:"\":PS.PATH
    UDTEXECUTE PRTSMT
  NEXT P
END
RETURN
