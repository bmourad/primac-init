  SUBROUTINE LIST.ACCESS.BY.USER(CONO,MAT SEC.REC,USERID,ACCESS_BY_USER, EASY.MENUS)
*COPY>CPYLIB>COM1
*********************************************************************
* REVISION     - [12.0]
* Copyright 1998 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM       - PRIMAC
* SOURCE       - PMCBP
* PROGRAM      - LIST.ACCESS.BY.USER
* BY           - ALEJANDRO DELGAD
* DATE         - 08/07/2002
* DESCRIPTION  - 
*                This program lists all menus the user has access to.
*
*T26784 adelgado 08/07/2002 * Original Code.
*********************************************************************
*
*COPY>PMC.CPYLIB>COMPANY
*COPY>PMC.CPYLIB>SECURITY
*COPY>CPYLIB>EDIT.COM
*COPY>CPYLIB>EDIT.COM.DRIVER
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*COPY>CPYLIB>SYSCOM
  MAT SYSCOM.REC =  ""; SYS.TYPE = 2
*
* INITIALIZE *
*
  DIM MENU.REC(40)
  ERRMSG = ""
  LINE.SPACE = 1
  PAGE.SIZE = 12
  BEGIN.PAGE = 8
  REQUEST = ''
  LINES=0;START.LINE=0;OLD.START.LINE=0;LAST.LINE=0
  ECD.SCRN.NO = 6
  SCV.REC(8)<ECD.SCRN.NO> = CONO
  SCV.REC(9)<ECD.SCRN.NO> = USERID
  SCV.REC(10)<ECD.SCRN.NO> = SEC.NAME
  READ ACCESS.REC FROM ACCESS_BY_USER, CONO:USERID ELSE ACCESS.REC = ''
  LINES = DCOUNT(ACCESS.REC<1>, VM)
  FOR XX = 1 TO LINES
    SCV.REC(2)<ECD.SCRN.NO,XX> = XX
    SCV.REC(11)<ECD.SCRN.NO,XX> = ACCESS.REC<1,XX>
    MATREAD MENU.REC FROM EASY.MENUS, ACCESS.REC<1,XX> ELSE MAT MENU.REC = ''
    SCV.REC(12)<ECD.SCRN.NO,XX> = MENU.REC(1)<1,3>
  NEXT XX
  ECD.ACTION = 3 ; CALL SCRN.EDIT
*
  LOOP.DONE = 0 ; START = 1
  LOOP
    ECD.NUM = 5; ECD.ACTION=4; CALL SCRN.EDIT
    BEGIN CASE
      CASE ECD.RET.VALUE = 'E' OR ECD.RET.VALUE = 'END'
        LOOP.DONE = 1
      CASE ECD.RET.VALUE = "S"
        START += PAGE.SIZE
        IF START > LINES THEN START = 1
        GOSUB DISPLAY.MULTI.LINES
      CASE ECD.RET.VALUE = 'SR'     
        START -= PAGE.SIZE      
        IF START < 1 THEN START = 1
        GOSUB DISPLAY.MULTI.LINES
      CASE ECD.RET.VALUE = 'ST'     
        START = 1               
        GOSUB DISPLAY.MULTI.LINES
      CASE ECD.RET.VALUE = 'SB'     
        START = LINES           
        GOSUB DISPLAY.MULTI.LINES
    END CASE
  UNTIL (LOOP.DONE) DO REPEAT
  GOTO 99999
*
DISPLAY.MULTI.LINES: 
*
  START = 1 + INT((START-1)/PAGE.SIZE) * PAGE.SIZE
  ECD.NUM=2 ; ECD.SUB.NUM=START ; ECD.ACTION=7 ; CALL SCRN.EDIT
  ECD.NUM=11 ; ECD.SUB.NUM=START ; ECD.ACTION=7 ; CALL SCRN.EDIT
  ECD.NUM=12 ; ECD.SUB.NUM=START ; ECD.ACTION=7 ; CALL SCRN.EDIT
  RETURN
*
91000*
  ERR.TYPE = 1 ; CALL SYSCOM(MAT SYSCOM.REC) ; RETURN
92000*
  ERR.TYPE = 2 ; CALL SYSCOM(MAT SYSCOM.REC) ; RETURN
93000*
  ERR.TYPE = 3 ; CALL SYSCOM(MAT SYSCOM.REC)
99999*
  ECD.ACTION = 99; CALL SCRN.EDIT
END
