*COPY>CPYLIB>COM1
*********************************************************************
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - PMCBP
* PROGRAM     - CONTROL.SETUP
* BY          - WALID YAMOUT, C.B.A
* DATE        - 10/11/84
* DESCRIPTION -
*********************************************************************
*ENDDOC
*COPY>PMC.CPYLIB>COMPANY
*COPY>CPYLIB>EDIT.COM.DRIVER
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*COPY>CPYLIB>SYSCOM
*
*--- SET UP ERROR ROUTINE
*
   SYS.TYPE = 1
   CALL SYSCOM(MAT SYSCOM.REC)
*
*--- OPEN FILES
*
   MAT FILE.VARS = ""
OPEN '','CONTROL' TO CONTROL ELSE ERRMSG = "CONTROL FILE IS MISSING"; GOTO 93000
OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = "COMPANY FILE IS MISSING"; GOTO 93000
OPEN '','PMC.SCREENS' TO M.SCREENS ELSE ERRMSG = "PMC.SCREENS FILE IS MISSING"; GOTO 93000
   MAT EDIT.COM.DRIVER = ""
   ECD.SCRN.CNT = 10
   ECD.SCRN.NAME<1> = "CONTROL.SETUP"
   ECD.SCRN.NAME<2> = "CONTROL.ARS.SUB"
   ECD.SCRN.NAME<3> = "CONTROL.APS.SUB"
   ECD.SCRN.NAME<4> = "CONTROL.PRS.SUB"
   ECD.SCRN.NAME<5> = "CONTROL.GLS.SUB"
   ECD.SCRN.NAME<6> = "CONTROL.ICS.SUB"
   ECD.SCRN.NAME<7> = "CONTROL.POS.SUB"
   ECD.SCRN.NAME<8> = "CONTROL.JES.SUB"
   ECD.SCRN.NAME<9> = "CONTROL.JCS.SUB"
   ECD.SCRN.NAME<10> = "CONTROL.PSS.SUB"
   ECD.ACTION = 1; CALL SCRN.EDIT
   ECD.SCRN.NO = 1
100*
   MAT SCV.REC = ""
   ECD.ACTION = 6; CALL SCRN.EDIT
   ECD.NUM = 1; ECD.ACTION = 4; CALL SCRN.EDIT
   BEGIN CASE
     CASE ECD.RET.VALUE = "END"
       GOTO 999999
     CASE NUM(ECD.RET.VALUE) AND ECD.RET.VALUE > 0
       MAT COMP.REC = ""
       CONO = ECD.RET.VALUE
       MATREAD COMP.REC FROM COMPANY, CONO ELSE GOTO 500
       CALL CONTROL.SETUP.LIST(CONO)
       ECD.ACTION = 2; CALL SCRN.EDIT
       ECD.ACTION = 3; CALL SCRN.EDIT
       RELEASE COMPANY, CONO
       GOTO 100
     CASE 1
       ERRMSG = "INVALID COMPANY NUMBER"; GOSUB 91000; GOTO 100
   END CASE
*
*--- ENTER OPTION
*
500*
   ECD.NUM = 2; SCV.REC(2)<1> = ""; ECD.ACTION = 4; CALL SCRN.EDIT
   OPTION = ECD.RET.VALUE
   BEGIN CASE
     CASE OPTION = "E" OR OPTION = "END"
       RELEASE COMPANY, CONO
       GOTO 100
     CASE OPTION = "P"
       CALL CONTROL.SETUP.LIST(CONO)
       ECD.ACTION = 2; CALL SCRN.EDIT
       ECD.ACTION = 3; CALL SCRN.EDIT
     CASE NUM(OPTION) AND OPTION > 0
       ON OPTION GOSUB 10100,10200,10300,1000,10500,1000,10700,10800,11000,11100,1000,1000
       ECD.SCRN.NO = 1; ECD.ACTION = 3; CALL SCRN.EDIT
   END CASE
   GOTO 500
*
*--- INVALID
*
1000*
   ERRMSG = "NO SETUP NEEDED FOR THIS MODULE"; GOSUB 91000
RETURN
*
*--- ARS SETUP
*
10100*
   ECD.SCRN.NO = 2
   CALL CONTROL.ARS.SUB(CONO)
RETURN
*
*--- APS SETUP
*
10200*
   ECD.SCRN.NO = 3
   CALL CONTROL.APS.SUB(CONO)
RETURN
*
*--- PRS SETUP
*
10300*
   ECD.SCRN.NO = 4
   CALL CONTROL.PRS.SUB(CONO)
RETURN
*
*--- GLS SETUP
*
10500*
   ECD.SCRN.NO = 5
   CALL CONTROL.GLS.SUB(CONO)
RETURN
*
*--- ICS SETUP
*
10700*
   ECD.SCRN.NO = 6
   CALL CONTROL.ICS.SUB(CONO)
RETURN
*
*--- POS SETUP
*
10800*
   ECD.SCRN.NO = 7
   CALL CONTROL.POS.SUB(CONO)
RETURN
*
*--- JES SETUP
*
11000*
   ECD.SCRN.NO = 8
   CALL CONTROL.JES.SUB(CONO)
RETURN
*
*--- JCS SETUP
*
11100*
   ECD.SCRN.NO = 9
   CALL CONTROL.JCS.SUB(CONO)
RETURN
*
*--- PSS SETUP
*
11200*
*  ECD.SCRN.NO = 10
*  CALL CONTROL.PSS.SUB(CONO)
RETURN
*
*---   ERROR ROUTINE
*
91000 ERR.TYPE = 1; CALL SYSCOM(MAT SYSCOM.REC); RETURN
92000 ERR.TYPE = 2; CALL SYSCOM(MAT SYSCOM.REC); RETURN
93000 ERR.TYPE = 3; CALL SYSCOM(MAT SYSCOM.REC)
999999*
*    PRINT @(-1):
   END
