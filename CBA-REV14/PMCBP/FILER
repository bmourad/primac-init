      SUBROUTINE FILER (CONO,FILENAME,OLD,NEW,KEY,KEYWORDS)
*COPYRIGHT MICRODATA CORPORATION
*ALL RIGHTS RESERVED
*THIS SUBROUTINE WILL MAINTAIN XREF LISTS OF KEY WORDS
      TBL=""
      OLD=TRIM(OLD)
      X=COUNT(OLD," ")+1
      L=X
      FOR I=1 TO X
         WORD=FIELD(OLD," ",I)
         IF WORD[LEN(WORD),1]<"/" THEN WORD=WORD[1,LEN(WORD)-1]
         IF WORD="" THEN GOTO 10
         IF LEN(WORD)=1 THEN GOTO 10
         LOCATE WORD IN TBL<1>,1 BY "AL" SETTING J ELSE INS WORD BEFORE TBL<1,J>
10    NEXT I
      NEW=TRIM(NEW)
      X=COUNT(NEW," ")+1
      FOR I=1 TO X
         WORD=FIELD(NEW," ",I)
         IF WORD[LEN(WORD),1]<"/" THEN WORD=WORD[1,LEN(WORD)-1]
         IF WORD="" THEN GOTO 20
         IF LEN(WORD)=1 THEN GOTO 20
         LOCATE WORD IN TBL<1>,1 BY "AL" SETTING J ELSE INS "" BEFORE TBL<1,J>;L=L+1; INS WORD BEFORE TBL<2,J>
         TBL<2,J>=WORD
20    NEXT I
      FOR X=1 TO L
         WORD1=TBL<1,X>;WORD2=TBL<2,X>
         IF WORD1="" THEN GOTO 22
         LOCATE WORD1 IN KEYWORDS<1> BY "AL" SETTING J ELSE GOTO 22
         GOTO 25
22       IF WORD2="" THEN GOTO 23
         LOCATE WORD2 IN KEYWORDS<1> BY "AL" SETTING J ELSE GOTO 23
         GOTO 25
23       IF WORD1="" AND WORD2="" THEN GOTO 25
         IF WORD1="" THEN GOTO 30;*ADD ROUTINE
         IF WORD2="" THEN GOTO 40;*DELETE ROUTINE
25    NEXT X
      RETURN
30    READVU REC FROM FILENAME,CONO:WORD2,1 ELSE REC=""
      LOCATE KEY IN REC<1>,1 BY "AL" SETTING I ELSE GO 35
      RELEASE FILENAME,CONO:WORD2
      GOTO 25
35    INS KEY BEFORE REC<1,I>
      WRITEV REC ON FILENAME,CONO:WORD2,1
      GOTO 25
40    READVU REC FROM FILENAME,CONO:WORD1,1 ELSE REC=""
      LOCATE KEY IN REC<1>,1 BY "AL" SETTING I ELSE RELEASE FILENAME,CONO:WORD1;GOTO 25
      DEL REC<1,I>
      IF REC="" THEN DELETE FILENAME,CONO:WORD1;GOTO 25
      WRITEV REC ON FILENAME,CONO:WORD1,1
      GOTO 25
   END   
