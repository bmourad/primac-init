   SUBROUTINE SYSCOM(MAT SYSCOM.REC)
*COPY>CPYLIB>COM3
***************************************
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
*T21046 rick 10/01/1996 * Modify pgm to support a new ERR.TYPE of 4
*                         which is like 1 except it passes back the
*                         users response to a prompt 
*T21177 diane 11/06/1996 * REV11 UPG
*ENDDOC
***************************************
*COPY>CPYLIB>EDIT.COM
*COPY>CPYLIB>SYSCOM
*COPY>CPYLIB>CHAR
*COPY>CPYLIB>TCC
*COPY>CPYLIB>PORT.CONTROL
*COPY>CPYLIB>ROC.H
*COPY>CPYLIB>SPECIAL.H
*
   PROMPT ""
   BEGIN CASE
   CASE SYS.TYPE = 1
      MAT SYSCOM.REC = ''
      SYS.TYPE = 2
   CASE SYS.TYPE = 2
      BEGIN CASE
      CASE ERR.TYPE = 1
         IF GUIFORM AND TU_VERNO THEN
            TYPE = "DLG.ERROR"
            BUTTONS = ""; RETURNS = ""
            IF ERR.CODE = "1" THEN
               TITLE = "I N F O   B O X"
            END ELSE
               TITLE = "M E S S A G E   B O X"
            END
            TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
            CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
         END ELSE
            CRTMODE = ""
            CALL GET.CRTMODE(CRTMODE)
            IF CRTMODE = "termulator" THEN
               GOSUB 1100
               TYPE = "DLG.ERROR"
               BUTTONS = ""; RETURNS = ""
               IF ERR.CODE = "1" THEN
                  TITLE = "I N F O   B O X"
               END ELSE
                  TITLE = "M E S S A G E   B O X"
               END
               TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
               CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
            END ELSE
               PRINT @(0,23) : SPACE(2) : ERRMSG : CL :
               PRINT @(0,23) :
               INPUT XX :
               PRINT @(0,23) : CL :
            END
         END
      CASE ERR.TYPE = 2
         IF GUIFORM THEN
            TYPE = "DLG.ERROR"
            BUTTONS = ""; RETURNS = ""
            TITLE = 'ERROR WARNING !!'
            ERRMSG = 'PLEASE NOTE DOWN THIS MESSAGE, AND':VM:'CONTACT YOUR VENDOR ':VM:ERRMSG
            TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
            CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
         END ELSE
            CRTMODE = ""
            CALL GET.CRTMODE(CRTMODE)
            IF CRTMODE = "termulator" THEN
               GOSUB 1100
               TYPE = "DLG.ERROR"
               BUTTONS = ""; RETURNS = ""
               TITLE = 'ERROR WARNING !!'
               ERRMSG = 'PLEASE NOTE DOWN THIS MESSAGE, AND':VM:'CONTACT YOUR VENDOR ':VM:ERRMSG
               TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
               CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
            END ELSE
               PRINT @(0,23) : SPACE(2) : 'WARNING !! PLEASE NOTE DOWN THIS MESSAGE, AND CONTACT YOUR VENDOR' : CL :
               INPUT XX :
               PRINT @(0,23) : SPACE(2) : ERRMSG : CL :
               PRINT @(0,23) :
               INPUT XX :
               PRINT @(0,23) : CL :
            END
         END
      CASE ERR.TYPE = 3
         IF GUIFORM THEN
            TYPE = "DLG.ERROR"
            BUTTONS = ""; RETURNS = ""
            TITLE = 'ERROR ALERT !!'
            ERRMSG = 'PLEASE NOTE DOWN THIS MESSAGE, AND':VM:'CONTACT YOUR VENDOR IMMEDIATELY':VM:ERRMSG
            TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
            CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
            TU_FUNC = "TU.RESET":TU_VERNO
            EXECUTE TU_FUNC
         END ELSE
            CRTMODE = ""
            CALL GET.CRTMODE(CRTMODE)
            IF CRTMODE = "termulator" THEN
               GOSUB 1100
               TYPE = "DLG.ERROR"
               BUTTONS = ""; RETURNS = ""
               TITLE = 'ERROR ALERT !!'
               ERRMSG = 'PLEASE NOTE DOWN THIS MESSAGE, AND':VM:'CONTACT YOUR VENDOR IMMEDIATELY':VM:ERRMSG
               TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
               CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
               TU_FUNC = "TU.RESET":TU_VERNO
               EXECUTE TU_FUNC
            END ELSE
               PRINT @(0,23) : SPACE(2) : 'ALERT !! PLEASE NOTE THIS MESSAGE, AND CONTACT YOUR VENDOR IMMEDIATELY' : CL :
               INPUT XX :
               PRINT @(0,23) : SPACE(2) : ERRMSG : CL :
               PRINT @(0,23) :
               INPUT XX :
               PRINT @(0,23) : CL :
            END
         END
         CHAIN "OFF"
      CASE ERR.TYPE = 4
         IF GUIFORM THEN
            IF LEN(ERRMSG) > 70 THEN
               TERR = ERRMSG[1,70]:VM:ERRMSG[71,999]
               ERRMSG = TERR
            END
            TYPE = "DLG.ERROR"
            BUTTONS = "OK":VM:"RETRY":VM:"ABORT"
            RETURNS = "":VM:"R":VM:"A"
            IF ERR.CODE = "1" THEN
               TITLE = "I N F O   B O X"
            END ELSE
               TITLE = "M E S S A G E   B O X"
            END
            TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
            CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
            IF NOT(ERROR) THEN
               ERR.RESP = VALUE
            END ELSE
               ERR.RESP = ""
            END
         END ELSE
            IF LEN(ERRMSG) > 70 THEN
               PRINT @(0,23): CL : ERRMSG[1,70]:
               INPUT XX
               ERRMSG = ERRMSG[71,999]
            END
            PRINT @(0,23) : CL : ERRMSG :
            INPUT XX :
            PRINT @(0,23) : CL :
            ERR.RESP = XX
         END
      CASE 1
      END CASE
   CASE 1
   END CASE
   GOTO 99999
*
*---- Get TU_VERNO
1100*
   IF UNASSIGNED(TU_VERNO) OR TU_VERNO = 0 THEN
      TU_VERNO_ID = "T_":@LOGNAME
      IF FILEINFO(TCC,0) THEN
         READ TU_VERNO FROM TCC, TU_VERNO_ID ELSE TU_VERNO = ""
      END ELSE
         OPEN "","TCC" TO TCC THEN
            READ TU_VERNO FROM TCC, TU_VERNO_ID ELSE TU_VERNO = ""
         END ELSE
            TU_VERNO = ""
         END
      END
   END
   RETURN
99999*
   RETURN
END
