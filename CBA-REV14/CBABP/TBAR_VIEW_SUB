      SUBROUTINE TBAR_VIEW_SUB (BAR_FILE, BAR_NAME, PREV_ACTIVE, PREV_HNDL, SCRN_PC, ALN, ERROR)
      BFILE = ""
      BNAME = ""
OPEN "","TCC" TO TCC THEN
   TU_VERNO_ID = "T_":@LOGNAME
   READ TU_VERNO FROM TCC, TU_VERNO_ID ELSE TU_VERNO = ""
END ELSE
   TU_VERNO = ""
END
      IF PREV_HNDL<ALN> # "" THEN
         BFILE = PREV_ACTIVE<ALN,2>
         BNAME = PREV_ACTIVE<ALN,1>
         BARHNDL = PREV_HNDL<ALN>
         TU_FUNC = "TU.TOOLBAR.KILL":TU_VERNO
         CALL @TU_FUNC(BARHNDL,ERROR)
         PREV_ACTIVE<ALN> = ""
         PREV_HNDL<ALN> = ""
      END
      FRMHNDL = SCRN_PC<ALN>
      TU_FUNC = "TU.TOOLBAR.LOAD":TU_VERNO
      CALL @TU_FUNC(BAR_FILE,BAR_NAME,FRMHNDL,"",BARHNDL,ERROR)
      IF ERROR = 0 THEN
         ASK_VALUE = ""
         ASK_TYPE = "DLG.QUESTION"
         ASK_PMSG = "Check the display of the ToolBar"
         ASK_PMSG<1,2> = "Hit <ok> to Continue"
         ASK_BUT = ""
         ASK_BUT_VAL = "Y"
         ASK_HMSG = "PRIMAC ToolBar Utilities"
         TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
         CALL @TU_FUNC(ASK_VALUE,ASK_TYPE,ASK_PMSG,ASK_BUT,ASK_BUT_VAL,ASK_HMSG,ERROR)
         TU_FUNC = "TU.TOOLBAR.KILL":TU_VERNO
         CALL @TU_FUNC(BARHNDL,ERROR)
      END
      IF BFILE # "" AND BNAME # "" THEN
         FRMHNDL = SCRN_PC<ALN>
         TU_FUNC = "TU.TOOLBAR.LOAD":TU_VERNO
         CALL @TU_FUNC(BFILE,BNAME,FRMHNDL,"",BARHNDL,ERROR)
         IF ERROR = 0 THEN
            PREV_ACTIVE<ALN> = BNAME
            PREV_ACTIVE<ALN,2> = BFILE
            PREV_HNDL<ALN> = BARHNDL
         END
      END
      RETURN
   END
