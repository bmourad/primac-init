*COPY>CPYLIB>CHAR
PROMPT ''
DIM CH.REC(5)
EQU CH.CHANGE TO CH.REC(1)
STD.SIZE = 7
DIM STD.CHANGES(7)
EQU STD.1 TO STD.CHANGES(1)
EQU STD.2 TO STD.CHANGES(2)
EQU STD.3 TO STD.CHANGES(3)
EQU STD.4 TO STD.CHANGES(4)
EQU STD.5 TO STD.CHANGES(5)
EQU STD.6 TO STD.CHANGES(6)
EQU STD.7 TO STD.CHANGES(7)
*
MAT STD.CHANGES = ''
*
STD.1<1,1> = "CHANGED NUMERIC DICT REFERENCES TO NON-NUMERIC"
STD.1<1,2> = "AND USE 'EX.INFORM' FOR SCREEN DISPLAY"
STD.1<1,3> = ''
STD.2<1,1> = "CHANGED DICT REFERENCE OF JOB# FOR 'JOB.REVERSE'"
STD.2<1,2> = "TO 'JOBNO'"
STD.2<1,3> = ''
STD.3<1,1> = "CHANGED DICT REFERENCE OF JOB# FOR 'JOB.CREDIT.STATS'"
STD.3<1,2> = "TO 'JOBNO'"
STD.3<1,3> = ''
STD.4<1,1> = "CHANGED DICT REFERENCE OF JOB# FOR 'JOB.TIME'"
STD.4<1,2> = "TO 'JOBNO'"
STD.4<1,3> = ''
STD.5<1,1> = "REMOVED '(' AND ')' FROM 'xxx-FILE' STATEMENTS"
STD.5<1,2> = ''
STD.5<1,3> = ''
STD.6<1,1> = "REMOVED '=' FROM MV STATEMENTS"
STD.6<1,2> = "i.e. MV %3 = '... should read MV %3 '...."
STD.6<1,3> = ''
STD.7<1,1> = "CHANGED ASSIGNMENT USING 'SYSTEM(18)' TO USE"
STD.7<1,2> = "'@TTY'"
STD.7<1,3> = ''
OPEN '','RBS.LOG.FILE' TO RBS.LOG.FILE ELSE STOP
5 *
PRINT CS
10 *
PRINT @(5,5):CL:
PRINT @(5,5):"SYSTEM: ":;INPUT CH.SYSTEM:
IF CH.SYSTEM = '' THEN GOTO 9999
20 *
PRINT @(5,6):CL:
PRINT @(5,6):"TYPE: ":;INPUT CH.TYPE:
IF CH.TYPE = '' THEN GOTO 10
IF CH.TYPE = 'P' THEN CH.TYPE = "PROCS"
IF CH.TYPE = 'B' THEN CH.TYPE = "BP"
PRINT @(11,6):CH.TYPE
30 *
PRINT @(5,7):CL:
PRINT @(5,7):"NAME: ":;INPUT CH.NAME:
IF CH.NAME = '' THEN GOTO 20
CH.SEQ = 0
PRINT @(5,9):"DESC. OF CHANGE":
35 *
MAT CH.REC = ''
    PRINT @(22,9):CL:
    PRINT @(22,10):CL:
    PRINT @(22,11):CL:
CH.SEQ = CH.SEQ + 1
MATREAD CH.REC FROM RBS.LOG.FILE, CH.SYSTEM:CH.TYPE:"!":CH.NAME:"!":CH.SEQ THEN
    PRINT @(22,9):CH.CHANGE<1,1>
    PRINT @(22,10):CH.CHANGE<1,2>
    PRINT @(22,11):CH.CHANGE<1,3>
    PRINT @(1,23):CL:
    PRINT @(1,23):"CORRECT RECORD? (Y/N) ":;INPUT RESP:
    IF RESP = "N" THEN GOTO 35
    NEW.REC = 0
END ELSE
    PRINT @(1,22):"NEW RECORD":
     NEW.REC = 1
END
40 *
PRINT @(1,23):CH.CHANGE<1,1>:
PRINT @(1,23):CL:
PRINT @(22,9):;INPUT IN.DATA:
PRINT @(1,23):CL:
IF IN.DATA = "DELETE" AND NOT(NEW.REC) THEN GOTO 2000
IF IN.DATA[1,1] = "S" THEN 
   STD.NBR = IN.DATA[2,1]
   IF STD.NBR > STD.SIZE THEN GOTO 40
   IF STD.NBR < 1 THEN GOTO 40
   CH.CHANGE<1,1> = STD.CHANGES(STD.NBR)<1,1>
   CH.CHANGE<1,2> = STD.CHANGES(STD.NBR)<1,2>
   CH.CHANGE<1,3> = STD.CHANGES(STD.NBR)<1,3>
    PRINT @(22,9):CH.CHANGE<1,1>
    PRINT @(22,10):CH.CHANGE<1,2>
    PRINT @(22,11):CH.CHANGE<1,3>
    GOTO 50
END
IF IN.DATA = '' THEN IN.DATA = CH.CHANGE<1,1>
IF IN.DATA = '' THEN GOTO 30
CH.CHANGE<1,1> = IN.DATA
PRINT @(22,9):CH.CHANGE<1,1>
PRINT @(1,23):CH.CHANGE<1,2>:
PRINT @(22,10):CL:@(22,10):;INPUT IN.DATA:
PRINT @(1,23):CL:
IF IN.DATA = '' THEN IN.DATA = CH.CHANGE<1,2>
CH.CHANGE<1,2> = IN.DATA
PRINT @(22,10):CH.CHANGE<1,2>
IF IN.DATA = '' THEN GOTO 50
PRINT @(1,23):CH.CHANGE<1,3>:
PRINT @(22,11):CL:@(22,11):;INPUT IN.DATA:
PRINT @(1,23):CL:
IF IN.DATA = '' THEN IN.DATA = CH.CHANGE<1,3>
CH.CHANGE<1,3> = IN.DATA
PRINT @(22,11):CH.CHANGE<1,3>
IF IN.DATA = '' THEN GOTO 50
50 *
1000 *
PRINT @(1,20):"OK TO UPDATE? (Y/N/C) ":;INPUT RESP:
IF RESP = "N" THEN GOTO 40
IF RESP = "C" THEN GOTO 5
IF RESP # "Y" THEN GOTO 1000
MATWRITE CH.REC ON RBS.LOG.FILE, CH.SYSTEM:CH.TYPE:"!":CH.NAME:"!":CH.SEQ
GOTO 5
2000 *
DELETE RBS.LOG.FILE, CH.SYSTEM:CH.TYPE:"!":CH.NAME:"!":CH.SEQ
GOTO 5
9999 *
PRINT " "
END
