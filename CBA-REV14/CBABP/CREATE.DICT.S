	SUBROUTINE CREATE.DICT(FILE.NAME)
*COPY>CPYLIB>COM1
*COPY>CPYLIB>COM.DICT.VAL
**********************************************************************
* REVISION   - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* FILE       - CBABP
* PROGRAM    - CREATE.DICT
* BY         - Julianne Rivera, Vercom Software, Inc.
* DATE       - 09/21/90
* DESCRIPTION
**********************************************************************
*COPY>PMC.CPYLIB>COMPANY
*COPY>CPYLIB>DICT.VALUES
*COPY>CPYLIB>UNI.DICT
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*COPY>CPYLIB>DICT.HLD.FILE
*
*---- INITIAL
*
MAT DICT.REC = ''
ERRMSG = ''
TFILE.CONO = '001'
TFILE2.CONO = '001'
* 

*
199 *
UD.TYPE = 'I'
ATT = HOLD.A.AMC
IF ATT = 0 THEN
SUF.X = '@ID'
END ELSE
SUF.X = 'F' : ATT
END
IF HOLD.MS.FLAG = 'Y' THEN
UD.MS.FLAG = 'M'
END ELSE
UD.MS.FLAG = 'S'
END
UD.HEAD = HOLD.S.NAME
WIDTH = HOLD.MAX.LEN
FMT1 = 'OCONV(': SUF.X :'[1,': CONO.LEN + GL.LEN : '],"TCOA;X;1;1")'
FMT2 = SUF.X: '[' : POS(1) + CCTR.LEN : ',' : GL.LEN : ']'
FMT3 = 'OCONV(' : SUF.X : '[1,': CONO.LEN : ']:@ID[' : ST.CCTR : ',' : GL.LEN : '], "TCOA;X;1;1")'
FMT5 = SUF.X : '[' : ST.CCTR : ',' : GL.LEN : ']' : ':" ":' : FMT3
FMT6 = SUF.X : '[' : POS(1) + CONO.LEN : ',' : GL.LEN : ']'
FOR I = 1 TO SF.CNT
SF1(I) = SUF.X : '[' : POS(I) + CCTR.LEN : ',' : SFR(I) : ']'
SF2(I) = SUF.X : '[' : POS(I) : ',' : SFR(I) : ']'
SF3(I) = SUF.X : '[' : POS(I) + CONO.LEN : ',' : SFR(I) : ']'
NEXT I
IF HOLD.TFILE.ATTR = 0 THEN
SUF.X2 = '@ID'
END ELSE
SUF.X2 = 'F' : HOLD.TFILE.ATTR
END
FMT35 = 'OCONV(' : SUF.X : '[1,' : CONO.LEN : ']:' : SUF.X2 : ',"TCOA;X;1;1)'
FMT36 = 'TRANS(COA,SUBR("-CATS",REUSE(@ID[1,' : CONO.LEN : ']),' : SUF.X2 : '),1,"X")'
BEGIN CASE
CASE HOLD.TYPE = '01'
UD.TYPE = 'D'
UD.FUN = ATT
WIDTH = GL.LEN
GOSUB 1000
CASE HOLD.TYPE = '02'
UD.FUN = SUF.X : '[' : HOLD.START.PT : ',' : GL.LEN : ']'
WIDTH = GL.LEN
GOSUB 1000
CASE HOLD.TYPE = '03'
UD.FUN = SUF.X : '[' : CCTR.LEN : ',' : HOLD.NO.LEN : ']'
GOSUB 1000
CASE HOLD.TYPE = '04'
UD.FUN = FMT1
GOSUB 1000
CASE HOLD.TYPE = '05'
UD.FUN = FMT2
WIDTH = STRUC.LEN
GOSUB 1000
CASE HOLD.TYPE = '06'
UD.FUN = FMT3
GOSUB 1000
CASE HOLD.TYPE > 6 AND HOLD.TYPE < 12
UD.FUN = SF1(HOLD.TYPE-6)
WIDTH = SFR(HOLD.TYPE-6)
GOSUB 1000
CASE HOLD.TYPE = '12'
UD.TYPE = 'D'
UD.FUN = ATT
WIDTH = STRUC.LEN
GOSUB 1000
CASE HOLD.TYPE > 12 AND HOLD.TYPE < 18
UD.FUN = SF2(HOLD.TYPE-12)
WIDTH = SFR(HOLD.TYPE-12)
GOSUB 1000
CASE HOLD.TYPE = '18'
UD.FUN = SUF.X : '[' : EN.GL.LEN2 : ',' : HOLD.NO.LEN : ']'
GOSUB 1000
CASE HOLD.TYPE = '19'
UD.FUN = SUF.X : '[' : SUFFIX.POS : ',' : SUFFIX.LEN : ']'
IF SUFFIX.LEN > 0 THEN WIDTH = SUFFIX.LEN ELSE WIDTH = 1
GOSUB 1000
CASE HOLD.TYPE = '20'
UD.FUN = SUF.X : '[' : (SUFFIX.POS + CCTR.LEN) : ',' : SUFFIX.LEN : ']'
IF SUFFIX.LEN > 0 THEN WIDTH = SUFFIX.LEN ELSE WIDTH = 1
GOSUB 1000
CASE HOLD.TYPE = '21'
UD.FUN = FMT5
GOSUB 1000
CASE HOLD.TYPE = '22'
UD.FUN = FMT6
WIDTH = STRUC.LEN
GOSUB 1000
CASE HOLD.TYPE > 22 AND HOLD.TYPE < 28
UD.FUN = SF3(HOLD.TYPE-22)
WIDTH = SFR(HOLD.TYPE-22)
GOSUB 1000
CASE HOLD.TYPE = '28'
UD.FUN = 'OCONV(' : SUF.X : ',"G!1");@1[' : EN.GL.LEN2 : ',' : HOLD.NO.LEN : ']'
GOSUB 1000
CASE HOLD.TYPE = '32'
UD.FUN = SUF.X2 : ':" ":' : FMT36
WIDTH = STRUC.LEN
GOSUB 1000
CASE HOLD.TYPE = '33'
TEMP = ''
FMT33 = 'EXTRACT(' : SUF.X : ',1,' : HOLD.TFILE.MV.NO : ',0);OCONV(@ID[1,' : CONO.LEN : ']:@1,"TCOA;X;1;1")'
TEMP = ';'
FOR I = 1 TO SF.CNT
FMT33 = FMT33 : TEMP : '@1[' : POS(I) : ',' : SFR(I) : ']'
TEMP = ':"-":'
NEXT I
FMT33 = FMT33 : ':" ":@2'
UD.FUN = FMT33
CASE HOLD.TYPE = '34'
TEMP = ''
FMT34 = ''
FOR I = 1 TO SF.CNT
FMT34 = FMT34 : TEMP : SUF.X2 : '[' : POS(I) : ',' : SFR(I) : ']'
TEMP = ':"-":'
NEXT I
UD.FUN = FMT34 : ':" ":OCONV(@ID[1,' : CONO.LEN : ']:' : SUF.X2 : ',"TCOA;X;1;1")'
CASE HOLD.TYPE = '35'
IF HOLD.MS.FLAG = 'Y' THEN
UD.FUN = FMT36
END ELSE
UD.FUN = FMT35
END
CASE HOLD.TYPE = '36'
UD.FUN = SUF.X : '[' : HOLD.START.PT : ',' : HOLD.NO.LEN : ']'
WIDTH = HOLD.NO.LEN
GOSUB 1000
CASE HOLD.TYPE = '50'
IF TFILE.CONO = '001' THEN
UD.FUN = 'OCONV(@ID,"G!1");@ID[4,99];' : TFILE.CONO : ';(OCONV(@3:@2,"T' : HOLD.TFILE : ';X;1;' : HOLD.TFILE.ATTR : '")'
END ELSE
UD.FUN = '@ID:OCONV(@1,"G!1");OCONV(@2,"T' : HOLD.TFILE : ';X;1;' : HOLD.TFILE.ATTR : '")'
END
CASE HOLD.TYPE = '54'
UD.FUN = 'F' : HOLD.KEY.FIELD : ';' : TFILE.CONO : ';@2:@1;OCONV(@3,"T' : HOLD.TFILE : ';X' : HOLD.TFILE.MV.NO : ';' : HOLD.TFILE.ATTR : ';' : HOLD.TFILE.ATTR : '");' : TFILE.CONO : ';@5:@4;CONV(@6,"T': HOLD.TFILE2 : ';X;' : HOLD.TFILE2.ATTR : ';' : HOLD.TFILE2.ATTR : '")'
GOSUB 1000
END CASE
IF HOLD.TYPE = 5 OR HOLD.TYPE = 12 OR HOLD.TYPE = 22 THEN
*UD.MASK = STRUC.LEN:HOLD.JUSTIFY:STR('#',SFR(1)):'-':STR('#',SFR(2)):'-':STR('#',SFR(3))
UD.MASK = HOLD.ACCT.MASK
END ELSE
UD.MASK = WIDTH:HOLD.JUSTIFY
END
9999 *
GOTO 999999
1000 *
IF WIDTH < 1 THEN
UD.HEAD = "."
GOTO 1999
END
IF UD.HEAD = '' THEN GOTO 1999
IF NUM(UD.HEAD) THEN GOTO 1999
IF INDEX(UD.HEAD,":",1) > 0 THEN GOTO 1999
IF UD.HEAD = STR(".",LEN(UD.HEAD)) THEN GOTO 1999
IF UD.HEAD = STR(" ",LEN(UD.HEAD)) THEN GOTO 1999
IF HOLD.TYPE = '05' OR HOLD.TYPE = '12' OR HOLD.TYPE = '22' THEN
MAXWIDTH = 14
END ELSE
MAXWIDTH = WIDTH
END
HCNT = DCOUNT(UD.HEAD,VM)
FOR N = 1 TO HCNT
UD.HEAD<1,N> = TRIM(UD.HEAD<1,N>)
NEXT N
IF UD.HEAD<1,N>[1,1] = "-" THEN
FOR N = 1 TO HCNT-1
IF LEN(UD.HEAD<1,N>) > MAXWIDTH THEN MAXWIDTH = LEN(UD.HEAD<1,N>)
NEXT N
UD.HEAD<1,HCNT> = STR("-",MAXWIDTH)
FOR N = 1 TO HCNT - 1
LEN.HEAD = LEN(UD.HEAD<1,N>)
SPC = INT((MAXWIDTH - LEN.HEAD)/2)
UD.HEAD<1,N> = SPACE(SPC) : UD.HEAD<1,N> : SPACE(MAXWIDTH - SPC - LEN.HEAD)
NEXT N
END
1999 *
RETURN
999999 *
RETURN
END
