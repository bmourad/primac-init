      SUBROUTINE SI_SYSCOM(MAT SYSCOM.REC)
*COPY>CPYLIB>SCOMMON1
**********************************************
* REVISION    - [11.0]
* Copyright 1995 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - CBABP
* PROGRAM     - SI_SYSCOM
* BY          - diane; CBA
* DATE        - 11/13/1996
* DESCRIPTION -
*
*T21177 diane 11/06/1996 * REV11 UPG
*ENDDOC
**********************************************
*COPY>CPYLIB>SCREEN.COM
*COPY>CPYLIB>TCC
*COPY>CPYLIB>EDIT.COM
*COPY>CPYLIB>SYSCOM
*COPY>CPYLIB>CHAR
*COPY>CPYLIB>ROC.H
*COPY>CPYLIB>SPECIAL.H
*
      PROMPT ""
      BEGIN CASE
      CASE SYS.TYPE = 1
         MAT SYSCOM.REC = ''
         SYS.TYPE = 2
      CASE SYS.TYPE = 2
*--- Check JCSBP JOB.TRACKING.DRIVER & GANG.ALLOC.MAINT
         PORT.NO = "TTY"
         CALL SYSVARS.SUB(PORT.NO)
         IF UNASSIGNED(TU_VERNO) THEN
            TU_VERNO_ID = "T_":@LOGNAME
            IF FILEINFO(TCC,0) THEN
               READ TU_VERNO FROM TCC, TU_VERNO_ID ELSE TU_VERNO = ""
            END ELSE
               OPEN "","TCC" TO TCC THEN
                  READ TU_VERNO FROM TCC, TU_VERNO_ID ELSE TU_VERNO = ""
               END ELSE
                  TU_VERNO = ""
               END
            END
         END
         BEGIN CASE
         CASE ERR.TYPE = 1
            IF S$GUIFORM THEN
               TYPE = "DLG.ERROR"
               BUTTONS = ""; RETURNS = ""
               IF ERR.CODE = 1 THEN
                  TITLE = "I N F O   B O X"
               END ELSE
                  TITLE = "M E S S A G E   B O X"
               END
               TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
               CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
            END ELSE
               CALL TCC.SUB(PORT.NO)
               IF PC.PORT.TYPE = 'termulator' THEN
*--- Check JCSBP JOB.TRACKING.DRIVER & GANG.ALLOC.MAINT
                  TYPE = "DLG.ERROR"
                  BUTTONS = ""; RETURNS = ""
                  TITLE = 'ERROR WARNING !!'
                  ERRMSG = 'PLEASE NOTE DOWN THIS MESSAGE, AND':VM:'CONTACT YOUR VENDOR ':VM:ERRMSG
                  TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
                  CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
               END ELSE
                  PRINT @(0,23) : SPACE(2) : ERRMSG : CL :
                  PRINT @(0,23) :
                  INPUT XX :
                  PRINT @(0,23) : CL :
               END
            END
         CASE ERR.TYPE = 2
            IF S$GUIFORM THEN
               TYPE = "DLG.ERROR"
               BUTTONS = ""; RETURNS = ""
               TITLE = 'ERROR WARNING !!'
               ERRMSG = 'PLEASE NOTE DOWN THIS MESSAGE, AND':VM:'CONTACT YOUR VENDOR ':VM:ERRMSG
               TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
               CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
            END ELSE
               CALL TCC.SUB(PORT.NO)
               IF PC.PORT.TYPE = 'termulator' THEN
*--- Check JCSBP JOB.TRACKING.DRIVER & GANG.ALLOC.MAINT
                  TYPE = "DLG.ERROR"
                  BUTTONS = ""; RETURNS = ""
                  TITLE = 'ERROR WARNING !!'
                  ERRMSG = 'PLEASE NOTE DOWN THIS MESSAGE, AND':VM:'CONTACT YOUR VENDOR ':VM:ERRMSG
                  TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
                  CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
               END ELSE
                  PRINT @(0,23) : SPACE(2) : 'WARNING !! PLEASE NOTE DOWN THIS MESSAGE, AND CONTACT YOUR VENDOR' : CL :
                  INPUT XX :
                  PRINT @(0,23) : SPACE(2) : ERRMSG : CL :
                  PRINT @(0,23) :
                  INPUT XX :
                  PRINT @(0,23) : CL :
               END
            END
         CASE ERR.TYPE = 3
            IF S$GUIFORM THEN
               TYPE = "DLG.ERROR"
               BUTTONS = ""; RETURNS = ""
               TITLE = 'ERROR ALERT !!'
               ERRMSG = 'PLEASE NOTE DOWN THIS MESSAGE, AND':VM:'CONTACT YOUR VENDOR IMMEDIATELY':VM:ERRMSG
               TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
               CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
               TU_FUNC = "TU.RESET":TU_REVNO
               EXECUTE TU_FUNC
            END ELSE
               CALL TCC.SUB(PORT.NO)
               IF PC.PORT.TYPE = 'termulator' THEN
*--- Check JCSBP JOB.TRACKING.DRIVER & GANG.ALLOC.MAINT
                  TYPE = "DLG.ERROR"
                  BUTTONS = ""; RETURNS = ""
                  TITLE = 'ERROR ALERT !!'
                  ERRMSG = 'PLEASE NOTE DOWN THIS MESSAGE, AND':VM:'CONTACT YOUR VENDOR IMMEDIATELY':VM:ERRMSG
                  TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
                  CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
                  TU_FUNC = "TU.RESET":TU_REVNO
                  EXECUTE TU_FUNC
               END ELSE
                  PRINT @(0,23) : SPACE(2) : 'ALERT !! PLEASE NOTE THIS MESSAGE, AND CONTACT YOUR VENDOR IMMEDIATELY' : CL :
                  INPUT XX :
                  PRINT @(0,23) : SPACE(2) : ERRMSG : CL :
                  PRINT @(0,23) :
                  INPUT XX :
                  PRINT @(0,23) : CL :
               END
            END
            CHAIN "OFF"
         CASE ERR.TYPE = 4
            IF GUIFORM THEN
               IF LEN(ERRMSG) > 70 THEN
                  TERR = ERRMSG[1,70]:VM:ERRMSG[71,999]
                  ERRMSG = TERR
               END
               TYPE = "DLG.ERROR"
*                  BUTTONS = ""; RETURNS = ""
               BUTTONS = "OK":VM:"RETRY":VM:"ABORT"
               RETURNS = "":VM:"R":VM:"A"
               IF ERR.CODE = "1" THEN
                  TITLE = "I N F O   B O X"
               END ELSE
                  TITLE = "M E S S A G E   B O X"
               END
               TU_FUNC = "TU.FORM.DIALOG":TU_VERNO
               CALL @TU_FUNC(VALUE, TYPE, ERRMSG, BUTTONS, RETURNS, TITLE, ERROR)
               IF NOT(ERROR) THEN
                  ERR.RESP = VALUE
               END ELSE
                  ERR.RESP = ""
               END
            END ELSE
               IF LEN(ERRMSG) > 70 THEN
                  PRINT @(0,23): CL : ERRMSG[1,70]:
                  INPUT XX
                  ERRMSG = ERRMSG[71,999]
               END
               PRINT @(0,23) : CL : ERRMSG :
               INPUT XX :
               PRINT @(0,23) : CL :
               ERR.RESP = XX
            END
         CASE 1
         END CASE
      CASE 1
      END CASE
      RETURN
   END
