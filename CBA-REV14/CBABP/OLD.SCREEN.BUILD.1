*COPY>CPYLIB>COM1
*COPY>CPYLIB>COM.SCREEN.BUILD
***************************************************************************
*
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
*
* PROGRAM - SCREEN.BUILD.1
*
* AUTHOR  - NICK AMENDOLA, COMPUTER BUSINESS ASSOCIATES
*
* DATE    - 06/09/84
*
* DESCRIPTION
*
* This is the main program for the screen builder system. The name of the
* screen to be added or maintained is requested and control is passed to
* the associated subroutines for processing.
*
***************************************************************************
*
*COPY>CPYLIB>EDIT.COM
*COPY>CPYLIB>EDIT.COM.DRIVER
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*
*---- DEFINE VARIABLES
*
*
*---- OPEN ALL FILES
*
      	      MAT FILE.VARS = ""
      OPEN "","VOC" TO MD ELSE
         ERRMSG =  "CANNOT OPEN MD FILE"
         GOTO 93000
      END
      OPEN "","M.SCREENS" TO M.SCREENS ELSE
         ERRMSG = "CANNOT OPEN M.SCREENS FILE"
         GOTO 93000
      END
*
*---- INITIALIZATION
*
10*
      MAT EDIT.COM = ""
      TYP = 0; CALL EDIT.SUB
*
      MAT EDIT.COM.DRIVER = ""
      ECD.SCRN.CNT = 2
      ECD.SCRN.NAME = "SCREEN.BUILD.1"
      ECD.SCRN.NAME<2> = "SCREEN.BUILD.SUB.2"
      ECD.ACTION = 1; CALL SCRN.EDIT
      ECD.SCRN.NO = 1
*
      SFILE = ""
      SNAME = ""
*
*---- MAIN PROCESSING
*
100*
      ECD.ACTION=2; CALL SCRN.EDIT
      MAT SCV.REC = ""
110*
      ECD.DEFAULT = SFILE
      ECD.NUM = 1; ECD.ACTION = 4; CALL SCRN.EDIT
      IF ECD.RET.VALUE = "END" THEN
         PRINT @(-1) :
         GOTO 99999
      END
      IF INDEX(ECD.RET.VALUE,".",1) = 0 THEN
         ECD.RET.VALUE = ECD.RET.VALUE:".SCREENS"
         SCV.REC(1) = ECD.RET.VALUE
         ECD.NUM=1;ECD.ACTION=5;CALL SCRN.EDIT
      END
      ERR = 0
      REC = ""
      READ REC FROM MD, ECD.RET.VALUE THEN
         IF REC<1> # "F" THEN
            ERR = 1
         END ELSE
            OPEN '',ECD.RET.VALUE TO SYS.SCREENS ELSE ERR = 1
         END
      END ELSE
         ERR = 1
      END
      IF ERR THEN
         ERRMSG = "INVALID FILE NAME - ":ECD.RET.VALUE
         GOSUB 91000
         GOTO 110
      END
      SFILE = ECD.RET.VALUE
      ECD.DEFAULT = SNAME
      ECD.NUM = 2
      ECD.ACTION=4; CALL SCRN.EDIT
      IF ECD.RET.VALUE = "END" THEN
         GOTO 110
      END
      SNAME = ECD.RET.VALUE
      SCREEN.NAME = ECD.RET.VALUE
      SCREEN.DIMENSIONS = ""
      SCREEN.DIMENSIONS<1> = 0
      SCREEN.DIMENSIONS<2> = 22
      SCREEN.DIMENSIONS<3> = 0
      SCREEN.DIMENSIONS<4> = 79
      SCREEN.DIMENSIONS<5> = 0
      SCREEN.DIMENSIONS<6> = 23
      SCREEN.DIMENSIONS<7> = 0
      SCREEN.DIMENSIONS<8> = 79
*     WRITE SCREEN.DIMENSIONS ON SYS.SCREENS, SCREEN.NAME:"*DIM"
      CALL SCREEN.BUILD.SUB.1 (SCREEN.NAME, SCREEN.DIMENSIONS,SYS.SCREENS)
      GOTO 100
*
*---- ERROR ROUTINE
*
91000*
      PRINT @(0,23):CL:ERRMSG:
      INPUT REPLY,1:
      PRINT @(0,23):CL:
      RETURN
93000*
      PRINT @(0,23):@(-4):ERRMSG:
      INPUT REPLY,1:
      PRINT @(0,23):@(-4):
99999*
   END
