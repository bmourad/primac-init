*********************************************************************
* REVISION - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM   - PRIMAC
* SOURCE   - GLSBP
* PROGRAM  - HIST.GL.COA.SUM
* BY       - WALID YAMOUT ,C.B.A
* DATE     - 09/19/85
*T24263 cm 12/09/1999 * Add Modified Account History Detail Report.
*T26005 alex 07/25/2001 * Display Beginning and Ending Balances.
*********************************************************************
*COPY>PMC.CPYLIB>COMPANY
*COPY>GLS.CPYLIB>GLM
*COPY>GLS.CPYLIB>COA.BAL
*COPY>CPYLIB>CHAR
*COPY>CPYLIB>SYSCOM
*
     SYS.TYPE = 1
     CALL SYSCOM(MAT SYSCOM.REC)
     PROCREAD INBUFF ELSE
        ERRMSG = "MUST RUN FROM PROC"; GOSUB 91000; GOTO 99999
     END
     CONO = INBUFF<1>
     OPEN "COMPANY" TO COMPANY ELSE
        ERRMSG = "COMPANY FILE IS MISSING"; GOSUB 91000; GOTO 88888
     END
     MATREAD COMP.REC FROM COMPANY,CONO ELSE
        ERRMSG = 'CANNOT LOCATE COMPANY, ' : CONO
        GOSUB 91000; GOTO 88888
     END
     MONTH = INBUFF<4>[5,2]
     OPEN INBUFF<20> TO COA.BAL ELSE
        ERRMSG = "COA.BAL FILE IS MISSING"; GOSUB 91000; GOTO 88888
     END
     OPEN INBUFF<16> TO CO.COA.BAL ELSE
        ERRMSG = "CO.COA.BAL FILE IS MISSING"; GOSUB 91000; GOTO 88888
     END
     OPEN 'CO.COA':INBUFF<3> TO HIST.COA.BAL ELSE
        ERRMSG = 'CO.COA':INBUFF<3>:' FILE IS MISSING'; GOSUB 91000; GOTO 88888
     END
     LINE.NO = 2 + INBUFF<3>[5,2]
100 *
     READNEXT ID ELSE GO 99999
     READ HIST.DATA FROM HIST.COA.BAL,ID ELSE GO 100
     HIST.BAL = HIST.DATA<LINE.NO>
     COA.ID = ID[1,6]
     MATREAD CB.REC FROM COA.BAL, COA.ID ELSE MAT CB.REC = ''
     CB.REC(3) = CB.REC(3) + HIST.BAL
     MATWRITE CB.REC ON COA.BAL, COA.ID
     GOTO 100
91000 *
     ERR.TYPE = 1; CALL SYSCOM(MAT SYSCOM.REC)
     RETURN
88888 INBUFF<3> = "END"
     PROCWRITE INBUFF
99999 END
