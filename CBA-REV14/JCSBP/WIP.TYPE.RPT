*COPY>CPYLIB>COM1
***********************************************************
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - JCSBP
* PROGRAM     - WIP.TYPE.RPT
* BY          - TINA BOND, C.B.A
* DATE        - 12/03/86
* DESCRIPTION - This program creates a WIP Valuation report
*
* TASK
*     18573 5/95 LLH - 1-52 WEEK ACCOUNTING PERIODS
*
*T22007 stefanie 08/27/1997 * Add Division to the heading.
*T25901 cmykleb 03/26/2002 * Change heading to use GET.PROG.HEAD pgm.
*T27901 lross 01/27/2004 * Uninitialized variable msg.
***********************************************************
*-- INSERT FILE EQUATE
*COPY>PMC.CPYLIB>COMPANY
*COPY>JCS.CPYLIB>JOB
*COPY>JCS.CPYLIB>JOB.TIME
*COPY>JCS.CPYLIB>JOB.MATL
*COPY>JCS.CPYLIB>JOB.OSP
*COPY>JCS.CPYLIB>JOB.SHIP
*COPY>JCS.CPYLIB>JOB.MISC
*COPY>CPYLIB>EDIT.COM
*COPY>CPYLIB>EDIT.COM.DRIVER
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>SYSCOM
*COPY>CPYLIB>CHAR
*
*
*--- INITAILIZATION
*
   MAT EDIT.COM = ""
   MAT EDIT.COM.DRIVER = ""
   MAT FILE.VARS = ""
   MAT COMP.REC  = ""
   MAT SCV.REC   = ""
*
   TOTALS = 0
   TOT.FF = 0
   TOT.TYPE = 0
   SP1 = SPACE(1)
   SP3 = SPACE(3)
   SP4 = SPACE(4)
   SP20 = SPACE(20)
   D6 = STR('-',6)
   D8 = STR('-',8)
   D10 = STR('-',10)
   D12 = STR('-',12)
*
   DIM LINE.REC(13)
   EQU LINE.MASTER    TO LINE.REC(1)
   EQU LINE.JOB       TO LINE.REC(2)
   EQU LINE.MAST.SUB  TO LINE.REC(3)
   EQU LINE.TYPE      TO LINE.REC(4)
   EQU LINE.TOTAL     TO LINE.REC(5)
   EQU LINE.DR        TO LINE.REC(6)
   EQU LINE.VF        TO LINE.REC(7)
   EQU LINE.FF        TO LINE.REC(8)
   EQU LINE.SV        TO LINE.REC(9)
   EQU LINE.MT        TO LINE.REC(10)
   EQU LINE.OS        TO LINE.REC(11)
   EQU LINE.SP        TO LINE.REC(12)
   EQU LINE.MS        TO LINE.REC(13)
   DIM TREC(8,4)
   DIM TTREC(8)
   DIM MREC(8,4)
   DIM TMREC(8,4)
   MAT TMREC = 0
   MAT MREC = 0
   TATT = "R" : AM : "C" : AM : "S"
*
*-- SET UP ERRMSG ROUTINE FOR CPYLIB SYSCOM
   SYS.TYPE = 1
   CALL SYSCOM(MAT SYSCOM.REC)
*
*-- GET COMPANY NAME
   PROCREAD BUFFER ELSE ERRMSG = "MUST RUN FROM MENU"; GOSUB 91000; GOTO 999999
   CONO = BUFFER<1>
   CO.NAME = BUFFER<2>
   MENU = BUFFER<3>
   DIVISION = BUFFER<4>   ;* T22007 <
   TYPE = BUFFER<5>
*-- OPEN FILE
   OPEN '','CONTROL' TO CONTROL ELSE ERRMSG = "CONTROL FILE IS MISSING";GOTO 93000
   OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = "COMPANY FILE IS MISSING";GOTO 93000
   OPEN '','PMC.SCREENS' TO M.SCREENS ELSE ERRMSG = "PMC.SCREENS FILE IS MISSING";GOTO 93000
   OPEN '','JOB' TO JOB ELSE ERRMSG = "JOB FILE IS MISSING";GOTO 93000
   OPEN '','JOB.TIME' TO JOB.TIME ELSE ERRMSG = "JOB.TIME FILE IS MISSING";GOTO 93000
   OPEN '','JOB.MATL' TO JOB.MATL ELSE ERRMSG = "JOB.MATL FILE IS MISSING";GOTO 93000
   OPEN '','JOB.OSP' TO JOB.OSP ELSE ERRMSG = "JOB.OSP FILE IS MISSING";GOTO 93000
   OPEN '','JOB.SHIP' TO JOB.SHIP ELSE ERRMSG = "JOB.SHIP FILE IS MISSING";GOTO 93000
   OPEN '','JOB.MISC' TO JOB.MISC ELSE ERRMSG = "JOB.MISC FILE IS MISSING";GOTO 93000
*
*--- SETUP HEADERS
*
*T25901 v
*  POS = 51 - INT(LEN(CO.NAME)/2)
*  POS2 = 70 - POS
*  HEAD1 = "DATE - ":OCONV(DATE(), 'D2/') "L#8"
*  HEAD1 = HEAD1 :SPACE(POS) :CO.NAME "L#30"
*  HEAD1 = HEAD1 :SPACE(POS2) : "PAGE : 'PL'"
*  HEAD2 = "DIVISION - ":DIVISION:SPACE(45):"WORK IN PROCESS":"'L'"
*  HEAD3 = SPACE(56):"BY JOB FOR TYPE (":TYPE:")":"'L'"
   CONO.NAME = ""
   REPORT.NAME = ""
   REPORT.NUMBER = BUFFER<2>
   HEAD1 = "" ; HEAD2 = ""
   CALL GET.PROG.HEAD(CONO,CONO.NAME,REPORT.NAME,REPORT.NUMBER,"",HEAD1,HEAD2)
   HEAD1 = HEAD1 : " 'PL'"
   HEAD3 = "DIVISION - ":DIVISION"L#3"
   HEAD3 = HEAD3:SPACE(51):"BY JOB FOR TYPE (":TYPE:")":" 'L'"
*T25901 ^
   IF MENU = "CURRENT" THEN
      HEAD4 = SPACE(65):"AS OF CURRENT PERIOD":"'LL'"
   END ELSE
      HEAD4 = SPACE(65):" AS OF PERIOD ":MENU[5,2]:SPACE(2):MENU[1,4]:"'LL'"
   END
   HEAD5 = SPACE(38):"<------------------LABOR------------------>":"'L'"
   HEAD6 = " MASTER    SUB              TOTAL                 FXD FACT   VAR FACT    S & A                OUTSIDE  ":"'L'"
   HEAD7 = "  JOB #    JOB#    TYPE     COST       DIRECT $    OVH $      OVH $      OVH $    MATERIAL $ PURCHASE $  SHIPPING    MISC.$":"'L'"
   HEAD8 = D8:SP1:D8:SP1:D6:SP1:D12:SP1:D10:SP1:D10:SP1:D10:SP1:D10:SP1:D10:SP1:D10:SP1:D10:SP1:D10:"'LL'"
   ULINE = SPACE(25):D12:SP1:D10:SP1:D10:SP1:D10:SP1:D10:SP1:D10:SP1:D10:SP1:D10:SP1:D10
   G.ULINE = SPACE(25):STR('=',12):SP1:STR('=',10):SP1:STR('=',10):SP1:STR('=',10):SP1:STR('=',10):SP1:STR('=',10):SP1:STR('=',10):SP1:STR('=',10):SP1:STR('=',10)
   PRINTER ON
   HEADING HEAD1:HEAD2:HEAD3:HEAD4:HEAD5:HEAD6:HEAD7:HEAD8
*-- READING ALL FILES AND PROCESS ONE AT A TIME
   PURGE.STATUS = 7
   PREV.MASTER = ""
100*
   READNEXT JOB.ID ELSE GOTO 999
   MATREAD JOB.REC FROM JOB, JOB.ID ELSE GOTO 100
   LOCATE PURGE.STATUS IN JOB.STATUS<1>,1 SETTING DUMMY ELSE DUMMY = 0
   IF DUMMY THEN GOTO 100
   JOBNO = JOB.ID[4,99]  ;*T27901 Move from below.
   IF JOB.MASTER = "" THEN JOB.MASTER = JOBNO
*T27901 JOBNO = JOB.ID[4,99]
   GOSUB 5500
   BEGIN CASE
      CASE MENU = "CURRENT" AND TYPE[1,1] = "A"
         GOSUB 4100
         DATA = 1
         LOOP
            READNEXT JOB.ID ELSE DATA = 0
         WHILE DATA DO
            MATREAD JOB.REC FROM JOB, JOB.ID ELSE GOTO 199
            LOCATE PURGE.STATUS IN JOB.STATUS<1>,1 SETTING DUMMY ELSE DUMMY = 0
            IF DUMMY THEN GOTO 199
            IF JOB.MASTER = "" THEN JOB.MASTER = JOBNO
            JOBNO = JOB.ID[4,99]
            IF PREV.MASTER # JOB.MASTER THEN GOSUB 5000
            GOSUB 4100
199      REPEAT
      CASE MENU = "CURRENT"
         LOCATE TYPE IN TATT,1 SETTING TPTR ELSE NULL
         GOSUB 4200
         DATA = 1
         LOOP
            READNEXT JOB.ID ELSE DATA = 0
         WHILE DATA DO
            MATREAD JOB.REC FROM JOB, JOB.ID ELSE GOTO 299
            LOCATE PURGE.STATUS IN JOB.STATUS<1>,1 SETTING DUMMY ELSE DUMMY = 0
            IF DUMMY THEN GOTO 299
            IF JOB.MASTER = "" THEN JOB.MASTER = JOBNO
            JOBNO = JOB.ID[4,99]
            IF PREV.MASTER # JOB.MASTER THEN GOSUB 5000
            GOSUB 4200
299      REPEAT
      CASE TYPE[1,1] = "A"
         GOSUB 4300
         DATA = 1
         LOOP
            READNEXT JOB.ID ELSE DATA = 0
         WHILE DATA DO
            MATREAD JOB.REC FROM JOB, JOB.ID ELSE GOTO 399
            LOCATE PURGE.STATUS IN JOB.STATUS<1>,1 SETTING DUMMY ELSE DUMMY = 0
            IF DUMMY THEN GOTO 399
            IF JOB.MASTER = "" THEN JOB.MASTER = JOBNO
            JOBNO = JOB.ID[4,99]
            IF PREV.MASTER # JOB.MASTER THEN GOSUB 5000
            GOSUB 4300
399      REPEAT
      CASE 1
         LOCATE TYPE IN TATT,1 SETTING TPTR ELSE NULL
         GOSUB 4400
         DATA = 1
         LOOP
            READNEXT JOB.ID ELSE DATA = 0
         WHILE DATA DO
            MATREAD JOB.REC FROM JOB, JOB.ID ELSE GOTO 499
            LOCATE PURGE.STATUS IN JOB.STATUS<1>,1 SETTING DUMMY ELSE DUMMY = 0
            IF DUMMY THEN GOTO 499
            IF JOB.MASTER = "" THEN JOB.MASTER = JOBNO
            JOBNO = JOB.ID[4,99]
            IF PREV.MASTER # JOB.MASTER THEN GOSUB 5000
            GOSUB 4400
499      REPEAT
   END CASE
   GOSUB 5000
999*
*-- PRINTING THE GRAND TOTAL VALUES
   PRINT ULINE
   T.LINE = 'COMPANY ':CONO "R#3":' TOTAL':SP3
   FOR X = 1 TO 4
      IF TOTALS<1,X> = 0 THEN GOTO 125
      T.LINE = T.LINE : TOT.TYPE<1,X> "L#1" : SP4
      T.LINE = T.LINE : OCONV(TOTALS<1,X>, 'MD2') "R#12" :SP1
      FOR XX = 1 TO 8
         T.LINE = T.LINE : OCONV(TMREC(XX,X), 'MD2') "R#10" :SP1
      NEXT XX
      PRINT T.LINE
      T.LINE = SP20
125 NEXT X
   PRINT G.ULINE
*-- END OF JOB
   PRINTER OFF
   GOTO 999999
*-- PROCESS THE RECORD FOR SPECIEFIC YEAR AND PERIOD
4100IF JOB.WIP<1,4> > MENU THEN GOTO 4999
   WIP = JOB.WIP<1,2,1> + JOB.WIP<1,2,2> + JOB.WIP<1,2,3> + JOB.WIP<1,2,4>
   IF WIP = 0 THEN
      IF JOB.WIP<1,4> = "" OR JOB.WIP<1,5> < MENU THEN GOTO 4999
   END
4110CNT = COUNT(JOB.LB.DEPT,VM) + (JOB.LB.DEPT # "")
   MAT TREC = 0
   IF JOB.LB.WIP<1,4> > MENU THEN GOTO 4120
   LB.WIP = JOB.LB.WIP<1,2,1> + JOB.LB.WIP<1,2,2> + JOB.LB.WIP<1,2,3> + JOB.LB.WIP<1,2,4>
   IF LB.WIP = 0 THEN
      IF JOB.LB.WIP<1,4> = "" OR JOB.LB.WIP<1,5> < MENU THEN GOTO 4120
   END
   FOR I = 1 TO CNT
      LB.ID = JOB.ID:"!":JOB.LB.DEPT<1,I>:"!":JOB.LB.CCTR<1,I>:"!"
      FOR II = 1 TO JOB.LB.SEQ<1,I>
         MATREAD JLB.REC FROM JOB.TIME, LB.ID:II ELSE GOTO 4115
         LOCATE JLB.TYPE IN TATT,1 SETTING TPTR ELSE NULL
         III = 1
         LOOP WHILE JLB.WIP<1,III> # '' DO
            FOR J = 1 TO 4
               TREC(J,TPTR) = TREC(J,TPTR) + JLB.WIP<1,III,J>
            NEXT J
            III = III + 1
         REPEAT
4115  NEXT II
   NEXT I
4120IF JOB.MT.WIP<1,4> > MENU THEN GOTO 4130
   MT.WIP = JOB.MT.WIP<1,2,1> + JOB.MT.WIP<1,2,2> + JOB.MT.WIP<1,2,3>
   IF MT.WIP = 0 THEN
      IF JOB.MT.WIP<1,4> = "" OR JOB.MT.WIP<1,5> < MENU THEN GOTO 4130
   END
   CNT = COUNT(JOB.MT.DEPT,VM) + (JOB.MT.DEPT # "")
   FOR I = 1 TO CNT
      MT.ID = JOB.ID:"!":JOB.MT.DEPT<1,I>:"!":JOB.MT.CCTR<1,I>:"!"
      MT.ID = MT.ID:JOB.MT.PROD<1,I>:"!":JOB.MT.WHSE<1,I>:"!"
      FOR II = 1 TO JOB.MT.SEQ<1,I>
         MATREAD JMT.REC FROM JOB.MATL, MT.ID:II ELSE GOTO 4125
         LOCATE JMT.TYPE IN TATT,1 SETTING TPTR ELSE NULL
         III = 1
         LOOP WHILE JMT.WIP<1,III> # "" DO
            TREC(5,TPTR) = TREC(5,TPTR) + JMT.WIP<1,III,1> + JMT.WIP<1,III,2> + JMT.WIP<1,III,3>
            III = III + 1
         REPEAT
4125  NEXT II
   NEXT I
4130IF JOB.OS.WIP<1,4> > MENU THEN GOTO 4140
   OS.WIP = JOB.OS.WIP<1,2,1> + JOB.OS.WIP<1,2,2>
   IF OS.WIP = 0 THEN
      IF JOB.OS.WIP<1,4> = "" OR JOB.OS.WIP<1,5> < MENU THEN GOTO 4140
   END
   CNT = COUNT(JOB.OS.DEPT,VM) + (JOB.OS.DEPT # "")
   FOR I = 1 TO CNT
      OS.ID = JOB.ID:"!":JOB.OS.DEPT<1,I>:"!":JOB.OS.CCTR<1,I>:"!"
      OS.ID = OS.ID:JOB.OS.PLINE<1,I>:"!"
      FOR II = 1 TO JOB.OS.SEQ<1,I>
         MATREAD JOS.REC FROM JOB.OSP, OS.ID:II ELSE GOTO 4135
         LOCATE JOS.TYPE IN TATT,1 SETTING TPTR ELSE NULL
         III = 1
         LOOP WHILE JOS.WIP<1,III> # "" DO
            TREC(6,TPTR) = TREC(6,TPTR) + JOS.WIP<1,III,1> + JOS.WIP<1,III,2>
            III = III + 1
         REPEAT
4135  NEXT II
   NEXT I
4140IF JOB.SP.WIP<1,4> > MENU THEN GOTO 4150
   SP.WIP = JOB.SP.WIP<1,2,1> + JOB.SP.WIP<1,2,2>
   IF SP.WIP = 0 THEN
      IF JOB.SP.WIP<1,4> = "" OR JOB.SP.WIP<1,5> < MENU THEN GOTO 4150
   END
   CNT = COUNT(JOB.SP.DEPT,VM) + (JOB.SP.DEPT # "")
   FOR I = 1 TO CNT
      SP.ID = JOB.ID:"!":JOB.SP.DEPT<1,I>:"!":JOB.SP.CCTR<1,I>:"!"
      FOR II = 1 TO JOB.SP.SEQ<1,I>
         MATREAD JSP.REC FROM JOB.SHIP, SP.ID:II ELSE GOTO 4145
         LOCATE JSP.TYPE IN TATT,1 SETTING TPTR ELSE NULL
         III = 1
         LOOP WHILE JSP.WIP<1,III> # "" DO
            TREC(7,TPTR) = TREC(7,TPTR) + JSP.WIP<1,III,1> + JSP.WIP<1,III,2>
            III =  III + 1
         REPEAT
4145  NEXT II
   NEXT I
4150IF JOB.MS.WIP<1,4> > MENU THEN GOTO 4900
   MS.WIP = JOB.MS.WIP<1,2,1> + JOB.MS.WIP<1,2,2>
   IF MS.WIP = 0 THEN
      IF JOB.MS.WIP<1,4> = "" OR JOB.MS.WIP<1,5> < MENU THEN GOTO 4900
   END
   CNT = COUNT(JOB.MS.DEPT,VM) + (JOB.MS.DEPT # "")
   FOR I = 1 TO CNT
      MS.ID = JOB.ID:"!":JOB.MS.DEPT<1,I>:"!":JOB.MS.CCTR<1,I>:"!"
      FOR II = 1 TO JOB.MS.SEQ<1,I>
         MATREAD JMS.REC FROM JOB.MISC, MS.ID:II ELSE GOTO 4155
         LOCATE JMS.TYPE IN TATT,1 SETTING TPTR ELSE NULL
         III = 1
         LOOP WHILE JMS.WIP<1,III> # "" DO
            TREC(8,TPTR) = TREC(8,TPTR) + JMS.WIP<1,III,1> + JMS.WIP<1,III,2>
            III = III + 1
         REPEAT
4155  NEXT II
   NEXT I
   GOTO 4900
4200IF JOB.WIP<1,4> > MENU THEN GOTO 4999
   WIP = JOB.WIP<1,2,1> + JOB.WIP<1,2,2> + JOB.WIP<1,2,3> + JOB.WIP<1,2,4>
   IF WIP = 0 THEN
      IF JOB.WIP<1,4> = "" OR JOB.WIP<1,5> < MENU THEN GOTO 4999
   END
4210CNT = COUNT(JOB.LB.DEPT,VM) + (JOB.LB.DEPT # "")
   MAT TREC = 0
   IF JOB.LB.WIP<1,4> > MENU THEN GOTO 4220
   LB.WIP = JOB.LB.WIP<1,2,1> + JOB.LB.WIP<1,2,2> + JOB.LB.WIP<1,2,3> + JOB.LB.WIP<1,2,4>
   IF LB.WIP = 0 THEN
      IF JOB.LB.WIP<1,4> = "" OR JOB.LB.WIP<1,5> < MENU THEN GOTO 4220
   END
   FOR I = 1 TO CNT
      LB.ID = JOB.ID:"!":JOB.LB.DEPT<1,I>:"!":JOB.LB.CCTR<1,I>:"!"
      FOR II = 1 TO JOB.LB.SEQ<1,I>
         MATREAD JLB.REC FROM JOB.TIME, LB.ID:II ELSE GOTO 4215
         IF JLB.TYPE # TYPE THEN GOTO 4215
         III = 1
         LOOP WHILE JLB.WIP<1,III> # '' DO
            FOR J = 1 TO 4
               TREC(J,TPTR) = TREC(J,TPTR) + JLB.WIP<1,III,J>
            NEXT J
            III = III + 1
         REPEAT
4215  NEXT II
   NEXT I
4220IF JOB.MT.WIP<1,4> > MENU THEN GOTO 4230
   MT.WIP = JOB.MT.WIP<1,2,1> + JOB.MT.WIP<1,2,2> + JOB.MT.WIP<1,2,3>
   IF MT.WIP = 0 THEN
      IF JOB.MT.WIP<1,4> = "" OR JOB.MT.WIP<1,5> < MENU THEN GOTO 4230
   END
   CNT = COUNT(JOB.MT.DEPT,VM) + (JOB.MT.DEPT # "")
   FOR I = 1 TO CNT
      MT.ID = JOB.ID:"!":JOB.MT.DEPT<1,I>:"!":JOB.MT.CCTR<1,I>:"!"
      MT.ID = MT.ID:JOB.MT.PROD<1,I>:"!":JOB.MT.WHSE<1,I>:"!"
      FOR II = 1 TO JOB.MT.SEQ<1,I>
         MATREAD JMT.REC FROM JOB.MATL, MT.ID:II ELSE GOTO 4225
         IF JMT.TYPE # TYPE THEN GOTO 4225
         III = 1
         LOOP WHILE JMT.WIP<1,III> # "" DO
            TREC(5,TPTR) = TREC(5,TPTR) + JMT.WIP<1,III,1> + JMT.WIP<1,III,2> + JMT.WIP<1,III,3>
            III = III + 1
         REPEAT
4225  NEXT II
   NEXT I
4230IF JOB.OS.WIP<1,4> > MENU THEN GOTO 4240
   OS.WIP = JOB.OS.WIP<1,2,1> + JOB.OS.WIP<1,2,2>
   IF OS.WIP = 0 THEN
      IF JOB.OS.WIP<1,4> = "" OR JOB.OS.WIP<1,5> < MENU THEN GOTO 4240
   END
   CNT = COUNT(JOB.OS.DEPT,VM) + (JOB.OS.DEPT # "")
   FOR I = 1 TO CNT
      OS.ID = JOB.ID:"!":JOB.OS.DEPT<1,I>:"!":JOB.OS.CCTR<1,I>:"!"
      OS.ID = OS.ID:JOB.OS.PLINE<1,I>:"!"
      FOR II = 1 TO JOB.OS.SEQ<1,I>
         MATREAD JOS.REC FROM JOB.OSP, OS.ID:II ELSE GOTO 4235
         IF JOS.TYPE # TYPE THEN GOTO 4235
         III = 1
         LOOP WHILE JOS.WIP<1,III> # "" DO
            TREC(6,TPTR) = TREC(6,TPTR) + JOS.WIP<1,III,1> + JOS.WIP<1,III,2>
            III = III + 1
         REPEAT
4235  NEXT II
   NEXT I
4240IF JOB.SP.WIP<1,4> > MENU THEN GOTO 4250
   SP.WIP = JOB.SP.WIP<1,2,1> + JOB.SP.WIP<1,2,2>
   IF SP.WIP = 0 THEN
      IF JOB.SP.WIP<1,4> = "" OR JOB.SP.WIP<1,5> < MENU THEN GOTO 4250
   END
   CNT = COUNT(JOB.SP.DEPT,VM) + (JOB.SP.DEPT # "")
   FOR I = 1 TO CNT
      SP.ID = JOB.ID:"!":JOB.SP.DEPT<1,I>:"!":JOB.SP.CCTR<1,I>:"!"
      FOR II = 1 TO JOB.SP.SEQ<1,I>
         MATREAD JSP.REC FROM JOB.SHIP, SP.ID:II ELSE GOTO 4245
         IF JSP.TYPE # TYPE THEN GOTO 4245
         III = 1
         LOOP WHILE JSP.WIP<1,III> # "" DO
            TREC(7,TPTR) = TREC(7,TPTR) + JSP.WIP<1,III,1> + JSP.WIP<1,III,2>
            III =  III + 1
         REPEAT
4245  NEXT II
   NEXT I
4250IF JOB.MS.WIP<1,4> > MENU THEN GOTO 4900
   MS.WIP = JOB.MS.WIP<1,2,1> + JOB.MS.WIP<1,2,2>
   IF MS.WIP = 0 THEN
      IF JOB.MS.WIP<1,4> = "" OR JOB.MS.WIP<1,5> < MENU THEN GOTO 4900
   END
   CNT = COUNT(JOB.MS.DEPT,VM) + (JOB.MS.DEPT # "")
   FOR I = 1 TO CNT
      MS.ID = JOB.ID:"!":JOB.MS.DEPT<1,I>:"!":JOB.MS.CCTR<1,I>:"!"
      FOR II = 1 TO JOB.MS.SEQ<1,I>
         MATREAD JMS.REC FROM JOB.MISC, MS.ID:II ELSE GOTO 4255
         IF JMS.TYPE # TYPE THEN GOTO 4255
         III = 1
         LOOP WHILE JMS.WIP<1,III> # "" DO
            TREC(8,TPTR) = TREC(8,TPTR) + JMS.WIP<1,III,1> + JMS.WIP<1,III,2>
            III = III + 1
         REPEAT
4255  NEXT II
   NEXT I
   GOTO 4900
4300IF JOB.WIP<1,4> > MENU THEN GOTO 4999
   WIP = JOB.WIP<1,2,1> + JOB.WIP<1,2,2> + JOB.WIP<1,2,3> + JOB.WIP<1,2,4>
   IF WIP = 0 THEN
      IF JOB.WIP<1,4> = "" OR JOB.WIP<1,5> < MENU THEN GOTO 4999
   END
4310CNT = COUNT(JOB.LB.DEPT,VM) + (JOB.LB.DEPT # "")
   MAT TREC = 0
   IF JOB.LB.WIP<1,4> > MENU THEN GOTO 4320
   LB.WIP = JOB.LB.WIP<1,2,1> + JOB.LB.WIP<1,2,2> + JOB.LB.WIP<1,2,3> + JOB.LB.WIP<1,2,4>
   IF LB.WIP = 0 THEN
      IF JOB.LB.WIP<1,4> = "" OR JOB.LB.WIP<1,5> < MENU THEN GOTO 4320
   END
   FOR I = 1 TO CNT
      LB.ID = JOB.ID:"!":JOB.LB.DEPT<1,I>:"!":JOB.LB.CCTR<1,I>:"!"
      FOR II = 1 TO JOB.LB.SEQ<1,I>
         MATREAD JLB.REC FROM JOB.TIME, LB.ID:II ELSE GOTO 4315
         LOCATE JLB.TYPE IN TATT,1 SETTING TPTR ELSE NULL
         III = 1
         LOOP WHILE JLB.WIP<1,III> # '' DO
            IF JLB.MON<1,III> <= MENU THEN
               FOR J = 1 TO 4
                  TREC(J,TPTR) = TREC(J,TPTR) + JLB.WIP<1,III,J>
               NEXT J
            END
            III = III + 1
         REPEAT
4315  NEXT II
   NEXT I
4320IF JOB.MT.WIP<1,4> > MENU THEN GOTO 4330
   MT.WIP = JOB.MT.WIP<1,2,1> + JOB.MT.WIP<1,2,2> + JOB.MT.WIP<1,2,3>
   IF MT.WIP = 0 THEN
      IF JOB.MT.WIP<1,4> = "" OR JOB.MT.WIP<1,5> < MENU THEN GOTO 4330
   END
   CNT = COUNT(JOB.MT.DEPT,VM) + (JOB.MT.DEPT # "")
   FOR I = 1 TO CNT
      MT.ID = JOB.ID:"!":JOB.MT.DEPT<1,I>:"!":JOB.MT.CCTR<1,I>:"!"
      MT.ID = MT.ID:JOB.MT.PROD<1,I>:"!":JOB.MT.WHSE<1,I>:"!"
      FOR II = 1 TO JOB.MT.SEQ<1,I>
         MATREAD JMT.REC FROM JOB.MATL, MT.ID:II ELSE GOTO 4325
         LOCATE JMT.TYPE IN TATT,1 SETTING TPTR ELSE NULL
         III = 1
         LOOP WHILE JMT.WIP<1,III> # "" DO
            IF JMT.MON<1,III> <= MENU THEN
               TREC(5,TPTR) = TREC(5,TPTR) + JMT.WIP<1,III,1> + JMT.WIP<1,III,2> + JMT.WIP<1,III,3>
            END
            III = III + 1
         REPEAT
4325  NEXT II
   NEXT I
4330IF JOB.OS.WIP<1,4> > MENU THEN GOTO 4340
   OS.WIP = JOB.OS.WIP<1,2,1> + JOB.OS.WIP<1,2,2>
   IF OS.WIP = 0 THEN
      IF JOB.OS.WIP<1,4> = "" OR JOB.OS.WIP<1,5> < MENU THEN GOTO 4340
   END
   CNT = COUNT(JOB.OS.DEPT,VM) + (JOB.OS.DEPT # "")
   FOR I = 1 TO CNT
      OS.ID = JOB.ID:"!":JOB.OS.DEPT<1,I>:"!":JOB.OS.CCTR<1,I>:"!"
      OS.ID = OS.ID:JOB.OS.PLINE<1,I>:"!"
      FOR II = 1 TO JOB.OS.SEQ<1,I>
         MATREAD JOS.REC FROM JOB.OSP, OS.ID:II ELSE GOTO 4335
         LOCATE JOS.TYPE IN TATT,1 SETTING TPTR ELSE NULL
         III = 1
         LOOP WHILE JOS.WIP<1,III> # "" DO
            IF JOS.MON<1,III> <= MENU THEN
               TREC(6,TPTR) = TREC(6,TPTR) + JOS.WIP<1,III,1> + JOS.WIP<1,III,2>
            END
            III = III + 1
         REPEAT
4335  NEXT II
   NEXT I
4340IF JOB.SP.WIP<1,4> > MENU THEN GOTO 4350
   SP.WIP = JOB.SP.WIP<1,2,1> + JOB.SP.WIP<1,2,2>
   IF SP.WIP = 0 THEN
      IF JOB.SP.WIP<1,4> = "" OR JOB.SP.WIP<1,5> < MENU THEN GOTO 4350
   END
   CNT = COUNT(JOB.SP.DEPT,VM) + (JOB.SP.DEPT # "")
   FOR I = 1 TO CNT
      SP.ID = JOB.ID:"!":JOB.SP.DEPT<1,I>:"!":JOB.SP.CCTR<1,I>:"!"
      FOR II = 1 TO JOB.SP.SEQ<1,I>
         MATREAD JSP.REC FROM JOB.SHIP, SP.ID:II ELSE GOTO 4345
         LOCATE JSP.TYPE IN TATT,1 SETTING TPTR ELSE NULL
         III = 1
         LOOP WHILE JSP.WIP<1,III> # "" DO
            IF JSP.MON<1,III> <= MENU THEN
               TREC(7,TPTR) = TREC(7,TPTR) + JSP.WIP<1,III,1> + JSP.WIP<1,III,2>
            END
            III =  III + 1
         REPEAT
4345  NEXT II
   NEXT I
4350IF JOB.MS.WIP<1,4> > MENU THEN GOTO 4900
   MS.WIP = JOB.MS.WIP<1,2,1> + JOB.MS.WIP<1,2,2>
   IF MS.WIP = 0 THEN
      IF JOB.MS.WIP<1,4> = "" OR JOB.MS.WIP<1,5> < MENU THEN GOTO 4900
   END
   CNT = COUNT(JOB.MS.DEPT,VM) + (JOB.MS.DEPT # "")
   FOR I = 1 TO CNT
      MS.ID = JOB.ID:"!":JOB.MS.DEPT<1,I>:"!":JOB.MS.CCTR<1,I>:"!"
      FOR II = 1 TO JOB.MS.SEQ<1,I>
         MATREAD JMS.REC FROM JOB.MISC, MS.ID:II ELSE GOTO 4355
         LOCATE JMS.TYPE IN TATT,1 SETTING TPTR ELSE NULL
         III = 1
         LOOP WHILE JMS.WIP<1,III> # "" DO
            IF JMS.MON<1,III> <= MENU THEN
               TREC(8,TPTR) = TREC(8,TPTR) + JMS.WIP<1,III,1> + JMS.WIP<1,III,2>
            END
            III = III + 1
         REPEAT
4355  NEXT II
   NEXT I
   GOTO 4900
4400IF JOB.WIP<1,4> > MENU THEN GOTO 4999
   WIP = JOB.WIP<1,2,1> + JOB.WIP<1,2,2> + JOB.WIP<1,2,3> + JOB.WIP<1,2,4>
   IF WIP = 0 THEN
      IF JOB.WIP<1,4> = "" OR JOB.WIP<1,5> < MENU THEN GOTO 4999
   END
4410CNT = COUNT(JOB.LB.DEPT,VM) + (JOB.LB.DEPT # "")
   MAT TREC = 0
   IF JOB.LB.WIP<1,4> > MENU THEN GOTO 4420
   LB.WIP = JOB.LB.WIP<1,2,1> + JOB.LB.WIP<1,2,2> + JOB.LB.WIP<1,2,3> + JOB.LB.WIP<1,2,4>
   IF LB.WIP = 0 THEN
      IF JOB.LB.WIP<1,4> = "" OR JOB.LB.WIP<1,5> < MENU THEN GOTO 4420
   END
   FOR I = 1 TO CNT
      LB.ID = JOB.ID:"!":JOB.LB.DEPT<1,I>:"!":JOB.LB.CCTR<1,I>:"!"
      FOR II = 1 TO JOB.LB.SEQ<1,I>
         MATREAD JLB.REC FROM JOB.TIME, LB.ID:II ELSE GOTO 4415
         IF JLB.TYPE # TYPE THEN GOTO 4415
         III = 1
         LOOP WHILE JLB.WIP<1,III> # '' DO
            IF JLB.MON<1,III> <= MENU THEN
               FOR J = 1 TO 4
                  TREC(J,TPTR) = TREC(J,TPTR) + JLB.WIP<1,III,J>
               NEXT J
            END
            III = III + 1
         REPEAT
4415  NEXT II
   NEXT I
4420IF JOB.MT.WIP<1,4> > MENU THEN GOTO 4430
   MT.WIP = JOB.MT.WIP<1,2,1> + JOB.MT.WIP<1,2,2> + JOB.MT.WIP<1,2,3>
   IF MT.WIP = 0 THEN
      IF JOB.MT.WIP<1,4> = "" OR JOB.MT.WIP<1,5> < MENU THEN GOTO 4430
   END
   CNT = COUNT(JOB.MT.DEPT,VM) + (JOB.MT.DEPT # "")
   FOR I = 1 TO CNT
      MT.ID = JOB.ID:"!":JOB.MT.DEPT<1,I>:"!":JOB.MT.CCTR<1,I>:"!"
      MT.ID = MT.ID:JOB.MT.PROD<1,I>:"!":JOB.MT.WHSE<1,I>:"!"
      FOR II = 1 TO JOB.MT.SEQ<1,I>
         MATREAD JMT.REC FROM JOB.MATL, MT.ID:II ELSE GOTO 4425
         IF JMT.TYPE # TYPE THEN GOTO 4425
         III = 1
         LOOP WHILE JMT.WIP<1,III> # "" DO
            IF JMT.MON<1,III> <= MENU THEN
               TREC(5,TPTR) = TREC(5,TPTR) + JMT.WIP<1,III,1> + JMT.WIP<1,III,2> + JMT.WIP<1,III,3>
            END
            III = III + 1
         REPEAT
4425  NEXT II
   NEXT I
4430IF JOB.OS.WIP<1,4> > MENU THEN GOTO 4440
   OS.WIP = JOB.OS.WIP<1,2,1> + JOB.OS.WIP<1,2,2>
   IF OS.WIP = 0 THEN
      IF JOB.OS.WIP<1,4> = "" OR JOB.OS.WIP<1,5> < MENU THEN GOTO 4440
   END
   CNT = COUNT(JOB.OS.DEPT,VM) + (JOB.OS.DEPT # "")
   FOR I = 1 TO CNT
      OS.ID = JOB.ID:"!":JOB.OS.DEPT<1,I>:"!":JOB.OS.CCTR<1,I>:"!"
      OS.ID = OS.ID:JOB.OS.PLINE<1,I>:"!"
      FOR II = 1 TO JOB.OS.SEQ<1,I>
         MATREAD JOS.REC FROM JOB.OSP, OS.ID:II ELSE GOTO 4435
         IF JOS.TYPE # TYPE THEN GOTO 4435
         III = 1
         LOOP WHILE JOS.WIP<1,III> # "" DO
            IF JOS.MON<1,III> <= MENU THEN
               TREC(6,TPTR) = TREC(6,TPTR) + JOS.WIP<1,III,1> + JOS.WIP<1,III,2>
            END
            III = III + 1
         REPEAT
4435  NEXT II
   NEXT I
4440IF JOB.SP.WIP<1,4> > MENU THEN GOTO 4450
   SP.WIP = JOB.SP.WIP<1,2,1> + JOB.SP.WIP<1,2,2>
   IF SP.WIP = 0 THEN
      IF JOB.SP.WIP<1,4> = "" OR JOB.SP.WIP<1,5> < MENU THEN GOTO 4450
   END
   CNT = COUNT(JOB.SP.DEPT,VM) + (JOB.SP.DEPT # "")
   FOR I = 1 TO CNT
      SP.ID = JOB.ID:"!":JOB.SP.DEPT<1,I>:"!":JOB.SP.CCTR<1,I>:"!"
      FOR II = 1 TO JOB.SP.SEQ<1,I>
         MATREAD JSP.REC FROM JOB.SHIP, SP.ID:II ELSE GOTO 4445
         IF JSP.TYPE # TYPE THEN GOTO 4445
         III = 1
         LOOP WHILE JSP.WIP<1,III> # "" DO
            IF JSP.MON<1,III> <= MENU THEN
               TREC(7,TPTR) = TREC(7,TPTR) + JSP.WIP<1,III,1> + JSP.WIP<1,III,2>
            END
            III =  III + 1
         REPEAT
4445  NEXT II
   NEXT I
4450IF JOB.MS.WIP<1,4> > MENU THEN GOTO 4900
   MS.WIP = JOB.MS.WIP<1,2,1> + JOB.MS.WIP<1,2,2>
   IF MS.WIP = 0 THEN
      IF JOB.MS.WIP<1,4> = "" OR JOB.MS.WIP<1,5> < MENU THEN GOTO 4900
   END
   CNT = COUNT(JOB.MS.DEPT,VM) + (JOB.MS.DEPT # "")
   FOR I = 1 TO CNT
      MS.ID = JOB.ID:"!":JOB.MS.DEPT<1,I>:"!":JOB.MS.CCTR<1,I>:"!"
      FOR II = 1 TO JOB.MS.SEQ<1,I>
         MATREAD JMS.REC FROM JOB.MISC, MS.ID:II ELSE GOTO 4455
         IF JMS.TYPE # TYPE THEN GOTO 4455
         III = 1
         LOOP WHILE JMS.WIP<1,III> # "" DO
            IF JMS.MON<1,III> <= MENU THEN
               TREC(8,TPTR) = TREC(8,TPTR) + JMS.WIP<1,III,1> + JMS.WIP<1,III,2>
            END
            III = III + 1
         REPEAT
4455  NEXT II
   NEXT I
4900TOT.COST = 0
   MAT TTREC = 0
   FOR I = 1 TO 4
      FOR J = 1 TO 8
         TTREC(I) = TTREC(I) + TREC(J,I)
         MREC(J,I) = MREC(J,I) + TREC(J,I)
      NEXT J
      TOT.COST = TOT.COST + TTREC(I)
   NEXT I
   IF TOT.COST = 0 THEN GOTO 4999
*-- FINDING THE TOTAL COST
   MAST.TOT<1,1> = MAST.TOT<1,1> + TTREC(1)
   MAST.TOT<1,2> = MAST.TOT<1,2> + TTREC(2)
   MAST.TOT<1,3> = MAST.TOT<1,3> + TTREC(3)
   MAST.TOT<1,4> = MAST.TOT<1,4> + TTREC(4)
   LN = COUNT(LINE.MASTER,AM) + (LINE.MASTER # "")
   LN = LN + 1
   LINE.MASTER<LN> = JOB.MASTER
   LINE.JOB<LN> = JOBNO
   LINE.TYPE<LN,1> = "R"
   LINE.TYPE<LN,2> = "C"
   LINE.TYPE<LN,3> = "S"
   LINE.TYPE<LN,4> = "N"
   LINE.DR<LN,1> = TREC(1,1)
   LINE.DR<LN,2> = TREC(1,2)
   LINE.DR<LN,3> = TREC(1,3)
   LINE.DR<LN,4> = TREC(1,4)
   LINE.VF<LN,1> = TREC(3,1)
   LINE.VF<LN,2> = TREC(3,2)
   LINE.VF<LN,3> = TREC(3,3)
   LINE.VF<LN,4> = TREC(3,4)
   LINE.FF<LN,1> = TREC(2,1)
   LINE.FF<LN,2> = TREC(2,2)
   LINE.FF<LN,3> = TREC(2,3)
   LINE.FF<LN,4> = TREC(2,4)
   LINE.SV<LN,1> = TREC(4,1)
   LINE.SV<LN,2> = TREC(4,2)
   LINE.SV<LN,3> = TREC(4,3)
   LINE.SV<LN,4> = TREC(4,4)
   LINE.MT<LN,1> = TREC(5,1)
   LINE.MT<LN,2> = TREC(5,2)
   LINE.MT<LN,3> = TREC(5,3)
   LINE.MT<LN,4> = TREC(5,4)
   LINE.OS<LN,1> = TREC(6,1)
   LINE.OS<LN,2> = TREC(6,2)
   LINE.OS<LN,3> = TREC(6,3)
   LINE.OS<LN,4> = TREC(6,4)
   LINE.SP<LN,1> = TREC(7,1)
   LINE.SP<LN,2> = TREC(7,2)
   LINE.SP<LN,3> = TREC(7,3)
   LINE.SP<LN,4> = TREC(7,4)
   LINE.MS<LN,1> = TREC(8,1)
   LINE.MS<LN,2> = TREC(8,2)
   LINE.MS<LN,3> = TREC(8,3)
   LINE.MS<LN,4> = TREC(8,4)
   LINE.TOTAL<LN,1> = TTREC(1)
   LINE.TOTAL<LN,2> = TTREC(2)
   LINE.TOTAL<LN,3> = TTREC(3)
   LINE.TOTAL<LN,4> = TTREC(4)
   TOT.TYPE<1,1>="R"
   TOT.TYPE<1,2>="C"
   TOT.TYPE<1,3>="S"
   TOT.TYPE<1,4>="N"
4999*
   RETURN
*-- PRINT TOTAL FOR MASTER JOB
5000*
   LN.CNT = COUNT(LINE.MASTER,AM) + (LINE.MASTER # "")
   BEGIN CASE
      CASE LN.CNT < 1
         GOTO 5500
      CASE LN.CNT = 1
         V.LINE = LINE.MASTER<1> "L#8" :SP1
         IF LINE.MASTER<1> = LINE.JOB<1> THEN
            V.LINE = V.LINE:SPACE(11)
         END ELSE
            V.LINE = V.LINE : LINE.JOB<1> "L#8" :SP3
         END
         FOR I = 1 TO 4
            IF LINE.TOTAL<1,I> = 0 THEN GOTO 5010
            V.LINE = V.LINE : LINE.TYPE<1,I> "L#1" : SP4
            V.LINE = V.LINE : OCONV(LINE.TOTAL<1,I>, 'MD2') "R#12" :SP1
            V.LINE = V.LINE : OCONV(LINE.DR<1,I>, 'MD2') "R#10" :SP1
            V.LINE = V.LINE : OCONV(LINE.FF<1,I>, 'MD2') "R#10" :SP1
            V.LINE = V.LINE : OCONV(LINE.VF<1,I>, 'MD2') "R#10" :SP1
            V.LINE = V.LINE : OCONV(LINE.SV<1,I>, 'MD2') "R#10" :SP1
            V.LINE = V.LINE : OCONV(LINE.MT<1,I>, 'MD2') "R#10" :SP1
            V.LINE = V.LINE : OCONV(LINE.OS<1,I>, 'MD2') "R#10" :SP1
            V.LINE = V.LINE : OCONV(LINE.SP<1,I>, 'MD2') "R#10" : SP1
            V.LINE = V.LINE : OCONV(LINE.MS<1,I>, 'MD2') "R#10"
            PRINT V.LINE
            V.LINE = SP20
5010     NEXT I
         IF LINE.MASTER<1> = LINE.JOB<1> THEN GOTO 5100
         LST = 1
      CASE 1
         LOCATE PREV.MASTER IN LINE.JOB,1 SETTING FND ELSE FND = 0
         IF FND AND FND < LN.CNT THEN
            LINE.MASTER<-1> = LINE.MASTER<FND>
            LINE.JOB<-1> = LINE.JOB<FND>
            LINE.TYPE<-1> = LINE.TYPE<FND>
            LINE.DR<-1> = LINE.DR<FND>
            LINE.VF<-1> = LINE.VF<FND>
            LINE.FF<-1> = LINE.FF<FND>
            LINE.SV<-1> = LINE.SV<FND>
            LINE.MT<-1> = LINE.MT<FND>
            LINE.OS<-1> = LINE.OS<FND>
            LINE.SP<-1> = LINE.SP<FND>
            LINE.MS<-1> = LINE.MS<FND>
            LINE.TOTAL<-1> = LINE.TOTAL<FND>
            LINE.MASTER = DELETE(LINE.MASTER,FND,0,0)
            LINE.JOB = DELETE(LINE.JOB,FND,0,0)
            LINE.TYPE = DELETE(LINE.TYPE,FND,0,0)
            LINE.DR = DELETE(LINE.DR,FND,0,0)
            LINE.VF = DELETE(LINE.VF,FND,0,0)
            LINE.FF = DELETE(LINE.FF,FND,0,0)
            LINE.SV = DELETE(LINE.SV,FND,0,0)
            LINE.MT = DELETE(LINE.MT,FND,0,0)
            LINE.OS = DELETE(LINE.OS,FND,0,0)
            LINE.SP = DELETE(LINE.SP,FND,0,0)
            LINE.MS = DELETE(LINE.MS,FND,0,0)
            LINE.TOTAL = DELETE(LINE.TOTAL,FND,0,0)
         END
         LST = 1
         FOR LN = 1 TO LN.CNT
            IF LN = 1 THEN
               V.LINE = LINE.MASTER<LN> "L#8":SP1
            END ELSE
               V.LINE = SPACE(9)
            END
            IF LINE.MASTER<LN> = LINE.JOB<LN> THEN
               V.LINE = V.LINE : SPACE(11)
            END ELSE
               V.LINE = V.LINE : LINE.JOB<LN> "L#8": SP3
            END
            FOR L = 1 TO 4
               IF LINE.TOTAL<LN,L> = 0 THEN GOTO 5050
               V.LINE = V.LINE : LINE.TYPE<LN,L> "L#1" : SP4
               V.LINE = V.LINE : OCONV(LINE.TOTAL<LN,L>, 'MD2') "R#12" :SP1
               V.LINE = V.LINE : OCONV(LINE.DR<LN,L>, 'MD2') "R#10" :SP1
               V.LINE = V.LINE : OCONV(LINE.FF<LN,L>, 'MD2') "R#10" :SP1
               V.LINE = V.LINE : OCONV(LINE.VF<LN,L>, 'MD2') "R#10" :SP1
               V.LINE = V.LINE : OCONV(LINE.SV<LN,L>, 'MD2') "R#10" :SP1
               V.LINE = V.LINE : OCONV(LINE.MT<LN,L>, 'MD2') "R#10" :SP1
               V.LINE = V.LINE : OCONV(LINE.OS<LN,L>, 'MD2') "R#10" :SP1
               V.LINE = V.LINE : OCONV(LINE.SP<LN,L>, 'MD2') "R#10" : SP1
               V.LINE = V.LINE : OCONV(LINE.MS<LN,L>, 'MD2') "R#10"
               PRINT V.LINE
               V.LINE = SP20
5050        NEXT L
         NEXT LN
   END CASE
   PRINT ULINE
   T.LINE = ""
   T.LINE = T.LINE : PREV.MASTER "L#8" : " TOTAL      "
   Y = 1
   FOR X = 1 TO 4
      T.LINE = T.LINE : LINE.TYPE<Y,X> "L#1" : SP4
      IF MAST.TOT<1,X> = 0 THEN GOTO 5075
      T.LINE = T.LINE : OCONV(MAST.TOT<1,X>, 'MD2') "R#12"
      FOR XX = 1 TO 8
         T.LINE = T.LINE : SPACE(1): OCONV(MREC(XX,X), 'MD2') "R#10"
      NEXT XX
      PRINT T.LINE
5075  T.LINE = ''
      T.LINE = T.LINE : SP20
   NEXT X
   PRINT ULINE
5100*
   FOR I = 1 TO 8
      FOR J = 1 TO 4
         TMREC(I,J) = TMREC(I,J) + MREC(I,J)
      NEXT J
   NEXT I
   TOTALS<1,1> = TOTALS<1,1> + MAST.TOT<1,1>
   TOTALS<1,2> = TOTALS<1,2> + MAST.TOT<1,2>
   TOTALS<1,3> = TOTALS<1,3> + MAST.TOT<1,3>
   TOTALS<1,4> = TOTALS<1,4> + MAST.TOT<1,4>
*-- CLEAR MASTER TOTALS
5500*
   MAT LINE.REC = ""
   MAST.TOT = 0
   MAT MREC = 0
   PREV.MASTER = JOB.MASTER
   RETURN
*-- CALLS FOR SYSCOM
91000ERR.TYPE = 1; CALL SYSCOM(MAT SYSCOM.REC); RETURN
92000ERR.TYPE = 2; CALL SYSCOM(MAT SYSCOM.REC); RETURN
93000ERR.TYPE = 3; CALL SYSCOM(MAT SYSCOM.REC)
999999*
END
