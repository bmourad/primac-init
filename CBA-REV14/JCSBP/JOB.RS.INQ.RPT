   SUBROUTINE JOB.RS.INQ.RPT(CONO,CO.NAME,JOB.NUM,SAVE.INV.JS.REC,HD1,HD2)
*COPY>CPYLIB>COM1
*COPY>JCS.CPYLIB>COM.JCS.LINK
*COPY>ICS.CPYLIB>COM.INV.MAIN  
*COPY>ICS.CPYLIB>COM.INV.SERIAL
*COPY>JCS.CPYLIB>COM.INV.STATS 
*COPY>PMC.CPYLIB>COM.CUST
*COPY>OPS.CPYLIB>COM.ORDER
*COPY>JCS.CPYLIB>COM.JOB.INQ
*********************************************************************
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - JCSBP
* PROGRAM     - JOB.RS.INQ.RPT
* DATE        - 11/21/83
* DESCRIPTION -
* T20936 gat 09/03/96 * FIX PROBLEM WITH JOB.RS.INQ.RPT
* T26334 epitka 12/19/2001 * REV12
* T26493 cmykleb 04/03/2002 * Change pgm to use headings from calling pgm.
*********************************************************************
*
*COPY>JCS.CPYLIB>JOB
*COPY>ICS.CPYLIB>INVENTORY
*COPY>ICS.CPYLIB>INV.JOB.STATS
*COPY>JCS.CPYLIB>JOB.TOT.REC
*COPY>ICS.CPYLIB>INV.CNV
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*
   DASHES = STR('-',80)
   PNO = 0
   LINE.COUNT = 99
*T26493 v
   HD3 = "JOB # : ":JOB.NUM"L#8":SPACE(48)
   HD3 = HD3 : "MATERIAL RESERVED REPORT"
*T26493 ^
**** PRINT DETAIL LINES AND TOTALS
100 *
   PROD.CNT = COUNT(JOB.RESV.MATL,VM) + (JOB.RESV.MATL # '')
   FOR D = 1 TO PROD.CNT
      MATREAD INV.REC FROM INVENTORY , CONO:JOB.RESV.MATL<1,D> ELSE
         MAT INV.REC = '' ; GOTO 111
      END
      MATREAD INV.JS.REC FROM INV.JOB.STATS,CONO:JOB.RESV.MATL<1,D>:"!":JOB.RESV.WHSE<1,D>:"!":JOB.NUM ELSE
         MAT INV.JS.REC = ''
      END
      MAT INV.CNV.REC = ''
      BEGIN CASE
         CASE INV.UNIT<1,2> = "SHT" AND INV.UNIT<1,3> = "LBS"
            ICR.CNV = "MD0"; ICR.DV2 = 1
            ICR.DV1 = INV.M.WT; ICR.MT1 = 1
         CASE INV.UNIT<1,2> = "PC" AND INV.UNIT<1,3> = "MSI"
            ICR.CNV = "MD0"; ICR.DV2 = 1
            ICR.DV1 = INV.PAP.WIDTH/100; ICR.MT1 = 10
         CASE INV.UNIT<1,2> = "FT" AND INV.UNIT<1,3> = "MSI"
            ICR.CNV = "MD0"; ICR.DV2 = 12
            ICR.DV1 = INV.PAP.WIDTH/100; ICR.MT1 = 100
         CASE 1
            ICR.CNV = "MD2"; ICR.DV2 = 1
            ICR.DV1 = 10; ICR.MT1 = 1
      END CASE
      GOSUB 1000
111 *
   NEXT D
   GOTO 99999
**** PRINT DETAIL LINE
1000 *
   IF LINE.COUNT > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   LINE = ''
   LINE = LINE :JOB.RESV.MATL<1,D> "L#15":SPACE(23)
   LINE = LINE : JOB.RESV.WHSE<1,D> "L#4":SPACE(1)
   LINE = LINE :INV.UNIT<1,2>"L#3":SPACE(1)
   LINE = LINE :INV.PAP.TYPE "L#8":SPACE(1)
   LINE = LINE :OCONV(JOB.RESV.DATE<1,D> , "D2/") "L#9":SPACE(1)
   IF JOB.RESV.QTY<1,D> > 0 THEN
      LINE = LINE:OCONV(INT((((JOB.RESV.QTY<1,D> / ICR.DV1) * ICR.MT1) / ICR.DV2) + .5),ICR.CNV)"R#10":SPACE(1)
   END ELSE
      LINE = LINE:OCONV(INT((((JOB.RESV.QTY<1,D> / ICR.DV1) * ICR.MT1) / ICR.DV2) - .5),ICR.CNV)"R#10":SPACE(1)
   END
   IF JOB.USED.QTY<1,D> > 0 THEN
      LINE = LINE:OCONV(INT((((JOB.USED.QTY<1,D> / ICR.DV1) * ICR.MT1) / ICR.DV2) + .5),ICR.CNV)"R#10":SPACE(1)
   END ELSE
      LINE = LINE:OCONV(INT((((JOB.USED.QTY<1,D> / ICR.DV1) * ICR.MT1) / ICR.DV2) - .5),ICR.CNV)"R#10":SPACE(1)
   END
* T20936
   IF SAVE.INV.JS.REC = "" THEN
      LINE = LINE:OCONV(IJS.REQ.DATE,"D2/")"L#8":SPACE(1)
   END ELSE
      LINE = LINE:OCONV(SAVE.INV.JS.REC<D,1>,"D2/")"L#8":SPACE(1)
   END
   IF SAVE.INV.JS.REC = "" THEN
      LINE = LINE:OCONV(IJS.REQ.AMT,"MD4")"R#10":SPACE(1)
   END ELSE
      LINE = LINE:OCONV(SAVE.INV.JS.REC<D,2>,"MD4")"R#10":SPACE(1)
   END
   IF SAVE.INV.JS.REC = "" THEN
      IF IJS.REQ.QTY > 0 THEN
         LINE = LINE:OCONV(INT((((IJS.REQ.QTY / ICR.DV1) * ICR.MT1) / ICR.DV2) + .5),ICR.CNV)"R#10":SPACE(1)
      END ELSE
         LINE = LINE:OCONV(INT((((IJS.REQ.QTY / ICR.DV1) * ICR.MT1) / ICR.DV2) - .5),ICR.CNV)"R#10":SPACE(1)
      END
   END ELSE
      IF SAVE.INV.JS.REC<D,3> > 0 THEN
         LINE = LINE:OCONV(INT((((SAVE.INV.JS.REC<D,3> / ICR.DV1) * ICR.MT1) / ICR.DV2) + .5),ICR.CNV)"R#10":SPACE(1)
      END ELSE
         LINE = LINE:OCONV(INT((((SAVE.INV.JS.REC<D,3> / ICR.DV1) * ICR.MT1) / ICR.DV2) - .5),ICR.CNV)"R#10":SPACE(1)
      END
   END
* T20936
   PRINT LINE
   LINE = SPACE(5): INV.FULL.DESC
   PRINT LINE
   LINE.COUNT = LINE.COUNT + 2
   RETURN
**** PRINT HEADING
9999 *
   PRINT CHAR(12)
   PNO = PNO + 1
*T26493 v
*  LINE = SPACE(2) : 'DATE - ' : OCONV(DATE(),"D2/") "L#8"
*  LINE = LINE : SPACE(5) : 'TIME - ' : OCONV(TIME(),"MTS") "L#8"
*  LINE = LINE : SPACE(22) : CO.NAME "L#30"
*  LINE = LINE : SPACE(15) : 'PAGE - ' : PNO "R#3"
*  PRINT LINE
*  PRINT SPACE(50) :'M A T L   R E S E R V E D   R E P O R T'
*  PRINT SPACE(50) :'         FOR JOB : ':JOB.NUM "L#8"
*  PRINT SPACE(50) :DASHES[1,39]
   PRINT HD1:PNO"R#3"
   PRINT HD2
   PRINT HD3
*T26493 ^
   PRINT
   LINE = '                                                                   RESERVED     USED'
   PRINT LINE
   LINE = 'PRODUCT NUM/PRODUCT DESC              WHSE U/M INV TYPE RESV DATE  QUANTITY   QUANTITY  REQ DATE  UN-PRICE   REQD QTY'
   PRINT LINE
   LINE = "------------------------------------- ---- --- -------- --------- ---------- ---------- -------- ---------- ----------"
   PRINT LINE
   PRINT
   LINE.COUNT = LINE.COUNT + 8
   RETURN
99999 *
   RETURN
END
