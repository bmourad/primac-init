*COPY>CPYLIB>COM1
*********************************************************************
* REVISION    - [08.1]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - DRSBP
* PROGRAM     - SHIPTO.MAST.DET.PRT
* AUTHOR      - L. ROSS, C.B.A.
* DATE        - 10/01/91
* DESCRIPTION
* This program prints the shipto master / detail records for a specific
* shipto No.
*T26493 cmykleb 03/22/2002 * Change report to use rpt # from proc.
*********************************************************************
*
***** INSERT FILES EQUATES
*
*COPY>JCS.CPYLIB>SHIPTO.MASTER
*COPY>JCS.CPYLIB>SHIPTO.DETAIL
*COPY>CPYLIB>SYSCOM
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*
**** SETUP ERRMSG ROUTINE
*
   SYS.TYPE = 1
   CALL SYSCOM(MAT SYSCOM.REC)
   PROMPT''
*
***** OPEN FILES
*
   OPEN '','SHIPTO.MASTER' TO SHIPTO.MASTER ELSE
      ERRMSG = 'SHIPTO.MASTER FILE IS MISSING'
      GOTO 93000
   END
   OPEN '','SHIPTO.DETAIL' TO SHIPTO.DETAIL ELSE
      ERRMSG = 'SHIPTO.DETAIL FILE IS MISSING'
      GOTO 93000
   END
*
**** READ PROC VALUES
*
   PROCREAD ID ELSE
      ERRMSG = 'CANNOT PERFORM PROCREAD'
      GOTO 93000
   END
   CONO = ID<1>
*T26493 v
*  CONO.NAME = ID<2>
*  REPORT.NAME = 'SHIPTO MASTER / DETAIL LIST'
*  REPORT.NUMBER = "XXXX"
   CONO.NAME= ""
   REPORT.NAME = ""
   REPORT.NUMBER = ID<2>
*T26493 ^
   REPORT.DATE = DATE()
   HD1 = "" ; HD2 = ""
   CALL GET.PROG.HEAD(CONO,CONO.NAME,REPORT.NAME,REPORT.NUMBER,REPORT.DATE,HD1,HD2)
   SHIPTO = ID<3>
   HD3 = 'FOR SHIPTO# : ':SHIPTO 'L#6':'   '
   DIM SHM.FLD(30), SHM.JST(30), SHM.LEN(30), SHM.CNV(30)
   DIM SDT.FLD(60), SDT.JST(60), SDT.LEN(60), SDT.CNV(60)
   MAT SHM.FLD = ''; MAT SHM.JST =''; MAT SHM.LEN = ''; MAT SHM.CNV = ''
   MAT SDT.FLD = ''; MAT SDT.JST = ''; MAT SDT.LEN = ''; MAT SDT.CNV = ''
   SHM.FLD(1) = 'SHM.SP.STORE'
   SHM.FLD(2) = 'SHM.SP.NAME'
   SHM.FLD(3) = 'SHM.SP.ADDR1'
   SHM.FLD(4) = 'SHM.SP.ADDR2'
   SHM.FLD(5) = 'SHM.SP.CITY'
   SHM.FLD(6) = 'SHM.SP.STATE'
   SHM.FLD(7) = 'SHM.SP.ZIP'
   SHM.FLD(8) = 'SHM.SP.ATTN'
   SHM.FLD(9) = 'SHM.SP.CRSRT'
   SHM.FLD(10) = 'SHM.SP.TAXJUR'
   SHM.FLD(11) = 'SHM.DT.NAME'
   SHM.FLD(12) = 'SHM.DT.ADDR1'
   SHM.FLD(13) = 'SHM.DT.ADDR2'
   SHM.FLD(14) = 'SHM.DT.CITY'
   SHM.FLD(15) = 'SHM.DT.STATE'
   SHM.FLD(16) = 'SHM.DT.ZIP'
   SHM.FLD(17) = 'SHM.DT.ATTN'
   SHM.FLD(18) = 'SHM.DT.CRSRT'
   SHM.FLD(19) = 'SHM.DT.TAXJUR'
   SHM.FLD(20) = 'SHM.DT.SHPVIA'
   SHM.FLD(21) = 'SHM.SP.ZONE'
   SHM.JST(1) = 'L'
   SHM.JST(2) = 'L'
   SHM.JST(3) = 'L'
   SHM.JST(4) = 'L'
   SHM.JST(5) = 'L'
   SHM.JST(6) = 'L'
   SHM.JST(7) = 'L'
   SHM.JST(8) = 'L'
   SHM.JST(9) = 'L'
   SHM.JST(10) = 'L'
   SHM.JST(11) = 'L'
   SHM.JST(12) = 'L'
   SHM.JST(13) = 'L'
   SHM.JST(14) = 'L'
   SHM.JST(15) = 'L'
   SHM.JST(16) = 'L'
   SHM.JST(17) = 'L'
   SHM.JST(18) = 'L'
   SHM.JST(19) = 'L'
   SHM.JST(20) = 'L'
   SHM.JST(21) = 'L'
   SHM.LEN(1) = 4
   SHM.LEN(2) = 30
   SHM.LEN(3) = 30
   SHM.LEN(4) = 30
   SHM.LEN(5) = 25
   SHM.LEN(6) = 2
   SHM.LEN(7) = 10
   SHM.LEN(8) = 30
   SHM.LEN(9) = 4
   SHM.LEN(10) = 3
   SHM.LEN(11) = 30
   SHM.LEN(12) = 30
   SHM.LEN(13) = 30
   SHM.LEN(14) = 25
   SHM.LEN(15) = 2
   SHM.LEN(16) = 10
   SHM.LEN(17) = 30
   SHM.LEN(18) = 4
   SHM.LEN(19) = 3
   SHM.LEN(20) = 2
   SHM.LEN(21) = 3
   SDT.FLD(1) = 'SDT.SP.INST.1'
   SDT.FLD(2) = 'SDT.SP.INST.1.USE'
   SDT.FLD(3) = 'SDT.SP.INST.LEN.1'
   SDT.FLD(4) = 'SDT.SP.INST.2'
   SDT.FLD(5) = 'SDT.SP.INST.2.USE'
   SDT.FLD(6) = 'SDT.SP.INST.LEN.2'
   SDT.FLD(7) = 'SDT.SP.INST.3'
   SDT.FLD(8) = 'SDT.SP.INST.3.USE'
   SDT.FLD(9) = 'SDT.SP.INST.LEN.3'
   SDT.FLD(10) = 'SDT.SP.INST.4'
   SDT.FLD(11) = 'SDT.SP.INST.4.USE'
   SDT.FLD(12) = 'SDT.SP.INST.LEN.4'
   SDT.FLD(13) = 'SDT.SP.INST.5'
   SDT.FLD(14) = 'SDT.SP.INST.5.USE'
   SDT.FLD(15) = 'SDT.SP.INST.LEN.5'
   SDT.FLD(16) = 'SDT.SP.INST.6'
   SDT.FLD(17) = 'SDT.SP.INST.6.USE'
   SDT.FLD(18) = 'SDT.SP.INST.LEN.6'
   SDT.FLD(19) = 'SDT.SP.INST.7'
   SDT.FLD(20) = 'SDT.SP.INST.7.USE'
   SDT.FLD(21) = 'SDT.SP.INST.LEN.7'
   SDT.FLD(22) = 'SDT.SP.INST.8'
   SDT.FLD(23) = 'SDT.SP.INST.8.USE'
   SDT.FLD(24) = 'SDT.SP.INST.LEN.8'
   SDT.FLD(25) = 'SDT.SP.INST.9'
   SDT.FLD(26) = 'SDT.SP.INST.9.USE'
   SDT.FLD(27) = 'SDT.SP.INST.LEN.9'
   SDT.FLD(28) = 'SDT.SP.INST.10'
   SDT.FLD(29) = 'SDT.SP.INST.10.USE'
   SDT.FLD(30) = 'SDT.SP.INST.LEN.10'
   SDT.FLD(31) = 'SDT.SP.INST.DATE'
   SDT.FLD(32) = 'SDT.SP.INST.DATE.USE'
   SDT.FLD(33) = 'SDT.VER.NO'
   SDT.FLD(34) = 'SDT.VER.DESC'
   SDT.FLD(35) = 'SDT.QTY'
   SDT.FLD(36) = 'SDT.DIST.CODE'
   SDT.FLD(37) = 'SDT.EDITION'
   SDT.FLD(38) = 'SDT.SHRKWRP'
   SDT.FLD(39) = 'SDT.CART.LAB'
   SDT.FLD(40) = 'SDT.SKID.LAB'
   SDT.FLD(41) = 'SDT.BOL'
   SDT.FLD(42) = 'SDT.FOLD'
   SDT.FLD(43) = 'SDT.PACK'
   SDT.FLD(44) = 'SDT.STORE.QTY'
   SDT.JST(1) = 'L'
   SDT.JST(2) = 'L'
   SDT.JST(3) = 'L'
   SDT.JST(4) = 'L'
   SDT.JST(5) = 'L'
   SDT.JST(6) = 'L'
   SDT.JST(7) = 'L'
   SDT.JST(8) = 'L'
   SDT.JST(9) = 'L'
   SDT.JST(10) = 'L'
   SDT.JST(11) = 'L'
   SDT.JST(12) = 'L'
   SDT.JST(13) = 'L'
   SDT.JST(14) = 'L'
   SDT.JST(15) = 'L'
   SDT.JST(16) = 'L'
   SDT.JST(17) = 'L'
   SDT.JST(18) = 'L'
   SDT.JST(19) = 'L'
   SDT.JST(20) = 'L'
   SDT.JST(21) = 'L'
   SDT.JST(22) = 'L'
   SDT.JST(23) = 'L'
   SDT.JST(24) = 'L'
   SDT.JST(25) = 'L'
   SDT.JST(26) = 'L'
   SDT.JST(27) = 'L'
   SDT.JST(28) = 'L'
   SDT.JST(29) = 'L'
   SDT.JST(30) = 'L'
   SDT.JST(31) = 'L'
   SDT.JST(32) = 'L'
   SDT.JST(33) = 'L'
   SDT.JST(34) = 'L'
   SDT.JST(35) = 'R'
   SDT.JST(36) = 'L'
   SDT.JST(37) = 'L'
   SDT.JST(38) = 'L'
   SDT.JST(39) = 'L'
   SDT.JST(40) = 'L'
   SDT.JST(41) = 'L'
   SDT.JST(42) = 'L'
   SDT.JST(43) = 'L'
   SDT.JST(44) = 'R'
   SDT.LEN(1) = 58
   SDT.LEN(2) = 10
   SDT.LEN(3) = 2
   SDT.LEN(4) = 58
   SDT.LEN(5) = 10
   SDT.LEN(6) = 2
   SDT.LEN(7) = 58
   SDT.LEN(8) = 10
   SDT.LEN(9) = 2
   SDT.LEN(10) = 58
   SDT.LEN(11) = 10
   SDT.LEN(12) = 2
   SDT.LEN(13) = 58
   SDT.LEN(14) = 10
   SDT.LEN(15) = 2
   SDT.LEN(16) = 58
   SDT.LEN(17) = 10
   SDT.LEN(18) = 2
   SDT.LEN(19) = 58
   SDT.LEN(20) = 10
   SDT.LEN(21) = 2
   SDT.LEN(22) = 58
   SDT.LEN(23) = 10
   SDT.LEN(24) = 2
   SDT.LEN(25) = 58
   SDT.LEN(26) = 10
   SDT.LEN(27) = 2
   SDT.LEN(28) = 58
   SDT.LEN(29) = 10
   SDT.LEN(30) = 2
   SDT.LEN(31) = 8
   SDT.LEN(32) = 10
   SDT.LEN(33) = 5
   SDT.LEN(34) = 30
   SDT.LEN(35) = 9
   SDT.LEN(36) = 5
   SDT.LEN(37) = 8
   SDT.LEN(38) = 1
   SDT.LEN(39) = 1
   SDT.LEN(40) = 1
   SDT.LEN(41) = 1
   SDT.LEN(42) = 4
   SDT.LEN(43) = 6
   SDT.LEN(44) = 4
   SDT.CNV(31) = 'D2/'
*
**** INITIALIZATION
*
   LINE.COUNT = 99
   PAGE.NO = 0
   HH.LINE1 = 'FIELD NAME':SPACE(11):'CONTENTS'
   HH.LINE2 = STR('-',20):' ':STR('-',60)
*
***** READ AND PROCESS FIRST RECORD
*
100 *
   READNEXT KEY ELSE GOTO 99999
   PRINTER ON
   GOSUB 9000
*
***** READ AND PROCESS ALL RECORDS
*
   DATA = 1
   LOOP
   WHILE DATA = 1 DO
      MATREAD SHM.REC FROM SHIPTO.MASTER, CONO:SHIPTO ELSE
         PRINTER OFF
         ERRMSG = 'SHIPTO.MASTER RECORD MISSING'
         GOSUB 91000
         GOTO 99999
      END
      MATREAD SDT.REC FROM SHIPTO.DETAIL, CONO:SHIPTO ELSE
*           PRINTER OFF
*           ERRMSG = 'SHIPTO.DETAIL RECORD MISSING'
*           GOSUB 91000
*           PRINTER ON
         MAT SDT.REC = ''
      END
      PLINE = ''
      FOR I = 1 TO 21
         CONTENTS = ''
         IF SHM.REC(I) # '' THEN
            PLINE = SHM.FLD(I) 'L#20':' '
            CONTENTS = SHM.REC(I)
            IF SHM.CNV(I) # "" THEN CONTENTS = OCONV(CONTENTS,SHM.CNV(I))
            FMT = SHM.JST(I):"#":SHM.LEN(I)
            CONTENTS =CONTENTS FMT
            PLINE= PLINE:CONTENTS
            GOSUB 1000
         END
      NEXT I
      FOR I = 1 TO 44
         IF SDT.REC(I) # '' THEN
            PLINE = SDT.FLD(I) 'L#20':' '
            CONTENTS = SDT.REC(I)
            IF SDT.CNV(I) # "" THEN CONTENTS = OCONV(CONTENTS,SDT.CNV(I))
            FMT = SDT.JST(I):"#":SDT.LEN(I)
            CONTENTS =CONTENTS FMT
            PLINE= PLINE:CONTENTS
            GOSUB 1000
         END
      NEXT I
      DATA = 0
   REPEAT
   GOTO 99999
*
**** DETAIL ROUTINE
*
1000 *
*
   IF LINE.COUNT > 53 THEN GOSUB 9000
   PRINT PLINE
   LINE.COUNT = LINE.COUNT + 1
   RETURN
*
***** PRINT HEADINGS
*
9000 *
   PRINT CHAR(12):
   PAGE.NO = PAGE.NO + 1
   PRINT HD1:PAGE.NO
   PRINT HD2
   PRINT
   PRINT HD3
   PRINT
   PRINT HH.LINE1
   PRINT HH.LINE2
   PRINT
   LINE.COUNT = 0
   RETURN
*
***** CALL SYSCOM(MAT SYSCOM.REC)
*
91000 *
   ERR.TYPE = 1
   CALL SYSCOM(MAT SYSCOM.REC)
   RETURN
92000 *
   ERR.TYPE = 2
   CALL SYSCOM(MAT SYSCOM.REC)
   RETURN
93000 *
   ERR.TYPE = 3
   CALL SYSCOM(MAT SYSCOM.REC)
*
**** END OF JOB
*
99999 *
   PRINTER OFF
END
