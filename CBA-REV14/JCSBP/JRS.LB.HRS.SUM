      SUBROUTINE JRS.LB.HRS.SUM
*COPY>JCS.CPYLIB>COM.JRS
*************************************************************
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - JCSBP
* PROGRAM     - JRS.LB.HRS.SUM
* BY          - W.R. MCKENZIE, COMPUTER BUSINESS ASSOCIATES
* DATE        - 05/25/88
* DESCRIPTION -
* This program produces a Labor Hours Posted Report
* T26556 ajibaly 05/08/2002 * Use report #.
*T28754 thompson 12/28/2005 * Expand reg and tot hrs for est and actual
*                             for larger clients
* T28964 wvaughan 8/07/2006 * Extend JOB.QTY field to display 8 numbers.
*************************************************************
*
*---- FILE EQUATES
*
*COPY>JCS.CPYLIB>JOB
*COPY>JCS.CPYLIB>OPERATION
*COPY>CPYLIB>CHAR
*COPY>CPYLIB>FILE.VARS
*COPY>JCS.CPYLIB>JOB.RPT.SET
*COPY>PMC.CPYLIB>COST.CNTR
*COPY>PMC.CPYLIB>DEPARTMENT
*COPY>JCS.CPYLIB>JOB.RPT.SUM
*
*---- INITIALIZATION
*
      PG.NO=0
      ERRMSG=''
      DEPT.DATE=''
      GRND.DATE=''
*T26556 v
*     RPT.NO="XXXX"
      HD1 = ""; HD2 = ""
      RPT.NAME = ""
      RPT.DATE = DATE()
      CALL GET.PROG.HEAD(CONO,C.CO.NAME,RPT.NAME,RPT.NO,RPT.DATE,HD1,HD2)
      PRINTER ON
*T26556 ^
      D.C.PRT = 0
      D.PRT = 0
      GRND.C.PRT.DATE=0
      DEPT.C.DATE=0
      DEPT.C.PRT.DATE=0
      GRND.C.DATE=0
      LINE.CNT = 75
      GRAND.C = 0
      UNKNOWN=STR("?",30)
      K=''
      DEPT.DATE = 0;D.PRT=0;D.C.PRT=0
      DEPT.C.DATE=0
      DIM G.TOT(16)
      MAT G.TOT=''
      DIM DEPT.TOT(19)
      MAT DEPT.TOT=''
*T28754      TLINE=SPACE(62):'------- ------ -------  ------- ------ ------ -------    ------ ------'
      TLINE=SPACE(58):'-------- ------ --------  -------- ------ ------ --------    ------ ------'
*
*---- MAIN PROCESSING
*
16*
      JOB.CNT = DCOUNT(JRS.IDS,AM)
      IF JRSD.CONS ="Y" THEN
         CONSOL="CONSOLIDATED"
      END ELSE
         CONSOL="            "
      END
      PTR=0
      FOR I = 1 TO JOB.CNT WHILE PTR=0
         IF FIELD(JRS.IDS<I>,'&',5) # 'L' THEN GOTO 10
         DEPT.NO = FIELD(JRS.IDS<I>,'&',2)
         IF DP.SEL # 'ALL' AND DP.SEL # DEPT.NO THEN GOTO 10
         MATREAD JRS.REC FROM JOB.RPT.SET, CONO:JOBNO:'&':JRS.IDS<I> ELSE GOTO 10
         PTR=I
10    NEXT I
      IF PTR = 0 THEN GOTO 99999
      CCTR.NO = FIELD(JRS.IDS<PTR>,'&',3)
      OPER.NO = FIELD(JRS.IDS<PTR>,'&',4)
      P.DP = DEPT.NO
      MATREAD DEPT.REC FROM DEPARTMENT,CONO:P.DP ELSE DEPT.DESC = UNKNOWN
      MATREAD OPER.REC FROM OPERATION, CONO:OPER.NO ELSE OPER.DESC = UNKNOWN
      GOSUB 20
      P.LINE=DEPT.DESC:'  ':DEPT.NO
      PRINT P.LINE
      PRINT STR('-',LEN(P.LINE))
      LINE.CNT=LINE.CNT + 2
      GOSUB 1000
      PTR = PTR+ 1
      FOR I = PTR TO JOB.CNT
         IF FIELD(JRS.IDS<I>,"&",5) # "L" THEN GOTO 17
         MATREAD JRS.REC FROM JOB.RPT.SET,CONO:JOBNO:'&':JRS.IDS<I> ELSE GOTO 17
         DEPT.NO = FIELD(JRS.IDS<I>,"&",2)
         IF DP.SEL # 'ALL' THEN
            IF DP.SEL # DEPT.NO THEN
               GOTO 17
*            END ELSE
*               JOB.CNT = 0
            END
         END
         CCTR.NO = FIELD(JRS.IDS<I>,"&",3)
         OPER.NO = FIELD(JRS.IDS<I>,"&",4)
         MATREAD OPER.REC FROM OPERATION,CONO:OPER.NO ELSE OPER.DESC=UNKNOWN
         IF LINE.CNT >= 50 THEN GOSUB 20
         IF DEPT.NO # P.DP THEN
            GOSUB 2000
            P.DP = DEPT.NO
            MATREAD DEPT.REC FROM DEPARTMENT,CONO:DEPT.NO ELSE DEPT.DESC=UNKNOWN
            P.LINE=DEPT.DESC:'  ':DEPT.NO
            PRINT P.LINE
            PRINT STR('-',LEN(P.LINE))
            LINE.CNT=LINE.CNT + 2
         END
         GOSUB 1000
17*
      NEXT I
      GOSUB 2000
      IF LINE.CNT + 3 >= 50 THEN GOSUB 20
      GRND.VAR = G.TOT(7)-G.TOT(3)
      IF GRND.VAR = 0 THEN GRND.VAR = ''
      GRND.C.VAR = G.TOT(15)-G.TOT(11)
      IF GRND.C.VAR = 0 THEN GRND.C.VAR = ''
      GRND.PRT.DATE = GRND.DATE
      GRND.C.PRT.DATE = GRND.C.DATE
      IF GRND.C.PRT.DATE = 0 THEN GRND.C.PRT.DATE = ''
      IF GRND.PRT.DATE = 0 THEN GRND.PRT.DATE = ''
      PRINT TLINE
*T28754      G.LINE='*** GRAND TOTALS ***':SPACE(33):OCONV(GRND.PRT.DATE,"D2/") "R#8":' ':OCONV(G.TOT(1),"MD2") "R#7"
      G.LINE='*** GRAND TOTALS ***':SPACE(29):OCONV(GRND.PRT.DATE,"D2/") "R#8":' ':OCONV(G.TOT(1),"MD2") "R#8"
*T28754      G.LINE=G.LINE:' ':OCONV(G.TOT(2),"MD2") "R#6":' ':OCONV(G.TOT(3),"MD2") "R#7":'  '
      G.LINE=G.LINE:' ':OCONV(G.TOT(2),"MD2") "R#6":' ':OCONV(G.TOT(3),"MD2") "R#8":'  '
*T28754      G.LINE=G.LINE:OCONV(G.TOT(4),"MD2") "R#7":' ':OCONV(G.TOT(5),"MD2") "R#6":' '
      G.LINE=G.LINE:OCONV(G.TOT(4),"MD2") "R#8":' ':OCONV(G.TOT(5),"MD2") "R#6":' '
*T28754      G.LINE=G.LINE:OCONV(G.TOT(6),"MD2") "R#6":' ':OCONV(G.TOT(7),"MD2") "R#7":'   '
      G.LINE=G.LINE:OCONV(G.TOT(6),"MD2") "R#6":' ':OCONV(G.TOT(7),"MD2") "R#8":'   '
*T28754      G.LINE=G.LINE:OCONV(GRND.VAR,"MD2") "R#7":'  ':OCONV(G.TOT(8),"MD2") "R#6"
      G.LINE=G.LINE:OCONV(GRND.VAR,"MD2") "R#7":' ':OCONV(G.TOT(8),"MD2") "R#6"
      PRINT G.LINE
      IF GRAND.C THEN
*T28754         G.LINE=SPACE(50):'CO ':OCONV(GRND.C.PRT.DATE,"D2/") "R#8":' ':G.TOT(9) "R#7":' '
         G.LINE=SPACE(46):'CO ':OCONV(GRND.C.PRT.DATE,"D2/") "R#8":' ':G.TOT(9) "R#8":' '
*T28754         G.LINE=G.LINE:OCONV(G.TOT(10),"MD2") "R#6":' ':OCONV(G.TOT(11),"MD2") "R#7":'  ':OCONV(G.TOT(12),"MD2") "R#7":' '
         G.LINE=G.LINE:OCONV(G.TOT(10),"MD2") "R#6":' ':OCONV(G.TOT(11),"MD2") "R#8":'  ':OCONV(G.TOT(12),"MD2") "R#8":' '
         G.LINE=G.LINE:OCONV(G.TOT(13),"MD2") "R#6":' ':OCONV(G.TOT(14),"MD2") "R#6":' '
*T28754         G.LINE=G.LINE:OCONV(G.TOT(15),"MD2") "R#7":'   ':OCONV(GRND.C.VAR,"MD2") "R#7":' ':OCONV(G.TOT(16),"MD2") "R#6"
         G.LINE=G.LINE:OCONV(G.TOT(15),"MD2") "R#8":'  ':OCONV(GRND.C.VAR,"MD2") "R#7":' ':OCONV(G.TOT(16),"MD2") "R#6"
         PRINT G.LINE
      END
      GOTO 99999
*
*---- PRINT THE HEADINGS
*
20*
      PRINT CHAR(12)
      PG.NO=PG.NO + 1
      H.LINE=''; HLINE1=''; HLINE2=''; HLINE3=''
      HLINE1="#":JOBNO "L#8":SPACE(1):CONSOL:"  REPORT NO: ":RPT.NO "L#4":SPACE(3)
      N=SPACE((50 - LEN(C.CO.NAME)) / 2)
      HLINE2=N:C.CO.NAME:N
      HLINE3=SPACE(8):OCONV(DATE(),"D2/")"R#8":SPACE(12):"PAGE: ":PG.NO
*T26556 v
*     PRINT HLINE1:HLINE2:HLINE3
*     PRINT JOB.CUST "L#8":SPACE(33):'L A B O R   H O U R S   P O S T E D   R E P O R T'
      PRINT HD1:PG.NO
      PRINT HD2
      PRINT "Job Number: ":JOBNO "L#8":SPACE(1):CONSOL
      PRINT JOB.CUST "L#8"
*T26556 ^
      PRINT C.CUST.NAME
      *T28964  PRINT JOB.QTY<1,1>"L#7":SPACE(45):'FOR ITEMS THROUGH: ':OCONV(JRSD.DATE,"D2-")
      PRINT JOB.QTY<1,1>"L#8":SPACE(45):'FOR ITEMS THROUGH: ':OCONV(JRSD.DATE,"D2-");*T28964
      PRINT JOB.DESC<1,1> "L#30":SPACE(22):'DATE LAST ENTRY  : ':OCONV(JRSD.LB.DATE,"D2-")
      PRINT 'SR: ':C.SALS.NAME "L#27":'SALES CODE: ':JOB.SALES.CODE
*T28754      PRINT SPACE(55):'LAST   ----- EST. HOURS -----  -------- ACTUAL HOURS -------'
      PRINT SPACE(51):'LAST   ----- EST. HOURS -----  -------- ACTUAL HOURS -------'
*T28754      PRINT 'DEPT  CCTR  OPER  DESCRIPTION':SPACE(26):'ENTRY    REG     O/T   TOTAL     REG     O/T    D/T   TOTAL       VAR   SPOIL'
      PRINT 'DEPT  CCTR  OPER  DESCRIPTION':SPACE(22):'ENTRY     REG     O/T    TOTAL      REG     O/T    D/T    TOTAL       VAR   SPOIL'
*T28754      PRINT '----  ----  ----  -------------------------------    -------- ------- ------ -------  ------- ------ ------ -------    ------ ------'
      PRINT '----  ----  ----  ---------------------------    -------- -------- ------ --------  -------- ------ ------ --------    ------ ------'
*T26556 v
*     LINE.CNT= 9
      LINE.CNT= 11
*T26556 ^
      RETURN
*
*-----PRINT LINE
*
1000*
      IF LINE.CNT > 50 THEN GOSUB 20
      P.LINE='';PLINE1='';PLINE2='';PLINE3=''
      P.LINE=P.LINE:SPACE(6):CCTR.NO "L#4":'  ':OPER.NO "L#4":'  ':OPER.DESC "L#31"
      IF JRS.R.QTY # "" OR JRS.E.R.QTY # "" OR JRS.S.QTY<1,1> # "" THEN
         D.PRT=1
*T28754         PLINE1='    ':OCONV(JRS.DATE,"D2/") "R#8":' ':OCONV(JRS.E.R.QTY<1,1>,"MD2") "R#7":' '
         PLINE1='':OCONV(JRS.DATE,"D2/") "R#8":' ':OCONV(JRS.E.R.QTY<1,1>,"MD2") "R#8":' '
*T28754         PLINE1 = PLINE1:OCONV(JRS.E.R.QTY<1,2>,"MD2") "R#6":' ':OCONV(JRS.E.R.QTY<1,1> + JRS.E.R.QTY<1,2>,"MD2Z") "R#7":'  '
         PLINE1 = PLINE1:OCONV(JRS.E.R.QTY<1,2>,"MD2") "R#6":' ':OCONV(JRS.E.R.QTY<1,1> + JRS.E.R.QTY<1,2>,"MD2Z") "R#8":'  '
*T28754         PLINE1=PLINE1:OCONV(JRS.R.QTY<1,1>,"MD2") "R#7":' ':OCONV(JRS.R.QTY<1,2>,"MD2") "R#6":' '
         PLINE1=PLINE1:OCONV(JRS.R.QTY<1,1>,"MD2") "R#8":' ':OCONV(JRS.R.QTY<1,2>,"MD2") "R#6":' '
*T28754         PLINE1=PLINE1:OCONV(JRS.R.QTY<1,3>,"MD2") "R#6":' ':OCONV(JRS.R.QTY<1,1>+JRS.R.QTY<1,2>+JRS.R.QTY<1,3>,"MD2Z") "R#7":'   '
         PLINE1=PLINE1:OCONV(JRS.R.QTY<1,3>,"MD2") "R#6":' ':OCONV(JRS.R.QTY<1,1>+JRS.R.QTY<1,2>+JRS.R.QTY<1,3>,"MD2Z") "R#8":'   '
         R.VAR=JRS.R.QTY<1,1>+JRS.R.QTY<1,2>+JRS.R.QTY<1,3>-JRS.E.R.QTY<1,1>-JRS.E.R.QTY<1,2>
         IF R.VAR = 0 THEN R.VAR =''
         PLINE1=PLINE1:OCONV(R.VAR,"MD2Z")"R#7":' ':OCONV(JRS.S.QTY<1,1>,"MD2") "R#6"
         P.LINE=P.LINE:PLINE1
         PRINT P.LINE
         LINE.CNT=LINE.CNT + 1
         IF JRS.C.QTY # "" OR JRS.E.C.QTY # "" OR JRS.S.QTY<1,2>  # "" THEN
            D.C.PRT=1
            P.LINE=''
            PLINE2=SPACE(49):' CO ':OCONV(JRS.C.DATE,"D2/") "R#8":' '
*T28754            PLINE2=PLINE2:OCONV(JRS.E.C.QTY<1,1>,"MD2") "R#7":' ':OCONV(JRS.E.C.QTY<1,2>,"MD2") "R#6":' '
            PLINE2=PLINE2:OCONV(JRS.E.C.QTY<1,1>,"MD2") "R#8":' ':OCONV(JRS.E.C.QTY<1,2>,"MD2") "R#6":' '
            PLINE2=PLINE2:OCONV(JRS.E.C.QTY<1,1> +JRS.E.C.QTY<1,2>,"MD2Z") "R#7":'  ':OCONV(JRS.C.QTY<1,1>,"MD2") "R#7":' '
            PLINE2=PLINE2:OCONV(JRS.C.QTY<1,2>,"MD2") "R#6":' ':OCONV(JRS.C.QTY<1,3>,"MD2") "R#6":' '
            PLINE2=PLINE2:OCONV(JRS.C.QTY<1,1>+JRS.C.QTY<1,2>+JRS.C.QTY<1,3>,"MD2Z") "R#7":' CO'
            C.VAR = JRS.C.QTY<1,1>+JRS.C.QTY<1,2>+JRS.C.QTY<1,3>-JRS.E.C.QTY<1,1>-JRS.E.C.QTY<1,2>
            PLINE2=PLINE2:OCONV(C.VAR,"MD2Z")"R#7":' ':OCONV(JRS.S.QTY<1,2>,"MD2") "R#6"
            P.LINE=PLINE2
            PRINT P.LINE
            LINE.CNT=LINE.CNT + 1
         END
      END ELSE
         IF JRS.C.QTY # "" OR JRS.E.C.QTY # "" OR JRS.S.QTY<1,2> # "" THEN
            D.C.PRT=1
            PLINE3=' CO ':OCONV(JRS.C.DATE,"D2/") "R#8":' '
            PLINE3=PLINE3:OCONV(JRS.E.C.QTY<1,1>,"MD2") "R#7":' ':OCONV(JRS.E.C.QTY<1,2>,"MD2") "R#6":' '
            PLINE3=PLINE3:OCONV(JRS.E.C.QTY<1,1> +JRS.E.C.QTY<1,2>,"MD2Z") "R#7":'  ':OCONV(JRS.C.QTY<1,1>,"MD2") "R#7":' '
            PLINE3=PLINE3:OCONV(JRS.C.QTY<1,2>,"MD2") "R#6":' ':OCONV(JRS.C.QTY<1,3>,"MD2") "R#6":' '
            PLINE3=PLINE3:OCONV(JRS.C.QTY<1,1>+JRS.C.QTY<1,2>+JRS.C.QTY<1,3>,"MD2") "R#7":' CO'
            C.VAR = JRS.C.QTY<1,1>+JRS.C.QTY<1,2>+JRS.C.QTY<1,3>-JRS.E.C.QTY<1,1>-JRS.E.C.QTY<1,2>
            PLINE3=PLINE3:OCONV(C.VAR,"MD2Z")"R#7":' ':OCONV(JRS.S.QTY<1,2>,"MD2") "R#6"
            P.LINE=P.LINE:PLINE3
            PRINT P.LINE
            LINE.CNT=LINE.CNT + 1
         END
      END
      IF JRS.DATE > DEPT.DATE THEN DEPT.DATE = JRS.DATE
      IF JRS.C.DATE > DEPT.C.DATE THEN DEPT.C.DATE = JRS.C.DATE
      DEPT.TOT(1)=DEPT.TOT(1) + JRS.E.R.QTY<1,1>
      DEPT.TOT(2)=DEPT.TOT(2) + JRS.E.R.QTY<1,2>
      DEPT.TOT(3)=DEPT.TOT(3) + JRS.E.R.QTY<1,1>+JRS.E.R.QTY<1,2>
      DEPT.TOT(4)=DEPT.TOT(4) + JRS.R.QTY<1,1>
      DEPT.TOT(5)=DEPT.TOT(5) + JRS.R.QTY<1,2>
      DEPT.TOT(6)=DEPT.TOT(6) + JRS.R.QTY<1,3>
      DEPT.TOT(7)=DEPT.TOT(7) + JRS.R.QTY<1,1>+JRS.R.QTY<1,2>+JRS.R.QTY<1,3>
      DEPT.TOT(8)=DEPT.TOT(8) + JRS.S.QTY<1,1>
      DEPT.TOT(9)=DEPT.TOT(9) + JRS.E.C.QTY<1,1>
      DEPT.TOT(10)=DEPT.TOT(10) + JRS.E.C.QTY<1,2>
      DEPT.TOT(11)=DEPT.TOT(11) + JRS.E.C.QTY<1,1>+JRS.E.C.QTY<1,2>
      DEPT.TOT(12)=DEPT.TOT(12) + JRS.C.QTY<1,1>
      DEPT.TOT(13)=DEPT.TOT(13) + JRS.C.QTY<1,2>
      DEPT.TOT(14)=DEPT.TOT(14) + JRS.C.QTY<1,3>
      DEPT.TOT(15)=DEPT.TOT(15) + JRS.C.QTY<1,1>+JRS.C.QTY<1,2>+JRS.C.QTY<1,3>
      DEPT.TOT(16)=DEPT.TOT(16) + JRS.S.QTY<1,2>
      IF LINE.CNT >= 50 THEN GOSUB 20
      RETURN
*
*---- PRINT DEPT TOTALS
*
2000*
      IF DEPT.DATE > GRND.DATE THEN GRND.DATE = DEPT.DATE
      IF DEPT.C.DATE > GRND.C.DATE THEN GRND.C.DATE = DEPT.C.DATE
      FOR L = 1 TO 16
         G.TOT(L)=G.TOT(L) + DEPT.TOT(L)
      NEXT L
      DEPT.TOT(17) = DEPT.TOT(7)-DEPT.TOT(3)
      IF DEPT.TOT(17) = 0 THEN DEPT.TOT(17) = ''
      DEPT.TOT(18) = DEPT.TOT(15)-DEPT.TOT(11)
      IF DEPT.TOT(17) = 0 THEN DEPT.TOT(17) = ''
      IF LINE.CNT >= 50 THEN GOSUB 20
      PRINT TLINE
      LINE.CNT = LINE.CNT + 1
      DEPT.PRT.DATE = DEPT.DATE
      DEPT.C.PRT.DATE = DEPT.C.DATE
      IF DEPT.C.PRT.DATE = 0 THEN DEPT.C.PRT.DATE = ''
      IF DEPT.PRT.DATE = 0 THEN DEPT.PRT.DATE = ''
      D.LINE='** ':DEPT.DESC:' DEPARTMENT TOTAL';D.LINE=D.LINE"L#40"
      IF D.PRT THEN
*T28754         DLINE1=SPACE(13):OCONV(DEPT.PRT.DATE,"D2/") "R#8":' ':OCONV(DEPT.TOT(1),"MD2") "R#7":' '
         DLINE1=SPACE(9):OCONV(DEPT.PRT.DATE,"D2/") "R#8":' ':OCONV(DEPT.TOT(1),"MD2") "R#8":' '
*T28754         DLINE1=DLINE1:OCONV(DEPT.TOT(2),"MD2") "R#6":' ':OCONV(DEPT.TOT(3),"MD2") "R#7":'  '
         DLINE1=DLINE1:OCONV(DEPT.TOT(2),"MD2") "R#6":' ':OCONV(DEPT.TOT(3),"MD2") "R#8":'  '
*T28754         DLINE1=DLINE1:OCONV(DEPT.TOT(4),"MD2") "R#7":' ':OCONV(DEPT.TOT(5),"MD2") "R#6":' '
         DLINE1=DLINE1:OCONV(DEPT.TOT(4),"MD2") "R#8":' ':OCONV(DEPT.TOT(5),"MD2") "R#6":' '
*T28754         DLINE1=DLINE1:OCONV(DEPT.TOT(6),"MD2") "R#6":' ':OCONV(DEPT.TOT(7),"MD2") "R#7":'   '
         DLINE1=DLINE1:OCONV(DEPT.TOT(6),"MD2") "R#6":' ':OCONV(DEPT.TOT(7),"MD2") "R#8":'   '
         DLINE1=DLINE1:OCONV(DEPT.TOT(17),"MD2")"R#7":' ':OCONV(DEPT.TOT(8),"MD2") "R#6"
         D.LINE=D.LINE:DLINE1
         PRINT D.LINE
         IF  D.C.PRT =0 THEN
            PRINT
            LINE.CNT=LINE.CNT + 2
         END ELSE
            GRAND.C = 1
            D.LINE=''
*T28754            DLINE2=SPACE(50):'CO ':OCONV(DEPT.PRT.DATE,"D2/") "R#8":' ':OCONV(DEPT.TOT(9),"MD2") "R#7":' '
            DLINE2=SPACE(46):'CO ':OCONV(DEPT.PRT.DATE,"D2/") "R#8":' ':OCONV(DEPT.TOT(9),"MD2") "R#8":' '
*T28754            DLINE2=DLINE2:OCONV(DEPT.TOT(10),"MD2") "R#6":' ':OCONV(DEPT.TOT(11),"MD2") "R#7":'  '
            DLINE2=DLINE2:OCONV(DEPT.TOT(10),"MD2") "R#6":' ':OCONV(DEPT.TOT(11),"MD2") "R#8":'  '
*T28754            DLINE2=DLINE2:OCONV(DEPT.TOT(12),"MD2") "R#7":' ':OCONV(DEPT.TOT(13),"MD2") "R#6":' '
            DLINE2=DLINE2:OCONV(DEPT.TOT(12),"MD2") "R#8":' ':OCONV(DEPT.TOT(13),"MD2") "R#6":' '
*T28754            DLINE2=DLINE2:OCONV(DEPT.TOT(14),"MD2") "R#6":' ':OCONV(DEPT.TOT(15),"MD2") "R#7":' CO'
            DLINE2=DLINE2:OCONV(DEPT.TOT(14),"MD2") "R#6":' ':OCONV(DEPT.TOT(15),"MD2") "R#8":' CO'
*T28754            DLINE2=DLINE2:OCONV(DEPT.TOT(18),"MD2")"R#7":' ':OCONV(DEPT.TOT(16),"MD2") "R#6"
            DLINE2=DLINE2:OCONV(DEPT.TOT(18),"MD2")"R#8":' ':OCONV(DEPT.TOT(16),"MD2") "R#6"
            D.LINE=DLINE2
            PRINT D.LINE;PRINT
            LINE.CNT=LINE.CNT + 3
         END
      END ELSE
         IF  D.C.PRT THEN
            GRAND.C=1
*T28754            DLINE3=SPACE(9):' CO ':OCONV(DEPT.PRT.DATE,"D2/") "R#8":' ':OCONV(DEPT.TOT(9),"MD2") "R#7"
            DLINE3=SPACE(9):' CO ':OCONV(DEPT.PRT.DATE,"D2/") "R#8":' ':OCONV(DEPT.TOT(9),"MD2") "R#8"
*T28754            DLINE3=DLINE3:' ':OCONV(DEPT.TOT(10),"MD2") "R#6":' ':OCONV(DEPT.TOT(11),"MD2") "R#7"
            DLINE3=DLINE3:' ':OCONV(DEPT.TOT(10),"MD2") "R#6":' ':OCONV(DEPT.TOT(11),"MD2") "R#8"
*T28754            DLINE3=DLINE3:'  ':OCONV(DEPT.TOT(12),"MD2") "R#7":' ':OCONV(DEPT.TOT(13),"MD2") "R#6"
            DLINE3=DLINE3:'  ':OCONV(DEPT.TOT(12),"MD2") "R#8":' ':OCONV(DEPT.TOT(13),"MD2") "R#6"
*T28754            DLINE3=DLINE3:' ':OCONV(DEPT.TOT(14),"MD2") "R#6":' ':OCONV(DEPT.TOT(15),"MD2") "R#7"
            DLINE3=DLINE3:' ':OCONV(DEPT.TOT(14),"MD2") "R#6":' ':OCONV(DEPT.TOT(15),"MD2") "R#8"
*T28754            DLINE3=DLINE3:' CO':OCONV(DEPT.TOT(18),"MD2")"R#7":' ':OCONV(DEPT.TOT(16),"MD2") "R#6"
            DLINE3=DLINE3:' CO':OCONV(DEPT.TOT(18),"MD2")"R#8":' ':OCONV(DEPT.TOT(16),"MD2") "R#6"
            D.LINE=D.LINE:DLINE3
            PRINT D.LINE;PRINT;LINE.CNT=LINE.CNT + 2
         END
      END
      DEPT.DATE = 0;D.PRT=0;D.C.PRT=0
      DEPT.C.DATE=0
      MAT DEPT.TOT = ''
      RETURN
99999*
      PRINTER OFF
      RETURN
   END
