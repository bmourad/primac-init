   SUBROUTINE JOB.MS.INQ.RPT(CONO,CO.NAME,JOB.NUM,SUB.CNT,HD1,HD2)
*COPY>CPYLIB>COM1
*COPY>JCS.CPYLIB>COM.JCS.LINK
*COPY>ICS.CPYLIB>COM.INV.MAIN  
*COPY>ICS.CPYLIB>COM.INV.SERIAL
*COPY>JCS.CPYLIB>COM.INV.STATS 
*COPY>PMC.CPYLIB>COM.CUST
*COPY>OPS.CPYLIB>COM.ORDER
*COPY>JCS.CPYLIB>COM.JOB.INQ
*********************************************************************
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - JCSBP
* PROGRAM     - JOB.MS.INQ.RPT
* DATE        - 11/21/83
* DESCRIPTION -
*T26334 epitka 12/19/2001 * REV12
*T26493 cmykleb 04/03/2002 * Change pgm to use headings from calling pgm.
*ENDDOC
*********************************************************************
*COPY>JCS.CPYLIB>JOB
*COPY>JCS.CPYLIB>JOB.MISC
*COPY>JCS.CPYLIB>JOB.TOT.REC
*COPY>PMC.CPYLIB>COST.CNTR
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*
   DASHES = STR('-',80)
   PNO = 0
   LINE.COUNT = 99
   SP1 = SPACE(1)
*T26493 v
   HD3 = "JOB # : ":JOB.NUM"L#8":SPACE(46)
   HD3 = HD3 : "MISCELLANEOUS POSTED REPORT"
*T26493 ^
**** PRINT DETAIL LINES AND TOTALS
100 DEPT.CNT = COUNT(MS.DEPT.NO,VM) + (MS.DEPT.NO # '')
   FOR D = 1 TO DEPT.CNT
      DEPT.TOTALS = ''
      PTR.CNT = COUNT(MS.DEPT.PTR<1,D>,SVM)+(MS.DEPT.PTR<1,D> # '')
      DPNO = MS.DEPT.NO<1,D>
      FOR PT = 1 TO PTR.CNT
         CCTR.TOTALS = ''
         PTR.NO = MS.DEPT.PTR<1,D,PT>; CCNO = JOB.MS.CCTR<1,PTR.NO>
         MATREAD CCTR.REC FROM COST.CNTR, CONO:CCNO ELSE
            MAT CCTR.REC = '????????????'
         END
         LINES = JOB.MS.SEQ<1,PTR.NO,1>
         MS.ID = CONO:JOB.NUM:"!":DPNO:"!":CCNO:"!"
         FOR SE = 1 TO LINES
            MATREAD JMS.REC FROM JOB.MISC, MS.ID:SE ELSE GOTO 111
            GOSUB 1000
111      NEXT SE
         FOR K = 2 TO SUB.CNT
            OLN = LINES + 1; LINES = LINES + JOB.MS.SEQ<1,PTR.NO,K>
            MS.ID = CONO:JOB.SUBS<1,K-1>:"!":DPNO:"!":CCNO:"!"
            FOR SE = OLN TO LINES
               MATREAD JMS.REC FROM JOB.MISC, MS.ID:(SE-OLN+1) ELSE GOTO 112
               GOSUB 1000
112         NEXT SE
         NEXT K
         GOSUB 2000
      NEXT PT
      GOSUB 3000
   NEXT D
   GOTO 99999
**** PRINT DETAIL LINE
1000 IF LINE.COUNT > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   LINE = ''
   LINE = LINE : CCNO "L#4": SP1 : JMS.OPER "L#4":SP1
   LINE = LINE : JMS.SEQ "L#8":SP1
   LINE = LINE : OCONV(JMS.DATE , "D2/") "L#8": SP1
   LINE = LINE : JMS.MON<1,1> "R#6" :SP1
   LINE = LINE : JMS.REASON "L#20":SP1
   BEGIN CASE
      CASE JMS.TYPE = 'R'
         LINE = LINE :OCONV(JMS.COST, "MD2") "R#7":SPACE(9)
      CASE JMS.TYPE = 'N'
         LINE = LINE : SPACE(8):OCONV(JMS.COST, "MD2") "R#7":SP1
      CASE 1
         LINE = LINE :OCONV(JMS.COST, "MD2") "R#7":SPACE(9)
   END CASE
   LINE = LINE :OCONV(JMS.COST , "MD2") "R#10":SP1
   LINE = LINE : OCONV(JMS.SALE, "MD2") "R#10":SP1
   LINE = LINE : JMS.RC.JOB "L#8":SP1:JMS.RC.TRAN "L#8"
   PRINT LINE
   LINE.COUNT = LINE.COUNT + 1
   RETURN
**** PRINT TOTALS FOR CCTR
2000 IF LINE.COUNT + 2 > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   GOSUB 9000
   LINE = ''
   LINE = LINE : "** CCTR - ":CCNO "L#3":" ":CCTR.DESC "L#32":" **"
   LINE = LINE : SPACE(22)
   LINE = LINE : SP1:OCONV(JOB.MS.COST<1,PTR.NO>, "MD2") "R#10"
   LINE = LINE : SP1:OCONV(JOB.MS.SALE<1,PTR.NO>, "MD2") "R#10"
   PRINT LINE
   PRINT
   LINE.COUNT = LINE.COUNT + 2
   RETURN
**** PRINT TOTALS FOR DEPT
3000 IF LINE.COUNT + 2 > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   GOSUB 9100
   LINE = ''
   LINE = LINE : "** DEPT - ":DPNO "L#5":" ":MS.DEPT.DESC<1,D> "L#30":" **"
   LINE = LINE : SPACE(22)
   LINE = LINE :SP1:OCONV(MS.DEPT.COST<1,D>, "MD2") "R#10"
   LINE = LINE :SP1:OCONV(MS.DEPT.SALE<1,D>, "MD2") "R#10"
   PRINT LINE
   PRINT
   LINE.COUNT = LINE.COUNT + 2
   RETURN
**** UNDER LINE FOR TOTALS
9000 IF LINE.COUNT > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   LINE = ''
   LINE = SPACE(72):'---------- ----------'
   PRINT LINE
   LINE.COUNT = LINE.COUNT + 1
   RETURN
**** UNDER LINE FOR TOTALS
9100 IF LINE.COUNT > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   LINE = ''
   LINE = SPACE(72):'========== =========='
   PRINT LINE
   LINE.COUNT = LINE.COUNT + 1
   RETURN
**** PRINT HEADING
9999 PRINT CHAR(12)
   PNO = PNO + 1
*T26943 v
*  LINE = SPACE(2) : 'DATE - ' : OCONV(DATE(),"D2/") "L#8"
*  LINE = LINE : SPACE(5) : 'TIME - ' : OCONV(TIME(),"MTS") "L#8"
*  LINE = LINE : SPACE(22) : CO.NAME "L#30"
*  LINE = LINE : SPACE(15) : 'PAGE - ' : PNO "R#3"
*  PRINT LINE
*  PRINT SPACE(52) :'M I S C   P O S T E D   R E P O R T'
*  PRINT SPACE(52) :'       FOR JOB : ':JOB.NUM 'L#8'
*  PRINT SPACE(52) :DASHES[1,35]
   PRINT HD1:PNO"R#3"
   PRINT HD2
   PRINT HD3
*T26493 ^
   PRINT
   LINE = 'CCTR OPER TRANS  # MIS DATE PERIOD        REASON        REGULAR NO CHRG TOTAL COST TOTAL SALE RCLS JOB RCL TRAN'
   PRINT LINE
   LINE = '---- ---- -------- -------- ------ -------------------- ------- ------- ---------- ---------- -------- --------'
   PRINT LINE
   PRINT
   LINE.COUNT = LINE.COUNT + 7
   RETURN
**** PRINT TOTALS FOR DEPT
99999 IF LINE.COUNT + 2 > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   GOSUB 9100
   LINE = ''
   LINE = LINE : "** TOTAL FOR ALL MISC DEPARTMENTS              **"
   LINE = LINE : SPACE(22)
   LINE = LINE :SP1:OCONV(MS.TOT.COST, "MD2") "R#10"
   LINE = LINE :SP1:OCONV(MS.TOT.SALE, "MD2") "R#10"
   PRINT LINE
   RETURN
END
