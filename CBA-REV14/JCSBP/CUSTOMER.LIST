*********************************************************************
* REVISION    - [08.0]
* SYSTEM      - PRIMAC
* SOURCE      - JCSBP
* PROGRAM     - CUSTOMER.LIST
* BY          - NATALIE BLAKE, C.B.A
* DATE        - 01/09/89
* DESCRIPTION - Creates a customer listing
*T26493 cmykleb 03/22/2002 * Change report to use rpt # from proc.
*********************************************************************
*COPY>PMC.CPYLIB>CUSTOMER
*COPY>CPYLIB>CHAR
*
*---OPEN FILES
*
   OPEN "","CUSTOMER" TO CUSTOMER ELSE ERRMSG = "CUSTOMER FILE IS MISSING"; GOTO 93000
*
*
*---- PERFORM PROCREAD
*
   PROCREAD BUFFER ELSE ERRMSG = "MUST RUN FROM A PROC"; GOSUB 93000; GOTO 99999
   CONO = BUFFER<1>
*T26493 v
*     CONO.NAME = BUFFER<2>
*     REPORT.NAME = "CUSTOMER   LISTING"
*     REPORT.NUMBER = "XXXX"
   CONO.NAME = ""
   REPORT.NAME = ""
   REPORT.NUMBER = BUFFER<2>
*T26493 ^
   REPORT.DATE = DATE()
   HD1 = "" ; HD2 = ""
*
*---- GET HEADING
*
   PRINTER ON
   CALL GET.PROG.HEAD(CONO,CONO.NAME,REPORT.NAME,REPORT.NUMBER,REPORT.DATE,HD1,HD2)
   H.LINE = " CUST         NAME AND ADDRESS        TYPE       CONTACT           PHONE     SLSM TX-JUR TX?     TX-NUM"
   UL1 =    "------ ------------------------------ ---- -------------------- ------------ ---- ------ --- ---------------"
   HEADING HD1:"'PL'":HD2:"'LL'":H.LINE:"'L'":UL1:"'L'"
*
*---MAIN PROCESSING
*
   MORE.DATA = 1
   LOOP
      READNEXT ID ELSE MORE.DATA = 0
   WHILE MORE.DATA DO
      MATREAD CUST.REC FROM CUSTOMER,ID ELSE GOTO 100
      PRINT ID[4,99] "L#6 ":
      PRINT CUST.NAME "L#30 ":
      PRINT CUST.TYPE "L#4 ":
      PRINT CUST.CONTACT<1,1> "L#20 ":
      PRINT CUST.PHONE "L#12 ":
      PRINT CUST.SALESMAN "L#4 ":
      PRINT CUST.TAX.JUR<1,1> "L#6 ":
      PRINT CUST.TAXABLE<1,1> "L#3 ":
      PRINT CUST.EXEMPT<1,1> "L#15"
      PRINT SPACE(7):CUST.ADDR1 "L#30"
      PRINT SPACE(7):CUST.ADDR2 "L#30"
      PRINT SPACE(7):CUST.ADDR3 "L#30"
      PRINT SPACE(7):CUST.ADDR4 "L#30"
      PRINT SPACE(7): CUST.ZIP "L#30"
      PRINT
100 *
   REPEAT
   GOTO 99999
93000 *
   PRINT @(0,23):CL:ERRMSG:
   INPUT REPLY:
99999 * PRINT @(-1)
   PRINTER OFF
   PRINTER CLOSE
END
