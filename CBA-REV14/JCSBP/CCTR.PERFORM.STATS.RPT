*COPY>CPYLIB>COM1
*
**********************************************
* REVISION    - [XX.X]
* Copyright 1995 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - JCSBP
* PROGRAM     - CCTR.PERFORM.STATS.RPT
* BY          - rick;CBA
* DATE        - 02/02/1999
* DESCRIPTION -
*
*T23179 rick 02/02/1999 * New report to simulate the cctr perf sum
*                         report but instead of using the PERF.STATS
*                         file use the JOB.TIME file. 	
*T26493 cmykleb 03/22/2002 * Change report to use rpt # from proc.
*T26800 lross 08/13/2002 * Rpt heading needs to be unique & page oflow
*                          prob.
*T26827 lross 08/27/2002 * Several differences vs Detail Report.
*ENDDOC
*********************************************************************
*
***** INSERT FILES EQUATES
*
*COPY>JCS.CPYLIB>PERF.STATS
*COPY>PMC.CPYLIB>EMPLOYEE
*COPY>CPYLIB>SYSCOM
*COPY>PMC.CPYLIB>COST.CNTR
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*COPY>JCS.CPYLIB>JOB.TIME
*
**** SETUP ERRMSG ROUTINE
*
     SYS.TYPE = 1
     CALL SYSCOM(MAT SYSCOM.REC)
*
***** OPEN FILES
*
     OPEN "JOB.TIME" TO JOB.TIME ELSE
       ERRMSG = "JOB.TIME FILE IS MISSING"
       GOTO 93000
     END
     OPEN '','EMPLOYEE' TO EMPLOYEE ELSE
       ERRMSG = 'EMPLOYEE FILE IS MISSING'
       GOTO 93000
     END
     OPEN '','COST.CNTR' TO COST.CNTR ELSE
       ERRMSG = 'COST.CNTR FILE IS MISSING'
       GOTO 93000
     END
*
**** READ PROC VALUES
*
     PROCREAD ID ELSE
       ERRMSG = 'CANNOT PERFORM PROCREAD'
       GOTO 93000
     END
     CONO          = ID<1>
*T26493 v
*    CONO.NAME     = ID<2>
*    REPORT.NAME   = "COST CNTR-DEPARTMENT PERFORMANCE SUMMARY"
*    REPORT.NUMBER = "XXXX"
     CONO.NAME = ""
     REPORT.NAME = ""
     REPORT.NUMBER = ID<2>
*T26493 ^
     REPORT.DATE   = DATE()
     THD1 = "";THD2 = ""
     CALL GET.PROG.HEAD(CONO,CONO.NAME,REPORT.NAME,REPORT.NUMBER,REPORT.DATE,THD1,THD2)
     ST.DATE  = ID<4>
     EN.DATE  = ID<5>
     ST.PER = ID<6>
     EN.PER = ID<7>
     STD.FLG = ID<8>
     FILE.FLG = ID<9>
     DIVISION = ID<10>
     ST.PER  = ST.PER[5,2]:'/':ST.PER[1,4]
     EN.PER  = EN.PER[5,2]:'/':EN.PER[1,4]
     XX = ICONV(ST.DATE,"D")
     ST.DATE = OCONV(XX,"D4/")
     XX = ICONV(EN.DATE,"D")
     EN.DATE = OCONV(XX,"D4/")
*
**** INITIALIZATION
*
     LINE.COUNT = 99
     PAGE.NO = 0
     PRT.FLG = 1
     DE = 1
     DI = 1
     UNDER.LINE1 = "-------------------------------------- "
     UNDER.LINE2 = "------- ------- ------ ------- ------- ------- ------- ------- ------- ------ ------- -------"
     UNDER.LINE3 = "======= ======= ====== ======= ======= ======= ======= ======= ======= ====== ======= ======="
     HD1 = "DEPARTMENT                            "
     HD2 = "   COST CENTER                        "
     HD3 = "DIVISION                              "
     HD4 = "   DEPARTMENT                         "
     HD5 = "                                      "
     MAT CCTR.REC = ""
*
***** TOTAL TABLE FOR COMP
*
     DIM TOT.COMP(15)
     EQU COMP.ACT.HRS     TO TOT.COMP(1)
     EQU COMP.STD.HRS     TO TOT.COMP(2)
     EQU COMP.CNC.HRS     TO TOT.COMP(3)
     EQU COMP.CHG.HRS     TO TOT.COMP(4)
     EQU COMP.N.C.HRS     TO TOT.COMP(5)
     EQU COMP.O.T.HRS     TO TOT.COMP(6)
     EQU COMP.D.T.HRS     TO TOT.COMP(7)
     EQU COMP.ACT.IMP     TO TOT.COMP(8)
     EQU COMP.STD.IMP     TO TOT.COMP(9)
     EQU COMP.ACT.IMP.HRS TO TOT.COMP(10)
     EQU COMP.OPER.CNT    TO TOT.COMP(11)
     MAT TOT.COMP = 0
*
***** TOTAL TABLE FOR DIV
*
     DIM TOT.DIV(15)
     EQU DIV.ACT.HRS     TO TOT.DIV(1)
     EQU DIV.STD.HRS     TO TOT.DIV(2)
     EQU DIV.CNC.HRS     TO TOT.DIV(3)
     EQU DIV.CHG.HRS     TO TOT.DIV(4)
     EQU DIV.N.C.HRS     TO TOT.DIV(5)
     EQU DIV.O.T.HRS     TO TOT.DIV(6)
     EQU DIV.D.T.HRS     TO TOT.DIV(7)
     EQU DIV.ACT.IMP     TO TOT.DIV(8)
     EQU DIV.STD.IMP     TO TOT.DIV(9)
     EQU DIV.ACT.IMP.HRS TO TOT.DIV(10)
     EQU DIV.NO          TO TOT.DIV(11)
     EQU DIV.OPER.CNT    TO TOT.DIV(12)
     MAT TOT.DIV = 0
*
***** TOTAL TABLE FOR DEPT
*
     DIM TOT.DEP(15)
     EQU DEP.ACT.HRS     TO TOT.DEP(1)
     EQU DEP.STD.HRS     TO TOT.DEP(2)
     EQU DEP.CNC.HRS     TO TOT.DEP(3)
     EQU DEP.CHG.HRS     TO TOT.DEP(4)
     EQU DEP.N.C.HRS     TO TOT.DEP(5)
     EQU DEP.O.T.HRS     TO TOT.DEP(6)
     EQU DEP.D.T.HRS     TO TOT.DEP(7)
     EQU DEP.ACT.IMP     TO TOT.DEP(8)
     EQU DEP.STD.IMP     TO TOT.DEP(9)
     EQU DEP.ACT.IMP.HRS TO TOT.DEP(10)
     EQU DEP.NO          TO TOT.DEP(11)
     EQU DEP.OPER.CNT    TO TOT.DEP(12)
     MAT TOT.DEP = 0
*
***** TOTAL TABLE FOR CCTR
*
     DIM TOT.CCTR(15)
     EQU CCTR.ACT.HRS     TO TOT.CCTR(1)
     EQU CCTR.STD.HRS     TO TOT.CCTR(2)
     EQU CCTR.CNC.HRS     TO TOT.CCTR(3)
     EQU CCTR.CHG.HRS     TO TOT.CCTR(4)
     EQU CCTR.N.C.HRS     TO TOT.CCTR(5)
     EQU CCTR.O.T.HRS     TO TOT.CCTR(6)
     EQU CCTR.D.T.HRS     TO TOT.CCTR(7)
     EQU CCTR.ACT.IMP     TO TOT.CCTR(8)
     EQU CCTR.STD.IMP     TO TOT.CCTR(9)
     EQU CCTR.ACT.IMP.HRS TO TOT.CCTR(10)
     EQU CCTR.OPER.CNT    TO TOT.CCTR(11)
     MAT TOT.CCTR = 0
*
***** READ AND PROCESS FIRST RECORD
*
     PRINTER ON
100* 
     READNEXT KEY ELSE GOTO 99999
     MATREAD JLB.REC FROM JOB.TIME,KEY ELSE GOTO 100
     JOBNO = KEY[4,99]
     JOBNO = FIELD(JOBNO,"!",1)
     DIV = JLB.DIV
     DEPT = FIELD(KEY,"!",2)
     CCTR = FIELD(KEY,"!",3)
     OPER = JLB.OPER
     MATREAD CCTR.REC FROM COST.CNTR,CONO:CCTR ELSE
       GOTO 100
     END
     LOCATE OPER IN CCTR.OPER<1>,1 SETTING SI ELSE
       GOTO 100
     END
*     IF CCTR.OPER.TYPE<1,SI> = 'U' THEN
*       IF CCTR.OPER.STD.HRS<1,SI> + 0 = 0 THEN
*         STD.IMP = CCTR.OPER.STD.IMP<1,SI>
*       END ELSE
*         STD.IMP = INT(100/CCTR.OPER.STD.HRS<1,SI>)
*       END
*     END ELSE
*       STD.IMP = CCTR.OPER.STD.IMP<1,SI>
*     END
     PREV.DIV = DIV
     PREV.DEPT = DEPT
     PREV.CCTR = CCTR
     CNT = 0
     GOSUB 1000
     IF DO.BAIL THEN GOTO 100
*
***** READ AND PROCESS ALL RECORDS
*
     DATA = 0
     LOOP
       READNEXT KEY ELSE DATA = 1
     WHILE DATA = 0 DO
       MATREAD JLB.REC FROM JOB.TIME,KEY ELSE GOTO 100
       JOBNO = KEY[4,99]
       JOBNO = FIELD(JOBNO,"!",1)
       DIV = JLB.DIV
       DEPT = FIELD(KEY,"!",2)
       CCTR = FIELD(KEY,"!",3)
       OPER = JLB.OPER
       STD.IMP = ""
       MATREAD CCTR.REC FROM COST.CNTR,CONO:CCTR ELSE
         GOTO 111
       END
       LOCATE OPER IN CCTR.OPER<1>,1 SETTING SI ELSE
         GOTO 111
       END
       GOSUB 400
       GOSUB 1000
111* 
     REPEAT
     GOSUB 4002
     GOSUB 4003
     GOSUB 4004
     GOSUB 4005
     GOTO 99999
*
**** FIND BREAK AND PRINT TOTALS
*
400* 
     IF PREV.DIV # DIV THEN
       GOSUB 4002
       GOSUB 4003
       GOSUB 4004
       PRINT
       LINE.COUNT = LINE.COUNT + 1
       PRT.FLG = 1
     END
     IF PREV.DEPT # DEPT THEN
       GOSUB 4002
       GOSUB 4003
       PRINT
       LINE.COUNT = LINE.COUNT + 1
       PRT.FLG = 1
     END
     IF PREV.CCTR # CCTR THEN
       GOSUB 4002
       PRT.FLG = 1
     END
     RETURN
*
**** ADD TOTAL FOR CCTR
*
1000*
     DO.BAIL = 0
     CNC.HRS = 0
     CNC.IMP = 0
*T26827 v
      STD.HRS = 0
      EFF.HRS = 0
      IMP.HRS = 0
      STD.IMP = 0
      EFF.IMP = 0
     IF NOT(NUM(JLB.CNCR)) THEN JLB.CNCR = 0
     IF STD.FLG = 'N' THEN
       IF FILE.FLG = 'C' THEN
         IF CCTR.OPER.STD.HRS<1,SI>+0 = 0 AND CCTR.OPER.STD.IMP<1,SI>+0 = 0 THEN GOTO 1099
       END ELSE
         IF JLB.HRS.STD+0 = 0 AND JLB.IMP.STD+0 = 0 THEN GOTO 1099
       END
     END
*T26827 ^
     IF JLB.CNCR+0 <> 0 THEN
*T24400 v
       IF JLB.CNCR = JLB.HRS AND JLB.RC.DESC = 'GANG ALLOC' THEN
         JLB.HRS = 0
         JLB.IMP = 0
         JLB.HRS.STD = 0
         JLB.IMP.STD = 0
         CCTR.OPER.STD.HRS<1,SI> = 0
         CCTR.OPER.STD.IMP<1,SI> = 0
       END
*T24400 ^
       CNC.HRS = JLB.CNCR
       IF JLB.CNCR = JLB.HRS THEN
         CNC.IMP = JLB.IMP
       END ELSE
         IF JLB.HRS+0 # 0 THEN
           PCT = JLB.CNCR / (JLB.HRS / 1000)
         END ELSE PCT = 1000
         CNC.IMP = INT((JLB.IMP / 1000) * PCT + .5)
       END
     END
** Below merged from lines 345-381.
     IF FILE.FLG = 'C' THEN
*       STD.IMP = CCTR.OPER.STD.IMP<1,SI> + 0
        IMP.STD = CCTR.OPER.STD.IMP<1,SI> + 0
        HRS.STD = CCTR.OPER.STD.HRS<1,SI> + 0
     END ELSE
*       STD.IMP = CCTR.OPER.STD.IMP<1,SI> + 0
        IMP.STD = CCTR.OPER.STD.IMP<1,SI> + 0
        HRS.STD = JLB.HRS.STD + 0
     END
*T18439 v From CCTR.PERFORM.RPT
      IF JLB.HRS + 0 = 0 THEN
        HRS.STD = 0
        IMP.STD = 0
      END
      IF JLB.HRS+0 >= 0 THEN SIGN = 1 ELSE SIGN = (-1)
      IF CCTR.OPER.TYPE<1,SI> = 'V' OR CCTR.OPER.TYPE<1,SI> = 'U' THEN
         IF JLB.HRS+0 # 0 THEN
            IMP.HRS = INT(JLB.IMP / JLB.HRS)
            IMP.HRS = IMP.HRS * SIGN
         END
      END
      IF FILE.FLG = "C" THEN
         BEGIN CASE
         CASE CCTR.OPER.TYPE<1,SI> = "U"
            BEGIN CASE
            CASE HRS.STD+0 # 0
*T24769 v
*               STD.HRS = INT(JLB.IMP * HRS.STD / 100)
               STD.HRS = INT(JLB.IMP * HRS.STD / 100)/100
*T24769 ^
               STD.IMP = INT(100 / HRS.STD)
            CASE IMP.STD+0 # 0
*T24769 v
*               STD.HRS = INT(JLB.IMP / IMP.STD)
               STD.HRS = INT(JLB.IMP / IMP.STD)/100
*T24769 ^
               STD.IMP = IMP.STD
            CASE 1
               STD.HRS = 0
               STD.IMP = 0
            END CASE
         CASE CCTR.OPER.TYPE<1,SI> = "V"
            IF IMP.STD+0 # 0 THEN
               STD.HRS = INT(JLB.IMP / IMP.STD)
               STD.IMP = IMP.STD
            END ELSE
               STD.HRS = 0
               STD.IMP = 0
            END
         CASE 1
            STD.HRS = HRS.STD + 0
            STD.IMP = 0
         END CASE
      END ELSE
         STD.HRS = HRS.STD + 0
         STD.IMP = IMP.STD + 0
      END
*T26827 ^
     CCTR.CNC.HRS = CCTR.CNC.HRS + CNC.HRS + 0
     N.C.HRS = 0;N.C.IMP = 0
     CHG.HRS = 0;CHG.IMP = 0
     O.T.HRS = 0;D.T.HRS = 0
*    STD.IMP = 0
*T26827 v CNCR does not mean NON-CHG per SC
*    IF JLB.CNCR + 0 = 0 THEN
       BEGIN CASE
         CASE JLB.TYPE = "N" OR JLB.TYPE = "S"
           N.C.HRS = JLB.HRS
           N.C.IMP = JLB.IMP
         CASE JLB.TYPE = "C"
           CHG.HRS = JLB.HRS
           CHG.IMP = JLB.IMP
         CASE 1
           CHG.HRS = JLB.HRS
           CHG.IMP = JLB.IMP
           JLB.TYPE = "R"
       END CASE
       BEGIN CASE
         CASE JLB.FCTR = "02"
           O.T.HRS = JLB.HRS
         CASE JLB.FCTR = "03"
           DT.HRS = JLB.HRS
       END CASE
*    END
*T26827 ^
*T26827 IF JLB.HRS.STD + JLB.IMP.STD <> 0 THEN
** Below performed after read - redundant.
*      LOCATE OPER IN CCTR.OPER<1>,1 SETTING SI ELSE
*        STD.IMP = 0
*        GOTO 1010
*      END
*T26827 ^
*       IF CCTR.OPER.TYPE<1,SI> = 'U' THEN
*         IF CCTR.OPER.STD.HRS<1,SI> + 0 = 0 THEN
*           STD.IMP = CCTR.OPER.STD.IMP<1,SI>
*         END ELSE
*           STD.IMP = INT(100/CCTR.OPER.STD.HRS<1,SI>)
*         END
*       END ELSE
*         STD.IMP = CCTR.OPER.STD.IMP<1,SI>
*       END
*T26827 v Moved to above ^
*      IF FILE.FLG = 'C' THEN
*        IF STD.FLG = 'N' THEN
*          IF CCTR.OPER.STD.HRS<1,SI>+0 = 0 AND CCTR.OPER.STD.IMP<1,SI>+0 = 0 THEN
*            DO.BAIL = 1
*            GOTO 1099
*          END
*        END
*        IF CCTR.OPER.TYPE<1,SI> = 'U' THEN
*          IF CCTR.OPER.STD.HRS<1,SI> + 0 = 0 THEN
*            STD.IMP = CCTR.OPER.STD.IMP<1,SI>
*          END ELSE
*            STD.IMP = INT(100/CCTR.OPER.STD.HRS<1,SI>)
*          END
*        END ELSE
*          STD.IMP = CCTR.OPER.STD.IMP<1,SI>
*        END
*        HRS.STD = CCTR.OPER.STD.HRS<1,SI> + 0
**        STD.IMP = CCTR.OPER.STD.IMP<1,SI> + 0
*      END ELSE
*        IF STD.FLG = 'N' THEN
*          IF JLB.HRS.STD+0 = 0 AND JLB.IMP.STD+0 = 0 THEN
*            GOTO 1099
*          END
*        END
*        IF CCTR.OPER.TYPE<1,SI> = 'U' THEN
*          IF CCTR.OPER.STD.HRS<1,SI> + 0 = 0 THEN
*            STD.IMP = CCTR.OPER.STD.IMP<1,SI>
*          END ELSE
*            STD.IMP = INT(100/CCTR.OPER.STD.HRS<1,SI>)
*          END
*        END ELSE
*          STD.IMP = CCTR.OPER.STD.IMP<1,SI>
*        END
*        HRS.STD = JLB.HRS.STD + 0
**        STD.IMP = CCTR.OPER.STD.IMP<1,SI> + 0
*      END
*T26827 ^
       CCTR.ACT.HRS = CCTR.ACT.HRS + JLB.HRS + 0
*      CCTR.STD.HRS = CCTR.STD.HRS + HRS.STD + 0
       CCTR.STD.HRS = CCTR.STD.HRS + STD.HRS + 0
       CCTR.ACT.IMP = CCTR.ACT.IMP + JLB.IMP + 0
*T26827 END
     CCTR.CHG.HRS = CCTR.CHG.HRS + CHG.HRS + 0
     CCTR.N.C.HRS = CCTR.N.C.HRS + N.C.HRS + 0
     CCTR.O.T.HRS = CCTR.O.T.HRS + O.T.HRS + 0
     CCTR.D.T.HRS = CCTR.D.T.HRS + D.T.HRS + 0
     IF CCTR.OPER.TYPE<1,SI> = "V" OR CCTR.OPER.TYPE<1,SI> = "U" THEN
       CCTR.OPER.CNT = CCTR.OPER.CNT + 1
     END
1010* 
     CCTR.STD.IMP = CCTR.STD.IMP + STD.IMP
*
     IF JLB.IMP+0 # 0 THEN
       CCTR.ACT.IMP.HRS = CCTR.ACT.IMP.HRS + JLB.HRS
     END
1099 *     
     RETURN
*
**** ADD TOTAL FOR DEPT
*
1001* 
     DEP.ACT.HRS<1,DI,DE> = DEP.ACT.HRS<1,DI,DE> + CCTR.ACT.HRS
     DEP.STD.HRS<1,DI,DE> = DEP.STD.HRS<1,DI,DE> + CCTR.STD.HRS
     DEP.CNC.HRS<1,DI,DE> = DEP.CNC.HRS<1,DI,DE> + CCTR.CNC.HRS
     DEP.CHG.HRS<1,DI,DE> = DEP.CHG.HRS<1,DI,DE> + CCTR.CHG.HRS
     DEP.N.C.HRS<1,DI,DE> = DEP.N.C.HRS<1,DI,DE> + CCTR.N.C.HRS
     DEP.O.T.HRS<1,DI,DE> = DEP.O.T.HRS<1,DI,DE> + CCTR.O.T.HRS
     DEP.D.T.HRS<1,DI,DE> = DEP.D.T.HRS<1,DI,DE> + CCTR.D.T.HRS
     DEP.ACT.IMP<1,DI,DE> = DEP.ACT.IMP<1,DI,DE> + CCTR.ACT.IMP
     DEP.STD.IMP<1,DI,DE> = DEP.STD.IMP<1,DI,DE> + CCTR.STD.IMP
     DEP.ACT.IMP.HRS<1,DI,DE> = DEP.ACT.IMP.HRS<1,DI,DE> + CCTR.ACT.IMP.HRS
     DEP.OPER.CNT<1,DI,DE> = DEP.OPER.CNT<1,DI,DE> + CCTR.OPER.CNT
     DEP.NO<1,DI,DE> = PREV.DEPT
     RETURN
*
**** ADD TOTAL FOR DIV
*
1002* 
     DIV.ACT.HRS<1,DI> = DIV.ACT.HRS<1,DI> + DEP.ACT.HRS<1,DI,DE>
     DIV.STD.HRS<1,DI> = DIV.STD.HRS<1,DI> + DEP.STD.HRS<1,DI,DE>
     DIV.CNC.HRS<1,DI> = DIV.CNC.HRS<1,DI> + DEP.CNC.HRS<1,DI,DE>
     DIV.CHG.HRS<1,DI> = DIV.CHG.HRS<1,DI> + DEP.CHG.HRS<1,DI,DE>
     DIV.N.C.HRS<1,DI> = DIV.N.C.HRS<1,DI> + DEP.N.C.HRS<1,DI,DE>
     DIV.O.T.HRS<1,DI> = DIV.O.T.HRS<1,DI> + DEP.O.T.HRS<1,DI,DE>
     DIV.D.T.HRS<1,DI> = DIV.D.T.HRS<1,DI> + DEP.D.T.HRS<1,DI,DE>
     DIV.ACT.IMP<1,DI> = DIV.ACT.IMP<1,DI> + DEP.ACT.IMP<1,DI,DE>
     DIV.STD.IMP<1,DI> = DIV.STD.IMP<1,DI> + DEP.STD.IMP<1,DI,DE>
     DIV.ACT.IMP.HRS<1,DI> = DIV.ACT.IMP.HRS<1,DI> + DEP.ACT.IMP.HRS<1,DI,DE>
     DIV.OPER.CNT<1,DI> = DIV.OPER.CNT<1,DI> + DEP.OPER.CNT<1,DI,DE>
     DIV.NO<1,DI> = PREV.DIV
     RETURN
*
**** ADD TOTAL FOR COMP
*
1003* 
     COMP.ACT.HRS = COMP.ACT.HRS + DIV.ACT.HRS<1,DI>
     COMP.STD.HRS = COMP.STD.HRS + DIV.STD.HRS<1,DI>
     COMP.CNC.HRS = COMP.CNC.HRS + DIV.CNC.HRS<1,DI>
     COMP.CHG.HRS = COMP.CHG.HRS + DIV.CHG.HRS<1,DI>
     COMP.N.C.HRS = COMP.N.C.HRS + DIV.N.C.HRS<1,DI>
     COMP.O.T.HRS = COMP.O.T.HRS + DIV.O.T.HRS<1,DI>
     COMP.D.T.HRS = COMP.D.T.HRS + DIV.D.T.HRS<1,DI>
     COMP.ACT.IMP = COMP.ACT.IMP + DIV.ACT.IMP<1,DI>
     COMP.STD.IMP = COMP.STD.IMP + DIV.STD.IMP<1,DI>
     COMP.ACT.IMP.HRS = COMP.ACT.IMP.HRS + DIV.ACT.IMP.HRS<1,DI>
     COMP.OPER.CNT = COMP.OPER.CNT + DIV.OPER.CNT<1,DI>
     RETURN
*
**** PRINT TOTAL FOR CCTR
*
4002* 
     GOSUB 1001
     CCTR.ACT.HRS = INT(CCTR.ACT.HRS / 10)
     CCTR.STD.HRS = INT(CCTR.STD.HRS / 10)
     CCTR.CNC.HRS = INT(CCTR.CNC.HRS / 10)
     CCTR.CHG.HRS = INT(CCTR.CHG.HRS / 10)
     CCTR.N.C.HRS = INT(CCTR.N.C.HRS / 10)
     CCTR.O.T.HRS = INT(CCTR.O.T.HRS / 10)
     CCTR.D.T.HRS = INT(CCTR.D.T.HRS / 10)
     IF LINE.COUNT > 55 THEN
       LINE.COUNT = 0
       DESC1 = HD1;DESC2 = HD2
       DESC3 = ""
       DEPT.PRT.FLG = 1
       GOSUB 9000
     END
     IF DEPT.PRT.FLG = 1 THEN
       DEPT.PRT.FLG = 0
       DEPT.KEY = CONO:PREV.DEPT
       DEPT.PRT.DESC = PREV.DEPT:"  ":OCONV(DEPT.KEY,"TDEPARTMENT;X;2;2")
       DS.LINE = ""
       DS.LINE = DEPT.PRT.DESC
       PRINT DS.LINE
       PRINT
       LINE.COUNT = LINE.COUNT + 2
     END
     CCTR.KEY = CONO:PREV.CCTR
     CCTR.PRT.DESC = "   ": PREV.CCTR:"  ":OCONV(CCTR.KEY,"TCOST.CNTR;X;1;1")
     CC.LINE = ''
     CC.LINE = CC.LINE :CCTR.PRT.DESC "L#38":" "
     CC.LINE = CC.LINE :OCONV(CCTR.ACT.HRS, "MD1") "R#7":' '
     CC.LINE = CC.LINE :OCONV(CCTR.STD.HRS, "MD1") "R#7":' '
     IF CCTR.STD.HRS+0 # 0 AND CCTR.ACT.HRS+0 # 0 THEN
       CCTR.EFF.HRS = INT(CCTR.STD.HRS  / CCTR.ACT.HRS * 1000)
     END ELSE
       CCTR.EFF.HRS = 0
     END
     CC.LINE = CC.LINE :OCONV(CCTR.EFF.HRS, "MD1") "R#6":' '
     CC.LINE = CC.LINE :OCONV(CCTR.CNC.HRS, "MD1") "R#7":' '
     IF CCTR.ACT.IMP.HRS+0 = 0 THEN
       IMP.HR = 0
     END ELSE
       IMP.HR = INT(CCTR.ACT.IMP / CCTR.ACT.IMP.HRS)
     END
     CC.LINE = CC.LINE :OCONV(IMP.HR, "MD0") "R#7":' '
*     IF CCTR.ACT.IMP.HRS+0 = 0 THEN
*        IMP.HR = 0
*     END ELSE
*        IMP.HR = INT(CCTR.STD.IMP/CCTR.ACT.IMP.HRS+0.5)
*     END
     IF CCTR.OPER.CNT+0 = 0 THEN
       IMP.HR = INT(CCTR.STD.IMP / 1)
     END ELSE
       IMP.HR = INT(CCTR.STD.IMP / CCTR.OPER.CNT)
     END
     CC.LINE = CC.LINE :OCONV(IMP.HR, "MD0") "R#7":' '
     CC.LINE = CC.LINE :OCONV(CCTR.CHG.HRS, "MD1") "R#7":' '
     CC.LINE = CC.LINE :OCONV(CCTR.N.C.HRS, "MD1") "R#7":' '
     CCTR.TOT.HRS = CCTR.CHG.HRS + CCTR.N.C.HRS
     CC.LINE = CC.LINE :OCONV(CCTR.TOT.HRS, "MD1") "R#7":' '
     IF CCTR.CHG.HRS+0 # 0 AND CCTR.TOT.HRS+0 # 0 THEN
       CCTR.CHG.PER = INT(CCTR.CHG.HRS / CCTR.TOT.HRS * 1000)
     END ELSE
       CCTR.CHG.PER = 0
     END
     CC.LINE = CC.LINE :OCONV(CCTR.CHG.PER, "MD1") "R#6":' '
     CC.LINE = CC.LINE :OCONV(CCTR.O.T.HRS, "MD1") "R#7":' '
*T26800 CC.LINE = CC.LINE :OCONV(CCTR.D.T.HRS, "MD1") "R#7":' '
     CC.LINE = CC.LINE :OCONV(CCTR.D.T.HRS, "MD1") "R#7"
     PRINT CC.LINE
     LINE.COUNT = LINE.COUNT + 1
     PREV.CCTR = CCTR
*    GOSUB 1001
     MAT TOT.CCTR = ''
     RETURN
*
**** PRINT TOTAL FOR DEPT
*
4003* 
*     IF LINE.COUNT > 55 THEN
*        LINE.COUNT = 0
*        DESC1 = HD1;DESC2 = HD2
*        DESC3 = ""
*        GOSUB 9000
*     END
      GOSUB 1002
     U.LINE = ''
     U.LINE = SPACE(39):UNDER.LINE2
     DEP.ACT.HRS<1,DI,DE> = INT(DEP.ACT.HRS<1,DI,DE> / 10)
     DEP.STD.HRS<1,DI,DE> = INT(DEP.STD.HRS<1,DI,DE> / 10)
     DEP.CNC.HRS<1,DI,DE> = INT(DEP.CNC.HRS<1,DI,DE> / 10)
     DEP.CHG.HRS<1,DI,DE> = INT(DEP.CHG.HRS<1,DI,DE> / 10)
     DEP.N.C.HRS<1,DI,DE> = INT(DEP.N.C.HRS<1,DI,DE> / 10)
     DEP.O.T.HRS<1,DI,DE> = INT(DEP.O.T.HRS<1,DI,DE> / 10)
     DEP.D.T.HRS<1,DI,DE> = INT(DEP.D.T.HRS<1,DI,DE> / 10)
     PRINT U.LINE
*     DEPT.KEY = CONO:PREV.DEPT
*     DEPT.PRT.DESC = PREV.DEPT:"  ":OCONV(DEPT.KEY,"TDEPARTMENT;X;1;1")
     DEPT.PRT.DESC = "DEPARTMENT TOTAL"
     DE.LINE = ''
     DE.LINE = DE.LINE :DEPT.PRT.DESC "R#38":" "
     DE.LINE = DE.LINE :OCONV(DEP.ACT.HRS<1,DI,DE>, "MD1") "R#7":' '
     DE.LINE = DE.LINE :OCONV(DEP.STD.HRS<1,DI,DE>, "MD1") "R#7":' '
     IF DEP.STD.HRS<1,DI,DE>+0 # 0 AND DEP.ACT.HRS<1,DI,DE>+0 # 0 THEN
       DEP.EFF.HRS = INT(DEP.STD.HRS<1,DI,DE> / DEP.ACT.HRS<1,DI,DE> * 1000)
     END ELSE
       DEP.EFF.HRS = 0
     END
     DE.LINE = DE.LINE :OCONV(DEP.EFF.HRS, "MD1") "R#6":' '
     DE.LINE = DE.LINE :OCONV(DEP.CNC.HRS<1,DI,DE>, "MD1") "R#7":' '
     IF DEP.ACT.IMP.HRS<1,DI,DE>+0 = 0 THEN
       IMP.HR = 0
     END ELSE
       IMP.HR = INT(DEP.ACT.IMP<1,DI,DE>/DEP.ACT.IMP.HRS<1,DI,DE>)
     END
     DE.LINE = DE.LINE :OCONV(IMP.HR, "MD0") "R#7":' '
*     IF DEP.ACT.IMP.HRS<1,DI,DE>+0 = 0 THEN
*        IMP.HR = 0
*     END ELSE
*        IMP.HR = INT(DEP.STD.IMP<1,DI,DE>/DEP.ACT.IMP.HRS<1,DI,DE>+0.5)
*     END
     IF DEP.OPER.CNT<1,DI,DE>+0 = 0 THEN
       IMP.HR = INT(DEP.STD.IMP<1,DI,DE>/1)
     END ELSE
       IMP.HR = INT(DEP.STD.IMP<1,DI,DE>/DEP.OPER.CNT<1,DI,DE>)
     END
     DE.LINE = DE.LINE :OCONV(IMP.HR, "MD0") "R#7":' '
     DE.LINE = DE.LINE :OCONV(DEP.CHG.HRS<1,DI,DE>, "MD1") "R#7":' '
     DE.LINE = DE.LINE :OCONV(DEP.N.C.HRS<1,DI,DE>, "MD1") "R#7":' '
     DEP.TOT.HRS = DEP.CHG.HRS<1,DI,DE> + DEP.N.C.HRS<1,DI,DE>
     DE.LINE = DE.LINE :OCONV(DEP.TOT.HRS, "MD1") "R#7":' '
     IF DEP.CHG.HRS<1,DI,DE>+0 # 0 AND DEP.TOT.HRS+0 # 0 THEN
       DEP.CHG.PER = INT(DEP.CHG.HRS<1,DI,DE> / DEP.TOT.HRS * 1000)
     END ELSE
       DEP.CHG.PER = 0
     END
     DE.LINE = DE.LINE :OCONV(DEP.CHG.PER, "MD1") "R#6":' '
     DE.LINE = DE.LINE :OCONV(DEP.O.T.HRS<1,DI,DE>, "MD1") "R#7":' '
*T26800 DE.LINE = DE.LINE :OCONV(DEP.D.T.HRS<1,DI,DE>, "MD1") "R#7":' '
     DE.LINE = DE.LINE :OCONV(DEP.D.T.HRS<1,DI,DE>, "MD1") "R#7"
     PRINT DE.LINE
     PRINT
     LINE.COUNT = LINE.COUNT + 3
*    GOSUB 1002
     PREV.DEPT = DEPT
     DEPT.PRT.FLG = 1
     DE = DE + 1
     RETURN
*
**** PRINT TOTAL FOR ALL DEPT'S
*
4004* 
     GOSUB 1003
     DEP.CNT = COUNT(DEP.NO<1,DI>, SVM) + (DEP.NO # "")
     LINE.COUNT = 99
     FOR DX = 1 TO DEP.CNT
       IF LINE.COUNT > 55 THEN
         LINE.COUNT = 0
         DESC1 = HD3;DESC2 = HD4
         DESC3 = "   DIVISION SUMMARY    "
         GOSUB 9000
         DIV.PRT.FLG = 1
       END
       IF DIV.PRT.FLG = 1 THEN
         DIV.PRT.FLG = 0
         DIV.KEY = CONO:PREV.DIV
         DIV.PRT.DESC = DIV.NO<1,DI>:"  ":OCONV(DIV.KEY,"TDIVISION;X;1;1")
         DS.LINE = ""
         DS.LINE = DIV.PRT.DESC
         PRINT DS.LINE
         PRINT
         LINE.COUNT = LINE.COUNT + 2
       END
       DEPT.KEY = CONO:DEP.NO<1,DI,DX>
       DEPT.PRT.DESC = "   ":DEP.NO<1,DI,DX>:"  ":OCONV(DEPT.KEY,"TDEPARTMENT;X;2;2")
       DE.LINE = ''
       DE.LINE = DE.LINE :DEPT.PRT.DESC "L#38":" "
       DE.LINE = DE.LINE :OCONV(DEP.ACT.HRS<1,DI,DX>, "MD1") "R#7":' '
       DE.LINE = DE.LINE :OCONV(DEP.STD.HRS<1,DI,DX>, "MD1") "R#7":' '
       IF DEP.STD.HRS<1,DI,DX>+0 # 0 AND DEP.ACT.HRS<1,DI,DX>+0 # 0 THEN
         DEP.EFF.HRS = INT(DEP.STD.HRS<1,DI,DX>/DEP.ACT.HRS<1,DI,DX>*1000)
       END ELSE
         DEP.EFF.HRS = 0
       END
       DE.LINE = DE.LINE :OCONV(DEP.EFF.HRS, "MD1") "R#6":' '
       DE.LINE = DE.LINE :OCONV(DEP.CNC.HRS<1,DI,DX>, "MD1") "R#7":' '
       IF DEP.ACT.IMP.HRS<1,DI,DX>+0 = 0 THEN
         IMP.HR = 0
       END ELSE
         IMP.HR = INT(DEP.ACT.IMP<1,DI,DX>/DEP.ACT.IMP.HRS<1,DI,DX>)
       END
       DE.LINE = DE.LINE :OCONV(IMP.HR, "MD0") "R#7":' '
*        IF DEP.ACT.IMP.HRS<1,DI,DX>+0 = 0 THEN
*           IMP.HR = 0
*        END ELSE
*           IMP.HR = INT(DEP.STD.IMP<1,DI,DX>/DEP.ACT.IMP.HRS<1,DI,DX>+0.5)
*        END
       IF DEP.OPER.CNT<1,DI,DX> + 0 = 0 THEN DEP.OPER.CNT<1,DI,DX> = 1
       IMP.HR = INT(DEP.STD.IMP<1,DI,DX>/DEP.OPER.CNT<1,DI,DX>)
       DE.LINE = DE.LINE :OCONV(IMP.HR, "MD0") "R#7":' '
       DE.LINE = DE.LINE :OCONV(DEP.CHG.HRS<1,DI,DX>, "MD1") "R#7":' '
       DE.LINE = DE.LINE :OCONV(DEP.N.C.HRS<1,DI,DX>, "MD1") "R#7":' '
       DEP.TOT.HRS = DEP.CHG.HRS<1,DI,DX> + DEP.N.C.HRS<1,DI,DX>
       DE.LINE = DE.LINE :OCONV(DEP.TOT.HRS, "MD1") "R#7":' '
       IF DEP.CHG.HRS<1,DI,DX>+0 # 0 AND DEP.TOT.HRS+0 # 0 THEN
         DEP.CHG.PER = INT(DEP.CHG.HRS<1,DI,DX>/DEP.TOT.HRS * 1000)
       END ELSE
         DEP.CHG.PER = 0
       END
       DE.LINE = DE.LINE :OCONV(DEP.CHG.PER, "MD1") "R#6":' '
       DE.LINE = DE.LINE :OCONV(DEP.O.T.HRS<1,DI,DX>, "MD1") "R#7":' '
*T26800 DE.LINE = DE.LINE :OCONV(DEP.D.T.HRS<1,DI,DX>, "MD1") "R#7":' '
       DE.LINE = DE.LINE :OCONV(DEP.D.T.HRS<1,DI,DX>, "MD1") "R#7"
       PRINT DE.LINE
       PRINT
       LINE.COUNT = LINE.COUNT + 2
     NEXT DX
*
**** PRINT DIV TOTAL LINE
*
*     IF LINE.COUNT > 55 THEN
*       LINE.COUNT = 0
*       GOSUB 9000
*     END
     U.LINE = ""
     U.LINE = U.LINE :SPACE(39)
     U.LINE = U.LINE :UNDER.LINE3
     PRINT U.LINE
     DIV.ACT.HRS<1,DI> = INT(DIV.ACT.HRS<1,DI> / 10)
     DIV.STD.HRS<1,DI> = INT(DIV.STD.HRS<1,DI> / 10)
     DIV.CNC.HRS<1,DI> = INT(DIV.CNC.HRS<1,DI> / 10)
     DIV.CHG.HRS<1,DI> = INT(DIV.CHG.HRS<1,DI> / 10)
     DIV.N.C.HRS<1,DI> = INT(DIV.N.C.HRS<1,DI> / 10)
     DIV.O.T.HRS<1,DI> = INT(DIV.O.T.HRS<1,DI> / 10)
     DIV.D.T.HRS<1,DI> = INT(DIV.D.T.HRS<1,DI> / 10)
*     DIV.KEY = CONO:DIV.NO<1,DI>
*     DIV.PRT.DESC = DIV.NO<1,DI>:"  ":OCONV(DIV.KEY,"TDIVISION;X;1;1")
     DIV.PRT.DESC = "DIVISION TOTAL"
     DV.LINE = ''
     DV.LINE = DV.LINE :DIV.PRT.DESC "R#38":" "
     DV.LINE = DV.LINE :OCONV(DIV.ACT.HRS<1,DI>, "MD1") "R#7":' '
     DV.LINE = DV.LINE :OCONV(DIV.STD.HRS<1,DI>, "MD1") "R#7":' '
     IF DIV.STD.HRS<1,DI>+0 # 0 AND DIV.ACT.HRS<1,DI>+0 # 0 THEN
       DIV.EFF.HRS = INT(DIV.STD.HRS<1,DI>/DIV.ACT.HRS<1,DI>*1000)
     END ELSE
       DIV.EFF.HRS = 0
     END
     DV.LINE = DV.LINE :OCONV(DIV.EFF.HRS , "MD1") "R#6":' '
     DV.LINE = DV.LINE :OCONV(DIV.CNC.HRS<1,DI>, "MD1") "R#7":' '
     IF DIV.ACT.IMP.HRS<1,DI>+0 = 0 THEN
       IMP.HR = 0
     END ELSE
       IMP.HR = INT(DIV.ACT.IMP<1,DI>/DIV.ACT.IMP.HRS<1,DI>)
     END
     DV.LINE = DV.LINE :OCONV(IMP.HR, "MD0") "R#7":' '
*     IF DIV.ACT.IMP.HRS<1,DI>+0 = 0 THEN
*        IMP.HR = 0
*     END ELSE
*        IMP.HR = INT(DIV.STD.IMP<1,DI>/DIV.ACT.IMP.HRS<1,DI>+0.5)
*     END
     IF DIV.OPER.CNT<1,DI> + 0 = 0 THEN DIV.OPER.CNT<1,DI> = 1
     IMP.HR = INT(DIV.STD.IMP<1,DI>/DIV.OPER.CNT<1,DI>)
     DV.LINE = DV.LINE :OCONV(IMP.HR, "MD0") "R#7":' '
     DV.LINE = DV.LINE :OCONV(DIV.CHG.HRS<1,DI>, "MD1") "R#7":' '
     DV.LINE = DV.LINE :OCONV(DIV.N.C.HRS<1,DI>, "MD1") "R#7":' '
     DIV.TOT.HRS = DIV.CHG.HRS<1,DI> + DIV.N.C.HRS<1,DI>
     DV.LINE = DV.LINE :OCONV(DIV.TOT.HRS, "MD1") "R#7":' '
     IF DIV.CHG.HRS<1,DI>+0 # 0 AND DIV.TOT.HRS+0 # 0 THEN
       DIV.CHG.PER = INT(DIV.CHG.HRS<1,DI>/DIV.TOT.HRS*1000)
     END ELSE
       DIV.CHG.PER = 0
     END
     DV.LINE = DV.LINE : OCONV(DIV.CHG.PER, "MD1") "R#6":' '
     DV.LINE = DV.LINE :OCONV(DIV.O.T.HRS<1,DI>, "MD1") "R#7":' '
*T26800 DV.LINE = DV.LINE :OCONV(DIV.D.T.HRS<1,DI>, "MD1") "R#7":' '
     DV.LINE = DV.LINE :OCONV(DIV.D.T.HRS<1,DI>, "MD1") "R#7"
     PRINT DV.LINE
*    GOSUB 1003
     LINE.COUNT = 99
     PREV.DIV = DIV
     DI = DI + 1
     DE = 1
     RETURN
*
***** PRINT ALL DIV
*
4005* 
     DIV.CNT = COUNT(DIV.NO, VM) + (DIV.NO # "")
     LINE.COUNT = 99
     FOR DX = 1 TO DIV.CNT
       IF LINE.COUNT > 55 THEN
         LINE.COUNT = 0
         DESC1 = HD5;DESC2 = HD3
         DESC3 = "    COMPANY SUMMARY     "
         GOSUB 9000
       END
       DIV.KEY = CONO:DIV.NO<1,DX>
       DIV.PRT.DESC = DIV.NO<1,DX>:"  ":OCONV(DIV.KEY,"TDIVISION;X;1;1")
       DV.LINE = ''
       DV.LINE = DV.LINE :DIV.PRT.DESC "L#38":" "
       DV.LINE = DV.LINE :OCONV(DIV.ACT.HRS<1,DX>, "MD1") "R#7":' '
       DV.LINE = DV.LINE :OCONV(DIV.STD.HRS<1,DX>, "MD1") "R#7":' '
       IF DIV.STD.HRS<1,DX>+0 # 0 AND DIV.ACT.HRS<1,DX>+0 # 0 THEN
         DIV.EFF.HRS = INT(DIV.STD.HRS<1,DX>/DIV.ACT.HRS<1,DX>*1000)
       END ELSE
         DIV.EFF.HRS = 0
       END
       DV.LINE = DV.LINE :OCONV(DIV.EFF.HRS , "MD1") "R#6":' '
       DV.LINE = DV.LINE :OCONV(DIV.CNC.HRS<1,DX>, "MD1") "R#7":' '
       IF DIV.ACT.IMP.HRS<1,DX>+0 = 0 THEN
         IMP.HR = 0
       END ELSE
         IMP.HR = INT(DIV.ACT.IMP<1,DX>/DIV.ACT.IMP.HRS<1,DX>)
       END
       DV.LINE = DV.LINE :OCONV(IMP.HR, "MD0") "R#7":' '
*        IF DIV.ACT.IMP.HRS<1,DX>+0 = 0 THEN
*           IMP.HR = 0
*        END ELSE
*           IMP.HR = INT(DIV.STD.IMP<1,DX>/DIV.ACT.IMP.HRS<1,DX>+0.5)
*        END
       IF DIV.OPER.CNT<1,DX> + 0 = 0 THEN DIV.OPER.CNT<1,DX> = 1
       IMP.HR = INT(DIV.STD.IMP<1,DX>/DIV.OPER.CNT<1,DX>)
       DV.LINE = DV.LINE :OCONV(IMP.HR, "MD0") "R#7":' '
       DV.LINE = DV.LINE :OCONV(DIV.CHG.HRS<1,DX>, "MD1") "R#7":' '
       DV.LINE = DV.LINE :OCONV(DIV.N.C.HRS<1,DX>, "MD1") "R#7":' '
       DIV.TOT.HRS = DIV.CHG.HRS<1,DX> + DIV.N.C.HRS<1,DX>
       DV.LINE = DV.LINE :OCONV(DIV.TOT.HRS, "MD1") "R#7":' '
       IF DIV.CHG.HRS<1,DX>+0 # 0 AND DIV.TOT.HRS+0 # 0 THEN
         DIV.CHG.PER = INT(DIV.CHG.HRS<1,DX>/DIV.TOT.HRS*1000)
       END ELSE
         DIV.CHG.PER = 0
       END
       DV.LINE = DV.LINE : OCONV(DIV.CHG.PER, "MD1") "R#6":' '
       DV.LINE = DV.LINE :OCONV(DIV.O.T.HRS<1,DX>, "MD1") "R#7":' '
*T26800 DV.LINE = DV.LINE :OCONV(DIV.D.T.HRS<1,DX>, "MD1") "R#7":' '
       DV.LINE = DV.LINE :OCONV(DIV.D.T.HRS<1,DX>, "MD1") "R#7"
       PRINT DV.LINE
       PRINT
       LINE.COUNT = LINE.COUNT + 2
     NEXT DX
*
**** PRINT COMPANY TOTAL
*
*     IF LINE.COUNT > 55 THEN
*       LINE.COUNT = 0
*       DESC1 = HD5;DESC2 = HD3
*       DESC3 = "    COMPANY SUMMARY     "
*       GOSUB 9000
*     END
     U.LINE = ""
     U.LINE = U.LINE :SPACE(39)
     U.LINE = U.LINE :UNDER.LINE3
     PRINT U.LINE
     COMP.ACT.HRS = INT(COMP.ACT.HRS / 10)
     COMP.STD.HRS = INT(COMP.STD.HRS / 10)
     COMP.CNC.HRS = INT(COMP.CNC.HRS / 10)
     COMP.CHG.HRS = INT(COMP.CHG.HRS / 10)
     COMP.N.C.HRS = INT(COMP.N.C.HRS / 10)
     COMP.O.T.HRS = INT(COMP.O.T.HRS / 10)
     COMP.D.T.HRS = INT(COMP.D.T.HRS / 10)
     COMP.PRT.DESC = "COMPANY TOTAL"
     CO.LINE = ''
     CO.LINE = CO.LINE :COMP.PRT.DESC "R#38":" "
     CO.LINE = CO.LINE :OCONV(COMP.ACT.HRS, "MD1") "R#7":' '
     CO.LINE = CO.LINE :OCONV(COMP.STD.HRS, "MD1") "R#7":' '
     IF COMP.STD.HRS+0 # 0 AND COMP.ACT.HRS+0 # 0 THEN
       COMP.EFF.HRS = INT(COMP.STD.HRS/COMP.ACT.HRS*1000)
     END ELSE
       COMP.EFF.HRS = 0
     END
     CO.LINE = CO.LINE :OCONV(COMP.EFF.HRS, "MD1") "R#6":' '
     CO.LINE = CO.LINE :OCONV(COMP.CNC.HRS, "MD1") "R#7":' '
     IF COMP.ACT.IMP.HRS+0 = 0 THEN
       IMP.HR = 0
     END ELSE
       IMP.HR = INT(COMP.ACT.IMP/COMP.ACT.IMP.HRS)
     END
     CO.LINE = CO.LINE :OCONV(IMP.HR, "MD0") "R#7":' '
*     IF COMP.ACT.IMP.HRS+0 = 0 THEN
*        IMP.HR = 0
*     END ELSE
*        IMP.HR = INT(COMP.STD.IMP/COMP.ACT.IMP.HRS+0.5)
*     END
     IF COMP.OPER.CNT + 0 = 0 THEN COMP.OPER.CNT = 1
     IMP.HR = INT(COMP.STD.IMP/COMP.OPER.CNT)
     CO.LINE = CO.LINE :OCONV(IMP.HR, "MD0") "R#7":' '
     CO.LINE = CO.LINE :OCONV(COMP.CHG.HRS, "MD1") "R#7":' '
     CO.LINE = CO.LINE :OCONV(COMP.N.C.HRS, "MD1") "R#7":' '
     COMP.TOT.HRS = COMP.CHG.HRS + COMP.N.C.HRS
     CO.LINE = CO.LINE :OCONV(COMP.TOT.HRS, "MD1") "R#7":' '
     IF COMP.CHG.HRS+0 # 0 AND COMP.TOT.HRS+0 # 0 THEN
       COMP.CHG.PER = INT(COMP.CHG.HRS/COMP.TOT.HRS*1000)
     END ELSE
       COMP.CHG.PER = 0
     END
     CO.LINE = CO.LINE :OCONV(COMP.CHG.PER, "MD1") "R#6":' '
     CO.LINE = CO.LINE :OCONV(COMP.O.T.HRS, "MD1") "R#7":' '
*T26800 CO.LINE = CO.LINE :OCONV(COMP.D.T.HRS, "MD1") "R#7":' '
     CO.LINE = CO.LINE :OCONV(COMP.D.T.HRS, "MD1") "R#7"
     PRINT CO.LINE
     RETURN
*
***** PRINT HEADINGS
*
9000* 
     PRINT CHAR(12):
     PAGE.NO = PAGE.NO + 1
     PRINT THD1:PAGE.NO
     PRINT THD2
     H.LINE = 'DIVISION : ':DIVISION
     H.LINE = H.LINE :SPACE(37):"FOR PERIOD ":ST.PER:" THROUGH ":EN.PER
     PRINT H.LINE
     H.LINE = SPACE(49):"FOR DATES ":ST.DATE:" THROUGH ":EN.DATE
     PRINT H.LINE
     IF DESC3 # "" THEN
       H.LINE = ""
       LEN.DESC = LEN(DESC3)
       LSPACE = 66 - INT( (LEN.DESC / 2) + .5)
       H.LINE = H.LINE : SPACE(LSPACE):DESC3
       PRINT H.LINE
       LINE.COUNT = LINE.COUNT + 1
     END
     PRINT
     H.LINE = ''
     H.LINE = H.LINE :DESC1
     H.LINE = H.LINE :"   ACT     STD     %     CNCR     ACT     STD     CHG     N/C    TOTAL    %      O-T     D-T  "
     PRINT H.LINE
     H.LINE = ""
     H.LINE = H.LINE :DESC2
     H.LINE = H.LINE :"  HOURS   HOURS   EFF    HOURS   QTY/HR  QTY/HR  HOURS   HOURS   HOURS  CH/HRS  HOURS   HOURS"
     PRINT H.LINE
     H.LINE = ''
     H.LINE = H.LINE :UNDER.LINE1:UNDER.LINE2
     PRINT H.LINE
     LINE.COUNT = LINE.COUNT + 10
     RETURN
*
***** CALL SYSCOM(MAT SYSCOM.REC)
*
91000* 
     ERR.TYPE = 1
     CALL SYSCOM(MAT SYSCOM.REC)
     RETURN
92000* 
     ERR.TYPE = 2
     CALL SYSCOM(MAT SYSCOM.REC)
     RETURN
93000* 
     ERR.TYPE = 3
     CALL SYSCOM(MAT SYSCOM.REC)
*
**** END OF JOB
*
99999* 
     PRINTER OFF
     END
