   SUBROUTINE JOB.SP.INQ.RPT(CONO,CO.NAME,JOB.NUM,SUB.CNT,HD1,HD2)
*COPY>CPYLIB>COM1
*COPY>JCS.CPYLIB>COM.JCS.LINK
*COPY>ICS.CPYLIB>COM.INV.MAIN  
*COPY>ICS.CPYLIB>COM.INV.SERIAL
*COPY>JCS.CPYLIB>COM.INV.STATS 
*COPY>PMC.CPYLIB>COM.CUST
*COPY>OPS.CPYLIB>COM.ORDER
*COPY>JCS.CPYLIB>COM.JOB.INQ
*********************************************************************
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - JCSBP
* PROGRAM     - JOB.SP.INQ.RPT
* DATE        - 11/21/83
* DESCRIPTION -
*T26334 epitka 12/19/2001 * REV12
*T26493 cmykleb 04/03/2002 * Change pgm to use headings from calling pgm.
*ENDDOC
*********************************************************************
*COPY>JCS.CPYLIB>JOB
*COPY>JCS.CPYLIB>JOB.SHIP
*COPY>JCS.CPYLIB>JOB.TOT.REC
*COPY>PMC.CPYLIB>COST.CNTR
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*
   DASHES = STR('-',80)
   PNO = 0
   TOTAL.SHIP = ''
   SP1 = SPACE(1)
   SP3 = SPACE(3)
   LINE.COUNT = 99
*T26943 v
   HD3 = "JOB # : ":JOB.NUM"L#8":SPACE(50)
   HD3 = HD3 : "SHIP POSTED REPORT"
*T26493 ^
**** PRINT DETAIL LINES AND TOTALS
100 DEPT.CNT = COUNT(SP.DEPT.NO,VM) + (SP.DEPT.NO # '')
   FOR D = 1 TO DEPT.CNT
      DEPT.TOTALS = ''
      PTR.CNT = COUNT(SP.DEPT.PTR<1,D>,SVM)+(SP.DEPT.PTR<1,D> # '')
      DPNO = SP.DEPT.NO<1,D>
      FOR PT = 1 TO PTR.CNT
         CCTR.TOTALS = ''
         PTR.NO = SP.DEPT.PTR<1,D,PT>; CCNO = JOB.SP.CCTR<1,PTR.NO>
         MATREAD CCTR.REC FROM COST.CNTR, CONO:CCNO ELSE
            MAT CCTR.REC = '????????????'
         END
         SP.ID = CONO:JOB.NUM:"!":DPNO:"!":CCNO:"!"
         LINES = JOB.SP.SEQ<1,PTR.NO,1>
         FOR SE = 1 TO LINES
            MATREAD JSP.REC FROM JOB.SHIP, SP.ID:SE ELSE GOTO 111
            GOSUB 1000
111      NEXT SE
         FOR K = 2 TO SUB.CNT
            OLN = LINES + 1; LINES = LINES + JOB.SP.SEQ<1,PTR.NO,K>
            SP.ID = CONO:JOB.SUBS<1,K-1>:"!":DPNO:"!":CCNO:"!"
            FOR SE = OLN TO LINES
               MATREAD JSP.REC FROM JOB.SHIP, SP.ID:(SE-OLN+1) ELSE GOTO 112
               GOSUB 1000
112         NEXT SE
         NEXT K
         GOSUB 2000
      NEXT PT
      GOSUB 3000
   NEXT D
   GOTO 99999
**** PRINT DETAIL LINE
1000 IF LINE.COUNT > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   LINE = ''
   LINE = LINE : CCNO "L#4": SP1 : JSP.OPER "L#4" : SP1
   LINE = LINE :  JSP.SHIP.TO "L#8" : SP1 : JSP.VIA "L#3" :SP1
   LINE = LINE : JSP.JURS "L#4" :SP1:JSP.INV "L#10":SP1
   LINE = LINE : JSP.FRT.NO "L#12" : SP1:OCONV(JSP.DATE, "D2/") "L#8":SP1
   LINE = LINE : JSP.MON<1,1> "R#6" :SP1
   BEGIN CASE
      CASE JSP.TYPE = 'R'
         LINE = LINE : JSP.QTY "R#7":SPACE(9)
         CCTR.TOTALS<1,1> = CCTR.TOTALS<1,1> + JSP.QTY
      CASE JSP.TYPE = 'N'
         LINE = LINE : SPACE(8):JSP.QTY "R#7":SP1
         CCTR.TOTALS<1,2> = CCTR.TOTALS<1,2> + JSP.QTY
      CASE 1
         LINE = LINE : JSP.QTY "R#7":SPACE(9)
         CCTR.TOTALS<1,1> = CCTR.TOTALS<1,1> + JSP.QTY
   END CASE
   LINE = LINE :JSP.QTY "R#9" :SP1
   CCTR.TOTALS<1,3> = CCTR.TOTALS<1,3> + JSP.QTY
   LINE = LINE :OCONV(JSP.COST, "MD2") "R#9" :SP1
   LINE = LINE : OCONV(JSP.SALE, "MD2") "R#9" : SP1
   LINE = LINE : JSP.RC.JOB "L#8":SP1
   LINE = LINE : JSP.RC.TRAN "L#7":SP1
   PRINT LINE
   LINE.COUNT = LINE.COUNT + 1
   RETURN
**** PRINT TOTALS FOR CCTR
2000 IF LINE.COUNT + 2 > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   GOSUB 9000
   LINE = ''
   LINE = LINE : "** CCTR - ":CCNO "L#3":" ":CCTR.DESC "L#32" : " **"
   LINE = LINE : SPACE(18)
   LINE = LINE : SP1:CCTR.TOTALS<1,1> "R#7"
   LINE = LINE : SP1:CCTR.TOTALS<1,2> "R#7"
   LINE = LINE : SP1:CCTR.TOTALS<1,3> "R#9"
   DEPT.TOTALS<1,1> = DEPT.TOTALS<1,1> + CCTR.TOTALS<1,1>
   DEPT.TOTALS<1,2> = DEPT.TOTALS<1,2> + CCTR.TOTALS<1,2>
   DEPT.TOTALS<1,3> = DEPT.TOTALS<1,3> + CCTR.TOTALS<1,3>
   LINE = LINE : SP1:OCONV(JOB.SP.COST<1,PTR.NO>, "MD2") "R#9"
   LINE = LINE : SP1:OCONV(JOB.SP.SALE<1,PTR.NO>, "MD2") "R#9"
   PRINT LINE
   PRINT
   LINE.COUNT = LINE.COUNT + 2
   RETURN
**** PRINT TOTALS FOR DEPT
3000 IF LINE.COUNT + 2 > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   GOSUB 9100
   LINE = ''
   LINE = LINE : "** DEPT - ":DPNO "L#5":" ":SP.DEPT.DESC<1,D> "L#30" : " **"
   LINE = LINE : SPACE(18)
   LINE = LINE : SP1:DEPT.TOTALS<1,1> "R#7"
   LINE = LINE : SP1:DEPT.TOTALS<1,2> "R#7"
   LINE = LINE : SP1:DEPT.TOTALS<1,3> "R#9"
   LINE = LINE :SP1:OCONV(SP.DEPT.COST<1,D>, "MD2") "R#9"
   LINE = LINE :SP1:OCONV(SP.DEPT.SALE<1,D>, "MD2") "R#9"
   PRINT LINE
   TOTAL.SHIP<1,1> = TOTAL.SHIP<1,1> + DEPT.TOTALS<1,1>
   TOTAL.SHIP<1,2> = TOTAL.SHIP<1,2> + DEPT.TOTALS<1,2>
   TOTAL.SHIP<1,3> = TOTAL.SHIP<1,3> + DEPT.TOTALS<1,3>
   PRINT
   LINE.COUNT = LINE.COUNT + 2
   RETURN
**** UNDER LINE FOR TOTALS
9000 IF LINE.COUNT > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   LINE = ''
   LINE =SPACE(68):'------- ------- --------- --------- ---------'
   PRINT LINE
   LINE.COUNT = LINE.COUNT + 1
   RETURN
**** UNDER LINE FOR TOTALS
9100 IF LINE.COUNT > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   LINE = ''
   LINE =SPACE(68):'======= ======= ========= ========= ========='
   PRINT LINE
   LINE.COUNT = LINE.COUNT + 1
   RETURN
**** PRINT HEADING
9999 PRINT CHAR(12)
   PNO = PNO + 1
*T26493 v
*  LINE = SPACE(2) : 'DATE - ' : OCONV(DATE(),"D2/") "L#8"
*  LINE = LINE : SPACE(5) : 'TIME - ' : OCONV(TIME(),"MTS") "L#8"
*  LINE = LINE : SPACE(22) : CO.NAME "L#30"
*  LINE = LINE : SPACE(15) : 'PAGE - ' : PNO "R#3"
*  PRINT LINE
*  PRINT SPACE(52) :'S H I P   P O S T E D   R E P O R T'
*  PRINT SPACE(52) :"       FOR JOB : ":JOB.NUM "L#8"
*  PRINT SPACE(52) :DASHES[1,35]
   PRINT HD1:PNO"R#3"
   PRINT HD2
   PRINT HD3
*T26493 ^
   PRINT
   LINE = 'CCTR OPER SHIP TO  VIA JURS INVOICE    FRT NUM      SHP DATE PERIOD REGULAR NO CHRG TOT  QTY  TOT COST  TOT SALE  RCLS JOB RC TRAN'
   PRINT LINE
   LINE = '---- ---- -------- --- ---- ---------- ------------ -------- ------ ------- ------- --------- --------- --------- -------- -------'
   PRINT LINE
   PRINT
   LINE.COUNT = LINE.COUNT + 7
   RETURN
***** PRINT SHIP TOTALS FOR ALL DEPARTMENTS AND END OF JOB 
99999 IF LINE.COUNT + 3 > 45 THEN
      LINE.COUNT = 0 ; GOSUB 9999
   END
   GOSUB 9100
   LINE = ''
   LINE = LINE : "** TOTAL FOR ALL SHIPPING DEPARTMENTS          **" "L#67"
   LINE = LINE : SP1:TOTAL.SHIP<1,1> "R#7"
   LINE = LINE : SP1:TOTAL.SHIP<1,2> "R#7"
   LINE = LINE : SP1:TOTAL.SHIP<1,3> "R#9"
   LINE = LINE : SP1:OCONV(SP.TOT.COST, "MD2") "R#9"
   LINE = LINE : SP1:OCONV(SP.TOT.SALE, "MD2") "R#9"
   PRINT LINE
   LINE.COUNT =  LINE.COUNT + 1
   RETURN
END
