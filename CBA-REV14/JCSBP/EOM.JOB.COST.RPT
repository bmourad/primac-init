*COPY>CPYLIB>COM1
**************************************************************
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - JCSBP
* PROGRAM     - EOM.JOB.COST.RPT
* BY          - RHONDA PERRIN, COMPUTER BUSINESS ASSOCIATES
* DATE        - 07/23/85
* DESCRIPTION -
* This program deletes JOB.COST.REPORT records with
* completed job dates.
*ENDDOC
**************************************************************
*
*---- FILE EQUATES
*
*COPY>CPYLIB>SYSCOM
*COPY>CPYLIB>CHAR
*COPY>CPYLIB>FILE.VARS
*COPY>PMC.CPYLIB>COMPANY
*COPY>JCS.CPYLIB>JOB.COST.REPORT
*
*---- SETUP FOR SYSTEM ERROR MESSAGES
*
     SYS.TYPE=1
     CALL SYSCOM(MAT SYSCOM.REC)
*
*---- PROCREAD
*
     PROCREAD XX ELSE ERRMSG="MUST BE RUN FROM PROC";GOSUB 91000;GOTO 99999
     CONO = XX<1>
*
*---- OPEN FILES
*
     OPEN '','COMPANY' TO COMPANY ELSE ERRMSG='COMPANY FILE MISSING';GOTO 93000
     OPEN '','CONTROL' TO CONTROL ELSE ERRMSG='CONTROL FILE MISSING';GOTO 93000
     OPEN '','JOB.COST.REPORT' TO JOB.COST.REPORT ELSE ERRMSG='JOB.COST.REPORT FILE MISSING';GOTO 93000
*
*---- MAIN PROCESSING
*
5*
     READNEXT JCR.KEY ELSE GOTO 99999
     READU TEMP.REC FROM JOB.COST.REPORT, JCR.KEY ELSE
        RELEASE JOB.COST.REPORT,JCR.KEY
        GOTO 5
     END
     DELETE JOB.COST.REPORT,JCR.KEY
     GOTO 5
*
*---- CALLS FOR SYSCOM
*
91000*
     ERR.TYP=1;CALL SYSCOM(MAT SYSCOM.REC);RETURN
93000*
     ERR.TYP=3;CALL SYSCOM(MAT SYSCOM.REC)
99999*
     END
