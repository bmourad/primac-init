*COPY>CPYLIB>SCOMMON1
*********************************************************************
* REVISION    - [10.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - RESBP
* PROGRAM     - EST.RES.EQUIP.LIST
* BY          - RICK BROWN
* DATE        - 10/07/94
* DESCRIPTION - This program lists the Roll Equipment file.
*T25901 cmykleb 03/08/2002 * Change heading to use GET.PROG.HEAD pgm.
*T26493 cmykleb 03/22/2002 * Change report to use rpt # from proc.
*********************************************************************
*COPY>JES.CPYLIB>EQUIPMENT
*COPY>PMC.CPYLIB>COST.CNTR
*COPY>PMC.CPYLIB>COMPANY
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>SYSCOM
*COPY>CPYLIB>CHAR
*
*---- SET SYSCOM
*
   SYS.TYPE=1
   CALL SI_SYSCOM(MAT SYSCOM.REC)
*
*---- OPEN FILES
*
   OPEN 'EQUIPMENT' TO EQUIPMENT ELSE
      ERRMSG = 'CANNOT OPEN EQUIPMENT FILE'
      GOTO 93000
   END
   OPEN 'COST.CNTR' TO COST.CNTR ELSE
      ERRMSG = 'CANNOT OPEN COST.CNTR FILE'
      GOTO 93000
   END
   OPEN 'COMPANY' TO COMPANY ELSE
      ERRMSG = 'CANNOT OPEN COMPANY FILE'
      GOTO 93000
   END
   OPEN 'CONTROL' TO CONTROL ELSE
      ERRMSG = 'CANNOT OPEN CONTROL FILE'
      GOTO 93000
   END
*
*---- PROC READ
*
   PROCREAD ID ELSE
      ERRMSG = "MUST RUN FROM MENU"
      GOSUB 91000
      GOTO 99999
   END
   CONO = ID<1>
   CONO.NAME = ID<2>
   PRT.FLG = ID<3>
*
*---- SET UP HEADINGS
*
*T25901 v
*  HD1 = ''
*  HD1B = SPACE(INT((100-LEN(CONO.NAME))/2)):CONO.NAME
*  HD1B = HD1B "L#100"
*  HD1 = HD1:HD1B:'   PAGE '
*  HD2 = 'REPORT # : ':REPORT.NUMBER
*  HD2 = HD2:SPACE(36):'R O L L   L A B E L   P R E S S   L I S T I N G'
*T26493 v
*  REPORT.NAME = "ROLL LABEL PRESS LISTING"
*  REPORT.NUMBER = "XXXX"
   REPORT.NUMBER = ID<2>
   REPORT.NAME = ""
   CONO.NAME = ""
*T26493 ^
   HD1 = "" ; HD2 = ""
   CALL GET.PROG.HEAD(CONO,CONO.NAME,REPORT.NAME,REPORT.NUMBER,"",HD1,HD2)
*T25901 ^
   HD3 = SPACE(32):'<--- REPEAT ----> <---- WIDTH ----> <- BLANK ->'
   HD4 = 'PRESS        DESCRIPTION           MIN      MAX      MIN      MAX    MIN   MAX  CU DU DRAW GAP BTWN GAP TRIM MIN R/F RGS FGS PGS'
   HD5 = '----- ------------------------- -------- -------- -------- -------- ----- ----- -- -- -------- -------- -------- --- --- --- ---'
*
*---- INITIALIZATION
*
   LINE.CNT = 999
   PAGE.CNT = 0
   PRINTER ON
*
*---- MAIN PROCESSING
*
100 *
   READNEXT KEY ELSE GOTO 99999
   PRESS = KEY[4,12]
   MATREAD CCTR.REC FROM COST.CNTR,CONO:PRESS ELSE
      MAT CCTR.REC = ''
      CCTR.DESC = 'UNKNOWN'
   END
   MATREAD EQUIPMENT.REC FROM EQUIPMENT,KEY ELSE GOTO 100
   BEGIN CASE
      CASE LINE.CNT + 3 > 54
         GOSUB 10000
         GOSUB 1000
      CASE 1
         GOSUB 1000
   END CASE
   DONE = 0
   LOOP
      READNEXT KEY ELSE DONE = 1
   UNTIL DONE DO
      PRESS = KEY[4,12]
      MATREAD EQUIPMENT.REC FROM EQUIPMENT,KEY ELSE GOTO 100
      MATREAD CCTR.REC FROM COST.CNTR,CONO:PRESS ELSE
         MAT CCTR.REC = ''
         CCTR.DESC = 'UNKNOWN'
      END
      BEGIN CASE
         CASE LINE.CNT + 3 > 54
            GOSUB 10000
            GOSUB 1000
         CASE 1
            GOSUB 1000
      END CASE
   REPEAT
   GOTO 99999
*
*---- PRINT DETAIL
*
1000 *
   PLINE = PRESS "L#5 "
   PLINE = PLINE:CCTR.DESC "L#25 "
   PLINE = PLINE:OCONV(EQP.RES.PRESS.REPEAT.MIN,"MD4")"R#8 "
   PLINE = PLINE:OCONV(EQP.RES.PRESS.REPEAT.MAX,"MD4")"R#8 "
   PLINE = PLINE:OCONV(EQP.RES.PRESS.WIDTH.MIN,"MD4")"R#8 "
   PLINE = PLINE:OCONV(EQP.RES.PRESS.WIDTH.MAX,"MD4")"R#8 "
   PLINE = PLINE:OCONV(EQP.RES.PRESS.DIE.BLANK,"MD2")"R#5 "
   PLINE = PLINE:OCONV(EQP.RES.PRESS.BLANK.MAX,"MD2")"R#5 "
   PLINE = PLINE:EQP.RES.PRESS.COLOR.UNITS "R#2 "
   PLINE = PLINE:EQP.RES.PRESS.DIE.UNITS "R#2 "
*      PLINE = PLINE:EQP.RL.PRESS.SPOIL.TBL "L#6 "
   PLINE = PLINE:OCONV(EQP.RL.DRAW.GAP.MIN,"MD4")"R#8 "
   PLINE = PLINE:OCONV(EQP.RL.WIDTH.GAP,"MD4")"R#8 "
   PLINE = PLINE:OCONV(EQP.RL.TRIM.MIN,"MD4")"R#8 "
   PLINE = PLINE:" ":EQP.RL.PRESS.DIE.TYPE "L#3"
   PLINE = PLINE:" ":EQP.RL.PRESS.GSROTARY "L#3"
   PLINE = PLINE:" ":EQP.RL.PRESS.GSFBED "L#3"
   PLINE = PLINE:" ":EQP.RL.PRESS.GSPRINT "L#3"
   PRINT PLINE
   LINE.CNT = LINE.CNT + 1
   RETURN
*
*---- PRINT HEADING
*
10000 *
   PAGE.CNT = PAGE.CNT + 1
   PRINT CHAR(12)
   PRINT HD1:PAGE.CNT
   PRINT HD2
   PRINT
   PRINT HD3
   PRINT HD4
   PRINT HD5
   PRINT
   LINE.CNT = 7
   RETURN
*
*---- SYSCOM MESSAGES
*
91000 *
   ERR.TYPE=1
   CALL SI_SYSCOM(MAT SYSCOM.REC)
   RETURN
92000 *
   ERR.TYPE=2
   CALL SI_SYSCOM(MAT SYSCOM.REC)
   RETURN
93000 *
   ERR.TYPE=3
   CALL SI_SYSCOM(MAT SYSCOM.REC)
99999 *
   PRINTER OFF
END
