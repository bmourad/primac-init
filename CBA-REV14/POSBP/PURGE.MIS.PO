*COPY>CPYLIB>COM1
*********************************************************************
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - POSBP
* PROGRAM     - PURGE.MIS.PO
* BY          - JIHAD YAMOUT , CBA
* DATE        - 08/22/84
* DESCRIPTION - THIS PROGRAM RUN FROM A PROC THAT SELECT MISC.PO FILE
*                AND THEN DELETE ALL ITEMS SELECTED.
*ENDDOC
*********************************************************************
*** INSERT FILES EQUETES
*COPY>POS.CPYLIB>MISC.PO
*COPY>CPYLIB>SYSCOM
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*** SETUP FOR SYSTEM ERRMSG
   SYS.TYPE = 1
   CALL SYSCOM(MAT SYSCOM.REC)
*** OPEN ALL FILES
OPEN '','MISC.PO' TO MISC.PO ELSE ERRMSG = 'MISC.PO FILE IS MISSING' ; GOTO 93000
*** GET CONO FROM PROC
   PROCREAD KEY ELSE
       ERRMSG = 'THIS PROCESS SHOULD BE RUN FROM A PROC' ; GOTO 93000
   END
*** MAIN PROCESS
DATA = 0
LOOP
   READNEXT ID ELSE DATA = 1
WHILE DATA = 0 DO
   MATREADU MPO.REC FROM MISC.PO ,ID ELSE
     RELEASE MISC.PO, ID
     MAT MPO.REC = '' ; GOTO 111
   END
   DELETE MISC.PO ,ID
111*
   REPEAT
   GOTO 99999
*** PRINT ERRMSG
91000 ERR.TYPE = 1; CALL SYSCOM(MAT SYSCOM.REC)
      RETURN
92000 ERR.TYPE = 2; CALL SYSCOM(MAT SYSCOM.REC)
      RETURN
93000 ERR.TYPE = 3; CALL SYSCOM(MAT SYSCOM.REC)
99999 * PRINT * @(-1) * :
      END
