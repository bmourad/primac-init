      SUBROUTINE FNGD.WHSE.RPT(CONO,PRODNO,HD1,HD2,S.HD2,PAGE.NO,LINE.CNT)
*COPY>CPYLIB>COM1
*COPY>ICS.CPYLIB>COM.INV.INQ
********************************************************************
* REVISION    - [08.1]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SOURCE        - OPSBP
* PROGRAM       - FNGD.WHSE.RPT
* BY            - JULIANNE RIVERA, VERCOM SOFTWARE INC.
* DATE          - 03/27/92
* DESCRIPTION   -
********************************************************************
*COPY>ICS.CPYLIB>INVENTORY
*COPY>ICS.CPYLIB>INV.WHSE
*COPY>ICS.CPYLIB>WAREHOUSE
*COPY>ICS.CPYLIB>INV.CNV
*COPY>ICS.CPYLIB>PRICE.TABLE
*COPY>CPYLIB>FILE.VARS
*COPY>CPYLIB>CHAR
*
*---- Display screen
*
      SP1 = SPACE(1)
*
      UNKNOWN = STR("?",25)
*
*---- Ship to
100 *
      IF LINE.CNT + 8 > 55 THEN
         GOSUB 3000
      END ELSE
         PRINT
         PRINT S.HD2
      END
      WHSECNT = DCOUNT(INV.WHSE.CODE,VM)
      FOR T = 1 TO WHSECNT
         GOSUB 1000
      NEXT T
      GOTO 99999
*
*---- Display a single line
*
1000 *
      MATREAD WHSE.REC FROM WAREHOUSE, CONO:INV.WHSE.CODE<1,T> ELSE
         MAT WHSE.REC = ""
         WHS.DESC = UNKNOWN
      END
      IF LINE.CNT > 55 THEN
         GOSUB 3000
      END
      MATREAD IWH.REC FROM INV.WHSE, CONO:PRODNO:"!":INV.WHSE.CODE<1,T> ELSE
         MAT IWH.REC = "" 
      END
      GOSUB 2000
      PRINT
      P.LINE = "WAREHOUSE  : ":INV.WHSE.CODE<1,T> "L#4" 
      P.LINE = P.LINE : SP1 : WHS.DESC "L#20" 
      PRINT P.LINE
      P.LINE = "SALES CODE : ":IWH.SALES.CODE "L#3" 
      P.LINE = P.LINE : SPACE(34) : "SELL PRICE (1) : " : OCONV(IWH.SELL<1,1>,"MD4")"R#10" 
      P.LINE = P.LINE : SPACE(6) : "STD SELL : " : OCONV(IWH.STD.COST,"MD4") "R#10" 
      PRINT P.LINE
      P.LINE = "PRICE TABLE: " : IWH.PRICE.GRP "L#6"
      IF IWH.PRICE.GRP = "" THEN
         MAT PGT.REC = ""
      END ELSE
      MATREAD PGT.REC FROM PRICE.TABLE, CONO:IWH.PRICE.GRP ELSE
         MAT PGT.REC = ""
         PGT.DESC = UNKNOWN
      END
      END
      P.LINE = P.LINE : SP1 : PGT.DESC "L#25"
      P.LINE = P.LINE : SPACE(16) : "(2) : " : OCONV(IWH.SELL<1,2>,"MD4") "R#10" 
      P.LINE = P.LINE : SPACE(6) : "AVG SELL : " : OCONV(IWH.AVG.COST,"MD4") "R#10"
      PRINT P.LINE
      P.LINE = "EST SALE   : " : OCONV(IWH.EST.SALE,"MD4") "R#10"
      P.LINE = P.LINE : SPACE(38) : "(3) : " : OCONV(IWH.SELL<1,3>,"MD4") "R#10"
      P.LINE = P.LINE : SPACE(6) : "MIN QTY  : " : OCONV(IWH.MIN.QTY,ICR.CNV) "R#10"
      PRINT P.LINE
      P.LINE = SPACE(61) : "(4) : " : OCONV(IWH.SELL<1,4>,"MD4") "R#10"
      P.LINE = P.LINE : SPACE(6) : "MAX QTY  : " : OCONV(IWH.MAX.QTY,ICR.CNV) "R#10"
      PRINT P.LINE
      LINE.CNT = LINE.CNT + 6
1999 *
      RETURN
*
*---- CONVERT QUANTITIES
2000 *
      IF ICR.DV1 + 0 # 0 THEN
         IF IWH.MIN.QTY >= 0 THEN
            IWH.MIN.QTY=INT((((IWH.MIN.QTY / ICR.DV1) * ICR.MT1) / ICR.DV2) + .5)
         END ELSE
            IWH.MIN.QTY=INT((((IWH.MIN.QTY / ICR.DV1) * ICR.MT1) / ICR.DV2) + .5)
         END
         IF IWH.MAX.QTY >= 0 THEN
            IWH.MAX.QTY=INT((((IWH.MAX.QTY / ICR.DV1) * ICR.MT1) / ICR.DV2) + .5)
         END ELSE
            IWH.MAX.QTY=INT((((IWH.MAX.QTY / ICR.DV1) * ICR.MT1) / ICR.DV2) - .5)
         END
      END ELSE
         IWH.MIN.QTY = 0 ; IWH.MAX.QTY = 0
      END
      RETURN
*
*---- PRINT HEADINGS
3000 *
      PRINT CHAR(12):
      PAGE.NO = PAGE.NO + 1
      PRINT HD1:PAGE.NO
      PRINT HD2
      PRINT
      PRINT S.HD2
      LINE.CNT = 4
      RETURN
99999 *
      RETURN
      END
