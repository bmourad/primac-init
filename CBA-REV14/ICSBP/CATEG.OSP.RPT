*COPY>CPYLIB>COM1
*********************************************************************
* REVISION    - [10.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - ICSBP
* PROGRAM     - CATEGORY.OSP.PRINT
* BY          - CURTIS WILLIAMS, VERCOM SOFTWARE, INC
* DATE        - 09/24/94
*
* MOD 09/24/94 CLW Task 17919 - accrual accounts
*
*********************************************************************
*
*--- INSERT FILE EQUATES
*
*COPY>PMC.CPYLIB>COMPANY
*COPY>JCS.CPYLIB>CATEGORY.OSP
*COPY>PMC.CPYLIB>COA
*COPY>CPYLIB>CHAR
*COPY>CPYLIB>SYSCOM
MAT SYSCOM.REC =  ""; SYS.TYPE = 2
*
*--- OPEN FILES
*
      OPEN "","CATEGORY.OSP" TO CATEGORY.OSP ELSE
         ERRMSG = "CATEGORY.OSP FILE IS MISSING" ; GOSUB 90000 ; GOTO 99999
      END
      OPEN "","COMPANY" TO COMPANY ELSE
         ERRMSG = "COMPANY FILE IS MISSING" ; GOSUB 90000 ; GOTO 99999
      END
      OPEN "","COA" TO COA ELSE
         ERRMSG = "COA FILE IS MISSING" ; GOSUB 90000 ; GOTO 99999
      END
*
*--- READ PROC VALUES
      PROCREAD ID ELSE
         ERRMSG = "THIS PROGRAM MUST RUN FROM A PROC." ; GOSUB 90000 ; GOTO 99999
      END
      CONO = ID<1> ; CONO.NAME = ID<2>
      MATREAD COMP.REC FROM COMPANY, CONO ELSE
         MAT COMP.REC = ""
      END
*
*--- GET THE FIRST TWO LINES OF HEADING
*
      UNKNOWN = STR("?",25)
      HD1 = "" ; HD2 = ""
      REPORT.NAME = "OUTSIDE PURCHASE CATEGORY LISTING"
      REPORT.NUMBER = "XXXX"
      REPORT.DATE = DATE()
      CALL GET.PROG.HEAD(CONO,CO.NAME,REPORT.NAME,REPORT.NUMBER,REPORT.DATE,HD1,HD2)
      MATREAD COMP.REC FROM COMPANY, CONO ELSE
         MAT COMP.REC = ""
      END
*
*--- INT
*
      PAGE.NO = 0
      S.HD1 = STR('<',41):" CATEGORY INFORMATION ":STR('>',41)
      S.HD2 = "<":STR("-",37):" G / L ACCOUNT INFORMATION ":STR('-',38):">"
      S.HD3 = "<--------------------- ACCRUAL ACCOUNTS --------------------->"
      S.HD4 = "<---------------------- DIRECT ACCOUNTS --------------------->"
      S.HD5 = "<---------------------- FIXED ACCOUNTS ---------------------->"
*
*---- MAIN PROCESSING
*
      PRINTER ON
      DATA = 1
      LOOP
         READNEXT KEY ELSE DATA = 0
      WHILE DATA = 1 DO
         MATREAD CAOS.REC FROM CATEGORY.OSP, KEY ELSE GOTO 111
         GOSUB 1000
         GOSUB 2000
111   REPEAT
      GOTO 99999
*
*--- PRINT INVENTORY INFORMATION
*
1000 *
      GOSUB 8000
      PRINT
      P.LINE = S.HD1
      PRINT P.LINE
      PRINT
      P.LINE = "CATEGORY    : ":KEY[4,8] "L#8":SPACE(4):"DESCRIPTION  : ":CAOS.DESC "L#20"
      PRINT P.LINE
      P.LINE = "Order Cycle : ":CAOS.LEAD.TIME
      PRINT P.LINE
      P.LINE = "MAJOR LINE  : ":CAOS.MAJ.LINE "L#8"
      PRINT P.LINE
      P.LINE = "FFOH %      : ":OCONV(CAOS.FOH.PCT,"MD2") "L#5"
      PRINT P.LINE
      P.LINE = "MARKUP %    : ":OCONV(CAOS.MARKUP,"MD2") "L#5"
      PRINT P.LINE
      RETURN
*
*--- PRINT ACCOUNT INFORMATION
*
2000 *
*
      PRINT
      PRINT S.HD2
      PRINT
      PRINT S.HD3
      P.LINE = "ACCRUED LIAB    : ":CAOS.ACCRU.LIAB CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CAOS.ACCRU.LIAB ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE := COA.DESC "L#24"
      PRINT P.LINE
      P.LINE = "ACCOUNT PAYABLE : ":CAOS.AP.ACCT CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CAOS.AP.ACCT ELSE
         COA.DESC = "UNKNOWN"
      END
      P.LINE := COA.DESC "L#24"
      PRINT P.LINE
      PRINT
      PRINT S.HD4
      P.LINE = ""
      P.LINE = "WORK IN PROCESS : ":CAOS.WIP CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CAOS.WIP ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "COST OF GOODS   : ":CAOS.COG CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CAOS.COG ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "APPLIED         : ":CAOS.APL CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CAOS.APL ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      PRINT S.HD5
      P.LINE = ""
      P.LINE = "WORK IN PROCESS : ":CAOS.FOH.WIP CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CAOS.FOH.WIP ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "COST OF GOODS   : ":CAOS.FOH CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CAOS.FOH ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "APPLIED         : ":CAOS.FOH.APL CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CAOS.FOH.APL ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      RETURN
*
*--- PRINT HEADING
*
8000 *
      PRINT CHAR(12):
      PAGE.NO = PAGE.NO + 1
      H.LINE = ""
      H.LINE = HD1:PAGE.NO
      PRINT H.LINE
      H.LINE = ""
      H.LINE = HD2
      PRINT H.LINE
      RETURN
*
*--- PRINT ERRMSG 
*
90000 ERR.TYPE=1;CALL SYSCOM(MAT SYSCOM.REC);RETURN
* 90000 *
*       PRINT @(0,23):CL:ERRMSG:
*       INPUT REPLY
*       PRINT @(0,23):CL
*       RETURN
*
*--- END OF REPORT
*
99999 *
      PRINTER OFF
      PRINTER CLOSE
      END
