*COPY>CPYLIB>COM1
*********************************************************************
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - ICSBP
* PROGRAM     - CATEGORY.PRINT
* BY          - JULIANNE RIVERA, VERCOM SOFTWARE, INC
* DATE        - 03/16/92
*
* MOD 09/24/94 CLW Task 17919 - accrual accounts
*T22058 stefanie 07/08/1997 * The word ACCRUED is spelled incorrectly in
*                             the report
*T25740 edvard 07/23/2001 * Added CATG.TRK.LVL    
*T26090 ajibaly 03/22/2002 * CONVERT TO R12 REPORT.SCRN
*T26855 cmykleb 10/14/2002 * Add Inter Division acct/desc to report.
*********************************************************************
*
*--- INSERT FILE EQUATES
*
*COPY>PMC.CPYLIB>COMPANY
*COPY>ICS.CPYLIB>CATEGORY
*COPY>PMC.CPYLIB>COA
*COPY>CPYLIB>CHAR
*COPY>CPYLIB>SYSCOM
MAT SYSCOM.REC =  ""; SYS.TYPE = 2
*
*--- OPEN FILES
*
      OPEN "","CATEGORY" TO CATEGORY ELSE
         ERRMSG = "CATEGORY FILE IS MISSING" ; GOSUB 90000 ; GOTO 99999
      END
      OPEN "","COMPANY" TO COMPANY ELSE
         ERRMSG = "COMPANY FILE IS MISSING" ; GOSUB 90000 ; GOTO 99999
      END
      OPEN "","COA" TO COA ELSE
         ERRMSG = "COA FILE IS MISSING" ; GOSUB 90000 ; GOTO 99999
      END
*
*--- READ PROC VALUES
      PROCREAD ID ELSE
         ERRMSG = "THIS PROGRAM MUST RUN FROM A PROC." ; GOSUB 90000 ; GOTO 99999
      END
*T26090     CONO = ID<1> ; CONO.NAME = ID<2>
      CONO = ID<1>
      MATREAD COMP.REC FROM COMPANY, CONO ELSE
         MAT COMP.REC = ""
      END
*
*--- GET THE FIRST TWO LINES OF HEADING
*
      UNKNOWN = STR("?",25)
      HD1 = "" ; HD2 = ""
*T26090v
*     REPORT.NAME = "PRODUCT LINE LISTING"
      REPORT.NAME = ''
      REPORT.NUMBER = ID<2>
*     REPORT.NUMBER = "XXXX"
*T26090 ^
      REPORT.DATE = DATE()
      CALL GET.PROG.HEAD(CONO,CO.NAME,REPORT.NAME,REPORT.NUMBER,REPORT.DATE,HD1,HD2)
*
*--- INT
*
      PAGE.NO = 0
      S.HD1 = STR('<',41):" CATEGORY INFORMATION ":STR('>',41)
      S.HD2 = "<":STR("-",37):" G / L ACCOUNT INFORMATION ":STR('-',38):">"
      S.HD3 = "<---------------------- DIRECT ACCOUNTS --------------------->"
      S.HD4 = "<--------------------- VARIABLE ACCOUNTS -------------------->"
      S.HD5 = "<---------------------- FIXED ACCOUNTS ---------------------->"
      S.HD6 = "<--------------------- ACCRUAL ACCOUNTS --------------------->"
*
*---- MAIN PROCESSING
*
      PRINTER ON
      DATA = 1
      LOOP
         READNEXT KEY ELSE DATA = 0
      WHILE DATA = 1 DO
         MATREAD CATG.REC FROM CATEGORY, KEY ELSE GOTO 111
         GOSUB 1000
         GOSUB 2000
111   REPEAT
      GOTO 99999
*
*--- PRINT INVENTORY INFORMATION
*
1000 *
      GOSUB 8000
      PRINT
      P.LINE = ""
      P.LINE = S.HD1
      PRINT P.LINE
      PRINT
      P.LINE = ""
      P.LINE = "PRODUCT LINE: ":KEY[4,8] "L#8":SPACE(4):"DESCRIPTION  : ":CATG.DESC "L#20"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "MAJOR LINE  : ":CATG.MAJ.LINE "L#8":SPACE(4):"ADDL SCREENS :":CATG.ADDL.SCRNS "L#15"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "TYPE        : ":CATG.TYPE "L#2"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "COST METHOD : ":CATG.COST.TYPE "L#2":"  "
      P.LINE = P.LINE:SPACE(8):"TRACK QOH    : ":CATG.TRACK.QOH "L#1":"  "
      P.LINE = P.LINE:SPACE(8):"VARIANCE % : ":OCONV(CATG.BURDEN.PRCNT,"MD2") "L#6"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "FNGD METHOD : ":CATG.FNGD.TYPE "L#2":"  "
*25892      P.LINE = P.LINE:SPACE(8):"GENERAL R/S  : ":CATG.R.S.ID "L#1":"  "
      P.LINE = P.LINE:SPACE(8):"TRACK LEVEL  : ":CATG.TRK.LVL "L#1":"  "
      P.LINE = P.LINE:SPACE(8):"PI METHOD  : ":CATG.PHY.INV.METH "L#2"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "SALE METHOD : ":CATG.SALE.TYPE "L#2":"  "
      P.LINE = P.LINE:SPACE(8):"REQ BOOKING  : ":CATG.REQ.BOOK "L#1":"  "
      P.LINE = P.LINE:SPACE(8):"PI ALLOW   : ":CATG.PHY.INV.ALLOW "L#2"
      PRINT P.LINE
      RETURN
*
*--- PRINT ACCOUNT INFORMATION
*
2000 *
*
      PRINT
      PRINT S.HD2
      PRINT
      PRINT S.HD6
*T22058 v      
*     P.LINE = "ACCURED AP LIAB : ":CATG.ACCRU.LIAB CO.ACCT.MASK:SPACE(5)
      P.LINE = "ACCRUED AP LIAB : ":CATG.ACCRU.LIAB CO.ACCT.MASK:SPACE(5)
*T22058 ^      
      MATREAD COA.REC FROM COA, CONO:CATG.ACCRU.LIAB ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE := COA.DESC "L#24"
      PRINT P.LINE
      P.LINE = "COST OF SALES   : ":CATG.COS CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.COS ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE := COA.DESC "L#24"
      PRINT P.LINE
      P.LINE = "ACCOUNTS PAYABLE: ":CATG.AP.ACCT CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.AP.ACCT ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE := COA.DESC "L#24"
      PRINT P.LINE
      PRINT
      PRINT S.HD3
      P.LINE = ""
      P.LINE = "INVENTORY       : ":CATG.INV CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.INV ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "INV ADJUSTMENTS : ":CATG.ADJ CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.ADJ ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "WORK IN PROCESS : ":CATG.WIP CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.WIP ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "COST OF GOODS   : ":CATG.COG CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.COG ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "FNGD VARIANCE   : ":CATG.INV.VAR CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.INV.VAR ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = "SHIP/NOT BILLED : ":CATG.SHIP.WIP CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.SHIP.WIP ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
*T26855 v
      P.LINE = "INTER DIVISION  : ":CATG.INTER.DIV CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.INTER.DIV ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
*T26855 ^
      PRINT
      PRINT S.HD4
      P.LINE = ""
      P.LINE = "WORK IN PROCESS : ":CATG.VOH.WIP CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.VOH.WIP ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "COST OF GOODS   : ":CATG.VOH CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.VOH ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "APPLIED         : ":CATG.VOH.APL CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.VOH.APL ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      PRINT
      PRINT S.HD5
      P.LINE = ""
      P.LINE = "WORK IN PROCESS : ":CATG.FOH.WIP CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.FOH.WIP ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "COST OF GOODS   : ":CATG.FOH CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.FOH ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      P.LINE = ""
      P.LINE = "APPLIED         : ":CATG.FOH.APL CO.ACCT.MASK:SPACE(5)
      MATREAD COA.REC FROM COA, CONO:CATG.FOH.APL ELSE
         COA.DESC = UNKNOWN
      END
      P.LINE = P.LINE:COA.DESC "L#25"
      PRINT P.LINE
      RETURN
*
*--- PRINT HEADING
*
8000 *
      PRINT CHAR(12):
      PAGE.NO = PAGE.NO + 1
      H.LINE = ""
      H.LINE = HD1:PAGE.NO
      PRINT H.LINE
      H.LINE = ""
      H.LINE = HD2
      PRINT H.LINE
      RETURN
*
*--- PRINT ERRMSG 
*
90000 ERR.TYPE=1;CALL SYSCOM(MAT SYSCOM.REC);RETURN
* 90000 *
*       PRINT @(0,23):CL:ERRMSG:
*       INPUT REPLY
*       PRINT @(0,23):CL
*       RETURN
*
*--- END OF REPORT
*
99999 *
      PRINTER OFF
      PRINTER CLOSE
      END
