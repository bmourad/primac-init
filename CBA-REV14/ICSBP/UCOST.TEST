CRT @(-1)
*COPY>ICS.CPYLIB>INVENTORY
*COPY>PMC.CPYLIB>PO
*COPY>ICS.CPYLIB>INV.CNV
PROMPT''
CONO='001'
OPEN 'INVENTORY' TO INVENTORY ELSE STOP
OPEN 'PO' TO PO ELSE STOP
1 CRT @(0,5):@(-4):'PO# ? ':;INPUT PONO:
  IF PONO='END' THEN STOP
  MATREAD PO.REC FROM PO,CONO:PONO ELSE GOTO 1
2 CRT @(0,7):@(-4):'PROD# ? ':;INPUT PRODNO:
  IF PRODNO='END' THEN STOP
  MATREAD INV.REC FROM INVENTORY,CONO:PRODNO ELSE GOTO 2
  INV.PPF = 100000
*COPY>ICSBP>INV.UM.CNV
LOCATE PRODNO IN PO.PROD.NUM<1>,1 SETTING P ELSE GOTO 1
      BUY.RECV.PRICE = INT((PO.GROS.PRICE<1,P> * (1- (PO.DISCOUNT<1,P>/10000))) +.5)
      IF SUM(PO.TOT.ONORD<1,P>) + 0 = 0 THEN
         RECV.PRICE = 0
      END ELSE
         IF INV.SBR + 0 # 1 THEN
            RECV.PRICE = INT(BUY.RECV.PRICE/INV.SBR +.5)
         END ELSE
            BUY.QTY=INT(((PO.TOT.ONORD<1,P>/ICR.DV1)*ICR.MT1/ICR.DV2)+.5)
            RECV.PRICE = BUY.RECV.PRICE * (BUY.QTY * 10)
            IF INV.PPF * 1 = 0 THEN INV.PPF = 100
            RECV.PRICE = RECV.PRICE / (INV.PPF/100)
            IF INV.UNIT<1,3> = "MSI" OR INV.UNIT<1,3> = "LBS" THEN
*              RECV.PRICE = RECV.PRICE * 1000
              RECV.PRICE *= 100
            END
            RECV.PRICE = INT(RECV.PRICE / (SUM(PO.TOT.ONORD<1,P>)) * (INV.COST.WT/100) +.5)
         END
      END
CRT ''
CRT "COSTING UNIT-PRICE IS ": RECV.PRICE
STOP
