*********************************************************************
* REVISION    - [08.0]
* SYSTEM      - PRIMAC
* SOURCE      - JCSBP
* PROGRAM     - OPS.CAT.LIST
* BY          - CINDY STRAIT
* DATE        - 02/21/97
* DESCRIPTION - Creates an OSP category listing
*T26090 ajibaly 03/21/2002 * CONVERT TO REV12 RPT.SCRN
*********************************************************************
*COPY>JCS.CPYLIB>CATEGORY.OSP
*COPY>PMC.CPYLIB>COMPANY
*COPY>CPYLIB>CHAR
*
*---OPEN FILES
*
OPEN "","CATEGORY.OSP" TO CATEGORY.OSP ELSE ERRMSG = "CATEGORY.OSP FILE IS MISSING"; GOTO 93000
OPEN "","COMPANY" TO COMPANY ELSE ERRMSG = "COMPANY FILE IS MISSING"; GOTO 93000
*
*
*---- PERFORM PROCREAD
*
PROCREAD BUFFER ELSE ERRMSG = "MUST RUN FROM A PROC"; GOSUB 93000; GOTO 99999
CONO = BUFFER<1>
*T26090 v
*CONO.NAME = BUFFER<2>
*REPORT.NAME = "OSP CATEGORY LISTING"
CONO.NAME = ''
REPORT.NAME = ''
*T26090 ^
REPORT.NUMBER = BUFFER<2>
REPORT.DATE = DATE()
HD1 = "" ; HD2 = ""
*
*---- GET HEADING
*
PRINTER ON
CALL GET.PROG.HEAD(CONO,CONO.NAME,REPORT.NAME,REPORT.NUMBER,REPORT.DATE,HD1,HD2)
H.LINE = "CATG " "L#6":SPACE(1)
H.LINE = H.LINE:"    DESCRIPTION" "L#20":SPACE(1)
H.LINE = H.LINE:"M-LINE" "L#7":SPACE(1)
H.LINE = H.LINE:"DAYS" "L#4":SPACE(1)
H.LINE = H.LINE:"COST OF GOODS" "L#12":SPACE(1)
H.LINE = H.LINE:"WORK IN PROCESS" "L#15":SPACE(1)
H.LINE = H.LINE:"DIR APPLIED" "L#12":SPACE(1)
H.LINE = H.LINE:"   FOH COGS" "L#12":SPACE(1)
H.LINE = H.LINE:" GOH APPLIED" "L#12":SPACE(1)
H.LINE = H.LINE:"FFOH %" "L#6":SPACE(1)
H.LINE = H.LINE:"MRKUP%"
H.LINE2 = " " "L#40":SPACE(1)
H.LINE2 = H.LINE2:" ACCRU LIAB" "L#12":SPACE(1)
H.LINE2 = H.LINE2:" ACCT PAYABLE" "L#15"
UL1 = "-" "L-6":SPACE(1)
UL1 = UL1:"-" "L-20":SPACE(1)
UL1 = UL1:"-" "L-7":SPACE(1)
UL1 = UL1:"-" "L-4":SPACE(1)
UL1 = UL1:"-" "L-12":SPACE(1)
UL1 = UL1:"-" "L-15":SPACE(1)
UL1 = UL1:"-" "L-12":SPACE(1)
UL1 = UL1:"-" "L-12":SPACE(1)
UL1 = UL1:"-" "L-12":SPACE(1)
UL1 = UL1:"-" "L-6":SPACE(1)
UL1 = UL1:"-" "L-6"
HEADING HD1:"'PL'":HD2:"'LL'":H.LINE:"'L'":H.LINE2:"'L'":UL1:"'L'"
*
*---MAIN PROCESSING
*
MATREAD COMP.REC FROM COMPANY,CONO ELSE MAT COMP.REC = ''
MORE.DATA = 1
LOOP
  READNEXT ID ELSE MORE.DATA = 0
WHILE MORE.DATA DO
  MATREAD CAOS.REC FROM CATEGORY.OSP,ID ELSE GOTO 100
  PRINT ID[4,99] "L#6 ":
  PRINT CAOS.DESC "L#20 ":
  PRINT CAOS.MAJ.LINE "L#7 ":
  PRINT CAOS.LEAD.TIME "L#4 ":
  PRINT CAOS.COG CO.ACCT.MASK "L#12 ":
  PRINT CAOS.WIP CO.ACCT.MASK "L#15 ":
  PRINT CAOS.APL CO.ACCT.MASK "L#12 ":
  PRINT CAOS.FOH CO.ACCT.MASK "L#12 ":
  PRINT CAOS.FOH.APL CO.ACCT.MASK "L#12 ":
  PRINT OCONV(CAOS.FOH.PCT,"MD2") "R#6 ":
  PRINT OCONV(CAOS.MARKUP,"MD2") "R#6"
  PRINT " " "L#42":
  PRINT CAOS.ACCRU.LIAB CO.ACCT.MASK "L#12 ":
  PRINT CAOS.AP.ACCT CO.ACCT.MASK "L#15 "
100 *
REPEAT
GOTO 99999
93000 *
PRINT @(0,23):CL:ERRMSG:
INPUT REPLY:
99999 * PRINT @(-1)
PRINTER OFF
PRINTER CLOSE
END
