SUBROUTINE RPC.XFER.DATA(ARRAY, VALUE, ERROR)
 INCLUDE TUBP USER.INCLUDE.H
*
** SBClient Host 3GL API
** Copyright (C) Ardent Software Inc. 1998
** Copyright (C) UniData, Inc. 1996, 1997
** Copyright (C) System Builder Corporation. 1995
**
**      This software is the proprietary property and contains
**      trade secrets of Ardent Software, Inc. Any unauthorized use,
**      disclosure or duplication is strictly prohibited.
**      All rights reserved.
*
*
* Description : GUI Report Display
*
** ARRAY<1> contains the ID of the TUXFER.DATA.xx file
** ARRAY<2> contains the count of the number of attributes (or ZERO for all)
** ARRAY<3> contains the first attribute to return (or ZERO for first)
*
 INCLUDE TUBP ROC.H
*
 INCLUDE TUBP SPECIAL.H
*
 INCLUDE TUBP TU.API.H
*
 INCLUDE TUBP HEADER.H
*
*
OPEN '',"TUXFER.DATA.":PORTNO TO TUXFER.DATA ELSE
VALUE = "TUXFER.DATA.":PORTNO:" is not a filename"
ERROR = 1
RETURN
END
READ HEADER FROM TUXFER.DATA,"XFER.HEADER" ELSE
VALUE = 'no report waiting'
ERROR = 1
RETURN
END
FIRSTAMC = ARRAY<3>
AMC = ARRAY<2>
ID = ARRAY<1>
READ VALUE FROM TUXFER.DATA,'XFER.DATA.':ID ELSE
VALUE = 'XFER.DATA.':ID:' not on file'
ERROR = 1
RETURN
END
IF FIRSTAMC > 1 THEN
P = INDEX(VALUE, AM, FIRSTAMC)
IF P THEN
VALUE = VALUE[P + 1, 32000]
END ELSE
VALUE = NUL
END
END
IF AMC THEN
P = INDEX(VALUE, AM, AMC)
IF P THEN
VALUE = VALUE[1, P - 1]
END ELSE
AMC = COUNT(VALUE, AM) + (VALUE # NUL)
END
END ELSE
AMC = COUNT(VALUE, AM) + (VALUE # NUL)
END
FIELDCOUNT = COUNT(VALUE<1>, VM) + (VALUE # NUL)
FOR AC = 1 TO AMC
FOR H = 1 TO FIELDCOUNT
IF HEADER<HED.OCONV, H> # NUL AND VALUE<AC, H> # NUL THEN
VALUE<AC, H> = OCONV(ICONV(VALUE<AC, H>, HEADER<HED.OCONV, H>), HEADER<HED.OCONV, H>)
END
NEXT H
NEXT AC
CALL TU.CONVERT(AM, CR, VALUE)
*MG*      CALL TU.CONVERT(VM, TAB, VALUE) ;* We now convert these at DataC++ level
RETURN
END
