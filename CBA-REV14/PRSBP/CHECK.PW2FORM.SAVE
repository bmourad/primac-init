******************************************************
* REVISION    - [08.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM        - PRIMAC
* SOURCE        - APSBP
* PROGRAM       - CHECK.PW2FORM.SAVE
* BY            - JIHAD YAMOUT , C.B.A
* DATE          - 07/30/85
* DESCRIPTION   - This program check if BACKUP W2 was run before for the 
*                 company spacified in the proc.
*ENDDOC
******************************************************
* 
**** READ ALL PROC BUFFER
*
10*
      PROCREAD ALL ELSE 
       ERRMSG = "MUST RUN FROM A PROC"
       GOSUB 90 ; GOTO 999
      END
      CONO = ALL<1> ; CONO.NAME = ALL<2> ; FILE.NAME = ALL<3>
      OPEN "",FILE.NAME TO FM ELSE
        ERRMSG = "CAN'T OPEN FILE ":FILE.NAME
        ALL<3> = "END" ; GOSUB 90 ; GOTO 99
      END
*
**** CHECK IF RECORD ON FILE FOR SPECIFIED COMPANY
*
20*
      READNEXT ID ELSE 
       GOTO 99
      END
      IF CONO = ID[1,3] THEN
         ALL<3> = "END"
         GOTO 99
      END
      GOTO 20
*
**** PRINT ERRMSG AND WRITE PROC ANS END THE PROGRAM
*
90*
    PRINT @(0,23):SPACE(79)
    PRINT @(0,23):ERRMSG:
    INPUT X:
    RETURN
99*
    PROCWRITE ALL
999*
    END
