*********************************************************************
* REVISION    - [14.0]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SYSTEM      - PRIMAC
* SOURCE      - TCPBP
* PROGRAM     - PRESS.PROD.RPT
* DATE        - 08/25/2010
* BY          - ABDUL GAFOOR , CBA
* DESCRIPTION - 
*ENDDOC
*********************************************************************
*COPY>CPYLIB>SYSCOM
*COPY>ICS.CPYLIB>INV.CNV
*COPY>JCS.CPYLIB>JOB
*COPY>PMC.CPYLIB>CUSTOMER
*COPY>PMC.CPYLIB>COST.CNTR
*COPY>JCS.CPYLIB>OPERATION
*COPY>ICS.CPYLIB>INVENTORY
*COPY>ICS.CPYLIB>CATEGORY
*COPY>JCS.CPYLIB>JOB.TIME ;*CODE CHANGED
*COPY>JCS.CPYLIB>JOB.MATL ;*CODE CHANGED
*COPY>CPYLIB>CHAR
*
*--- SET UP THE ERRMSG ROUTINE FOR SYSCOM
*
SYS.TYPE = 1
CALL SYSCOM(MAT SYSCOM.REC)
*
*--- PROCREAD
*
PROCREAD ID ELSE
  ERRMSG = ' CANNOT PERFORM PROCREAD'
  GOTO 93000
END
CONO = ID<1>
REPORT.NUMBER = ID<2>
DPT.NO = ID<3>
CCTR.NO = ID<4>
SDATE = ID<5>
EDATE = ID<6>
DIV.NO = ID<7>
CUST.NO = ID<8>
JOB.NO = ID<9>
*
*--- OPEN THE FILE
*
OPEN '','JOB' TO JOB ELSE ERRMSG = 'JOB FILE IS MISSING'; GOTO 93000
OPEN '','CUSTOMER' TO CUSTOMER ELSE ERRMSG = 'CUSTOMER FILE IS MISSING'; GOTO 93000
OPEN '','COST.CNTR' TO COST.CNTR ELSE ERRMSG = 'COST.CNTR FILE IS MISSING'; GOTO 93000
OPEN '','OPERATION' TO OPERATION ELSE ERRMSG = 'OPERATION FILE IS MISSING'; GOTO 93000
OPEN '','INVENTORY' TO INVENTORY ELSE ERRMSG = 'INVENTORY FILE IS MISSING'; GOTO 93000
OPEN '','CATEGORY' TO CATEGORY ELSE ERRMSG = 'CATEGORY FILE IS MISSING'; GOTO 93000
OPEN '','JOB.TIME' TO JOB.TIME ELSE ERRMSG = 'JOB.TIME FILE IS MISSING'; GOTO 93000 ;*CODE CHANGED
OPEN '','JOB.MATL' TO JOB.MATL ELSE ERRMSG = 'JOB.MATL FILE IS MISSING'; GOTO 93000 ;*CODE CHANGED
OPEN '','CONTROL' TO CONTROL ELSE ERRMSG = 'CONTROL FILE IS MISSING'; GOTO 93000
*GFR = ""
*GFR<1> = "PAGE RESIZING "; WRITE GFR ON CONTROL,"092410"
*
*--- SETUP HEADERS
*
H1.LINE = SPACE(79):"<---- WASTE ---->  RUN ":SPACE(18):"<- HOURS ->"
H2.LINE = "  DATE   S  JOB NO     CUSTOMER    CL     PRODUCT      IMPRESSION   NET COUNT     MR       MR%    HOURS   IMP/HR NET/HR  WASH   M/R"
H3.LINE = "-------- - -------- -------------- --- --------------- ----------- ----------- --------- ------- -------- ------ ------ ----- -----"
DT.LINE = " THROUGH "
DT1.LINE = "----------- ----------- --------- ------- -------- ------ ------ ----- -----"
CONO.NAME = ""
REPORT.NAME = ""
REPORT.DATE = DATE()
HD1 = "" ; HD2 = ""
CALL GET.PROG.HEAD(CONO,CONO.NAME,REPORT.NAME,REPORT.NUMBER,REPORT.DATE,HD1,HD2)
*
*--- INITIALIZATION
*
*PRINT.FLAG = ""; ERR.FLAG = ""; OPEN.FLAG = 1 *DELETE IT
PAGE.NO = 0 ; SP1 = " "; ERRMSG = ""
TOT.IMPR = 0; TOT.NET.CNT = 0; TOT.MR = 0; TOT.MR.PRCNT = 0;TOT.RUN.HRS = 0
TOT.IMP.PER.HR = 0 ;TOT.NET.PER.HR = 0 ;TOT.LINE = "";CCTR.CHANGED = 0;TEMP.CCTR = "";TEMP.CCTR.DESC = "";PREV.CCTR = "";PREV.CCTR.DESC = ""
TOT.MR.RUN.HRS = 0;TOT.WASH.RUN.HRS=0 ; TEMP.STR.ID = "";PREV.TEMP.STR.ID = "" ;COMMON.JOB.LINE = ""
JTOT.IMPR = 0;JTOT.NET.CNT=0;JTOT.MR=0;JTOT.MR.PRCNT=0;JTOT.RUN.HRS=0;JTOT.IMP.PER.HR=0;JTOT.NET.PER.HR=0;JTOT.MR.RUN.HRS=0;JTOT.WASH.RUN.HRS=0
JTOT.RPT.DATE = "";JTOT.SHIFT = "";JTOT.TEMP.JOB = "";JTOT.CUST = "";JTOT.JOB.CLR = "";JTOT.PROD = "";JOB.CHANGE=0;TOP.HEADING=0;CALC.TOT.IMPR = 0; CALC.TOT.NET.CNT = 0
ALIGN = ""
TEMP.JTM.ID = "" ;*CODE CHANGED
MAT JLB.REC = "" ;*CODE CHANGED
*
*--- MAIN PROCESS
*
PRINTER ON
100*
DATA = 0; INSERT.HEADING = 1;LINE.CNT = 0 ; PAGE.SIZE = 45
JOB.TIME.IDS = ""
LOOP
  READNEXT KEY ELSE DATA = 1
WHILE DATA = 0 DO
  JOB.TIME.IDS<1,-1> = KEY
REPEAT
UDTEXECUTE "CLEARSELECT" CAPTURING JUNK
FOR I = 1 TO DCOUNT(JOB.TIME.IDS,VM)
  PROD = "";CUST = "";UNITS = "";MR = 0;MR.PRCNT = 0 ; CALC.UNITS = 0;CALC.MR = 0
  NET.COUNTS = 0; RUN.HRS = "";IMPR.PER.HRS = 0;NET.PER.HRS = 0; PRNT.CHR = 0
  TEMP.JOB = 0; SHIFT = "" ; JOB.CLR = "";HRS.DIFF = ""
  MR.RUN.HRS = "";WASH.RUN.HRS = "";LINE.TO.DISPLAY.TOTAL = 0;LINE.TO.DISPLAY=0
  MR.JLB.IMP = 0
  KEY = JOB.TIME.IDS<1,I>
  MATREAD JLB.REC FROM JOB.TIME,KEY ELSE
    MAT JLB.REC = ''
    GOTO 111
  END
  MATREAD OPER.REC FROM OPERATION,CONO:JLB.OPER ELSE
    MAT OPER.REC = ''
    GOTO 111
  END
  JLB_JOB = FIELD(KEY,"!",1)[4,10]
  JLB_DEPT = FIELD(KEY,"!",2)
  JLB_CCTR = FIELD(KEY,"!",3)
  JLB_SEQ = FIELD(KEY,"!",4)
  JLB_PROD = ""
  IF JLB_JOB = "" THEN GOTO 111
  MATREAD JOB.REC FROM JOB,CONO:JLB_JOB ELSE
    MAT JOB.REC = ''
  END
* READ JOB PRODUCT v
  FOR JB = 1 TO DCOUNT(JOB.MT.PROD,VM)
    JLB_PROD = JOB.MT.PROD<1,JB>
    MATREAD INV.REC FROM INVENTORY,CONO:JLB_PROD ELSE
      MAT INV.REC = ''
      JLB_PROD = ""
    END
    READV CATG.TYPE FROM CATEGORY,CONO:INV.LINE,8 ELSE CATG.TYPE = ""
    IF JLB_PROD # "" AND CATG.TYPE # "L" AND CATG.TYPE # "S" AND CATG.TYPE # "RL" AND CATG.TYPE # "PC" THEN
      JLB_PROD = ""
    END
  NEXT JB
* READ JOB PRODUCT ^
  READV CUST.NAME FROM CUSTOMER,CONO:JOB.CUST,1 ELSE CUST.NAME = ''
  MATREAD CCTR.REC FROM COST.CNTR,CONO:JLB_CCTR ELSE
    MAT CCTR.REC = ''
    GOTO 111
  END
  T.DATE = JLB.DATE
  SHIFT = JLB.SHIFT
  ELAP.HRS = JLB.HRS
  IF ELAP.HRS = "" THEN GOTO 111
  IF OPER.GROUP = "R" OR OPER.GROUP = "RUN" THEN
    RUN.HRS += ELAP.HRS
    RUN.HRS = OCONV(RUN.HRS,"MD2")
  END ELSE
    IF OPER.GROUP = "M" OR OPER.GROUP = "MR" THEN
      MR.RUN.HRS += ELAP.HRS
      MR.RUN.HRS = OCONV(MR.RUN.HRS,"MD2")
      MR.JLB.IMP += JLB.IMP ; *ARIEF
      IF MR.JLB.IMP # "" AND MR.JLB.IMP # 0 THEN
        MR.JLB.IMP = MR.JLB.IMP/100 ; *ARIEF
      END
    END ELSE
      IF OPER.GROUP = "W" OR OPER.GROUP = "WASH" THEN
        WASH.RUN.HRS += ELAP.HRS
        WASH.RUN.HRS = OCONV(WASH.RUN.HRS,"MD2")
      END
    END
  END
  RPT.DATE = JLB.DATE
  IF JLB.IMP # "" THEN
    UNITS = JLB.IMP / 100
    CALC.UNITS = UNITS
  END 
  TEMP.JOB = JLB_JOB
  PROD = JLB_PROD[1,15]
  CUST = CUST.NAME[1,14]
  SHIFT = JLB.SHIFT
  JOB.CLR = JOB.COLORS
  IF JLB.PRMPT.CODE # "" THEN
    LOCATE "71" IN JLB.PRMPT.CODE<1>,1 SETTING INDX ELSE INDX = 0
    IF INDX THEN
      NET.COUNTS = JLB.PRMPT.RESP<1,INDX> / 100
    END
  END ELSE
    NET.COUNTS = 0
  END
  IF CALC.UNITS # "" AND CALC.UNITS # 0 THEN
*ARIEF v
*    CALC.MR = CALC.UNITS - NET.COUNTS
*    MR = CALC.MR
    MR = MR.JLB.IMP
*ARIEF ^
  END 
  IF CALC.UNITS # 0 OR NET.COUNTS # 0 OR MR # 0 OR MR.PRCNT # 0 OR IMPR.PER.HRS # 0 OR NET.PER.HRS # 0 THEN
    LINE.TO.DISPLAY.TOTAL = CALC.UNITS + NET.COUNTS + MR + MR.PRCNT + IMPR.PER.HRS + NET.PER.HRS
  END
  IF (LINE.TO.DISPLAY.TOTAL + 0 ) # 0 THEN
    LINE.TO.DISPLAY = 1
  END
*GFR<-1>="LINE.TO.DISPLAY ":LINE.TO.DISPLAY :" TOP.HEADING ":TOP.HEADING; WRITE GFR ON CONTROL,"092410"
  IF LINE.TO.DISPLAY THEN
    IF NOT(TOP.HEADING) THEN
*GFR<-1>="PRINT.HEADING IN TOP"; WRITE GFR ON CONTROL,"092410"
      GOSUB PRINT.HEADING
      TOP.HEADING = 1
    END
    IF LINE.CNT LT PAGE.SIZE THEN
      LINE.CNT += 1
*GFR<-1>="IN IF LINE.CNT ":LINE.CNT; WRITE GFR ON CONTROL,"092410"
    END ELSE
      LINE.CNT = 1
*GFR<-1>="IN ELSE PRINT HEADING "; WRITE GFR ON CONTROL,"092410"
      PRINT ""
      GOSUB PRINT.HEADING
    END
    TEMP.STR.ID = T.DATE:SHIFT:TEMP.JOB
    IF TEMP.STR.ID # "" AND PREV.TEMP.STR.ID # "" AND TEMP.STR.ID # PREV.TEMP.STR.ID THEN
      GOSUB CALC.JTOT.PER.HR
      GOSUB DISPLAY.LINE.VALUE
      COMMON.JOB.LINE = 0
      GOSUB GET.JOB.TOTALS
      GOSUB GET.CCTR.TOTALS
      PREV.TEMP.STR.ID =  TEMP.STR.ID
      JOB.CHANGE = 1
    END ELSE
      COMMON.JOB.LINE = 1
      GOSUB GET.JOB.TOTALS
      PREV.TEMP.STR.ID =TEMP.STR.ID
      GOSUB GET.CCTR.TOTALS
    END
    IF TEMP.CCTR # JLB_CCTR THEN
      IF TEMP.CCTR # "" THEN 
        CCTR.CHANGED = 1
        PREV.CCTR = TEMP.CCTR
        PREV.CCTR.DESC = TEMP.CCTR.DESC
        GOSUB CALC.TOT.PER.HR
        GOSUB ALIGN.TOT.LINE
        GOSUB DISPLAY.CCTR.TOTALS
*GFR<-1>="IN CCTR CHAGNE TEMP.CCTR ":TEMP.CCTR :" LINE.CNT ":LINE.CNT; WRITE GFR ON CONTROL,"092410"
        GOSUB PRINT.HEADING
        TOT.IMPR = 0; TOT.NET.CNT = 0; TOT.MR = 0; TOT.MR.PRCNT = 0
        TOT.RUN.HRS = 0;TOT.IMP.PER.HR = 0 ;TOT.NET.PER.HR = 0
        CALC.TOT.IMPR = 0; CALC.TOT.NET.CNT = 0
      END
      TEMP.CCTR = JLB_CCTR
      TEMP.CCTR.DESC = CCTR.DESC
      GOSUB GET.CCTR.TOTALS
    END
  END
  PLINE =  ""
111*
*REPEAT
NEXT I
*
IF DATA AND (LINE.CNT GT 0) THEN
  COMMON.JOB.LINE = 1
  LINE.TO.DISPLAY = 1
  GOSUB CALC.JTOT.PER.HR
  GOSUB DISPLAY.LINE.VALUE
  PREV.CCTR = JLB_CCTR
  PREV.CCTR.DESC = CCTR.DESC
  GOSUB CALC.TOT.PER.HR
  GOSUB ALIGN.TOT.LINE
  GOSUB DISPLAY.CCTR.TOTALS
END
GOTO 999999
*
*--- SUBROUTINES
*
**************
PRINT.HEADING: 
**************
*
PAGE.NO = PAGE.NO + 1
PRINT HD1:PAGE.NO
PRINT HD2
PRINT SPACE(62):SDATE:DT.LINE:EDATE:SPACE(44)
H.LINE = ""
H.LINE = H.LINE : "PRESS: ":CCTR.DESC
PRINT H.LINE
PRINT H1.LINE
PRINT H2.LINE
PRINT H3.LINE
*LINE.COUNT = 9
HDR.FLG = 1
LINE.CNT = 7
RETURN
*
********************
DISPLAY.CCTR.TOTALS: 
********************
IF LINE.TO.DISPLAY THEN
  PRINT SPACE(55):DT1.LINE
  PREV.CCTR = TEMP.CCTR
  VALUE = TEMP.CCTR.DESC[1,15] ; PRNT.CHR = 15 ;GOSUB FORMAT.VALUE ;PREV.CCTR.DESC = VALUE
  PRINT SPACE(15):"TOTALS FOR ":PREV.CCTR:" - ":PREV.CCTR.DESC:SPACE(8):TOT.LINE
  PRINT
END
RETURN
*
******************
ALIGN.LINE: 
******************
*
T.UNITS = OCONV(T.UNITS,"MD0,")
T.NET.COUNTS = OCONV(T.NET.COUNTS,"MD0,")
T.MR = OCONV(T.MR,"MD0,")
IF T.MR.PRCNT # "" AND T.MR.PRCNT # 0 THEN
  T.MR.PRCNT = T.MR.PRCNT:"%"
END
T.IMPR.PER.HRS = OCONV(T.IMPR.PER.HRS,"MD0,")
T.NET.PER.HRS = OCONV(T.NET.PER.HRS,"MD0,")
VALUE = T.SHIFT ; PRNT.CHR = 1;ALIGN = "L" ;GOSUB FORMAT.VALUE ;T.SHIFT = VALUE
VALUE = T.TEMP.JOB ; PRNT.CHR = 8;ALIGN = "R" ;GOSUB FORMAT.VALUE ;T.TEMP.JOB = VALUE
VALUE = T.CUST ; PRNT.CHR = 14;ALIGN = "L" ;GOSUB FORMAT.VALUE ; T.CUST = VALUE
VALUE = T.JOB.CLR ; PRNT.CHR = 3;ALIGN = "R" ;GOSUB FORMAT.VALUE ; T.JOB.CLR = VALUE
VALUE = T.PROD ; PRNT.CHR = 15;ALIGN = "L" ;GOSUB FORMAT.VALUE ; T.PROD = VALUE
VALUE = T.UNITS ; PRNT.CHR = 11 ;ALIGN = "R";GOSUB FORMAT.VALUE ; T.UNITS = VALUE
VALUE = T.NET.COUNTS ; PRNT.CHR = 11;ALIGN = "R" ;GOSUB FORMAT.VALUE ;T.NET.COUNTS = VALUE
VALUE = T.MR ; PRNT.CHR = 9;ALIGN = "R" ;GOSUB FORMAT.VALUE ;T.MR = VALUE
VALUE = T.MR.PRCNT ; PRNT.CHR = 7;ALIGN = "R" ;GOSUB FORMAT.VALUE ;T.MR.PRCNT = VALUE
VALUE = T.RUN.HRS ; PRNT.CHR = 8;ALIGN = "R" ;GOSUB FORMAT.VALUE ;T.RUN.HRS = VALUE
VALUE = T.IMPR.PER.HRS ; PRNT.CHR = 6;ALIGN = "R" ;GOSUB FORMAT.VALUE ;T.IMPR.PER.HRS = VALUE
VALUE = T.NET.PER.HRS ; PRNT.CHR = 6;ALIGN = "R" ;GOSUB FORMAT.VALUE ;T.NET.PER.HRS = VALUE
VALUE = T.MR.RUN.HRS ; PRNT.CHR = 5;ALIGN = "R" ;GOSUB FORMAT.VALUE ;T.MR.RUN.HRS = VALUE
VALUE = T.WASH.RUN.HRS ; PRNT.CHR = 5;ALIGN = "R" ;GOSUB FORMAT.VALUE ;T.WASH.RUN.HRS = VALUE
PLINE = OCONV(T.RPT.DATE,'D2/'):SPACE(1):T.SHIFT:SPACE(1):T.TEMP.JOB:SPACE(1):T.CUST:SPACE(1):T.JOB.CLR:SPACE(1):T.PROD:SPACE(1):T.UNITS:SPACE(1):T.NET.COUNTS:SPACE(1):T.MR:SPACE(1):T.MR.PRCNT:SPACE(1):T.RUN.HRS:SPACE(1):T.IMPR.PER.HRS:SPACE(1):T.NET.PER.HRS:SPACE(1):T.WASH.RUN.HRS:SPACE(1):T.MR.RUN.HRS
PRINT PLINE
RETURN
*
*************
FORMAT.VALUE: 
*************
*
IF VALUE # "" AND VALUE # 0 THEN
  IF ALIGN = "L" THEN
    VALUE = VALUE:STR(SPACE(1),PRNT.CHR - LEN(VALUE))
  END ELSE
    VALUE = STR(SPACE(1),PRNT.CHR - LEN(VALUE)):VALUE
  END
END ELSE
  VALUE = SPACE(PRNT.CHR)
END
RETURN
*
****************
GET.CCTR.TOTALS: 
****************
*
IF TEMP.CCTR = JLB_CCTR THEN
  TOT.IMPR += UNITS
  TOT.NET.CNT += NET.COUNTS
  CALC.TOT.IMPR += UNITS
  CALC.TOT.NET.CNT += NET.COUNTS
  TOT.MR += MR
  TOT.RUN.HRS += ICONV(RUN.HRS,"MD2")
  TOT.MR.RUN.HRS += ICONV(MR.RUN.HRS,"MD2")
  TOT.WASH.RUN.HRS += ICONV(WASH.RUN.HRS,"MD2")
END
RETURN
*
****************
CALC.TOT.PER.HR: 
****************
*
TOT.RUN.HRS = OCONV(TOT.RUN.HRS,"MD2")
TOT.MR.RUN.HRS = OCONV(TOT.MR.RUN.HRS,"MD2")
TOT.WASH.RUN.HRS = OCONV(TOT.WASH.RUN.HRS,"MD2")
IF CALC.TOT.IMPR # "" AND TOT.RUN.HRS # "" AND TOT.RUN.HRS # 0 THEN
  TOT.IMP.PER.HR = INT(CALC.TOT.IMPR / (TOT.RUN.HRS + TOT.MR.RUN.HRS)) ;*CODE CHANGED
END
IF CALC.TOT.NET.CNT # "" AND TOT.RUN.HRS # "" AND TOT.RUN.HRS # 0 THEN
  TOT.NET.PER.HR = INT(CALC.TOT.NET.CNT / TOT.RUN.HRS)
END
*AS PER BILL v
*IF TOT.MR # "" AND TOT.MR # 0 AND CALC.TOT.NET.CNT # "" AND CALC.TOT.NET.CNT # 0 THEN
IF TOT.MR # "" AND TOT.MR # 0 THEN
*  TOT.MR.PRCNT = (TOT.MR * 100 /CALC.TOT.NET.CNT)
  TOT.MR.PRCNT = (TOT.MR * 100 /CALC.TOT.IMPR)
  TOT.MR.PRCNT = OCONV(ICONV(TOT.MR.PRCNT,"MD2"),"MD2")
END
*AS PER BILL ^
RETURN
*
*****************
CALC.JTOT.PER.HR: 
*****************
*
JTOT.RUN.HRS = OCONV(JTOT.RUN.HRS,"MD2")
JTOT.MR.RUN.HRS = OCONV(JTOT.MR.RUN.HRS,"MD2")
JTOT.WASH.RUN.HRS = OCONV(JTOT.WASH.RUN.HRS,"MD2")
IF JTOT.IMPR # "" AND JTOT.RUN.HRS # "" AND JTOT.RUN.HRS # 0 THEN
  JTOT.IMP.PER.HR = INT(JTOT.IMPR / (JTOT.RUN.HRS + JTOT.MR.RUN.HRS)) ;*CODE CHANGED
END
IF JTOT.NET.CNT # "" AND JTOT.RUN.HRS # "" AND JTOT.RUN.HRS # 0 THEN
  JTOT.NET.PER.HR = INT(JTOT.NET.CNT / JTOT.RUN.HRS)
END
*AS PER BILL v
*IF JTOT.MR # "" AND JTOT.MR # 0 AND JTOT.NET.CNT # "" AND JTOT.NET.CNT # 0 THEN
IF JTOT.MR # "" AND JTOT.MR # 0 THEN
*  JTOT.MR.PRCNT = (JTOT.MR * 100 /JTOT.NET.CNT)
  JTOT.MR.PRCNT = (JTOT.MR * 100 /JTOT.IMPR);*AS PER BILL
  JTOT.MR.PRCNT = OCONV(ICONV(JTOT.MR.PRCNT,"MD2"),"MD2")
END
*AS PER BILL ^
RETURN
*
***************
GET.JOB.TOTALS: 
***************
*
JTOT.RPT.DATE = RPT.DATE
JTOT.SHIFT = SHIFT
JTOT.TEMP.JOB = TEMP.JOB
JTOT.CUST = CUST
JTOT.JOB.CLR = JOB.CLR
JTOT.PROD = PROD
JTOT.IMPR += UNITS
JTOT.NET.CNT += NET.COUNTS
JTOT.MR += MR
JTOT.RUN.HRS += ICONV(RUN.HRS,"MD2")
JTOT.MR.RUN.HRS += ICONV(MR.RUN.HRS,"MD2")
JTOT.WASH.RUN.HRS += ICONV(WASH.RUN.HRS,"MD2")
RETURN
*
***************
ALIGN.TOT.LINE: 
***************
*
TOT.IMPR = OCONV(TOT.IMPR,"MD0,")
TOT.NET.CNT = OCONV(TOT.NET.CNT,"MD0,")
TOT.MR = OCONV(TOT.MR,"MD0,")
IF TOT.MR.PRCNT # "" AND TOT.MR.PRCNT # 0 THEN
  TOT.MR.PRCNT = TOT.MR.PRCNT:"%"
END
TOT.IMP.PER.HR = OCONV(TOT.IMP.PER.HR,"MD0,")
TOT.NET.PER.HR = OCONV(TOT.NET.PER.HR,"MD0,")
VALUE = TOT.IMPR ; PRNT.CHR = 11 ;GOSUB FORMAT.VALUE ; TEMP.TOT.IMPR = VALUE
VALUE = TOT.NET.CNT ; PRNT.CHR = 11 ;GOSUB FORMAT.VALUE ;TEMP.TOT.NET.CNT = VALUE
VALUE = TOT.MR ; PRNT.CHR = 9 ;GOSUB FORMAT.VALUE ;TEMP.TOT.MR = VALUE
VALUE = TOT.MR.PRCNT ; PRNT.CHR = 7 ;GOSUB FORMAT.VALUE ;TEMP.TOT.MR.PRCNT = VALUE
VALUE = TOT.RUN.HRS ; PRNT.CHR = 8 ;GOSUB FORMAT.VALUE ;TEMP.TOT.RUN.HRS = VALUE
VALUE = TOT.IMP.PER.HR ; PRNT.CHR = 6 ;GOSUB FORMAT.VALUE ;TEMP.TOT.IMP.PER.HR = VALUE
VALUE = TOT.NET.PER.HR ; PRNT.CHR = 6 ;GOSUB FORMAT.VALUE ;TEMP.TOT.NET.PER.HR = VALUE
VALUE = TOT.MR.RUN.HRS ; PRNT.CHR = 5 ;GOSUB FORMAT.VALUE ;TEMP.TOT.MR.RUN.HRS = VALUE
VALUE = TOT.WASH.RUN.HRS ; PRNT.CHR = 5 ;GOSUB FORMAT.VALUE ;TEMP.TOT.WASH.RUN.HRS = VALUE
TOT.LINE = TEMP.TOT.IMPR:SPACE(1):TEMP.TOT.NET.CNT:SPACE(1):TEMP.TOT.MR:SPACE(1):TEMP.TOT.MR.PRCNT:SPACE(1):TEMP.TOT.RUN.HRS:SPACE(1):TEMP.TOT.IMP.PER.HR:SPACE(1):TEMP.TOT.NET.PER.HR:SPACE(1):TEMP.TOT.WASH.RUN.HRS:SPACE(1):TEMP.TOT.MR.RUN.HRS
TOT.IMPR = 0;TOT.NET.CNT=0;TOT.MR=0;TOT.MR.PRCNT=0;TOT.RUN.HRS=0;TOT.IMP.PER.HR=0
TOT.NET.PER.HR=0;TOT.MR.RUN.HRS=0;TOT.WASH.RUN.HRS=0
TEMP.TOT.IMPR = 0;TEMP.TOT.NET.CNT=0;TEMP.TOT.MR=0;TEMP.TOT.MR.PRCNT=0;TEMP.TOT.RUN.HRS=0;TEMP.TOT.IMP.PER.HR=0
TEMP.TOT.NET.PER.HR=0;TEMP.TOT.MR.RUN.HRS=0;TEMP.TOT.WASH.RUN.HRS=0
RETURN
*
*******************
DISPLAY.LINE.VALUE: 
*******************
*
IF COMMON.JOB.LINE OR JOB.CHANGE THEN
  T.RPT.DATE = JTOT.RPT.DATE 
  T.SHIFT = JTOT.SHIFT
  T.TEMP.JOB = JTOT.TEMP.JOB
  T.CUST = JTOT.CUST
  T.JOB.CLR = JTOT.JOB.CLR
  T.PROD = JTOT.PROD
  T.UNITS = JTOT.IMPR
  T.NET.COUNTS = JTOT.NET.CNT
  T.MR = JTOT.MR
  T.MR.PRCNT = JTOT.MR.PRCNT
  T.RUN.HRS = JTOT.RUN.HRS
  T.IMPR.PER.HRS = JTOT.IMP.PER.HR
  T.NET.PER.HRS = JTOT.NET.PER.HR
  T.MR.RUN.HRS = JTOT.MR.RUN.HRS
  T.WASH.RUN.HRS = JTOT.WASH.RUN.HRS
  GOSUB ALIGN.LINE
  JTOT.RPT.DATE = "";JTOT.SHIFT = 0;JTOT.TEMP.JOB=0;JTOT.CUST=0;JTOT.JOB.CLR=0
  JTOT.IMPR=0;JTOT.NET.CNT=0;JTOT.MR=0;JTOT.MR.PRCNT=0;JTOT.RUN.HRS=0;JTOT.IMP.PER.HR=0
  JTOT.NET.PER.HR=0;JTOT.MR.RUN.HRS=0;JTOT.WASH.RUN.HRS=0;JOB.CHANGE=0
END
RETURN
*
**********
*CALC.HRS: 
**********
**
*IF ETIME < STIME THEN ETIME=ETIME+2400
*ELAP.MIN=(INT(ETIME/100)*60+MOD(ETIME,100))-(INT(STIME/100)*60+MOD(STIME,100))
*ELAP.HRS=INT(ELAP.MIN*100/60+0.5)
*RETURN
*
*--- CALLS FOR SYSCOM
*
91000*
ERR.TYPE = 1; CALL SYSCOM(MAT SYSCOM.REC)
RETURN
92000*
ERR.TYPE = 2; CALL SYSCOM(MAT SYSCOM.REC)
RETURN
93000*
ERR.TYPE = 3; CALL SYSCOM(MAT SYSCOM.REC)
999999*
PRINTER OFF
END
