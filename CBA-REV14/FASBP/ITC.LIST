*********************************************************************
* REVISION    - [08.1]
* Copyright 1982 by Computer Business Associates (Vercom Software, Inc.)
* SOURCE        - FASBP
* PROGRAM       - ITC.LIST
* BY            - ANN POWLEY, C.B.A
* DATE          - 09/06/88
*********************************************************************
*COPY>FAS.CPYLIB>ITC
*COPY>CPYLIB>SYSCOM
*COPY>CPYLIB>CHAR
*
*--- Setup SYSCOM
*
   SYS.TYPE = 1
   CALL SYSCOM(MAT SYSCOM.REC)
*
*--- Get buffer
*
   PROCREAD BUFFER ELSE
      ERRMSG = "Must be executed from a PROC"
      GOSUB 91000; GOTO 99999
   END
   CONO = BUFFER<1>
   HD = BUFFER<2>
*
*--- Open files
*
   OPEN "","ITC" TO ITC ELSE
      ERRMSG = "Cannot locate ITC file"; GOTO 93000
   END
*
*--- Get ITC record
*
   MATREAD ITC.REC FROM ITC, CONO : "ITC" ELSE
      ERRMSG = "The investment tax credit table is not setup"
      GOSUB 91000; GOTO 99999
   END
*
*--- Print the ITC record
*
   PRINTER ON
   HEADING HD
   PRINT; PRINT; PRINT
   PRINT "LN#  LIFE YEARS  TAX PERCENT"
   PRINT "---  ----------  -----------"
   FOR I = 1 TO 19
      PRINT I "R#2" : SPACE(7) : ITC.REC(I) "R#2" :
      PRINT SPACE(9) : OCONV(ITC.REC(I+19),"MD2") "R#5"
   NEXT I
   PRINTER CLOSE
   PRINTER OFF
   GOTO 99999
*
*--- Error message routine
*
91000*
   PRINT @(0,23) : ERRMSG : CL :
   INPUT REPLY :
   PRINT @(0,23) : CL :
   RETURN
93000*
   ERR.TYPE = 3; CALL SYSCOM(MAT SYSCOM.REC)
99999*
END
