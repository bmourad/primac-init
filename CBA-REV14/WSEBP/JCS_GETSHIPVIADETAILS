SUBROUTINE JCS_GETSHIPVIADETAILS(CONO, SHIPVIAID, ERRMSG, OUT_PARAM_SHIPVIA,SCHEMA.ONLY)
*OUT_PARAM_SHIPVIA ='<ShipVia><cono></cono><ShipViaCode></ShipViaCode><ShipViaName></ShipViaName><ShipViaAccount></ShipViaAccount><ShipViaAccountName></ShipViaAccountName><OurTruck></OurTruck></ShipVia>'
SCHEMA.ONLY = 1
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE PMC.CPYLIB SHIP.VIA
$INCLUDE PMC.CPYLIB COA
*
* INITIALIZE VARIABLES
*
ERRMSG = ''
ACCT = ''
OPEN '','SHIP.VIA' TO SHIP.VIA ELSE ERRMSG = "CANNOT OPEN SHIP.VIA FILE" ;GOTO 99999
OPEN '','COA' TO COA ELSE ERRMSG = "CANNOT OPEN COA FILE" ;GOTO 99999
OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = "CANNOT OPEN COMPANY FILE" ;GOTO 99999
* READ THE COMPANY CODE
MATREAD COMP.REC FROM COMPANY,CONO ELSE
      ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
      GOTO 99999
END
MATREAD SHIP.VIA.REC FROM SHIP.VIA, CONO:SHIPVIAID THEN
  SCHEMA.ONLY = 0
  OUT_PARAM_SHIPVIA = '<ShipVia>'
*  OUT_PARAM_SHIPVIA := '<cono>' : ID[1,3] : '</cono>'
OUT_PARAM_SHIPVIA := '<cono>' : CONO : '</cono>'
  OUT_PARAM_SHIPVIA := '<ShipViaId>' : SHIPVIAID : '</ShipViaId>'
  OUT_PARAM_SHIPVIA := '<ShipViaName>' : SHPV.DESC  : '</ShipViaName>'
IF SHPV.GL.NO NE '' THEN
  ACCT=SHPV.GL.NO[1,3]:"-":SHPV.GL.NO[4,99]
END
  OUT_PARAM_SHIPVIA := '<ShipViaAccount>' : ACCT : '</ShipViaAccount>' 
  MATREAD COA.REC FROM COA, CONO : SHPV.GL.NO ELSE COA.DESC=""     
  OUT_PARAM_SHIPVIA := '<ShipViaAccountName>' : COA.DESC  : '</ShipViaAccountName>'
  OUT_PARAM_SHIPVIA := '<OurTruck>' : SHPV.TRUCK.FLG : '</OurTruck>'  
  OUT_PARAM_SHIPVIA := '</ShipVia>' 
END 
RETURN
*
*
99999*
 IF ERRMSG <> "" THEN
 ERRMSG = "GetShipViaDetails ---> JCS_GETSHIPVIADETAILS ---> " : ERRMSG
      CALL WRITELOG(ERRMSG)
 END
 RETURN
 END
