SUBROUTINE PMC_VENDOR_GETVENDORDETAILS(CONO,VENDID,STRXML,ERRMSG,SCHEMA.ONLY)
SCHEMA.ONLY = 1
$INCLUDE PMC.CPYLIB VEND
$INCLUDE PMC.CPYLIB COMPANY
* OPEN FILES
*
OPEN "","COMPANY" TO COMPANY ELSE
           ERRMSG = "CANNOT OPEN COMPANY FILE"
           GOTO 99999
END
OPEN "","VEND" TO VEND ELSE
           ERRMSG = "CANNOT OPEN VEND FILE"
           GOTO 99999
END
 OPEN "","CONTROL" TO CONTROL ELSE
            ERRMSG = "CANNOT OPEN CONTROL FILE"
            GOTO 99999
 END
*
* INITIALIZE  VARIABLES
*
ERRMSG=""
*
* MAIN PROCESSING
*
****VEND
*
MATREAD COMP.REC FROM COMPANY,CONO ELSE
ERRMSG="COMPANY NUMBER ":CONO : " DOES NOT EXIST"
GOTO 99999
END
MATREAD VEND.REC FROM VEND, CONO:VENDID THEN
  SCHEMA.ONLY = 0
 PO.TERMS.DESC = VEND.TERMS<1,2>
 PO.TERMS.DIS = VEND.TERMS<1,1>[1,4]
 PO.TERMS.DIS = OCONV(PO.TERMS.DIS,"MD2")
 IF PO.TERMS.DESC[1,1] = 'P' THEN
    PO.TERMS.DATE = ''
 END ELSE
    PO.TERMS.DATE = VEND.TERMS<1,1>[5,2]
 END
  *STRXML:='<Vendor><VendorId>'  : VENDID : '</VendorId><VendorDesc>' : VEND.PO.DESC: '</VendorDesc></Vendor>'
  STRXML='<Vendor><VendorId>'  : VENDID : '</VendorId><VendorDesc>' : VEND.PO.DESC: '</VendorDesc>'
  STRXML:='<VendorAdd1>'  : VEND.PO.ADDR1 : '</VendorAdd1><VendorAdd2>'  : VEND.PO.ADDR2 : '</VendorAdd2>'
  STRXML:='<VendorCity>'  :FIELD(VEND.PO.CT.ST, ",",1) : '</VendorCity><VendorState>'  : FIELD(VEND.PO.CT.ST, ",",2) : '</VendorState>'
  STRXML:='<VendorZip>'  : VEND.PO.ZIP : '</VendorZip><VendorPhone>'  :VEND.PHONE : '</VendorPhone>'
  STRXML:='<VendorFax>'  : VEND.FAX : '</VendorFax>'
  STRXML:='<VendorEmailAddress>'  : VEND.EMAIL.ADDR : '</VendorEmailAddress>'
  STRXML:='<VendorTermsDesc>'  : PO.TERMS.DESC : '</VendorTermsDesc><VendorTermsDis>'  :PO.TERMS.DIS : '</VendorTermsDis>'
  STRXML:='<VendorTermsDate>'  : PO.TERMS.DATE : '</VendorTermsDate><VendorShipVia>':VEND.SHIP.VIA:'</VendorShipVia></Vendor>'
END ELSE
  SCHEMA.ONLY = 0
  ERRMSG=VENDID :" IS NOT ON FILE TRY AGAIN !"
  GOTO 99999
END
RETURN
*
* WRITE ERROR MESSAGE
*
99999*
IF ERRMSG <> "" THEN
      STRXML='<Vendor><ErrorStack>' :ERRMSG : '</ErrorStack></Vendor>'
      ERRMSG = "GetVendorDetailsXml ----> PMC_VENDOR_GETVENDORDETAILS --->": ERRMSG
      CALL WRITELOG(ERRMSG)
END
RETURN
