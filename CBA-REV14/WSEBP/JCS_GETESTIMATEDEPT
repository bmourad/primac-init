SUBROUTINE WSE_MRW_GETJOBDATA(CONO, JOBID, ERRMSG, PAPERXML)
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE JCS.CPYLIB JOB
PAPERXML = "<PaperData>"
INV.DATA = ''
OPEN '','INVENTORY' TO INVENTORY ELSE
  ERRMSG = 'INVENTORY FILE IS MISSING'
  RETURN
END
OPEN '','JOB' TO JOB ELSE
  ERRMSG = 'JOB FILE IS MISSING'
  RETURN
END
 
MATREAD JOB.REC FROM JOB, CONO:JOBID THEN
  NCNT = DCOUNT(JOB.RESV.MATL,@VM)
  FOR I = 1 TO NCNT
    MATREAD INV.REC FROM INVENTORY, CONO:JOB.RESV.MATL<1,I> THEN
      IF (INV.PAP.TYPE = 'LROLL' OR INV.PAP.TYPE = 'ROLL') AND INV.UNIT<1,1> = 'LBS' THEN
        INV.DATA :=  "<Paper>"
INV.DATA :=  "<ProductId>" : JOB.RESV.MATL<1,I> : "</ProductId>"
INV.DATA :=  "<WarehouseId>" : JOB.RESV.WHSE<1,I> : "</WarehouseId>"
INV.DATA :=  "<ReservedDate>" : OCONV(JOB.RESV.DATE<1,I>,"D4/") : "</ReservedDate>"
INV.DATA :=  "<QuantityAllocated>" : OCONV(JOB.ALOC.QTY<1,I>/10,"MD2") : "</QuantityAllocated>"
INV.DATA :=  "<QuantityReserved>" : OCONV(JOB.RESV.QTY<1,I>/10,"MD2") : "</QuantityReserved>"
INV.DATA := "</Paper>"
      END
    END
  NEXT I
END
PAPERXML := INV.DATA
PAPERXML := "</PaperData>"
RETURN
