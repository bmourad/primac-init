SUBROUTINE JES_GETESTIMATEQUANTITIES(CONO, EST.ID, SCHEMA.ONLY, ERRMSG, STRXML)
STRXML='<Estimate><Quantity>--Select--</Quantity></Estimate>'
SCHEMA.ONLY = 1
$INCLUDE PMC.CPYLIB COMPANY
*IF CONO="" THEN
*  ERRMSG="COMPANY NUMBER CANNOT BE BLANK"
*  GOTO 99999
*END
*IF CUST.ID="" THEN
*  ERRMSG="CUSTOMER ID CANNOT BE BLANK"
*  GOTO 99999
*END
*
* OPEN FILES
*
OPEN "","COMPANY" TO COMPANY ELSE
           ERRMSG = "CANNOT OPEN COMPANY FILE"
           GOTO 99999
END
OPEN "","ESTIMATE" TO ESTIMATE ELSE
           ERRMSG = "CANNOT OPEN ESTIMATE FILE"
           GOTO 99999
END
*
* INITIALIZE  VARIABLES
*
EST.QTY = ''
ERRMSG=""
*
* MAIN PROCESSING
*
MATREAD COMP.REC FROM COMPANY,CONO ELSE
ERRMSG="COMPANY NUMBER ":CONO : " DOES NOT EXIST"
      GOTO 99999
END
READV EST.QTY FROM ESTIMATE,CONO:EST.ID, 41 ELSE EST.QTY=''
CNT = DCOUNT(EST.QTY,@VM)
FOR I = 1 TO CNT
  SCHEMA.ONLY = 0
  STRXML := '<Estimate><Quantity>' : EST.QTY<1,I> : '</Quantity></Estimate>'
NEXT I
RETURN
*
* WRITE ERROR MESSAGE
*
99999*
IF ERRMSG <> "" THEN
      ERRMSG = "GetEstimateQuantities ----> JES_GETESTIMATEQUANTITIES --->": ERRMSG
      CALL WRITELOG(ERRMSG)
END
RETURN
