SUBROUTINE POR_REQUISITION_GETWHSE(CONO,VALUE,KEY,ERRMSG,STRXML)
*STRXML := "<Xmldata>"
STRXML := '<Xmldata><Testing></Testing><ProdWhse></ProdWhse></Xmldata>'
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE ICS.CPYLIB INV.WHSE
$INCLUDE ICS.CPYLIB WAREHOUSE
OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = 'COMPANY FILE IS MISSING'; GOTO 99999
OPEN '','INVENTORY' TO INVENTORY ELSE ERRMSG = 'INVENTORY FILE IS MISSING'; GOTO 99999
OPEN '','INV.WHSE' TO INV.WHSE ELSE ERRMSG = 'INV.WHSE IS MISSING'; GOTO 99999
OPEN '','WAREHOUSE' TO WAREHOUSE ELSE ERRMSG = 'WAREHOUSE FILE IS MISSING'; GOTO 99999
  MATREAD COMP.REC FROM COMPANY,CONO ELSE
      ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
      GOTO 99999
  END
  MATREAD INV.REC FROM INVENTORY, CONO:VALUE ELSE
    ERRMSG = "INVENTORY (":VALUE:") IS NOT ON FILE."
    GOTO 99999
  END
  PO.PROD.NUM<1,LN> = VALUE
  PO.WHSE<1,LN> = KEY
  INV.WHSE.KEY = CONO:PO.PROD.NUM<1,LN>:"!":PO.WHSE<1,LN>
  IF CO.INTR.WHSE # '' AND PO.WHSE<1,LN> = CO.INTR.WHSE THEN
    ERRMSG = 'CAN NOT APPLY, USING AN INTER-DIVISIONAL WHSE IS RESTRICTED'
    GOTO 99999
  END
  MATREAD IWH.REC FROM INV.WHSE , INV.WHSE.KEY ELSE
    ERRMSG = "INV.WHSE RECORD NOT ON FILE" 
    GOTO 99999
  END
  MATREAD WHSE.REC FROM WAREHOUSE, CONO:PO.WHSE<1,LN> ELSE
    ERRMSG = "WAREHOUSE RECORD NOT ON FILE"
    GOTO 99999
  END
  STRXML := '<Xmldata>'
  STRXML := '<Testing>' :ERRMSG: '</Testing>'
  STRXML := '<ProdWhse>' :INV.WHSE.KEY: '</ProdWhse>'
  STRXML := '</Xmldata>'
99999*
  IF ERRMSG <> "" THEN
      ERRMSG = "GetWarehouse ---> POR_REQUISITION_GETWHSE ---> " : ERRMSG
      CALL WRITELOG(ERRMSG)
  END
RETURN
