SUBROUTINE JCS_GETOPERATION(CONO,OUTPUTXML,SCHEMA.ONLY)
SCHEMA.ONLY = 1
ERRMSG=""
CNT = 1
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE JCS.CPYLIB OPERATION
$INCLUDE PMC.CPYLIB COST.CNTR
 OPEN "COMPANY" TO COMPANY ELSE ERRMSG="CANNOT OPEN COMPANY FILE";GOTO 99999
 OPEN "OPERATION" TO OPERATION ELSE ERRMSG="CANNOT OPEN OPERATION FILE"; GOTO 99999
OPEN "COST.CNTR" TO COST.CNTR ELSE ERRMSG="CANNOT OPEN COST.CNTR FILE"; GOTO 99999
IF CONO = "*" THEN
CMD= "SSELECT OPERATION"
 END ELSE
 MATREAD COMP.REC FROM COMPANY,CONO ELSE
 ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
GOTO 99999
END
CMD= "SSELECT OPERATION WITH @ID LIKE '" : CONO : "...'"
END
UDTEXECUTE CMD
DATA=1
LOOP
READNEXT ID ELSE DATA=0
 WHILE DATA DO
 SCHEMA.ONLY = 0
 OPER.DESC=''
MATREAD OPER.REC FROM OPERATION, ID ELSE
 ERRMSG = "OPERATION NOT FOUND"
END
OUTPUTXML:="<OPERATION>"
OUTPUTXML:="<Cono>" : ID[1,3] : "</Cono>"
 OUTPUTXML:="<OperationId>" : ID[4,99] : "</OperationId>"
 OUTPUTXML:="<OperationName>" : OPER.DESC : "</OperationName>"
OUTPUTXML:="<OperationType>" : OPER.CTYPE : "</OperationType>"
OUTPUTXML:="<OperationPrompt>" :  OPER.PROMPT : "</OperationPrompt>"
OUTPUTXML:="<OperationSchd>" :OPER.SCHED:"</OperationSchd>"
OUTPUTXML:="<OperationMaltReq>" : OPER.MATL.REQ : "</OperationMaltReq>"
OUTPUTXML:="</OPERATION>"
CNT = CNT + 1
REPEAT
CLEARSELECT
RETURN
99999*
IF ERRMSG <> "" THEN
 ERRMSG = "GetDivisionList ----> JCS_GETDIVISIONLIST --->": ERRMSG
CALL WRITELOG(ERRMSG)
END
RETURN
