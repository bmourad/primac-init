SUBROUTINE JES_GETESP(CONO, JOBID, ERRMSG, OUT_PARAM_ESP,SCHEMA.ONLY)
OUT_PARAM_ESP ='<ESP><DimAround></DimAround><DimAcross></DimAcross><LblPerCarton></LblPerCarton><SheetLength></SheetLength><SheetWidth></SheetWidth><LblSheet></LblSheet></ESP>'
SCHEMA.ONLY = 1
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE JES.CPYLIB ESTIMATE.RES
ERRMSG = ''
*
* OPEN FILES
*
OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = "CANNOT OPEN COMPANY FILE" ;GOTO 99999
OPEN '','ESTIMATE.RES' TO ESTIMATE.RES ELSE ERRMSG = "CANNOT OPEN ESTIMATE.RES FILE" ;GOTO 99999
*
* READ THE COMPANY CODE
*
MATREAD COMP.REC FROM COMPANY,CONO ELSE
      ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
      GOTO 99999
END
MATREAD EST.RL.REC FROM ESTIMATE.RES, CONO:JOBID THEN
  SCHEMA.ONLY = 0
  OUT_PARAM_ESP = '<ESP>'
  OUT_PARAM_ESP := '<DimAround>' : EST.RL.DIM.AR : '</DimAround>'
  OUT_PARAM_ESP := '<DimAcross>' : EST.RL.DIM.AC : '</DimAcross>'
  OUT_PARAM_ESP := '<LblPerCarton>' : EST.RL.NO.PER.CARTON  : '</LblPerCarton>'
  OUT_PARAM_ESP := '<SheetLength>': EST.RL.SHEET.LENGTH :'</SheetLength>'
  OUT_PARAM_ESP := '<SheetWidth>': EST.RL.SHEET.WIDTH :'</SheetWidth>'
  OUT_PARAM_ESP := '<LblSheet></LblSheet>'
  OUT_PARAM_ESP := '</ESP>'   
END 
RETURN
*
*
99999*
 IF ERRMSG <> "" THEN
 ERRMSG = "ESP ---> JES_GETESP---> " : ERRMSG
      CALL WRITELOG(ERRMSG)
 END
 RETURN
 END
