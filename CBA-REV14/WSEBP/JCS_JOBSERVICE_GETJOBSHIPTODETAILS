SUBROUTINE JCS_GETJOBSHIPTODETAILS(CONO,JOBID,SHIPTOID, ERRMSG, OUT_PARAM_SHIPTODETAILS,SCHEMA.ONLY)
OUT_PARAM_SHIPTODETAILS  = '<ShipToDetails>'
OUT_PARAM_SHIPTODETAILS := '<BOL></BOL><CartonLabel></CartonLabel><DistributionCode></DistributionCode>'
OUT_PARAM_SHIPTODETAILS := '<Edition></Edition><Fold></Fold><Instruction1></Instruction1>'
OUT_PARAM_SHIPTODETAILS := '<Instruction1Length></Instruction1Length><Instruction2></Instruction2><Instruction2Length></Instruction2Length>'
OUT_PARAM_SHIPTODETAILS := '<Instruction3></Instruction3><Instruction3Length></Instruction3Length><Instruction4></Instruction4>'
OUT_PARAM_SHIPTODETAILS := '<Instruction4Length></Instruction4Length><Instruction5></Instruction5><Instruction5Length></Instruction5Length>'
OUT_PARAM_SHIPTODETAILS := '<Instruction6></Instruction6><Instruction6Length></Instruction6Length><Instruction7></Instruction7>'
OUT_PARAM_SHIPTODETAILS := '<Instruction7Length></Instruction7Length><Instruction8></Instruction8><Instruction8Length></Instruction8Length>'
OUT_PARAM_SHIPTODETAILS := '<Instruction9></Instruction9><Instruction9Length></Instruction9Length><Instruction10></Instruction10>'
OUT_PARAM_SHIPTODETAILS := '<Instruction10Length></Instruction10Length><InstructionDate></InstructionDate><Packaging></Packaging>'
OUT_PARAM_SHIPTODETAILS := '<Quantity></Quantity><ShipVia></ShipVia><ShrinkWrap></ShrinkWrap><SkidLabel></SkidLabel>'
OUT_PARAM_SHIPTODETAILS := '<StoreQuantity></StoreQuantity><VersionNo></VersionNo><VersionDescription></VersionDescription>'
OUT_PARAM_SHIPTODETAILS := '</ShipToDetails>'
SCHEMA.ONLY = 1
ERRMSG = ''
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE JCS.CPYLIB TEMPLATE.DETAIL
OPEN '','TEMPLATE.DETAIL' TO TEMPLATE.DETAIL ELSE ERRMSG = "CANNOT OPEN TEMPLATE.DETAIL FILE" ;GOTO 99999
OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = "CANNOT OPEN COMPANY FILE" ;GOTO 99999
* READ THE COMPANY CODE
MATREAD COMP.REC FROM COMPANY,CONO ELSE
      ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
      GOTO 99999
END
MATREAD TDT.REC FROM TEMPLATE.DETAIL, CONO:SHIPTOID:"!":JOBID THEN
  SCHEMA.ONLY = 0
  OUT_PARAM_SHIPTODETAILS = '<ShipToDetails>'
  OUT_PARAM_SHIPTODETAILS := '<BOL>' : TDT.BOL  : '</BOL>'
  OUT_PARAM_SHIPTODETAILS := '<CartonLabel>' : TDT.CART.LAB  : '</CartonLabel>'
  OUT_PARAM_SHIPTODETAILS := '<DistributionCode>' : TDT.DIST.CODE  : '</DistributionCode>'
  OUT_PARAM_SHIPTODETAILS := '<Edition>' : TDT.EDITION  : '</Edition>'
  OUT_PARAM_SHIPTODETAILS := '<Fold>' : TDT.FOLD  : '</Fold>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction1>' : TDT.SP.INST.1  : '</Instruction1>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction1Length>' : TDT.SP.INST.LEN.1  : '</Instruction1Length>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction2>' : TDT.SP.INST.1  : '</Instruction2>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction2Length>' : TDT.SP.INST.LEN.1  : '</Instruction2Length>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction3>' : TDT.SP.INST.1  : '</Instruction3>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction3Length>' : TDT.SP.INST.LEN.1  : '</Instruction3Length>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction4>' : TDT.SP.INST.1  : '</Instruction4>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction4Length>' : TDT.SP.INST.LEN.1  : '</Instruction4Length>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction5>' : TDT.SP.INST.1  : '</Instruction5>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction5Length>' : TDT.SP.INST.LEN.1  : '</Instruction5Length>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction6>' : TDT.SP.INST.1  : '</Instruction6>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction6Length>' : TDT.SP.INST.LEN.1  : '</Instruction6Length>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction7>' : TDT.SP.INST.1  : '</Instruction7>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction7Length>' : TDT.SP.INST.LEN.1  : '</Instruction7Length>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction8>' : TDT.SP.INST.1  : '</Instruction8>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction8Length>' : TDT.SP.INST.LEN.1  : '</Instruction8Length>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction9>' : TDT.SP.INST.1  : '</Instruction9>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction9Length>' : TDT.SP.INST.LEN.1  : '</Instruction9Length>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction10>' : TDT.SP.INST.1  : '</Instruction10>'
  OUT_PARAM_SHIPTODETAILS := '<Instruction10Length>' : TDT.SP.INST.LEN.1  : '</Instruction10Length>'
  OUT_PARAM_SHIPTODETAILS := '<InstructionDate>' : OCONV(TDT.SP.INST.DATE,"D2/")  : '</InstructionDate>'
  OUT_PARAM_SHIPTODETAILS := '<Packaging>' : TDT.PACK  : '</Packaging>'
  OUT_PARAM_SHIPTODETAILS := '<Quantity>' : TDT.QTY  : '</Quantity>'
  OUT_PARAM_SHIPTODETAILS := '<ShipVia>' : TDT.SHIP.VIA  : '</ShipVia>'
  OUT_PARAM_SHIPTODETAILS := '<ShrinkWrap>' : TDT.SHRKWRP  : '</ShrinkWrap>'
  OUT_PARAM_SHIPTODETAILS := '<SkidLabel>' : TDT.SKID.LAB  : '</SkidLabel>'
  OUT_PARAM_SHIPTODETAILS := '<StoreQuantity>' : TDT.STORE.QTY  : '</StoreQuantity>'
  OUT_PARAM_SHIPTODETAILS := '<VersionNo>' : TDT.VER.NO  : '</VersionNo>'
  OUT_PARAM_SHIPTODETAILS := '<VersionDescription>' : TDT.VER.DESC  : '</VersionDescription>'
  OUT_PARAM_SHIPTODETAILS := '</ShipToDetails>'
END 
RETURN
*
*
99999*
 IF ERRMSG <> "" THEN
 ERRMSG = "GetJobShipToDetails ---> JCS_GETJOBSHIPTODETAILS ---> " : ERRMSG
      CALL WRITELOG(ERRMSG)
 END
 RETURN
