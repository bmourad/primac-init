SUBROUTINE PMC_WBPREGISTRATION_REGISTERPROCESSANDKEY(WFINSTANCEID,ERRMSG,SCHEMA.ONLY)
SCHEMA.ONLY = 1
* OPEN FILES
*
OPEN "","WBPREGISTRY" TO WBPREGISTRY ELSE
    ERRMSG="WBPREGISTRY FILE IS MISSING"; GOTO 99999
END
*
* INITIALIZE  VARIABLES
*
ERRMSG=""
* MAIN PROCESSING
*
IF WFINSTANCEID # "" THEN
  WRITE "" ON WBPREGISTRY,WFINSTANCEID
 SCHEMA.ONLY = 0
END
RETURN
*
* WRITE ERROR MESSAGE
*
99999*
IF ERRMSG <> "" THEN
      ERRMSG = "RegisterProcessAndKey ----> PMC_WBPREGISTRATION_REGISTERPROCESSANDKEY --->": ERRMSG
      CALL WRITELOG(ERRMSG)
END
RETURN
