SUBROUTINE JES_GETESH(CONO, JOBID, ERRMSG, OUT_PARAM_ESH,SCHEMA.ONLY)
OUT_PARAM_ESH ='<ESH><DimAround></DimAround><DimAcross></DimAcross><CarWidth></CarWidth><HozSpace></HozSpace><NumLblWide></NumLblWide><LblPerCarton></LblPerCarton><SheetLength></SheetLength><SheetWidth></SheetWidth><QtyPack></QtyPack><LblSheet></LblSheet></ESH>'
SCHEMA.ONLY = 1
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE JES.CPYLIB ESTIMATE.RES
ERRMSG = ''
*
* OPEN FILES
*
OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = "CANNOT OPEN COMPANY FILE" ;GOTO 99999
OPEN '','ESTIMATE.RES' TO ESTIMATE.RES ELSE ERRMSG = "CANNOT OPEN ESTIMATE.RES FILE" ;GOTO 99999
*
* READ THE COMPANY CODE
*
MATREAD COMP.REC FROM COMPANY,CONO ELSE
      ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
      GOTO 99999
END
MATREAD EST.RL.REC FROM ESTIMATE.RES, CONO:JOBID THEN
  SCHEMA.ONLY = 0
  OUT_PARAM_ESH = '<ESH>'
  OUT_PARAM_ESH := '<DimAround>' : EST.RL.DIM.AR : '</DimAround>'
  OUT_PARAM_ESH := '<DimAcross>' : EST.RL.DIM.AC : '</DimAcross>'
  OUT_PARAM_ESH := '<CarWidth>' : EST.RL.CARRIER.WIDTH : '</CarWidth>'
  OUT_PARAM_ESH := '<HozSpace></HozSpace>'
  OUT_PARAM_ESH := '<NumLblWide>': EST.RL.NO.WIDE :'</NumLblWide>'
  OUT_PARAM_ESH := '<LblPerCarton>' : EST.RL.NO.PER.CARTON  : '</LblPerCarton>'
  OUT_PARAM_ESH := '<SheetLength>': EST.RL.SHEET.LENGTH :'</SheetLength>'
  OUT_PARAM_ESH := '<SheetWidth>': EST.RL.SHEET.WIDTH :'</SheetWidth>'
  OUT_PARAM_ESH := '<QtyPack>': EST.RL.NO.PER.PKG :'</QtyPack>'
  OUT_PARAM_ESH := '<LblSheet></LblSheet>'
  OUT_PARAM_ESH := '</ESH>'   
END 
RETURN
*
*
99999*
 IF ERRMSG <> "" THEN
 ERRMSG = "ESH ---> JES_GETESH---> " : ERRMSG
      CALL WRITELOG(ERRMSG)
 END
 RETURN
 END
