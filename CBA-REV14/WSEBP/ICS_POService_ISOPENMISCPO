SUBROUTINE ICS_POService_ISOPENMISCPO(CONO, MPO.CODE, SCHEMA.ONLY, ERRMSG, STRXML)
$INCLUDE POS.CPYLIB MISC.PO
**** OPEN FILES
OPEN '','MISC.PO' TO MISC.PO ELSE
  ERRMSG = 'MISC.PO FILE IS MISSING'
END
FLG = 0
MPO.CODE = CONO:MPO.CODE
MATREAD MPO.REC FROM MISC.PO , MPO.CODE ELSE
  MAT MPO.REC = ''
END
QCNT = DCOUNT(MPO.PROD.DESC,@VM)
FOR MV.NUM = 1 TO QCNT
  IF MPO.TOT.OPEN<1,MV.NUM> + 0 > 0 THEN
    FLG = 1
  END ELSE
    FLG = 0
  END
NEXT MV.NUM
 STRXML := '<Payload><PO_Num>':MPO.CODE[4,99]:'</PO_Num> <PO_Open>':FLG:'</PO_Open></Payload>'
RETURN
