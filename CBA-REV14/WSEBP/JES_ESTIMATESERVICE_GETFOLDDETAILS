SUBROUTINE JES_GETFOLDDETAILS(CONO, EST.ID, SCHEMA.ONLY, ERRMSG, STRXML)
$INCLUDE JES.CPYLIB ESTIMATE
$INCLUDE PMC.CPYLIB COMPANY
STRXML := '<EstimateBinderyFold><FolderBulk></FolderBulk><FolderWorkCenter></FolderWorkCenter><FolderImpostion></FolderImpostion><FolderNumPages></FolderNumPages><FolderPPI></FolderPPI><FolderNumSheets></FolderNumSheets><FolderSigs></FolderSigs><EST_BIND_FOLD_CCTR_MC></EST_BIND_FOLD_CCTR_MC></EstimateBinderyFold>'
OPEN '','ESTIMATE' TO ESTIMATE ELSE ERRMSG = "CANNOT OPEN ESTIMATE FILE" ;GOTO 99999
OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = "CANNOT OPEN COMPANY FILE" ;GOTO 99999
* READ THE COMPANY CODE
SCHEMA.ONLY="1"
MATREAD COMP.REC FROM COMPANY,CONO ELSE
      ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
      GOTO 99999
END
MATREAD EST.REC FROM ESTIMATE, CONO:EST.ID THEN
  J=1
  ECNT=DCOUNT(EST.BIND.FOLD.BULK,@VM)   
 IF ECNT # "0" THEN 
   STRXML=''
 END
  FOR J=1 TO ECNT
     SCHEMA.ONLY="0"
STRXML := '<EstimateBinderyFold>'
     STRXML := '<FolderBulk>' :  OCONV(EST.BIND.FOLD.BULK<1,J>,"MD4") : '</FolderBulk>'
     STRXML := '<FolderWorkCenter>' : EST.BIND.FOLD.CCTR<1,J>  : '</FolderWorkCenter>'        
     STRXML := '<FolderImpostion>' : EST.BIND.FOLD.IMPO<1,J>  : '</FolderImpostion>'
     STRXML := '<FolderNumPages>' : OCONV(EST.BIND.FOLD.PGS<1,J>,"MD0")  : '</FolderNumPages>'
     STRXML := '<FolderPPI>' : OCONV(EST.BIND.FOLD.PPI<1,J>,"MD0") : '</FolderPPI>'
     STRXML := '<FolderNumSheets>' : OCONV(EST.BIND.FOLD.SHT<1,J>,"MD4") : '</FolderNumSheets>'
     STRXML := '<FolderSigs>' : OCONV(EST.BIND.FOLD.SIG<1,J>,"MD0")  : '</FolderSigs>'
     STRXML := '<EST_BIND_FOLD_CCTR_MC>' : J  : '</EST_BIND_FOLD_CCTR_MC>'
     STRXML := '</EstimateBinderyFold>'
  NEXT J  
END  
RETURN
*
99999*
 IF ERRMSG <> "" THEN
 ERRMSG = "GetFoldDetails  ---> JES_GETFOLDDETAILS ---> " : ERRMSG
      CALL WRITELOG(ERRMSG)
 END
 RETURN
 END
