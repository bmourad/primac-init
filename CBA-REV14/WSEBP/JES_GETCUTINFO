SUBROUTINE JES_GETCUTINFO(CONO, EST.ID, SCHEMA.ONLY, ERRMSG, STRXML)
$INCLUDE JES.CPYLIB ESTIMATE
$INCLUDE PMC.CPYLIB COMPANY
STRXML := '<CutInformation><BindBasisWeight></BindBasisWeight><CutterWorkCenter></CutterWorkCenter><NumCuts></NumCuts><CutLength></CutLength><CutterNOut></CutterNOut><CutterSheets></CutterSheets><CutWidth></CutWidth><EST_BIND_CUT_CCTR_MC ></EST_BIND_CUT_CCTR_MC ></CutInformation>'
OPEN '','ESTIMATE' TO ESTIMATE ELSE ERRMSG = "CANNOT OPEN ESTIMATE FILE" ;GOTO 99999
OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = "CANNOT OPEN COMPANY FILE" ;GOTO 99999
* READ THE COMPANY CODE
SCHEMA.ONLY="1"
MATREAD COMP.REC FROM COMPANY,CONO ELSE
      ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
      GOTO 99999      
END
MATREAD EST.REC FROM ESTIMATE, CONO:EST.ID THEN
  ECNT=DCOUNT(EST.BIND.CUT.CCTR,@VM)
  IF ECNT # "0"  THEN 
    STRXML=''  
    SCHEMA.ONLY="0"
  END
  FOR I=1 TO ECNT  
     STRXML := '<CutInformation>'
     STRXML := '<BindBasisWeight>' : EST.BIND.CUT.BASIS<1,I> : '</BindBasisWeight>'
     STRXML := '<CutterWorkCenter>' : EST.BIND.CUT.CCTR<1,I> : '</CutterWorkCenter>'
     STRXML := '<NumCuts>' EST.BIND.CUT.CUTS<1,I> : '</NumCuts>'
     STRXML := '<CutLength>' : OCONV(EST.BIND.CUT.LENGTH<1,I>,"MD4") : '</CutLength>'
     STRXML := '<CutterNOut>' : EST.BIND.CUT.OUT<1,I>  : '</CutterNOut>'
     STRXML := '<CutterSheets>' : EST.BIND.CUT.SHT<1,I>  : '</CutterSheets>'
     STRXML := '<CutWidth>' : OCONV(EST.BIND.CUT.WIDTH<1,I>,"MD4") : '</CutWidth>' 
     STRXML := '<EST_BIND_CUT_CCTR_MC >' : I : '</EST_BIND_CUT_CCTR_MC >'     
     STRXML := '</CutInformation>'
   NEXT I   
END 
RETURN
*
99999*
 IF ERRMSG <> "" THEN
 ERRMSG = "GetCutInfo ---> JCS_GETCUTINFO ---> " : ERRMSG
      CALL WRITELOG(ERRMSG)
 END
RETURN
END
