SUBROUTINE JCS_GETSALESCODEDETAILS(CONO, SALESCODEID, ERRMSG, OUT_PARAM_SALES,SCHEMA.ONLY)
OUT_PARAM_SALES ='<SalesCode><cono></cono><SalesCodeId></SalesCodeId><SalesCodeName></SalesCodeName><SalesAccount></SalesAccount><SalesAccountName></SalesAccountName><ReturnAllowAccount></ReturnAllowAccount><ReturnAllowAccountName></ReturnAllowAccountName><DiscountAccount></DiscountAccount><DiscountAccountName></DiscountAccountName></SalesCode>'
SCHEMA.ONLY = 1
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE PMC.CPYLIB SALES.CODE
$INCLUDE PMC.CPYLIB COA
*
* INITIALIZE VARIABLES
*
ERRMSG=''
ACCT=''
OPEN '','SALES.CODE' TO SALES.CODE ELSE ERRMSG = "CANNOT OPEN SALES.CODE FILE" ;GOTO 99999
OPEN '','COA' TO COA ELSE ERRMSG = "CANNOT OPEN COA FILE" ;GOTO 99999
OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = "CANNOT OPEN COMPANY FILE" ;GOTO 99999
* READ THE COMPANY CODE
MATREAD COMP.REC FROM COMPANY,CONO ELSE
      ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
      GOTO 99999
END
MATREAD SLC.REC FROM SALES.CODE, CONO:SALESCODEID THEN
  SCHEMA.ONLY = 0
      OUT_PARAM_SALES ='<SalesCode>'
      OUT_PARAM_SALES := '<cono>' : CONO : '</cono>'
      OUT_PARAM_SALES := '<SalesCodeId>' : SALESCODEID : '</SalesCodeId>'
      OUT_PARAM_SALES := '<SalesCodeName>' : SLC.DESC : '</SalesCodeName>'
      IF SLC.GL.ACCT NE '' THEN
      ACCT=SLC.GL.ACCT[1,3]:"-":SLC.GL.ACCT[4,99]
 END
      OUT_PARAM_SALES := '<SalesAccount>' : ACCT  : '</SalesAccount>'
 MATREAD COA.REC FROM COA,CONO:SLC.GL.ACCT ELSE COA.DESC = "UNKNOWN"
      OUT_PARAM_SALES := '<SalesAccountName>' : COA.DESC  : '</SalesAccountName>'
      IF SLC.RT.ACCT NE '' THEN
      ACCT=SLC.RT.ACCT[1,3]:"-":SLC.RT.ACCT[4,99]
 END ELSE
      ACCT=SLC.RT.ACCT
 END
      OUT_PARAM_SALES := '<ReturnAllowAccount>' : ACCT : '</ReturnAllowAccount>'
 MATREAD COA.REC FROM COA,CONO:SLC.RT.ACCT ELSE COA.DESC = "UNKNOWN"
      OUT_PARAM_SALES := '<ReturnAllowAccountName>' : COA.DESC : '</ReturnAllowAccountName>'
      IF SLC.DS.ACCT NE "" THEN
       ACCT=SLC.DS.ACCT[1,3]:"-":SLC.DS.ACCT[4,99]
END ELSE
       ACCT=SLC.DS.ACCT
END
       OUT_PARAM_SALES := '<DiscountAccount>' : ACCT : '</DiscountAccount>'
MATREAD COA.REC FROM COA,CONO:SLC.DS.ACCT ELSE COA.DESC = "UNKNOWN"
       OUT_PARAM_SALES := '<DiscountAccountName>' : COA.DESC :'</DiscountAccountName>' 
       OUT_PARAM_SALES := '</SalesCode>' 
END 
RETURN
*
*
99999*
 IF ERRMSG <> "" THEN
 ERRMSG = "GetSalesCodeDetails----> JCS_GETSALESCODEDETAILS ---> " : ERRMSG
      CALL WRITELOG(ERRMSG)
 END
 RETURN
 END
