 SUBROUTINE JCS_GETSHIPVIALIST(CONO,OUTPUTXML,SCHEMA.ONLY)
 *************************************************
OUTPUTXML='<ShipVia><Cono></Cono><ShipViaCode></ShipViaCode><Description>--Select--</Description></ShipVia>'
 SCHEMA.ONLY = 1
 $INCLUDE PMC.CPYLIB SHIP.VIA
 $INCLUDE PMC.CPYLIB COMPANY
 ERRMSG="" 
 OPEN "COMPANY" TO COMPANY ELSE ERRMSG="CANNOT OPEN COMPANY FILE";GOTO 99999
 OPEN 'SHIP.VIA' TO SHIP.VIA ELSE ERRMSG="CANNOT OPEN SHIP.VIA FILE" ; GOTO 99999
 MATREAD COMP.REC FROM COMPANY,CONO ELSE
       ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
      GOTO 99999
 END
 CMD= "SSELECT SHIP.VIA WITH @ID LIKE '" : CONO : "...'"
 UDTEXECUTE CMD
 CTR = 1
 DATA=1
 LOOP
 READNEXT ID ELSE DATA=0
 WHILE DATA DO
 MATREAD SHIP.VIA.REC FROM SHIP.VIA,ID THEN
   SCHEMA.ONLY = 0
*   IF CTR = 1 THEN 
*     OUTPUTXML="<ShipVia>"
*   END ELSE
     OUTPUTXML:="<ShipVia>"
*   END
   OUTPUTXML:="<Cono>" : ID[0,3] : "</Cono>"  
   OUTPUTXML:="<ShipViaCode>" : ID[4,99] : "</ShipViaCode>"  
   OUTPUTXML:="<Description>" : ID[4,99]:"-":SHPV.DESC : "</Description>" 
   OUTPUTXML:="</ShipVia>"
   CTR = CTR + 1
END
REPEAT
CLEARSELECT
RETURN
99999*
IF ERRMSG <> "" THEN
     ERRMSG ="GetShipViaList ----> JCS_GETSHIPVIALIST --->": ERRMSG
     CALL WRITELOG(ERRMSG)
END
RETURN
