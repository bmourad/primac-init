SUBROUTINE JCS_GETJOBCATEGORIES(CONO,OUTPUTXML,SCHEMA.ONLY)
*************************************************
*OUTPUTXML ='<JobCategory><JobCategoryId></JobCategoryId><JobCategoryName></JobCategoryName></JobCategory>'
* OUTPUTXML ='<JobCategory><JobCategoryId></JobCategoryId><JobCategoryName></JobCategoryName><Display></Display></JobCategory>'
SCHEMA.ONLY = 1
ERRMSG=""
CNT = 1
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE JCS.CPYLIB JOB.CATEGORY
OPEN "COMPANY" TO COMPANY ELSE ERRMSG="GetJobCategories ----> JCS_GETJOBCATEGORIES --->CANNOT OPEN COMPANY FILE";GOTO 99999
OPEN 'JOB.CATEGORY' TO JOB.CATEGORY ELSE ERRMSG="GetJobCategories ----> JCS_GETJOBCATEGORIES ---> CANNOT OPEN JOB.CATEGORY FILE" ; GOTO 99999
*MATREAD COMP.REC FROM COMPANY,CONO ELSE
*     ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
*     GOTO 99999
*END
IF CONO = "*" THEN
 CMD= "SSELECT JOB.CATEGORY"
 END ELSE
MATREAD COMP.REC FROM COMPANY,CONO ELSE
ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
GOTO 99999
END
CMD= "SSELECT JOB.CATEGORY WITH @ID LIKE '" : CONO : "...'"
END
UDTEXECUTE CMD
DATA=1
LOOP
 READNEXT ID ELSE DATA=0
WHILE DATA DO
  MATREAD JCATG.REC FROM JOB.CATEGORY,ID THEN
     SCHEMA.ONLY = 0
*     IF CNT = 1 THEN 
*     OUTPUTXML="<JobCategory>"
*     END ELSE
     OUTPUTXML:="<JobCategory>"
*     END
OUTPUTXML := "<Cono>" : ID[1,3] : "</Cono>"
     OUTPUTXML:="<JobCategoryId>":ID[4,99]:"</JobCategoryId>"
     OUTPUTXML:="<JobCategoryName>":JCATG.DESC:"</JobCategoryName>"      
     OUTPUTXML:="<Display>":ID[4,99]:"-":JCATG.DESC:"</Display>"
     OUTPUTXML:="</JobCategory>"
     CNT = CNT + 1
  END
REPEAT
CLEARSELECT
RETURN
99999*
IF ERRMSG <> "" THEN
    ERRMSG="GetJobCategories ----> JCS_GETJOBCATEGORIES --->": ERRMSG
    CALL WRITELOG(ERRMSG)
END
RETURN
