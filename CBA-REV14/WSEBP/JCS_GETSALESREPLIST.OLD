 SUBROUTINE JCS_GETSALESREPLIST(CONO,OUTPUTXML,SCHEMA.ONLY)
 *************************************************
OUTPUTXML='<SalesRep><SalesRepcode></SalesRepcode><SalesRepName></SalesRepName></SalesRep>'
SCHEMA.ONLY = 1
ERRMSG=""
CNT = 1
 $INCLUDE PMC.CPYLIB SALESMAN
 $INCLUDE PMC.CPYLIB COMPANY
 OPEN "COMPANY" TO COMPANY ELSE ERRMSG="CANNOT OPEN COMPANY FILE";GOTO 99999
 OPEN 'SALESMAN' TO SALESMAN ELSE ERRMSG="CANNOT OPEN SALESMAN FILE" ; GOTO 99999
 MATREAD COMP.REC FROM COMPANY,CONO ELSE
       ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
       GOTO 99999
 END
 CMD= "SSELECT SALESMAN WITH @ID LIKE '" : CONO : "...'"
 UDTEXECUTE CMD
 DATA=1
 LOOP
 READNEXT ID ELSE DATA=0
 WHILE DATA DO
 MATREAD SALESMAN.REC FROM SALESMAN,ID THEN
   SCHEMA.ONLY = 0
   IF CNT = 1 THEN 
   OUTPUTXML="<SalesRep>"
   END ELSE
   OUTPUTXML:="<SalesRep>"
   END
   OUTPUTXML:="<SalesRepcode>" : ID : "</SalesRepcode>"  
   OUTPUTXML:="<SalesRepName>" : SALS.NAME : "</SalesRepName>" 
   OUTPUTXML:="</SalesRep>"
   CNT = CNT + 1
END
REPEAT
CLEARSELECT
RETURN
99999*
IF ERRMSG <> "" THEN
     ERRMSG ="GetSalesRepList ----> JCS_GETSALESREPLIST --->": ERRMSG
     CALL WRITELOG(ERRMSG)
END
RETURN
