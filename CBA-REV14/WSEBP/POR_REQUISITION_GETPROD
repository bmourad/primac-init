SUBROUTINE POR_REQUISITION_GETPROD(CONO,VALUE,ERRMSG,STRXML)
STRXML := '<InventoryProduct><ProductNo></ProductNo><ProductDesc></ProductDesc></InventoryProduct>'
$INCLUDE ICS.CPYLIB INVENTORY
$INCLUDE PMC.CPYLIB COMPANY
OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = 'COMPANY FILE IS MISSING'; GOTO 99999
OPEN '','INVENTORY' TO INVENTORY ELSE ERRMSG = 'INVENTORY FILE IS MISSING'; GOTO 99999
  MATREAD COMP.REC FROM COMPANY,CONO ELSE
      ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
      GOTO 99999
  END
  MATREAD INV.REC FROM INVENTORY, CONO:VALUE ELSE
    ERRMSG = "INVENTORY (":VALUE:") IS NOT ON FILE."
    GOTO 99999
  END
  STRXML := '<InventoryProduct>'
  STRXML := '<ProductNo>' : VALUE : '</ProductNo>'
  STRXML := '<ProductDesc>' : INV.FULL.DESC : '</ProductDesc>'
  STRXML := '</InventoryProduct>'
99999*
 IF ERRMSG <> "" THEN
 ERRMSG = "GetProduct  ---> POR_REQUISITION_GETPROD ---> " : ERRMSG
      CALL WRITELOG(ERRMSG)
 END
 RETURN
