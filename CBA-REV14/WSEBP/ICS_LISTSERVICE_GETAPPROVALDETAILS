SUBROUTINE ICS_LISTSERVICE_GETAPPROVALDETAILS(USRID,STRXML,ERRMSG,SCHEMA.ONLY)
SCHEMA.ONLY = 1
$INCLUDE POS.CPYLIB APP.REQ
$INCLUDE PMC.CPYLIB COMPANY
* OPEN FILES
*
OPEN "","APP.REQ" TO APP.REQ ELSE
           ERRMSG = "CANNOT OPEN APP.REQ FILE"
           GOTO 99999
END
OPEN "","CONTROL" TO CONTROL ELSE
           ERRMSG = "CANNOT OPEN CONTROL FILE"
           GOTO 99999
END
*
* INITIALIZE  VARIABLES
*
ERRMSG=""
*
* MAIN PROCESSING
*
****VEND
CNT = 0
CMD= "SSELECT APP.REQ WITH @ID LIKE '...":USRID:"...'"
UDTEXECUTE CMD CAPTURING JUNG
DATA=1
LOOP
  READNEXT ID ELSE DATA=0
  WHILE DATA DO
    SCHEMA.ONLY = 0
    CNT = CNT + 1
    MATREAD APP.REQ.REC FROM APP.REQ, ID THEN
STRXML:='<APPROVALDETAILS><APPROVALId>'  : ID[4,99] : '</APPROVALId></APPROVALDETAILS>'
    END
REPEAT
UDTEXECUTE "CLEARSELECT"
RETURN
*
* WRITE ERROR MESSAGE
*
99999*
IF ERRMSG <> "" THEN
      ERRMSG = "GetApprovalDetails ----> ICS_LISTSERVICE_GETAPPROVALDETAILS --->": ERRMSG
      CALL WRITELOG(ERRMSG)
END
RETURN
