SUBROUTINE PMC_COMPANY_GETSHIPVIALIST(CONO,STRXML,ERRMSG,SCHEMA.ONLY)
SCHEMA.ONLY = 1
$INCLUDE POS.CPYLIB APP.REQ
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE PMC.CPYLIB SHIP.VIA
* OPEN FILES
*
OPEN "","SHIP.VIA" TO SHIP.VIA ELSE
           ERRMSG = "CANNOT OPEN SHIP.VIA FILE"
           GOTO 99999
END
OPEN "","COMPANY" TO COMPANY ELSE
           ERRMSG = "CANNOT OPEN COMPANY FILE"
           GOTO 99999
END
*
* INITIALIZE  VARIABLES
*
ERRMSG=""
CNT = 0
FLAG = 0
CONO_ID = ""
SHPV_ID = ""
SHPV_DESC = ""
SHPV_ID_DESC = ""
*
* MAIN PROCESSING
*
****SHIP VIA LIST
IF INDEX(CONO,"XML",1) THEN
  IF CONO[1,1] = "*" THEN CONO = CONO[1,1] ELSE CONO = CONO[1,3]
  FLAG = 1
END
IF CONO = "*" THEN
CMD= "SSELECT SHIP.VIA"
END ELSE
MATREAD COMP.REC FROM COMPANY,CONO ELSE
ERRMSG="COMPANY NUMBER ":CONO : " DOES NOT EXIST"
GOTO 99999
END
CNT = 0
CMD= "SSELECT SHIP.VIA WITH @ID LIKE '" : CONO : "...'"
END
UDTEXECUTE CMD CAPTURING JUNG
DATA=1
LOOP
  READNEXT ID ELSE DATA=0
  WHILE DATA DO
    SCHEMA.ONLY = 0
    MATREAD SHIP.VIA.REC FROM SHIP.VIA, ID THEN
    CNT = CNT + 1
      IF FLAG THEN
        CONO_ID<1,CNT> = ID[1,3]
        SHPV_ID<1,CNT> = ID[4,99]
        SHPV_DESC<1,CNT> = SHPV.DESC 
	SHPV_ID_DESC<1,CNT> = ID[4,99]:"-":SHPV.DESC
      END ELSE
STRXML:='<ShipVia><Cono>': ID[1,3] :'</Cono><ShipViaId>'  : ID[4,99] : '</ShipViaId><ShipViaDesc>'  : SHPV.DESC : '</ShipViaDesc><ShipViaIdDesc>' :ID[4,99]:"-":SHPV.DESC: '</ShipViaIdDesc></ShipVia>'
      END
    END
REPEAT
IF FLAG THEN
STRXML:='<ShipVia><Cono>': CONO_ID :'</Cono><ShipViaId>'  : SHPV_ID : '</ShipViaId><ShipViaDesc>'  : SHPV_DESC : '</ShipViaDesc><ShipViaIdDesc>' :SHPV_ID_DESC: '</ShipViaIdDesc></ShipVia>'
END
UDTEXECUTE "CLEARSELECT"
RETURN
*
* WRITE ERROR MESSAGE
*
99999*
IF ERRMSG <> "" THEN
      ERRMSG = "GetShipViaList ----> PMC_COMPANY_GETSHIPVIALIST --->": ERRMSG
      CALL WRITELOG(ERRMSG)
END
RETURN
