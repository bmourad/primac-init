   SUBROUTINE RFT_SYSVARS_SUB(SYSVAR)
*****************************************************************
*   This subroutine is a generic subroutine to retreive system information
*   More variable can be easily added upon request
*
*@DICT MUST BE USED IN THE BASIC PROGRAM
*@ID MUST BE USED IN THE BASIC PROGRAM
*@RECORD MUST BE USED IN THE BASIC PROGRAM
*Delimiters:
*   @AM = ATTRIBUTE MARK
*   @VM = VALUE MARK
*   @SM = SUBVALUE MARK
*   @RM = RECORD MARK
*   @TM = TEXT MARK
*   @SVM = SUBVALUE MARK (SAME AS @SM)
*
*T21037 gat 09/30/1996 * FIX FOR SUBNETED CUSTOMERS..EXPAND NODE ID.
*T11111 duane 05/08/1998 * FIX PROBLEM WITH DUPLICATE IP ADDRESSES IN
*                          PORT.NO ROUTINE
*T27646 thompson 08/18/2003 * MODIFY FOR MULTI PLATFORM ISSUE
*T27684 wyamout 09/08/2003 * ADD UDTHOME
*T27689 wyamout 09/09/2003 * ADD ALL THE POSSIBLE USAGE OF @VARAIABLES
*                            TO THE CASE
*ENDDOC
**********************************************************************
*
*--- CHECK REQUEST
*
   BEGIN CASE
   CASE SYSVAR = "TTY";* Primac Unique ID
*     UDT.NO = @UDTNO;* T27689
*     LOG.NAME = @LOGNAME;* T27689
*     SYSVAR = LOG.NAME:"_":UDT.NO ; *T27689
      GOSUB PMCTTY_SUB
   CASE SYSVAR = "OS";* Operating system
      SYSVAR = SYSTEM(33)
   CASE SYSVAR = "ACCT";* Account Name
      SYSVAR = @WHO
*T27689 v
   CASE SYSVAR = "@TTY";* Current tty
      SYSVAR = @TTY
   CASE SYSVAR = "ACCOUNT";* Path where you first enered UniData
      SYSVAR = @ACCOUNT
   CASE SYSVAR = "COMMAND";* Last UniData command
      SYSVAR = @COMMAND
   CASE SYSVAR = "CONV";* used with CALCULATE
      SYSVAR = @CONV
   CASE SYSVAR = "CRTHIGH";* screen hight
      SYSVAR = @CRTHIGH
   CASE SYSVAR = "CRTWIDE";* screen width
      SYSVAR = @CRTWIDE
   CASE SYSVAR = "DATA";* data stack or input queue
      SYSVAR = @DATA
   CASE SYSVAR = "DATE";* internal system date when the program began
      SYSVAR = @DATE
   CASE SYSVAR = "DAY";* DD
      SYSVAR = @DAY
   CASE SYSVAR = "FORMAT";* used with CALCULATE
      SYSVAR = @FORMAT
   CASE SYSVAR = "GID";* group ID (UNIX/WINDOWS diff)
      SYSVAR = @GID
   CASE SYSVAR = "HEADER";* used with CALCULATE
      SYSVAR = @HEADER
   CASE SYSVAR = "LASTVERB";* last executed command
      SYSVAR = @LASTVERB
   CASE SYSVAR = "LEVEL";* Current PERFORM or EXECUTE level
      SYSVAR = @LEVEL
   CASE SYSVAR = "LOGNAME";* Login Name
      SYSVAR = @LOGNAME
   CASE SYSVAR = "LPTRHIGH";* page length
      SYSVAR = @LPTRHIGH
   CASE SYSVAR = "LPTRWIDE";* page width
      SYSVAR = @LPTRWIDE
   CASE SYSVAR = "MONTH";* MM
      SYSVAR = @MONTH
   CASE SYSVAR = "PARASENTENCE";* last paragraph/sentence with parameters
      SYSVAR = @PARASENTENCE
   CASE SYSVAR = "PATH";* current path
      SYSVAR = @PATH
   CASE SYSVAR = "RECUR0";* recursive user defined
      SYSVAR = @RECUR0
   CASE SYSVAR = "RECUR1";* recursive user defined
      SYSVAR = @RECUR1
   CASE SYSVAR = "RECUR2";* recursive user defined
      SYSVAR = @RECUR2
   CASE SYSVAR = "RECUR3";* recursive user defined
      SYSVAR = @RECUR3
   CASE SYSVAR = "RECUR4";* recursive user defined
      SYSVAR = @RECUR4
   CASE SYSVAR = "SENTENCE";* statement invoked the program
      SYSVAR = @SENTENCE
   CASE SYSVAR = "SYS.BELL";* enable or disable bell
      SYSVAR = @SYS.BELL
   CASE SYSVAR = "SYSTEM.RETURN.CODE";* ussually returns -1 if ECL command error
      SYSVAR = @SYSTEM.RETURN.CODE
   CASE SYSVAR = "TIME";* internal system time when the program began
      SYSVAR = @TIME
   CASE SYSVAR = "TRANSACTION";* 1 if there is a transaction occurring
      SYSVAR = @TRANSACTION
   CASE SYSVAR = "TUPLE";* ???
      SYSVAR = @TUPLE
   CASE SYSVAR = "UDTNO";* Unidata user number
      SYSVAR = @UDTNO
   CASE SYSVAR = "UID";* OS user ID
      SYSVAR = @UID
   CASE SYSVAR = "USER0";* user define, must reset
      SYSVAR = @USER0
   CASE SYSVAR = "USER1";* user define, must reset
      SYSVAR = @USER1
   CASE SYSVAR = "USER2";* user define, must reset
      SYSVAR = @USER2
   CASE SYSVAR = "USER3";* user define, must reset
      SYSVAR = @USER3
   CASE SYSVAR = "USER4";* Used as Redback Flag
      SYSVAR = @USER4
   CASE SYSVAR = "USERNO";* udt process ID number
      SYSVAR = @USERNO
   CASE SYSVAR = "USER.RETURN.CODE";* User Defined
      SYSVAR = @USER.RETURN.CODE
   CASE SYSVAR = "USER.TYPE";* 0=Normal, 1=Phantom, 2=Redirect
      SYSVAR = @USER.TYPE
   CASE SYSVAR = "WHO";* current directory (not path)
      SYSVAR = @WHO
   CASE SYSVAR = "YEAR";* YY
      SYSVAR = @YEAR
   CASE SYSVAR = "UDTHOME"
      GOSUB GETENV_SUB
   CASE SYSVAR = "redback"
      GOSUB PMCRBFLAG_SUB
   CASE SYSVAR = "PMCLOGNAME"
      GOSUB PMCLOGNAME_SUB
   CASE SYSVAR = "HFNAME"
      GOSUB PMCHFNAME_SUB
*T27689 ^
   CASE 1
      SYSVAR = ""
   END CASE
   GOTO 99999
*
*
*---- All Other
*
*T27689 v
*
*--- OTHER SYSTEM FUNCTIONS
*
GETENV_SUB: 
   SYSVAR = GETENV (SYSVAR)
   RETURN
*
*--- PRIMAC FUNCTIONS
*
PMCTTY_SUB: 
   SYSVAR = @LOGNAME : "_" : @UDTNO
   RETURN
*
PMCRBFLAG_SUB: 
   SYSVAR = @USER4
   IF SYSVAR[1,7] = "redback" THEN
      SYSVAR = SYSVAR[8,99]
   END ELSE
      SYSVAR = ""
   END
   RETURN
*
PMCRBLOGNAME_SUB: 
   GOSUB PMCRBFLAG_SUB
   IF SYSVAR = "" OR SYSVAR<1,2> = "" THEN
      SYSVAR = ""
   END ELSE
      SYSVAR = SYSVAR<1,2>
   END
   RETURN
*
PMCLOGNAME_SUB:
   GOSUB PMCRBLOGNAME_SUB
   IF SYSVAR = "" THEN
      SYSVAR = @LOGNAME
   END
   RETURN
*
PMCHFNAME_SUB: 
   GOSUB PMCTTY_SUB
   SYSVAR = SYSVAR : "_" : UPCASE (@LOGNAME)
   RETURN
*T27689 ^
99999*
   RETURN
END
