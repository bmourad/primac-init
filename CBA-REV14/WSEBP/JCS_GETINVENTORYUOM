SUBROUTINE JCS_GETINVENTORYUOM(CONO,ERRMSG, OUT_PARAM,SCHEMA.ONLY)
OUT_PARAM='<UOMData><UOM><UOMCode></UOMCode><UOMDescription></UOMDescription></UOM></UOMData>'
SCHEMA.ONLY = 1
$INCLUDE PMC.CPYLIB COMPANY
$INCLUDE ICS.CPYLIB INVENTORY
ERRMSG = ''
OPEN '','INVENTORY' TO INVENTORY ELSE ERRMSG = "CANNOT OPEN INVENTORY FILE" ;GOTO 99999
OPEN '','COMPANY' TO COMPANY ELSE ERRMSG = "CANNOT OPEN COMPANY FILE" ;GOTO 99999
UOM.CODE = ''
* READ THE COMPANY CODE
MATREAD COMP.REC FROM COMPANY,CONO ELSE
      ERRMSG=CONO:"- THIS COMPANY NUMBER DOES NOT EXIST"
      GOTO 99999
END
NCTR = 0
CMD= "SSELECT INVENTORY WITH @ID LIKE '" : CONO : "...'"
 UDTEXECUTE CMD
 DATA=1
 LOOP
 READNEXT ID ELSE DATA=0
 WHILE DATA DO
 NCTR = NCTR + 1
 IF NCTR = 1 THEN OUT_PARAM ='<UOMData><UOM>-<UOMCode>':@VM:'</UOMCode><UOMDescription>--Select--</UOMDescription></UOM>'
 MATREAD INV.REC FROM INVENTORY, ID THEN 
  SCHEMA.ONLY = 0
  CNT=DCOUNT(INV.UNIT,@VM)  
  PTR=0
   FOR I = 1 TO CNT
    IF INV.UNIT<1,I> NE '' THEN
     LOCATE INV.UNIT<1,I> IN UOM.CODE<1> SETTING PTR ELSE
      UOM.CODE<1,-1> = INV.UNIT<1,I>
      OUT_PARAM := '<UOM>'
      OUT_PARAM := '<UOMCode>' : INV.UNIT<1,I> : '</UOMCode>'
      OUT_PARAM := '<UOMDescription>' : INV.UNIT<1,I> : '</UOMDescription>'   
      OUT_PARAM := '</UOM>' 
     END
   END
   NEXT I
  END 
REPEAT
IF NCTR GE 1 THEN OUT_PARAM :='</UOMData>'
CLEARSELECT
RETURN
*
*
99999*
 IF ERRMSG <> "" THEN
 ERRMSG = "ERROR FROM JCS_GETINVENTORYUOM ---> " : ERRMSG
      CALL WRITELOG(ERRMSG)
 END
 RETURN
 END
