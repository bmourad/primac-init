SUBROUTINE TAXJM_CREATETAXID(CONO,KEY,TAX_JUR,TAX_ACCT,TAX_RATE,STRXML,ERRMSG)
*DEBUG
*STRXML = "<Xmldata>"
$INCLUDE PMC.CPYLIB TAX
$INCLUDE PMC.CPYLIB COA
$INCLUDE PMC.CPYLIB COMPANY
OPEN "","TAX" TO TAX ELSE
   ERRMSG = "CANNOT OPEN TAX FILE"
   RETURN
END
OPEN "","COA" TO COA ELSE
   ERRMSG = "CANNOR OPEN COA FILE"
   RETURN
END
OPEN "","COMPANY" TO COMPANY ELSE
   ERRMSG = "CNANOT OPEN COMPANY FILE"
   RETURN
END
300*
*CONO = 001
*KEY = 456
*TAX_JUR = " NEW TAX"
*TAX_ACCT = "000000"
*TAX_RATE = 15
*CONO = CONO
*KEY =  KEY
MATREAD TAX.REC FROM TAX, CONO:KEY THEN
   STRXML := '<Taxid>' : KEY : '</Taxid>'
   STRXML := '<TaxDesc>' : TAX.JUR : '</TaxDesc>'
   STRXML := '<TaxAccount>' : TAX.ACCT : '</TaxAccount>'
   STRXML := '<TaxRate>' : TAX.RATE : '</TaxRate>'
   STRXML := "</Xmldata>"
END ELSE
    KEY = KEY
   TAX.JUR = TAX_JUR
   TAX.ACCT = TAX_ACCT
   GOSUB 100 
   TAX.RATE = TAX_RATE
   MATWRITE TAX.REC ON TAX, CONO:KEY
* PRINT @(0,20):"THE ID  ":KEY : "WRITEEN TO THE FILE"
*100 *
*   MATREAD COA.REC FROM COA , CONO:TAX.ACCT THEN
*      TAX.ACCT = TAX.ACCT
*   END ELSE
*      ERRMSG = "THE RECORD ":TAX.ACCT:" IS NOT IN COA FILE"
*   END
*RETURN
*100 *
*   MATREAD COA.REC FROM COA , CONO:TAX.ACCT THEN
*      TAX.ACCT = TAX.ACCT
*   END ELSE
*      ERRMSG = "THE RECORD ":TAX.ACCT:" IS NOT IN COA FILE"
*   END
*RETURN
END
100 *
   MATREAD COA.REC FROM COA , CONO:TAX.ACCT THEN
      TAX.ACCT = TAX.ACCT
   END ELSE
      ERRMSG = "THE RECORD ":TAX.ACCT:" IS NOT IN COA FILE"
   END
RETURN
RETURN
