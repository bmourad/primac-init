SUBROUTINE ICS_POService_ISOPENOUTSIDEPO(CONO, PO.CODE, SCHEMA.ONLY, ERRMSG, STRXML)
$INCLUDE POS.CPYLIB OUTSIDE.PO
OPEN '','OUTSIDE.PO' TO OUTSIDE.PO ELSE
  ERRMSG = "CANNOT OPEN OUTSIDE.PO FILE"
END
PO.KEY = CONO:PO.CODE
FLG = 0
MATREAD OPO.REC FROM OUTSIDE.PO,PO.KEY ELSE CONTINUE
JCNT = DCOUNT(OPO.JOB.NO,@VM)
FOR V = 1 TO JCNT
  OPO.TOT.OPEN<1,V> = OPO.QTY<1,V> - OPO.QTY.RECVD<1,V> - OPO.CANCEL.QTY<1,V>
  IF OPO.TOT.OPEN<1,V> + 0 > 0 THEN
    FLG = 1
  END ELSE
    FLG = 0
  END
NEXT V
STRXML := '<Payload><PO_Num>':PO.KEY[4,99]:'</PO_Num> <PO_Open>':FLG:'</PO_Open></Payload>'
RETURN
