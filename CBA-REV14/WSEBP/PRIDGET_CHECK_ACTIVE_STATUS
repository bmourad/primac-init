SUBROUTINE PRIDGET_CHECK_ACTIVE_STATUS (CONO,USER,DIV.OWNER,RET.FLAG,MAT APP.REQ.REC,APP.REQ.ID,YYY)
$INCLUDE CPYLIB COMMON1
* THIS PROGRAM CHECKS THE ACTIVE STATUS OF THE
* APPROVER AND RETURNS TRUE OR FALSE FLAG
*ENDDOC
**********************************************
*   CPYLIBS
$INCLUDE PMC.CPYLIB COMPANY
$DEFINE FILEVARS
$IFNDEF THEN
$INCLUDE CPYLIB FILE.VARS
$ENDIF
$INCLUDE POS.CPYLIB APP.REQ
*
OPEN '','APP.REQ' TO APP.REQ ELSE ERRMSG = 'APP.REQ FILE IS MISSING';STOP
   RET.FLAG = 1
   IF DIV.OWNER = "00" THEN 
      APP.REQ.ID = CONO:USER:"!ALL"
      MATREAD APP.REQ.REC FROM APP.REQ,APP.REQ.ID THEN
         IF APP.STATUS = "N" THEN
            RET.FLAG = 0
         END
      END ELSE
         RET.FLAG = 0
      END
   END ELSE
      APP.REQ.ID = CONO:USER:"!ALL"
      MATREAD APP.REQ.REC FROM APP.REQ,APP.REQ.ID THEN
         IF APP.STATUS = "N" THEN
            MATREAD APP.REQ.REC FROM APP.REQ,CONO:USER:"!":DIV.OWNER THEN
               IF APP.STATUS = "N" THEN
                  RET.FLAG = 0
               END
            END ELSE
               RET.FLAG = 0
            END
         END
      END ELSE
         APP.REQ.ID = CONO:USER:"!":DIV.OWNER
         MATREAD APP.REQ.REC FROM APP.REQ,APP.REQ.ID THEN
            IF APP.STATUS = "N" THEN
               RET.FLAG = 0
            END
         END ELSE
            RET.FLAG = 0
         END
      END
   END
