SUBROUTINE JCS_GETCUSTOMERCSR(CONO,CUST.ID,STRXML,ERRMSG,SCHEMA.ONLY)
STRXML='<CustomerCSR><CSrId></CSrId><CSRName></CSRName><CSRUserId></CSRUserId><CSREmail></CSREmail></CustomerCSR>'
SCHEMA.ONLY = 1
$INCLUDE PMC.CPYLIB CUSTOMER
$INCLUDE PMC.CPYLIB CSR.CODE
$INCLUDE PMC.CPYLIB COMPANY
*IF CONO="" THEN
*  ERRMSG="COMPANY NUMBER CANNOT BE BLANK"
*  GOTO 99999
*END
*IF CUST.ID="" THEN
*  ERRMSG="CUSTOMER ID CANNOT BE BLANK"
*  GOTO 99999
*END
*
* OPEN FILES
*
OPEN "","CUSTOMER" TO CUSTOMER ELSE
      	ERRMSG = "CANNOT OPEN CUSTOMER FILE"
    	GOTO 99999
END
OPEN "","CSR.CODE" TO CSR.CODE ELSE
      	ERRMSG = "CANNOT OPEN CSR.CODE FILE"
    	GOTO 99999
END
OPEN "","COMPANY" TO COMPANY ELSE
      	ERRMSG = "CANNOT OPEN COMPANY FILE"
    	GOTO 99999
END
*
* INITIALIZE  VARIABLES
*
CUST.CSR.CODE = ''
ERRMSG=""
*
* MAIN PROCESSING
*
MATREAD COMP.REC FROM COMPANY,CONO ELSE
ERRMSG="COMPANY NUMBER ":CONO : " DOES NOT EXIST"
      GOTO 99999
END
READV CUST.CSR.CODE FROM CUSTOMER,CONO:CUST.ID, 21 ELSE CUST.CSR.CODE=''
IF CUST.CSR.CODE # '' THEN
  MATREAD CSR.REC FROM CSR.CODE, CONO:CUST.CSR.CODE THEN
     SCHEMA.ONLY = 0
     STRXML="<CustomerCSR>"
     STRXML:="<CSrId>":CUST.CSR.CODE:"</CSrId>"
     STRXML:="<CSRName>":CSR.DESC:"</CSRName>"
     STRXML:="<CSRUserId>":CSR.USER:"</CSRUserId>"
     STRXML:="<CSREmail>":CSR.EMAIL:"</CSREmail>"
     STRXML:="</CustomerCSR>"
  END 
END
RETURN
*
* WRITE ERROR MESSAGE
*
99999*
IF ERRMSG <> "" THEN
      ERRMSG = "GetCustomerCsr ----> JCS_GETCUSTOMERCSR --->": ERRMSG
      CALL WRITELOG(ERRMSG)
END
RETURN
