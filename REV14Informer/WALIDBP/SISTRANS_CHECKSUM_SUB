   SUBROUTINE SISTRANS_CHECKSUM_SUB (MODE, ID, MAT SISMSG_REC, MAT SISTRN_REC, TOT_CHKSUM)
*COPY>SIS.CPYLIB>SIS_TRANS
*COPY>SIS.CPYLIB>SISMSG
*COPY>CPYLIB>CHAR
*
   TOT_CHKSUM = 0
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_TRANSID)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_TIMESTMP)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_TTYPE)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_DIV)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_DEPT)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_CCTR)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_JOB)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_EMP)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_SHIFT)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_OPER)
   BEGIN CASE
      CASE SISTRN_UNITS = ""
         TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_UNITS)
      CASE ("X":SISTRN_UNITS) = "X0"
         TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_UNITS)
      CASE (SISTRN_UNITS/100) = INT(SISTRN_UNITS/100)
         TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(OCONV(SISTRN_UNITS, "MD2"))
      CASE (SISTRN_UNITS/10) = INT(SISTRN_UNITS/10)
         TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(OCONV(SISTRN_UNITS, "MD2"))
      CASE 1
         TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_UNITS/100)
   END CASE
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_COMPLETE)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_SPOILAGE)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_CLASS)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_TCODE)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_OT_CODE)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_BARCODE)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_PROD)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_WHSE)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_LOC)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_SKID)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_QTYPE)
   BEGIN CASE
      CASE SISTRN_QTY = ""
         TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_QTY)
      CASE ("X":SISTRN_QTY) = "X0"
         TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_QTY)
      CASE (SISTRN_QTY/1000) = INT(SISTRN_QTY/1000)
         TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(OCONV((SISTRN_QTY/10), "MD2"))
      CASE (SISTRN_QTY/10) = INT(SISTRN_QTY/10)
         TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(OCONV((SISTRN_QTY/10), "MD2"))
      CASE 1
         TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_QTY/1000)
   END CASE
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_COMMENTS)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_UPLOAD)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_CONO)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_SERVER)
   TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_CLIENT)
   JCNT = DCOUNT(SISTRN_MJ_JOB,VM)
   FOR JP = 1 TO JCNT
      TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_MJ_JOB<1,JP>)
   NEXT JP
   MCNT = DCOUNT(SISTRN_MP_PROD,VM)
   SCNT = DCOUNT(SISTRN_MP_SKID,VM)
   IF SCNT > MCNT THEN MCNT = SCNT
   FOR MP = 1 TO MCNT
      TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_MP_PROD<1,MP>)
      TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_MP_WHSE<1,MP>)
      TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_MP_LOC<1,MP>)
      TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_MP_SKID<1,MP>)
      TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_MP_QTYPE<1,MP>)
      BEGIN CASE
         CASE SISTRN_MP_QTY<1,MP> = ""
            TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_MP_QTY<1,MP>)
         CASE ("X":SISTRN_MP_QTY<1,MP>) = "X0"
            TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_MP_QTY<1,MP>)
         CASE (SISTRN_MP_QTY<1,MP>/1000) = INT(SISTRN_MP_QTY<1,MP>/1000)
            TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(OCONV((SISTRN_MP_QTY<1,MP>/10), "MD2"))
         CASE (SISTRN_MP_QTY<1,MP>/10) = INT(SISTRN_MP_QTY<1,MP>/10)
            TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(OCONV((SISTRN_MP_QTY<1,MP>/10), "MD2"))
         CASE 1
            TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_MP_QTY<1,MP>/1000)
      END CASE
   NEXT MP
   PCNT = DCOUNT(SISTRN_PRMPT.CODE,VM)
   FOR PP = 1 TO PCNT
      TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_PRMPT.CODE<1,PP>)
      TOT_CHKSUM = TOT_CHKSUM + CHECKSUM(SISTRN_PRMPT.RESP<1,PP>)
   NEXT PP
   TOT_CHKSUM = MOD(TOT_CHKSUM,32767);* INTEGER MAX NUMBER IS 32767
   IF MODE = "PRINT" THEN
      IF SISMSG_CHECKSUM # TOT_CHKSUM THEN
         CRT ID :", ": SISMSG_CHECKSUM :", ": TOT_CHKSUM
*
         PRINT NEW.PAGE
         PRINT ID :", ": SISMSG_CHECKSUM :", ": TOT_CHKSUM
         PRINT
         PRINT "TRANSID" "L#30 " : CHECKSUM(SISTRN_TRANSID) "R#7 " : SISTRN_TRANSID
         PRINT "TIMESTMP" "L#30 " : CHECKSUM(SISTRN_TIMESTMP) "R#7 " : SISTRN_TIMESTMP
         PRINT "TTYPE" "L#30 " : CHECKSUM(SISTRN_TTYPE) "R#7 " : SISTRN_TTYPE
         PRINT "DIV" "L#30 " : CHECKSUM(SISTRN_DIV) "R#7 " : SISTRN_DIV
         PRINT "DEPT" "L#30 " : CHECKSUM(SISTRN_DEPT) "R#7 " : SISTRN_DEPT
         PRINT "CCTR" "L#30 " : CHECKSUM(SISTRN_CCTR) "R#7 " : SISTRN_CCTR
         PRINT "JOB" "L#30 " : CHECKSUM(SISTRN_JOB) "R#7 " : SISTRN_JOB
         PRINT "EMP" "L#30 " : CHECKSUM(SISTRN_EMP) "R#7 " : SISTRN_EMP
         PRINT "SHIFT" "L#30 " : CHECKSUM(SISTRN_SHIFT) "R#7 " : SISTRN_SHIFT
         PRINT "OPER" "L#30 " : CHECKSUM(SISTRN_OPER) "R#7 " : SISTRN_OPER
         TMPSUM = ""
         TMPVAL = ""
         BEGIN CASE
            CASE SISTRN_UNITS = ""
               TMPSUM = CHECKSUM(SISTRN_UNITS)
               TMPVAL = SISTRN_UNITS
            CASE ("X":SISTRN_UNITS) = "X0"
               TMPSUM = CHECKSUM(SISTRN_UNITS)
               TMPVAL = SISTRN_UNITS
            CASE (SISTRN_UNITS/100) = INT(SISTRN_UNITS/100)
               TMPSUM = CHECKSUM(OCONV(SISTRN_UNITS, "MD2"))
               TMPVAL = OCONV(SISTRN_UNITS, "MD2")
            CASE (SISTRN_UNITS/10) = INT(SISTRN_UNITS/10)
               TMPSUM = CHECKSUM(OCONV(SISTRN_UNITS, "MD2"))
               TMPVAL = OCONV(SISTRN_UNITS, "MD2")
            CASE 1
               TMPSUM = CHECKSUM(SISTRN_UNITS/100)
               TMPVAL = SISTRN_UNITS/100
         END CASE
         PRINT "UNITS" "L#30 " : TMPSUM "R#7 " : TMPVAL
         PRINT "COMPLETE" "L#30 " : CHECKSUM(SISTRN_COMPLETE) "R#7 " : SISTRN_COMPLETE
         PRINT "SPOILAGE" "L#30 " : CHECKSUM(SISTRN_SPOILAGE) "R#7 " : SISTRN_SPOILAGE
         PRINT "CLASS" "L#30 " : CHECKSUM(SISTRN_CLASS) "R#7 " : SISTRN_CLASS
         PRINT "TCODE" "L#30 " : CHECKSUM(SISTRN_TCODE) "R#7 " : SISTRN_TCODE
         PRINT "OT_CODE" "L#30 " : CHECKSUM(SISTRN_OT_CODE) "R#7 " : SISTRN_OT_CODE
         PRINT "BARCODE" "L#30 " : CHECKSUM(SISTRN_BARCODE) "R#7 " : SISTRN_BARCODE
         PRINT "PROD" "L#30 " : CHECKSUM(SISTRN_PROD) "R#7 " : SISTRN_PROD
         PRINT "WHSE" "L#30 " : CHECKSUM(SISTRN_WHSE) "R#7 " : SISTRN_WHSE
         PRINT "LOC" "L#30 " : CHECKSUM(SISTRN_LOC) "R#7 " : SISTRN_LOC
         PRINT "SKID" "L#30 " : CHECKSUM(SISTRN_SKID) "R#7 " : SISTRN_SKID
         PRINT "QTYPE" "L#30 " : CHECKSUM(SISTRN_QTYPE) "R#7 " : SISTRN_QTYPE
         TMPSUM = ""
         TMPVAL = ""
         BEGIN CASE
            CASE SISTRN_QTY = ""
               TMPSUM = CHECKSUM(SISTRN_QTY)
               TMPVAL = SISTRN_QTY
            CASE ("X":SISTRN_QTY) = "X0"
               TMPSUM = CHECKSUM(SISTRN_QTY)
               TMPVAL = SISTRN_QTY
            CASE (SISTRN_QTY/1000) = INT(SISTRN_QTY/1000)
               TMPSUM = CHECKSUM(OCONV((SISTRN_QTY/10), "MD2"))
               TMPVAL = OCONV((SISTRN_QTY/10), "MD2")
            CASE (SISTRN_QTY/10) = INT(SISTRN_QTY/10)
               TMPSUM = CHECKSUM(OCONV((SISTRN_QTY/10), "MD2"))
               TMPVAL = OCONV((SISTRN_QTY/10), "MD2")
            CASE 1
               TMPSUM = CHECKSUM(SISTRN_QTY/1000)
               TMPVAL = SISTRN_QTY/1000
         END CASE
         PRINT "QTY" "L#30 " : TMPSUM "R#7 " : TMPVAL
         PRINT "COMMENTS" "L#30 " : CHECKSUM(SISTRN_COMMENTS) "R#7 " : SISTRN_COMMENTS
         PRINT "UPLOAD" "L#30 " : CHECKSUM(SISTRN_UPLOAD) "R#7 " : SISTRN_UPLOAD
         PRINT "CONO" "L#30 " : CHECKSUM(SISTRN_CONO) "R#7 " : SISTRN_CONO
         PRINT "SERVER" "L#30 " : CHECKSUM(SISTRN_SERVER) "R#7 " : SISTRN_SERVER
         PRINT "CLIENT" "L#30 " : CHECKSUM(SISTRN_CLIENT) "R#7 " : SISTRN_CLIENT
         JCNT = DCOUNT(SISTRN_MJ_JOB,VM)
         FOR JP = 1 TO JCNT
            IF JP = 1 THEN
               PRINT "Multi Jobs"
            END
            VLINE = JP "R#3 "
            VLINE = VLINE : CHECKSUM(SISTRN_MJ_JOB<1,JP>)
            PRINT VLINE
         NEXT JP
         MCNT = DCOUNT(SISTRN_MP_PROD,VM)
         SCNT = DCOUNT(SISTRN_MP_SKID,VM)
         IF SCNT > MCNT THEN MCNT = SCNT
         FOR MP = 1 TO MCNT
            IF MP = 1 THEN
               PRINT "Multi Products"
            END
            VLINE = MP "R#3 "
            VLINE = VLINE : CHECKSUM(SISTRN_MP_PROD<1,MP>) "L#5 "
            VLINE = VLINE : CHECKSUM(SISTRN_MP_WHSE<1,MP>) "L#5 "
            VLINE = VLINE : CHECKSUM(SISTRN_MP_LOC<1,MP>) "L#5 "
            VLINE = VLINE : CHECKSUM(SISTRN_MP_SKID<1,MP>) "L#5 "
            VLINE = VLINE : CHECKSUM(SISTRN_MP_QTYPE<1,MP>) "L#5 "
            TMPSUM = ""
            BEGIN CASE
               CASE SISTRN_MP_QTY<1,MP> = ""
                  TMPSUM = CHECKSUM(SISTRN_MP_QTY<1,MP>)
               CASE ("X":SISTRN_MP_QTY<1,MP>) = "X0"
                  TMPSUM = CHECKSUM(SISTRN_MP_QTY<1,MP>)
               CASE (SISTRN_MP_QTY<1,MP>/1000) = INT(SISTRN_MP_QTY<1,MP>/1000)
                  TMPSUM = CHECKSUM(OCONV((SISTRN_MP_QTY<1,MP>/10), "MD2"))
               CASE (SISTRN_MP_QTY<1,MP>/10) = INT(SISTRN_MP_QTY<1,MP>/10)
                  TMPSUM = CHECKSUM(OCONV((SISTRN_MP_QTY<1,MP>/10), "MD2"))
               CASE 1
                  TMPSUM = CHECKSUM(SISTRN_MP_QTY<1,MP>/1000)
            END CASE
            VLINE = VLINE : TMPSUM
            PRINT VLINE
         NEXT MP
         PCNT = DCOUNT(SISTRN_PRMPT.CODE,VM)
         FOR PP = 1 TO PCNT
            IF PP = 1 THEN
               PRINT "Multi Prompts"
            END
            VLINE = PP "R#3 "
            VLINE = VLINE : CHECKSUM(SISTRN_PRMPT.CODE<1,PP>) "L#5 "
            VLINE = VLINE : CHECKSUM(SISTRN_PRMPT.RESP<1,PP>)
            PRINT VLINE
         NEXT PP
      END ELSE
         CRT ID :", ": TOT_CHKSUM
      END
   END
   RETURN
END
